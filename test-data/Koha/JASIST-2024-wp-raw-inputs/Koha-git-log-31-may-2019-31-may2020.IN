commit 9c5ff1df9de387ba6bb5f47c27f84c2d6108d3a8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 29 20:04:16 2020 +0100

    Bug 24846: Add sponsorship details
    
    Sponsored-by: PTFS Europe
    Sponsored-by: ByWater Solutions
    Sponsored-by: BibLibre
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a7778ed8586b00bdf79dbd5db02c525d108ea8ea
Author: Mengü Yazıcıoğlu <kohadevinim@devinim.com.tr>
Date:   Fri May 22 22:11:31 2020 +0000

    Bug 25592: Add Devinim to about page
    
    This adds Devinim to the 'Contributing companies and
    institutions' section on Koha's about page.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 7b1e8c59fe0edc2faab878c6bd9d45de9f720e81
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 28 15:30:02 2020 +0200

    Bug 25618: Fix wrong package install path for misc dir
    
    root@koha-debian9:/# koha-z3950-responder --start d9
    [....] Starting Z39.50/SRU daemon for d9:Can't open perl script "/usr/share/koha/bin/z3950_responder.pl/z3950_responder.pl": Not a directory
     failed!
    
    Test plan:
    On a dev install, copy the debian script and run it
    Same on a package install
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 46e23b3a035e9c326c50aaa2dfba62667a9aca4b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 28 17:37:20 2020 +0000

    Bug 25617: (QA follow-up) Add responses to tests
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit dd0c7c55fc2b5f0a312055d0c051b166d75ea82d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 28 16:12:57 2020 +0200

    Bug 25617: (bug 25133 follow-up) 12 PM is not 24 but 0
    
    There was an error in the precedent code, in 12hr format, 12PM is
    actually 00:00
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit a79cf4150e8a08e743acc7d7147af91757d7a9b8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 22 14:29:20 2020 +0200

    Bug 25513: Remove unneeded integer casting in Koha::Object->TO_JSON
    
    This patch removes a problematic integer casting happening in TO_JSON.
    The original need for this cast (a DBD::mysql bug) is now fixed. We
    remove the cast as it is causing random failures.
    
    To test:
    1. Apply the regression tests
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/acquisitions_orders.t
    => FAIL: Tests fail with select high values (i.e. casting gives wrong
            results)
    3. Apply this patch
    4. Repeat 2
    => SUCCESS: Tests now pass!
    5. Sign off :-D
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 9d8f9f1d3b0a10bc677904cd39764acbf4f75e13
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed May 27 09:55:16 2020 -0300

    Bug 25513: Regression tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit f1cc9d6b599ae423d8024fb11f3f601d57ab9963
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 26 10:10:52 2020 +0200

    Bug 25601: (bug 18928 follow-up) Fix "Unset" for "return policy for $branch"
    
    returnbranch has to pass an itemtype key when setting the rule (here
    setting it to unlimited for any item types)
    
    Test plan:
    1. Go the "Circulation and fine rules" admin page
    2. Set a rule for "Default checkout, hold and return policy"
    3. Unset it
    4. Select a library
    5. Set a rule for "Default checkout, hold and return policy"
    6. Unset it
    
    Display should be consistent with what you selected
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 218322597e7a7104a15229e333ae7c1a917a675c
Author: Didier Gautheron <didier.gautheron@biblibre.com>
Date:   Wed May 27 04:18:58 2020 +0200

    Bug 25608: (bug 23463 follow-up) Fix inventory regression
    
    Follow-up work
      commit bbb504c86f5ca0a474365d4839177412f415c4ee
      Bug 23463: Replace ModItem with Koha::Item->store
    
    Test plan :
        - Create a biblio with default framework
        - Create an item with barcode='000AAA1', callnumber='ZZZAAA1'
        - Create an item with barcode='000AAA2', callnumber='ZZZAAA2'
        - Create a file 'barecodes.txt' containing 2 lines '000AAA1' and '000AAA2'
        - Go to inventory tool : /cgi-bin/koha/tools/inventory.pl
        - Choose file in 'Barcode file'
        - Enter item callnumber between 'ZZZ' and 'ZZZa'
        - Check 'Compare barcodes list to results'
        - Submit
        => without patch, you get an error trace
        - Apply patch, it works
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Amended commit title.
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 051b2d014241ea6f71084227b05023808cff0212
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed May 27 06:28:40 2020 -0400

    Bug 25444: More minor improvements to simplified loop
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 6b1a53da6d38e5bba7317e8b24be1df501ed0db0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 27 10:25:15 2020 +0200

    Bug 25444: Simplify the code using a loop
    
    In order to prevent typos or further regressions it is better (I think)
    to have this code into a loop
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 84230706499b4673d9061adc2d2ac025fa31a342
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 26 09:08:15 2020 -0400

    Bug 25444: Backup/restore course items fields correctly
    
    This patch makes the code set the *_storage fields when adding new
    fields to an existing course item. And reverts those fields correctly
    when removing the item from the course.
    
    If a new field is enabled on an existing course reserve, the storage
    field is not given a value, so when the item goes off reserve, the
    item field will always be updated to NULL.
    
    To test:
    1. Apply the regression tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/CourseReserves/CourseItems.t
    => FAIL: Tests fail, data is not reverted correctly
    3. Apply this patch and repeat 2
    => SUCCESS: Tests pass! Data is correctly reverted
    4. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 5818d900e8e7927bc437dc60cd992c6a18ceb16f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 26 13:04:11 2020 -0400

    Bug 25444: Add unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 0b5a8f6c19c2705ed72c57185aee12b1333cf5ae
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 26 14:41:04 2020 +0200

    Bug 20116: Fix package install path for clear_cache.pl
    
    root@koha-debian10:~# koha-translate --install es-ES
    /bin/bash: /usr/share/koha/misc/bin/clear_cache.pl: No such file or directory
    
    The script is in /usr/share/koha/bin/clear_cache.pl
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 652b0ec817e1c3e9d25c9a2945c721c8cb896cf8
Author: Petro Vashchuk <stalkernoid@gmail.com>
Date:   Mon May 25 17:39:58 2020 +0300

    Bug 25556: fix for unnecessary empty name/value pairs creation
    
    During the web-install onboarding process, when the default circulation rule gets created, "circulation_rules" table gets populated with empty rule_name/rule_value items. This behavior differs from how the "unset" button on the smart-rules.pl page in "Default checkout, hold and return policy" group acts and leads to unpredictable bug when empty "holdallowed" rule_name prevents holds from any user.
    This fix removes creation of these empty name/value pairs.
    
    To reproduce:
        1) Start with an empty installation (or delete all circulation rules and press "unset" in hold and return policy section on /cgi-bin/koha/admin/smart-rules.pl page). This is to have the circulation_rules table empty so onboarding.pl will work.
        2) Go through the onboarding.pl process and create a default circulation rule.
        3) Make sure that circulation_rules table contains will contain empty "patron_maxonsiteissueqty", "max_holds", "patron_maxissueqty", "returnbranch", "holdallowed" and "hold_fulfillment_policy" fields.
        4) Apply the patch.
        5) Repeat steps 1 and 2.
        6) Observe that there are none of six mentioned above name/value pairs appeared.
    
    To reproduce the bug with empty "holdallowed" rule_name:
        1) Repeat steps 1, 2 and 3 that are listed in the previous instruction of reproduction, in order to get empty "holdallowed" field.
        2) Find existing or create a new book with available status and place a holding on it.
        3) Observe the yellow notification window with "Cannot place hold. No items are available to be placed on hold." warning.
        4) Apply the patch.
        5) Repeat steps 1 and 2.
        6) Observe that hold was successfully placed and yellow notification does not appear anymore.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit fc0292195bc9d85159dbd5fae6cfaf57f7d55115
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 25 10:25:52 2020 +0200

    Bug 22630: Display correct "in storage" value
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 6fd3b974fc9d13cafb0c7e426c6a9c92b1339e28
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 25 10:14:19 2020 +0200

    Bug 24413: (follow-up) Add tests
    
    Add missing transaction.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 721d925c58db26d432faf4b7ef37c23343bd3ac0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 22 15:33:36 2020 +0200

    Bug 25540: Default for branches.pickup_location must be 0
    
    This is a try to fix failures in both
    t/db_dependent/Template/Plugin/Branches.t
    t/db_dependent/Koha/Biblio.t
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cdfcc5430fe8241559d081054d69d3d4adbc497d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 19 15:31:43 2020 +0200

    Bug 25540: Use build_sample_item
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6028c92c7b299b85d871605cd46d5bb97b760f7b
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri May 22 16:45:02 2020 +0200

    Bug 25517: Look in all possible places for MO files
    
    On a 'dev' install, MO files will be installed in
    <intranetdir>/misc/translator/po
    On 'standard' and 'single' installs, they will be installed in
    <intranetdir>/../../misc/translator/po
    
    This patch makes Koha::I18N try to use the "dev" directory first, and
    fallback to the "standard" directory.
    If none of these directories exist, it dies.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f87317af7fc5d45d1a826c953b53c7ea821d2447
Author: Mason James <mtj@kohaaloha.com>
Date:   Sat May 23 08:56:00 2020 +1200

    Bug 25591: Update debian/control for debian 10
    
    This patch updates the debian/control for koha 20.05 on debian 10
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 17cd698b46e45aff36b1a28fc44b5c775f385b21
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 22 14:49:06 2020 +0100

    Bug 24380: (RM follow-up) Fix update statement to prevent regression
    
    The update statement did not respect the original value of
    CalcalateFinesOnReturn and so would result in an unexpected functional
    change during upgrades.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e1fbb8f3874a4ab203022ad500344c96455e829e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 22 13:15:55 2020 +0100

    Bug 24347: Add sponsorship details
    
    Sponsored-by: Athens County Public Libraries
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8ec729dc01ab185fb9d72915783e997fcc3d3d17
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 22 11:20:00 2020 +0200

    Bug 24612: Fix existing ReserveSlip tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c579207d90cfba4290a42a06156d0556a56a16f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 22 12:09:29 2020 +0100

    Bug 23975: (RM follow-up) Comment example configuration
    
    As promised, I am commenting out the configuration for git repositories
    to use for searches by default prior to release. To enable the feature,
    simply uncomment the relevant github repositories or add your own.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a2af51d688fd72e1f38dd687649f31d8d97d529a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 22 11:20:28 2020 +0100

    Increment version for 20.05.00 alpha release
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b651295f92c9f11f91302a2a99bdbd56a96da70
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 22 11:39:37 2020 +0100

    Teams fixes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40c562fa52d1243950c7e3ee3548e0aadaa732ad
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 22 11:12:22 2020 +0100

    Translation Fixes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1b7acc052a640e4f38ee6e0bb6c29c7f40c20804
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 22 10:40:26 2020 +0100

    Clean up 'John Doe'
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9364ddad0e5bcc77535cc86c920453267e4a0536
Author: Koha translators <>
Date:   Fri May 22 06:18:12 2020 -0300

    Translation updates for Koha 20.05.00
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c6dc178f2e4de65e753c6a62c9550c9361120173
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 19:08:20 2020 +0100

    Add 20.11 release team
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3e597a1fade7079bf51708e7935c16d704daa5b8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 16:42:54 2020 +0100

    Update Contributors for 20.05
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 85ab68c07f9240eba08d74b232be8434e65e9afb
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed May 20 19:04:24 2020 -0300

    Bug 24229: Avoid fetching ALL items in test
    
    I'm not sure what we need to test here, besides we get results. I'm
    pretty sure we shouldn't allow a plain GET return all objects because it
    could cause a DOS very easily. But it certainly belongs to a separate
    bug/discussion.
    
    In this case, I put a constraint on the items domain (by using
    _per_page=10 in the query params) so it won't happen that under certain
    conditions the user agent used by Test::Mojo time outs.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9e665fb9a753032fed711959f1d8cc5780655b8c
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu May 14 11:47:51 2020 +0000

    Bug 25473: Move JavaScript out of the footer of addorderiso2709.tt
    
    This patch undoes the move of the JavaScript block to the footer made in
    Bug 22734. The item information tab can include embedded JavaScript for
    cataloging plugins, and these don't currently work with JS in the
    footer.
    
    To test, apply the patch and test the JavaScript driven features of the
    "Add to basket from a staged file" page:
    
    - Acquisitions -> Vendor -> Basket -> Add to basket from a staged file
      - MARC and Card previews, select all/clear all
      - Item information tab: Cataloging plugins for fields like
        date acquired, barcode
      - Default accounting details tab: Show inactive control
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4e945dff87a8bc4badb605361c1db63f71b04a07
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 21 15:35:33 2020 +0200

    Bug 25567: Fix typo categorycode vs category_code
    
    Well, this is actually the real root of the error!
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7ce6f7895610913f35fb1531faa1a40cefcd5f88
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 21 15:30:35 2020 +0200

    Bug 25567: Prevent patron category type's categorycode to be created with ""
    
    It must be NULL/undef, the default from the DB.
    
    The method Koha::Patron::Attribute::Type->categorycode is not covered by tests!
    
    To recreate:
    Create a new patron attribute type, don't select a patron's category (and not repeatable or unique)
    Go to the batch patron modification tool, enter a cardnumber, next.
    => boom!
    Apply the patch, edit the patron attribute, save
    Go to the batch patron modification tool, enter a cardnumber, next.
    => success!
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bbe6b07f4340afca18763724194fbc577b77959d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 13 15:18:29 2020 +0200

    Bug 24413: Add tests
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 10af741387a75d29c6b7782c6ce3d2c07cad9517
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 21 12:37:44 2020 +0100

    Bug 24413: Do not remove the restrictions from AddReturn
    
    As we are now removing them from MarkIssueReturned they should not be
    removed from AddReturn as well.
    Also I think this will fix a regression, if $doreturn is not set (in
    case the item is withdrawn and BlockReturnOfWithdrawnItems or the item
    is lost and BlockReturnOfLostItems, and other specific cases).
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 70ae2eaf9cdc7708f85b1724e5bc89623355b585
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 17 16:27:57 2020 +0100

    Bug 24413: Apply AutoRemoveOverduesRestrictions for lost items
    
    It's quite hard to know where this need to be fixed.
    it can be either MarkIssueReturned or LostItem, depending on the
    different cases we want to handle.
    
    This patch picked MarkIssueReturned, but maybe the similar code in
    AddReturn needs to be removed then.
    
    == Test plan ==
    1. Set MarkLostItemsAsReturned to 'from items tab of the catalog module'
    2. Set AutoRemoveOverduesRestrictions to 'Do'
    3. Set up an overdues restriction in the notice triggers
    4. Check out an item and let the overdues process restrict the account
    5. Navigate to the moredetail.pl page (items tab) for the overdue item
    6. Mark the item lost
    7. Return to the account in question - notice the item has been returned, but the restriction remains
    8. Clean state: remove restriction + remove item lost status
    9. Apply patch
    10. Redo the test but this time in addition to the item being returned,
        the restriction will be lifted.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aa1f0fd73fa2a8dadd86ef5defc390e164845429
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 13 13:42:02 2020 +0200

    Bug 24612: Use the reserve_id to identify a reserve when building a notice
    
    Now that we have the reserve_id PK on the reserves table we should use
    it (instead of the couple borrowernumber, biblionumber)
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e9e8b635e14fe1229006b556e8aa0babf61455c7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 13 13:10:55 2020 +0200

    Bug 24612: Add tests
    
    ReserveSlip call need to be adjusted in test.
    We also add a new reserve (same biblio, same patron) to highlight the problem.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d864c5640a3e3b02cbb64bde034935fa746a09ce
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 12 10:02:56 2020 +0100

    Bug 24612: Make hold-transfer-slip take reserve_id
    
    To make sure we are going to display the correct hold's info we need to
    pass the reserve_id.
    
    == Test plan ==
    1. Add some content to HOLD_SLIP notice, e.g.
    
      <h2>[% branch.branchname %]</h2>
      <div>[% biblio.author %]<br>[% biblio.title %]<br>[% item.barcode %]
      <ul><li> Reserve ID:  [% hold.reserve_id %]</li>
      <li>Expiration date: [% hold.expirationdate %]</li></ul>
    
    2. Add 2 holds for 1 patron to a single record
    3. Check the reserve IDs in the reserves table - on a clean sandbox, they will be 1 and 2
    4. Check in one of the items from the record and print the slip
    5. Note that the reserve ID on the slip is 2 and the expiration date is blank
    6. Repeated check ins do not change this
    7. Check in a second item from the record
    8. Note that the reserve ID for this hold is also 2, but this time the expiration date is filled in
    9. Check in the first item again - the reserve ID stays as 2, but this time the expiration date is filled in
    10. Apply patch
    11. cancel the holds to come back to a clean state
        (and maybe ensure items aren't in transit)
    12. redo the test and see the following differences
    13. 1st checkin:
        1. expiration date ok
        2. the reserve ID is the one of the first hold
    14. 2nd checkin:
        1. expiration date ok
        2. the reserve ID is the one of the second hold
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1bcc45be621b19dc602d675ca10d844301496b06
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri May 8 16:13:40 2020 +0000

    Bug 25428: Correctly encode link if authority subfield is a URL
    
    This patch modifies the script and template for showing the details of
    an authority record so that if the authority subfield is configured to
    be a link the link is correctly output in the template.
    
    To test you must have an authority type configured with at least one
    subfield designated as a URL:
    
     - Go to Administration -> Authority types
     - Select "MARC structure" from the actions menu for the authority type
       you want to modify.
     - Select "Subfields" from the actions menu for the tag containing
       the subfield you want to modify (for instance 856).
     - Edit the subfield you want to display as a link (e.g. subfield u).
     - In the subfield configuration form under "Advanced constraints" check
       the "Is a URL" checkbox and save your changes.
    
     - Apply the patch and go to Authorities in the staff interface.
     - Search for or create an authority record which contains URL
       information in the right subfield (for instance 856$u).
     - View the details for the record. Using the 856 example, the "8" tab
       should contain an active link pointing to the correct URL.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 635242a69a5ed049801d018a6be712d8dcbabb07
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 11 10:58:15 2020 +0200

    Bug 25452: Restore alternate address email display
    
    Broken since
      commit 0ab22e1c7c6b6e8d14a4fb7478ab2a3d42da347d
      Bug 18789: Send Koha::Patron object to the templates
    
    Test plan:
    Create or modify a patron, fill the "email" field of the "alternate
    address" block (B_email)
    Go to the detail view of the patron
    => Without this patch the email is not display
    => With this patch applied you see it!
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 67ff0f72854d4dabdda8cb59696f15e7b5d88c2a
Author: Slava Shishkin <slavashishkin@gmail.com>
Date:   Thu May 14 17:53:47 2020 +0300

    Bug 25506: Fix for "Use of uninitialized value" in about.pl
    
    Perl warning on the "About Koha" page:
    
    Use of uninitialized value in string eq
    at /home/vagrant/kohaclone/about.pl line 220.
    
    Fixed by adding additional precheck for
    C4::Context->config('zebra_auth_index_mode') being Perl's "true".
    
    To test:
        1) Ensure you don't have "<zebra_auth_index_mode>...
           </zebra_auth_index_mode>" in your koha-conf.xml so you will have
           "C4::Context->config" returning "undef"
        2) Go to the "About Koha" page.
        3) Observe the warning in the log file.
        4) Apply patch.
        5) Repeat step 2.
        6) Check that previous warning was suppressed.
    
    Signed-off-by: Andreas Roussos <a.roussos@dataly.gr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 37370c415ab5e59422aff46be14ccfec0cf8c373
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 21 12:00:34 2020 +0200

    Bug 25563: (bug 24386 follow-up) Don't disable submit button if form has not been submitted yet
    
    On bug 24386 we prevent double form submission using the our own preventDoubleFormSubmit JS function.
    
    The problem is that we are checking some conditions, and prevent the
    form submission if something is not filled (for instance no checkbox
    checked, or no fund selected).
    
    Technically it means that:
    - click the submit button
    - it submits the form
    - we disable the submit button
    - we prevent the form to be submitted before something is wrong
    At this stage the button is disabled and the form cannot be longer be
    submitted.
    
    This patch replaces the "on submit" event of the form with the "on click" event of the submit button.
    Which means we are going to:
    - click the submit button
    - we prevent the form to be submitted before something is wrong
    => The button will only be disabled if the form is really submitted
    
    Test plan:
    - stage a marc record
    - acquisitions: have a basket
    - click on "Add to basket"
    - "From a staged file"
    - Don't tick the record
    - Save
    - You should see an expected error message
    - Tick the record
    - Save
    - You should see an expected error message
    - Choose a fund
    - Click the "Save" button as many times as you can, to try double submit
    it.
    => The order is saved
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5169c5fab8cd8ada5442b66bfa2f2165e540b9ec
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 20 17:12:56 2020 +0200

    Bug 25411: Group conditions in if elsif
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d0c44578524dc2bd7b380dac56a53382b5aca7e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 14 19:09:04 2020 -0300

    Bug 25411: Add special handling for public plugin routes
    
    This patch implements the required logic in the API code so plugins are
    not affected by the new RESTPublicAnonymousRequests system preference.
    It is up to the plugin develpers to handle this
    
    To test:
    1. Apply the tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/REST/Plugin/PluginRoutes.t
    => FAIL: Notice the tests fail
    3. Apply this patch
    4. Repeat 2
    => SUCCESS: Tests pass! Yay! Not bad for a friday evening!
    5. Sign off :-D
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 84bd1ac370db07d2b05c1c39433cb7963a98be71
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 14 15:15:52 2020 -0300

    Bug 25411: Regression tests
    
    This patch adds tests the new RESTPublicAnonymousRequests syspref
    doesn't apply to routes added by plugins.
    
    It is up to the plugin developer to handle those conditions.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/REST/Plugin/PluginRoutes.t
    => FAIL: Notice the tests fail
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5f9cc8ada9a3186265f7c4fff1529775f03ac969
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 19 14:26:56 2020 +0200

    Bug 25284: chown /var/log/koha log files on koha-create
    
    To prevent Apache to create intranet-error.log and opac-error.log with
    root permission we chown them after it has been restarted (and so
    created them) when a new Koha instance is created
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d517453d95b3a16f9cdc61910a53433310ca2c7f
Author: David Cook <dcook@prosentient.com.au>
Date:   Mon May 18 05:41:34 2020 +0000

    Bug 25485: Remove tiny_mce symlink during pre install of deb package
    
    This patch removes the tiny_mce symlink before Koha package installation
    using the same method that we used when we removed the YUI symlink
    in 2015.
    
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f342b0b617237f05287518b6bbf749c7db533a5c
Author: David Cook <dcook@prosentient.com.au>
Date:   Mon May 18 03:28:56 2020 +0000

    Bug 25485: Remove all mention of tiny_mce in debian/rules
    
    This patch removes the removal of the following during the
    build process:
    /usr/share/koha/intranet/htdocs/intranet-tmpl/lib/tiny_mce
    
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 067f1b8b556015bbd0f35f36aac700d79467786b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 12 14:19:53 2020 -0400

    Bug 25485: TinyMCE broken in Debian package installs
    
    When installing the Debian package of Koha, we install the Debian tinymce package and symlink over our own tinymce libs that are in the Koha codebase. This version of tinymce does not have the same files and because of this, tinymce does not get loaded.
    
    We should remove the use of the tinymce Debian package, and just use our own version of TinyMCE.
    
    Test Plan:
    1) Install Koha 19.11 from package
    2) Browse to the news editor
    4) Note the WYSIWYG editor is missing
    5) Build a new Koha package with this patch applied, install it
    6) Reload the news editor
    7) Note the WYSIWYG editor is back!
    
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c6ed5b5da125347ef95ae439eaf21858410f7edf
Author: David Cook <dcook@prosentient.com.au>
Date:   Mon May 18 07:08:18 2020 +0000

    Bug 25524: Remove --line-regexp option in log4perl_component()
    
    The current grep expression uses -x|--line-regexp, but that causes
    the regexp to fail to match since we're not specifying a regexp
    that can match a whole line. We can either provide a better regexp,
    or remove that --line-regexp option.
    
    This patch removes the --line-regexp (ie -x) option from the grep
    in log4perl_component, so that it detects logger components correctly.
    
    To Test:
    0) Apply patch
    1) Build Koha package
    2) Look at /etc/koha/sites/kohadev/log4perl.conf in an existing
    Koha instance (e.g. on koha-testing-docker), and note it has
    components for z3950, api, and sip
    3) Install package
    4) Note that /etc/koha/sites/kohadev/log4perl.conf is the same as before
    5) Remove the "log4perl.logger.sip and log4perl.appender.SIP lines from
    /etc/koha/sites/kohadev/log4perl.conf
    6) Reinstall package
    7) Note that the missing lines have been appended to the file at
    /etc/koha/sites/kohadev/log4perl.conf
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f8f890621e8ce99c36f4117eb018bbb3ec3da960
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 18 17:50:11 2020 +0200

    Bug 25531: Debar patron if needed when checkin is backdated
    
    If think this case does not apply to real-life, but the logic needs to
    be fixed.
    If an item is due now, and AddReturn is called now with a return date in
    the future, the issue is overdue and the patron must be debarred.
    However it is not as we compare with now and not the return date
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d7066e8cfb50df6e78e8bb1dd491736b1aadcde6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 18 17:49:37 2020 +0200

    Bug 25531: Add tests
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a4cf3569d4c9c49aba43e3c524d8ac09474740a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 14 09:06:51 2020 -0300

    Bug 25502: Adapt Advanced macros routes to current guidelines
    
    The original development started before the changes we introduced in the guidelines in late 2019, and the major code changes that took place in January 2020.
    
    - Attribute mapping logic is now on the Koha::Object-level (the patches implement that, but are not using it)
    - Related to the above, some helper methods like to_api and to_model are kept, the same for the mappings in the controller, they should all go away
    - Related to the above, set_from_api and new_from_api should be used instead of using helper to_api and to_model methods in the controller
    - $c->objects->search doesn't use the to_model and to_api params
    - Response status codes need to be changed, at least for DELETE operations
    
    Those are fixed by this patch.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/advanced_editor_macros.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b3ed9a40426bec52c1da9334818c49a6cbcfb464
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed May 13 17:17:21 2020 -0300

    Bug 25493: Make ->unhandled_exception use Koha::Logger
    
    To test:
    1. Edit the Koha/REST/V1/Cities.pm 'list' method adding
       die("Nada"); before the render step.
    2. Restart plack and try the endpoint
    => SUCCESS: The message is generic, but you see something is
    logged in /var/log/koha/kohadev/api-error.log
    3. Change die("Nada"); for a real exception like:
    
        use Koha::Exceptions;
        Koha::Exceptions::DuplicateObject->throw("Nada");
    4. Repeat 2.
    => SUCCESS: The message is generic, but a meaningful text is added to
    the logs.
    5. Point your browser to the /api/v1/hola route from your dev
       environment
    => FAIL: Wow, such a weird error
    6. Apply this patch
    7. Restart plack and repeat 2, 3 and 4
    => SUCCESS: No behaviour change
    8. Repeat 5
    => SUCCESS: The regular Mojolicious 404 weird page
    9. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c97921bb68849a2c7dd5f2f5ad8f5b97789df5c1
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Tue May 19 10:05:41 2020 -0300

    Bug 25501: Supress warnings on installing translation
    
    To test:
    1) Verify the error installing translations for any language
    2) Apply the patch
    3) Repeat 1), check warning is gone
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8994ded2c47d22fd46ea46f6e7855da52826b351
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 14 16:04:20 2020 +0200

    Bug 25481: Pass --user to start-stop-daemon when a pidfile is used
    
    Since D10, the behaviour of start-stop-daemon changed, see from its
    manual:
    """
    Warning:  using this match option with a world-writable pidfile or using it alone with a daemon that writes the pidfile as an unprivileged (non-root) user will be refused with an error (since
    version 1.19.3) as this is a security risk, because either any user can write to it, or if the daemon gets compromised, the contents of the pidfile cannot be trusted, and  then  a  privileged
    runner (such as an init script executed as root) would end up acting on any system process.  Using /dev/null is exempt from these checks.
    """
    
    Test plan:
    koha-plack --restart kohadev
    should success with this patch.
    Without this patch you get:
    start-stop-daemon: matching only on non-root pidfile /var/run/koha/kohadev/plack.pid is insecure
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 96b4f6802b4b6b195d09f9b7dc9db29288a2b885
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon May 18 14:14:42 2020 -0400

    Bug 25535: Hold API mapping maps cancellationdate to cancelation_date, but it should be cancellation_date
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8efa607ae58ecb83e4b6088633f4b302abfe4822
Author: Petro Vashchuk <stalkernoid@gmail.com>
Date:   Mon May 18 14:45:56 2020 +0300

    Bug 25516: Fix for "Can't call method unblessed on unblessed reference"
    
    Software error:
        Can't call method "unblessed" on unblessed reference at ../reserve/request.pl line 581.
    was caused by recent commit with `wantarray` removal in sub pickup_locations in ‘Item.pm’
    and visible on fresher Perls (where experimental feature "autoderef" removed https://www.effectiveperlprogramming.com/2010/11/use-array-references-with-the-array-operators/ )
    
    To test:
        1) Get a clean dev environment after "reset_all"
        2) Add an empty record for “Default checkout, hold and return policy” on /cgi-bin/koha/admin/smart-rules.pl.
        3) Open item record, like /cgi-bin/koha/reserve/request.pl?biblionumber=1&borrowernumber=1
        4) Observe the error (Can't call method "unblessed" on unblessed reference at ../reserve/request.pl line 581.)
        5) Apply patch.
        6) Repeat steps 2 and 3.
        7) Observe that the error is gone.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 048a6cfc02e7f72159e3345a36e8496528fe68ca
Author: David Cook <dcook@prosentient.com.au>
Date:   Mon May 18 06:23:07 2020 +0000

    Bug 25510: Put space between negation operator and function name
    
    This patch puts a space between the negation operator ! and
    the function name (ie log4perl_component).
    
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 36f671090af9c0728aa5afdbb677f9e390e18117
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 15 10:12:46 2020 +0200

    Bug 25510: Fix syntax error in koha-common.postinst
    
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da1a85b3a7a134c8eccc24a06828727c258db60f
Author: David Cook <dcook@prosentient.com.au>
Date:   Mon May 18 03:02:05 2020 +0000

    Bug 25068: Fix koha-common.install directives
    
    Bug 24735 removed etc/searchengine/queryparser.yml, which removed
    the need for koha-common.install to install the following file:
    debian/tmp/etc/koha/searchengine
    
    This patch removes that line and causes the Koha packages to build
    correctly again.
    
    To test:
    0) Apply patch
    1) Build a Koha package using one of the following methods:
    - https://wiki.koha-community.org/wiki/Building_Debian_Packages_-_The_Easy_Way
    - https://hub.docker.com/r/koha/koha-dpkg
    - https://gitlab.com/minusdavid/koha-deb-builder-docker
    
    Signed-off-by: Mason James <mtj@kohaaloha.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ba59f81d2fb947e9cf1ec0e2b74e9bce64168ff8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 19 08:24:46 2020 +0100

    Bug 13881: Add Sponsorship details
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 291d8a5ee3639cbc1318853c5eb4e024bd7fdc31
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 19 08:17:56 2020 +0100

    Bug 13881: (RM follow-up) Fix terminology
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 94470aa7c3525e9d1019639f30ad7008890ecfdc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 19 08:17:17 2020 +0100

    Bug 13881: DBRev 19.12.00.091
    
    Correction to preference terminology
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7587975da2fbc470a4c336ad8fdb5afef8b88926
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 16:56:22 2020 +0100

    Bug 25188: Sponsorship details
    
    Sponsored-by: PTFS Europe
    Mentored-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a4372c2d579b070335108bce7ea728f3cc206fb
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 16:55:03 2020 +0100

    Bug 20847: Add sponsorship details
    
    Sponsored-by: PTFS Europe
    Mentored-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3acd1bce91e4d43c4abb2317d6650654d2e4ace8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 16:53:11 2020 +0100

    Bug 25130: Add sponsorship details
    
    Sponsored-by: PTFS Europe
    Mentored-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4debe59d276926691d866c9c594ca6e0327a8a1a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 16:51:55 2020 +0100

    Bug 20370: Add sponsorship details
    
    Sponsored-by: PTFS Europe
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d37e3d81da34be89c6d3c65df5fa14bdd16eae93
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 16:51:03 2020 +0100

    Bug 23119: Add sponsorship details
    
    Sponsored-by: PTFS Europe
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit be34c35d60267a6ff972bfd9a526696702876308
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 16:49:59 2020 +0100

    Bug 24976: Add sponsorship details
    
    Sponsored-by: PTFS Europe
    Mentored-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4492fad72adc746b956c5f80684db0061df2dae0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 16:49:21 2020 +0100

    Bug 24484: Add sponsorship details
    
    Sponsored-by: PTFS Europe
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 067aa1c5f731bc9eac40ff53e6c3be2e58ef1c0f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri May 15 11:46:07 2020 +0000

    Bug 25278: add clear_search_fields_cache method
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0899d99b7c2ce5920664f4d4710869b2f0d25b81
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Apr 27 14:05:46 2020 +0000

    Bug 25278: (follow-up) Fix other occurrences
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3f4ae28cd8de3ae60ab85bc914840a59ae4b1ec2
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 24 15:52:50 2020 +0000

    Bug 25278: Retrieve correct search fields for authorities
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f04129ca45171f8e9c115ca8e25b7dc4b9f9686e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 24 16:32:06 2020 +0000

    Bug 25278: Unit tests
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 48ea8edb6188045f24aa3508a4fdb209369b1720
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 24 16:08:44 2020 +0000

    Bug 25277: Unit test
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 68bcc31dfcdfd48614843ff27a4594a69ef95ed7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 24 13:34:31 2020 +0000

    Bug 25277: Don't specify a field in query if none passed
    
    == test plan ==
    To test:
    0 - Have Koha running with ES 6 enabled
    1 - Launch the z3950 responder:
        perl misc/z3950_responder.pl --config-dir /kohadevbox/koha/etc/z3950 --debug
    2 - Connect using yaz-client:
        yaz-client localhost:2100
    2.1 Alternative, if you add the responder as a Z39.50 server in Koha and
      do a catalogue Z39.50 search. Don't forget to search in the keywords
      field. Not the title field.
    3 - base biblios
    4 - find bruce
    5 - No results
    6 - Stop the responder
    7 - Apply patch
    8 - Repeat
    9 - This time you get results
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0a24e721dda54e67759c7c10d956ee63da6b8ec5
Author: Phil Ringnalda <phil@chetcolibrary.org>
Date:   Tue Apr 28 17:16:51 2020 -0700

    Bug 25308: Escape querystring for Z39.50 popup from cataloging
    
    Test plan:
    
    1. For bonus fun, Administration -> MARC Frameworks -> New framework,
    with the code A&B and description Ants & Bees
    2. In the A&B Actions menu, choose MARC structure since Import won't
    work
    3. Accept the offer to copy in structure from default
    4. Cataloging -> New record -> Ants & Bees
    5. Type This & That in the 245$a (and for extra credit, in 020$a, and
    create an author authority with an & in it so you can put it in the
    100/110)
    6. Click Z39.50/SRU search, make sure everything you typed is prefilled
    including the parts after &
    7. Search for anything that will retrieve a record (the ISBN This &
    That probably won't), choose Import
    8. Check that the record came back, and verify in the Settings menu that
    it's still in the Ants & Bees framework.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8371d10fa5639690a3deb77b64f8079325993ff4
Author: Phil Ringnalda <phil@chetcolibrary.org>
Date:   Fri Apr 24 11:34:29 2020 -0700

    Bug 11446: Use encodeURIComponent on search terms in authority lookup plugin
    
    While adding the data from the existing field to the auth_finder URI,
    we're using encodeURI(), which is meant for an entire URI and thus
    doesn't escape &. Things that are going into a querystring need
    encodeURIComponent() instead.
    
    Test plan:
    
    1. Enable the system preference EnableAdvancedCatalogingEditor
    2. Clear your browser cache, even a shift+reload won't get you a fresh
    marc-editor.js for the advanced editor
    3. Create a Topical Term authority with 150 $aThis & That$xStuff & Junk
    4. In the Basic editor, use the authority plugin on the 650 field to
    select that authority.
    5. Click the authority plugin again, verify that the popup contains This
    & That and Stuff & Junk rather than just This and Stuff
    6. From the Cataloging home page choose Advanced editor
    7. In a new line paste 650 _ _ ‡aThis & That‡xStuff & Junk
    8. Type ctrl+shift+L and verify the popup shows both words in both
    fields
    9. When you remember the plugin exists there too, edit your
    Stuff & Junk authority, and in a 550 tag type One & Two in
    $a and Three & Four in $x and click the plugin link, verify that
    the search window has your search terms not cut off.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 05705ab2ad12aff3627eb53e7e4d56d6a4b20bcd
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 18 09:26:09 2020 -0300

    Bug 25527: Add logger to Koha::ExternalContent
    
    This patch makes Koha::Logger initialization happen in the ->new method
    for the Koha::ExternalContent-derived classes. In the case of RecordedBooks,
    it doesn't look like it is used at all.
    
    In the case of OverDrive, it will now use the Koha::ExternalContent
    exported logger accessor.
    
    I added tests for this addition to Koha::ExternalContent to the
    OverDrive tests.
    
    I also removed references to Test::DBIx::Class as it is not used at all.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha_ExternalContent_OverDrive.t
    => SUCCESS: Tests pass!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 48e3e6aafb04fbe6eea33da8550c9952a3f52a11
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 18 09:23:42 2020 -0300

    Bug 25527: Initialize the logger when required
    
    In an OO package, the logger initialization should happen in the
    constructor. This is not an OO package and the initialization is
    happening on loading it. This is a wrong behaviour and certainly breaks
    in environments where initialization cannot happen (package building,
    for example). There could be several options to solve this, as it is
    used in a single sub on this package, I opted for initializing on that
    sub.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5117fab4890f86b8f11a129485917db3d357b920
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 15:21:09 2020 +0100

    Bug 22970: Add sponsorship details
    
    Sponsored-by: Université de Lyon 3
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1cde48f92f5823dea3a8867fcaeab5b7a1902e8f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 14:28:26 2020 +0100

    Bug 24255: Add sponsorship details
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a425ec395cc96c6bb88528ad34ff7ff60f5337a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 14:27:40 2020 +0100

    Bug 24252: Add sponsorship details
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a00ca6a9d96aa9e9c01fe30619d883b4f50ee58d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 13:51:47 2020 +0100

    Bug 23593: Add sponsorship details
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fdea1cbd22f2a51cd8269aa9f7db57acfd295e6c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 13:49:32 2020 +0100

    Bug 23592: Add sponsorship details
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9223a483f1695ea73ee199bd7a001722ecf47f8f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 12:50:44 2020 +0100

    Bug 24080: Add sponsorship details
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f32789be1396817da459493693f4d36f663d4e95
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 12:49:22 2020 +0100

    Bug 23442: Add sponsorship details
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bc421faa0d90da91a14d1d900103d732b732b5bf
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 11:43:55 2020 +0100

    Bug 13881: DBRev 19.12.00.090
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 85243da0b437b30676a6d4d4f490be7c917d5d10
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 18 11:40:14 2020 +0100

    Bug 13881: (RM follow-up) Make 'Desks' feature optional
    
    This patch adds a new 'UseIssueDesks' preference which defaults to
    "Don't use" to enabled/disable the 'Desks' functionality added with this
    bug.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2a031b352c90c3c79cfd0c7c0e132971a82406fb
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 14 10:42:06 2020 +0000

    Bug 25482: Explicitly set macros as not shard during tests
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f66e253312fc2777cf495a19a61a60867f661d09
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed May 13 19:34:30 2020 -0300

    Bug 25482: Fix tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 810e761660d7424b097a6c6f1d1211513889fa09
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed May 13 19:07:17 2020 -0300

    Bug 25482: Wrong permissions specification for adv editor macros
    
    The current permissions are defined as a hash, with a duplicate key.
    This is generally invalid, but Debian 9's Mojolicious::Plugin::OpenAPI
    lets it go through, even though the results are, random?
    
    This patch sets the required permissions right, and following the
    haspermissions() syntax correctly.
    
    Tests for searching macros are not passing. Still trying to figure.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f96a105e872fdfda5fa67753663b1d80fd2c4c5b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 26 16:01:37 2020 +0000

    Bug 24994: Correct DB Updates
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 883b36da925c25dff38a435f648491dbafb1a1a7
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 12 10:49:51 2020 -0400

    Bug 25468: Preserve line breaks in hold notes
    
    In a hold note, line breaks are not preserved when viewing the note. A
    note like:
    --
    Test 1
    
    Test 2
    --
    
    will be rendered as:
    --
    Test 1 Test 2
    --
    
    Test Plan:
    1) Place a hold with a note, use line breaks in the note.
    2) Note the lines all run together when viewing the hold.
    3) Apply this patch.
    4) Reload the page.
    5) Notes should now display with the original line breaks!
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 741fa0b0065cf3309d02dc709292d71405f2260a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 13 13:05:48 2020 +0200

    Bug 25480: Don't hide apache error and display incorrect error
    
    When searching if some apache mod are enable we are hiding the error (2> /dev/null) and display an error about the (guessed) missing module.
    
    It can lead to wrong tracks, let display the original apache error if there is one.
    
    This is linked with https://gitlab.com/koha-community/koha-testing-docker/-/merge_requests/119
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9ed284c0a49c280daf217240e03142ac701e8e06
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Apr 13 15:51:36 2020 +0000

    Bug 23403: Catch other cases of ->{patron}
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 29f797b9808f513ca4ba662729f6a8a81edcda68
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 23 15:57:14 2020 +0100

    Bug 23403: List borrowernumber in the ILS::Patron fields
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b720285bdba315944e303ef166e5c89c4c591ddf
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Mar 23 08:52:58 2020 -0400

    Bug 23403: Fix whitespace
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 23dd6651f83e42200185130bd340520ea2e945f1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 21 18:39:15 2019 +0100

    Bug 23403: Remove cardnumber from SIP
    
    == Test plan ==
    1 - Have two patrons with userids and no cardnumber
    2 - Note which of these has the higher borrower number
    3 - Use the SIP cli emulator to connect and checkout a book to the patron with higher borrowernumber
          See example after
    4 - Note the book may checkout to the wrong patron!
    5 - Apply patch
    6 - Checkout to both patrons via sip
    7 - The patrons get the correct checkouts
    
    === SIP CLI emulator ===
    ./misc/sip_cli_emulator.pl -a 127.0.0.1 -p 6001 -su term1 -sp term1 \
    -l CPL --patron 23529001000463 -m checkout --item 39999000001259
    
    translation: via the koha user term1, checkout item 39999000001259 to
    patron 23529001000463
    
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d69ab6ee9185d124e8d282608e279d8590a6180f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 11 10:10:39 2020 -0300

    Bug 24458: Use the ViewPolicy filter on search results
    
    This patch implements the use of the ViewPolicy record processor filter
    inside C4::Search::searchResults. The idea is that the $record_processor
    is instantiated once and reused inside the loop. This leaves options for
    further optimizations I will do on a follow-up bug.
    
    The filter is applied to the MARC data before it is passed to the XSLT
    processor.
    
    To test:
    1. Apply the regression tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Search.t
    => FAIL: This is not implemented, tests fail
    3. Apply this patch
    4. Repeat 2
    5. Feel the joy in your body from a long standing bug being solved
    6. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0524f3b6d6a96e9016802a2a4d4ea3a27ef0d2fa
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 11 10:08:36 2020 -0300

    Bug 24458: Regression tests
    
    This patch introduces tests for searchResults. The idea is to set a
    subfield as hidden in OPAC and another on the staff interface, and see
    if searchResults honours this on the XSLTResultsRecord contents.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Search.t
    => FAIL: This is not really implemented
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 009007b8092d2973e66cbabd782613ee72265763
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue May 12 09:09:22 2020 -0300

    Bug 25416: (follow-up) Remove useless use statement
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a81b9d3fadd5604cd2cabf44455d563b0f53e7a7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 11 08:38:49 2020 -0300

    Bug 25416: Unit tests
    
    This patch adds tests for the new 'feature': i.e. searchResults passes
    the added $xslt_variables to the XSLTParse4Display method.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2a216e206c13585308fbfb8897f78f9672bd81e0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 7 14:23:40 2020 -0300

    Bug 25416: Let OPAC XSLTs know if the context is an anonymous session
    
    This patch makes use of the 'variables' parameter in XSLTParse4Display
    method in the different places that it is used in the OPAC. It does by
    passing this parameter with
    
        anonymous_session => 1|0
    
    The value will depend on the output from get_template_and_user (i.e. if
    there's a returned borrowernumber).
    
    A special case takes place in search results, as the call to
    XSLTParse4Display happens in C4::Search::searchResults. So a new
    parameter 'xslt_variables' is added to it.
    
    To test:
    1. Apply the [DO NOT PUSH] patch
    2. Open the OPAC in your browser
    3. Try detail pages, search results, tags and lists/shelves pages with
       or without an active session
    => FAIL: It always says (somewhere) 'Anonymous session: Yes'
    4. Apply this patch, restart_all
    5. Repeat 3
    => SUCCESS: It will tell the Yes/No correctly regarding anonymous
    sessions!
    6. Sign off :-D
    
    Sponsored-by: Universidad ORT Uruguay
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e720e7e820408e7e2b7b03f65cbdd1435a2d031
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed May 13 16:52:47 2020 +0100

    Bug 23794: (RM follow-up) Remove warnings from updatedatabase
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 233974a2514ed7891d889624a86312e29e8f43e5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 13 16:10:34 2020 +0200

    Bug 24161: (follow-up) Fix failing test (when running slow)
    
    The previous assumption was wrong, we just need to return the last one.
    The tests mean to have 2 different values in the claimed_on dates.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b2859011326b8c5ee9d2a67890b8e753b1fbc37
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 13 16:02:35 2020 +0200

    Bug 23794: (follow-up) Remove extra carriage return
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4429b42036061d6cf5662f12e390c521eef65771
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed May 13 10:34:10 2020 +0100

    Bug 25389: DBRev 19.12.00.089
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c5f34fe3ada46e29c9b1ac99b10186fab6d9670f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 11 11:39:00 2020 +0100

    Bug 25389: Catch errant cases of LOST_RETURNED
    
    For upgrades taking place after the fix for the update in bug 24592 was
    pushed, we need to catch any last remaining error cases and correct
    them.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bd6ccad5d9b78719241d06a96a7ac0b77cabcef1
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 11 11:33:32 2020 +0100

    Bug 25389: Catch LOST_RETURNED in DB update 19.12.00.021
    
    An errant update from bug 22563 could lead to cases of LOST_RETURNED as
    aposed to LOST_RETURN as an account_credit_type. This patch adds code to
    deal with those cases to the update for bug 24592
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 483e40d2236bbb584022846bd1c85d62f149f096
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 11 11:30:35 2020 +0100

    Bug 25389: Correct stray cases of LOST_RETURNED
    
    The original DB update for bug 22563 incorrectly mapped CR to
    LOST_RETURNED as aposed to LOST_RETURN.  This patch catches such cases
    and updates them in the update for bug 23805
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ed564837a64a45bfd1551ab54417daf0a3b9c559
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 11 11:27:16 2020 +0100

    Bug 25389: Correct original DB update for bug 22563
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b2786e56b91d825d06b6e3e6eb5930a72b94ee92
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri May 8 16:04:17 2020 -0300

    Bug 24368: Comprehensive tests for Koha::Template::Plugin::Branches::pickup_locations
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b42afc9a377cf13109a24b57eb777f3d3d08cdf
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri May 8 16:01:58 2020 -0300

    Bug 24368: Remove Koha::Libraries->pickup_locations
    
    This patch removes the unused method, and cleans the tests.
    To test:
    1. Verify Koha::Libraries->pickup_locations is not used in the code:
       $ git grep 'Koha::Libraries\->pickup_locations'
    => SUCCESS: no uses
    2. Apply this patch
    3. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Libraries.t
    => SUCCESS: Tests pass!
    4. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 33a44e438376a567966e80100c1ef4a3c06b215d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 13 09:57:40 2020 +0200

    Bug 24161: Fix failing test (when running slow)
    
    We "mocked" the claim date to make sure we were not going to hit this
    problem, but it's not done on the correct claim, it should be done on
    the last one (so second).
    
    from Koha::Acq::Order->claimed_date
    
    294     my $last_claim = $self->claims->last;
    295     return unless $last_claim;
    296     return $last_claim->claimed_on;
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5bff65dd7a76f69d3cfb91c5e4806b3618edf3b3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 12 09:24:28 2020 +0100

    Bug 25417: (QA follow-up) Add integration test for AddReturn
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7b84e00f7e2f8c8b05c798ee08a1fee203903c27
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 11 21:14:24 2020 +0100

    Bug 25417: (QA follow-up) Restore 'fixing' of fines
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 49d2756f7be4815e7e93874710241506d6a3f9fc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 11 21:13:47 2020 +0100

    Bug 25417: (QA follow-up) Clarify _FixOverduesOnReturn test
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 53349e8000d7073220fedb48bcd910abec7a592b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 8 12:28:46 2020 +0200

    Bug 25417: Prevent negative debit amount on backdating returns
    
    Koha::Account->add_credit is expecting a positive amount.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Didier Gautheron <didier.gautheron@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2c9a322486e003e9f36d48fa72a5dd27b6ebcad9
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu May 7 14:21:59 2020 -0400

    Bug 25417: Add unit test
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Didier Gautheron <didier.gautheron@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 61718c5c57ff4d17992624126dc2edbadb394d74
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 11 12:10:24 2020 +0200

    Bug 15253: Remove specific logging output
    
    * We should not call Log::Log4perl directly
    * Not sure it is correct as I get from (comment 77):
     % koha-sip --restart
    
     [2020/04/23 11:23:27] [ERROR] [undef]@[undef]: Argument "0.33_01" isn't
     numeric in numeric lt (<) at /usr/share/perl5/Net/Server/Log/Sys/Syslog.pm
     line 42.
      C4::SIP::Trapper::PRINT /kohadevbox/koha/C4/SIP/Trapper.pm (24)
    
     Why "ERROR" when it's a warning?
     The [undef]@[undef] seems wrong here.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8cb408cf15663dfc68762d0d1bb8f746b9bfa00d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 29 06:42:29 2020 -0400

    Bug 15253: Add POD to C4/SIP/Logger.pm and C4/SIP/Trapper.pm
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b47e18637d58faa20e40e991845e10fac53305f0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 29 06:27:10 2020 -0400

    Bug 15253: Convert all tabs into 4 spaces in affected files
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 46c9d97cfd8d3010386a483bfc147b75d1d58707
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Apr 23 09:25:33 2020 -0400

    Bug 15253: Log trapped errors as log level 'warn' instead of 'error'
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2c43e95e0cd108d0a4722f4c96215c278e762fc1
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 1 08:14:48 2020 -0400

    Bug 15253: Add log4perl conf updates for Debian packages
    
    * Add log4perl conf updates for Debian packages
    * Rename sip2.log to sip.log
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ec5ffbd059f5d9534ebd586fbb4278854c3bb285
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 22 13:24:55 2020 -0400

    Bug 15253: Rename syslog() to siplog()
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4bc14ef0523a942e6723c8e68372d9ffe45621f2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Apr 22 11:02:42 2019 -0400

    Bug 15253: Move subs to a new module, allow unit tests to function
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 315f544cdc4b17912a12e41b90615d54babba705
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 1 11:47:12 2018 +0000

    Bug 15253: Add Koha::Logger based logging for SIP2
    
    Now that we have Koha::Logger, we should use it in our SIP server. This
    has the potential to make debugging SIP issue much easier. We should add
    the userid for the sipuser to the namespace so we can allow for separate
    files per sip user if wanted.
    
    Test Plan:
    1) Apply this patch set
    2) Update the modififed log4perl.conf to your system
    3) Restart your sip server
    4) Tail your sip2.log, run some queries
    5) Note you still get the same output messages as before, with the
       addition of the ip address and username ( if available )
       prefixing the message.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Chris Cormack <chris@bigballofwax.co.nz>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ff15008d20430079fe8bbad51df1709f6663cc7a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed May 6 08:50:54 2020 +0100

    Bug 13547: (QA follow-up) Add basic tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 10c642cb008a7aba563002f800afb96d03c91efc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed May 6 08:26:39 2020 +0100

    Bug 13547: (follow-up) Improve POD for template plugin
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2bb243bb6283b6deab82b8d7744ceb288e32e9a2
Author: Nazlı Çetin <nazli@devinim.com.tr>
Date:   Fri Mar 27 17:13:02 2020 +0000

    Bug 13547: (follow-up) Item field 'Materials specified' would be useful to see in OPAC
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 660edd0524477641c074fd7b083ba977d26fe6f5
Author: Nazlı Çetin <nazli@devinim.com.tr>
Date:   Thu Mar 5 15:02:37 2020 +0000

    Bug 13547: Add item field 3 (Materials specified) to the OPAC holdings table
    
    Test plan:
    
    1- View a record with Materials specified (field 3) data in the opac
    2- Apply patch
    3- Log in to staff client
    4- Home->Administration->Column Settings->OPAC->holdingst
    5- Set item_materials visibility
    6- Refresh OPAC page
    7- Confirm that the materials specified column has been added after the
       Call number column.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 74ff965734dc069ffa18b0158ef07fcef664d118
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 7 12:06:10 2020 +0000

    Bug 24823: (QA follow-up) Fix deletion and POD
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d9bfbefaaf72f7827279204f5867cdcfcb0ab16d
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Thu Mar 12 11:52:18 2020 +0100

    Bug 24823: Remove unused parameters
    
    Remove unused Elasticsearch parameters 'key_prefix' and 'request_timeout'.
    Refactor so that get_elasticsearch_params only returns parameters used
    by Search::Elasticsearch, add class accessor for index_name.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 419d158c7f4c3034c332e4ab6e8d4e3b14f19c5b
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Mon Mar 9 11:48:13 2020 +0100

    Bug 24823: Fix spelling error and remove last of Catmandu
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6dac19f1e27db98b0f03f940576f1bf6bb69cf74
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Thu Mar 5 18:05:10 2020 +0100

    Bug 24823: Drop Catmandu dependency
    
    Replace remaining Catmandu dependant code with the Search::Elasticsearch
    equivalent.
    
    To test:
    1) Apply patch
    2) Run tests in t/Koha/SearchEngine/Elasticsearch.t, t/Koha/SearchEngine/ElasticSearch/*
    and t/db_dependent/Koha/SearchEngine/*
    3) All tests should pass
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0ef02cea4a2a2b247127a6b02352f84f9e9b3ea9
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri May 24 08:51:58 2019 +0200

    Bug 22970: Allow to change homebranch in batch add course reserves
    
    Test plan:
    1. Create a course (disabled)
    2. Add multiple reserves to this course using 'batch add' and set
       a homebranch different from the items homebranch
    3. Enable the course
    4. Verify that the items homebranch have changed
    5. Disable the course
    6. Verify that the items homebranch were reset to their initial value
    
    Depends on bug 22630
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8771232293cf6e9a1aed77b5e8f9dbaceb8590a2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 7 10:10:18 2020 -0300

    Bug 25279: (QA follow-up) Use .escapeHtml
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit daaabc21302421653e17dce33e280a0d5e8b8d3a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 6 16:09:32 2020 +0200

    Bug 25279: Replace encodeURI with encodeURIComponent
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e3aa4ddf6106b4e0ed3f4b441681c3a911c36d1a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed May 6 10:34:09 2020 -0300

    Bug 25279: URI-escape city_id in links
    
    This patch escapes city_id uses in URLs, and also removes redundant dom
    entry as this is inherited from the global datatables configuration
    anyway.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 15c0e11a2ce1abbe6d244f7e23b18f4d91e410d7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 6 14:59:47 2020 +0200

    Bug 25279: Use another var name for the filter
    
    It prevents:
    * The screen to display "no city, create one" if we are
    searching for a string that does not return any results.
    * The list to display only the city we have just created
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc11887a64277552caf2aaba7886e542a2c7b474
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue May 5 20:28:10 2020 -0300

    Bug 25279: HTML escape cells
    
    This patch makes HTML entities be escaped. It is done in a simple way.
    We need to explore ways to do it at datatables.js level but it deserves
    its own bug.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 64de96c612d844304129b9e3c1d1c57652c9b5dd
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue May 5 18:55:49 2020 -0300

    Bug 25279: (QA follow-up) Original behaviour
    
    This patch does the following things:
    - Uses a call to Koha::Cities->search(*)->count to display the same
      message we displayed before when no city was found/defined (datatable
      not rendered at all).
    - Restores the main search box functionality, the passed param is used
      to query on the city name with wildcards on both sides, for (a)
      counting results and for (b) apending to the API call with the same
      behaviour.
    
    The only missing bit from QA is HTML/URI escaping values from cells, but
    this is going to happen at DT level most sure.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 71e3d02ffb5f415e5a03f2b114f107a0ca3a7a3a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri May 1 02:26:27 2020 -0300

    Bug 25279: (QA follow-up) Make button texts translatable
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cb623f0f4cf6f7fa09559c44cb18fdf0d9ba14d3
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Apr 27 15:35:18 2020 -0400

    Bug 25279: Fix edit and delete links
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4364b1666e85eb4d2e38184a7dcd1bd64826c8ff
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Apr 24 11:50:04 2020 -0300

    Bug 25279: Use the API to list cities
    
    This patch makes the general cities datatable use the API for rendering.
    To test:
    1. Test the datatable behaviour
    2. Apply this patch
    3. Repeat your tests
    => SUCCESS: Things work! Filtering and sorting specially
    
    Bonus: Use the browser inspector to notice each interaction with the
    datatable triggers an API call with the right query parameters
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a07c5c153aaecc5cc8b0d1de5c53f184da5971b9
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Apr 24 11:48:58 2020 -0300

    Bug 25279: Add general query parameters to the /cities route
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 23e860683f5390cb72fa7e39e7da560512531191
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue May 5 18:26:48 2020 -0300

    Bug 24561: (follow-up) Use full_numbers for pagingType
    
    We are trying to keep the current datatables behaviour so this is a
    trivial yet sensible change.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e0ab580538dc8cad53597d56cc873b1af0470603
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Apr 30 11:20:05 2020 -0300

    Bug 24561: (follow-up) Set default matching criteria to 'contains' and add configuration option
    
    This patch adds option.criteria as an option. Possible values are
    'contains', 'starts_with', 'ends_with' and 'exact'. 'contains' is the
    default value.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4b37a4e8d3f93404f796a4edbfacb8b7a737c0ae
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed Feb 19 11:33:14 2020 -0300

    Bug 24561: Add a Datatables api wrapper that implements filter and order embedded columns
    
    This patch adds the ability to filter and order by embedded columns.
    
    To use it you must in JS:
    
    $('datatable_selector').api({datatables_options})
    
    where datatables_options are all datatables options plus:
    
    1. embed: [list of embeddable tables]
       This option adds x-koha-embed header to request.
    
    2. header_filter: true|false
       This option if true sets x-koha-query header with stringyfied json of filters
    
    Oderable and searchable columns must define data option as string, otherwise filter and order won't be possible.
    If you must custom the output, use the render function.
    
    For example:
    
    * Don't
    
    > $('.table_selector').api({
    >   columns: [
    >     {
    >       data: function(row, type, val, meta) {
    >         return '<a href="'+row.link+'">'+row.holds.patron.firstname+'</a>';
    >       },
    >       orderable: true,
    >       searchable: true
    >     }
    >   ]
    > });
    
    * Do
    
    > $('.table_selector').api({
    >   columns: [
    >     {
    >       data: 'holds.patron.firstname',
    >       render: function(row, type, val, meta) {
    >         return '<a href="'+row.link+'">'+row.holds.patron.firstname+'</a>';
    >       },
    >       orderable: true,
    >       searchable: true
    >     }
    >   ]
    > });
    
    To test you must implement and test bug 20936, where it will be used.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3f546c031ab4557fb6bf98342cc3b8dfe870e11d
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Mon May 4 16:00:26 2020 +0000

    Bug 25188: Make circulation notes more prominent on the patron details tab
    
    This patch adds a more prominent circulation note to the moremember.pl
    details screen.
    
    To test:
    
    1) Add a circulation note to a patron record.
    2) Note that it displays prominently on the checkout tab, but only under
    the Library Use block on the details tab.
    3) Apply the patch.
    4) Check that the note is now displayed prominently at the top of the
    details (moremember.pl) screen.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7dc2aa28b711fa1e488173e78bba2dd92e9c8237
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 12 11:20:33 2020 +0100

    Bug 24185: Add mentorship
    
    Mentored-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18acb9a0d542d5b93cc85d25dd10cfb22e38bc3c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 12 11:18:43 2020 +0100

    Bug 24027: Add Mentorship lines
    
    Mentored-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 643309499aeaafc7da33abf6c2c52b13ab9321bd
Author: Slava Shishkin <slavashishkin@gmail.com>
Date:   Sun May 10 18:15:09 2020 +0300

    Bug 25409: Add missing "Required" text and "required" classes
    
    Highlight text with red by adding “required” class to the label and added red
    “Required” text next to select field in "onboardingstep5.tt" template.
    
    To test:
        1) Start new installation. During onboarding tool phase you will be
           requested to create a new circulation rule.
        2) Observe that "Units" label has no "required" class and that
           there’s no “Required” text next to a select field.
        3) Apply patch.
        4) Repeat step 2 (you can reload circulation rule creation page).
        5) Observe the error is gone.
    
    Mentored-by: Peter Vashchuk <stalkernoid@gmail.com>
    Mentored-by: Andrew Nugged <nugged@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6c95f7154856b03b53d620642417ca8179c12377
Author: Slava Shishkin <slavashishkin@gmail.com>
Date:   Thu May 7 14:24:31 2020 +0300

    Bug 25409: Add missing "required" class to template
    
    Added "required" class to "itemtype" label in "onboardingstep5.tt"
    template.
    
    To test:
        1) Start new instalation. During onboarding tool phase you will be
           requested to create a new circulation rule.
        2) Observe that "itemtype" label has no "required" class.
        3) Apply patch.
        4) Repeat step 2 (you can reload circulation rule creation page).
        5) Observe the error is gone.
    
    Mentored-by: Peter Vashchuk <stalkernoid@gmail.com>
    Mentored-by: Andrew Nugged <nugged@gmail.com>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f248063ee557af6d19afc17f4801213287e76b95
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 12 11:13:49 2020 +0100

    Bug 25184: (RM follow-up) Make DB update idempotent
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 98c98df95500e7c899385926be466c5c88308fd3
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon May 11 17:08:35 2020 +0000

    Bug 25418: (QA follow-up) Raise size of input box
    
    In twelve hour format the length of the string is 20 characters
    we need the box to fit all of them
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d26407e4d1b5a8d5b42c67c8649b55a2ecab9d4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 7 17:18:35 2020 +0200

    Bug 25418: (bug 25133 follow-up) Display due date with hours
    
    And not as due date, it's not a display-only info, but an input.
    
    This patch is a follow-up of Bug 25133: Fix time part of due date for 12hr
    
    == Test plan ==
    1. create checkouts with the following params and results
    2. tomorrow 11:59 PM timeformat syspref: 12h
       - item is due without a specific time, only date (after-checkout green box)
    3. backdate 11:59 PM timeformat syspref: 12h
       - note the yellow confirm box has only the date
       - item is due at 12:00 PM (after-checkout green box)
    4. tomorrow 11:23 AM timeformat syspref: 12h
       - item is due at 11:23 AM (after-checkout green box)
    5. backdate 11:23 AM timeformat syspref: 12h
       - note the yellow confirm box has the date and time
       - item is due 11:23 AM (after-checkout green box)
    6. tomorrow 23:59 timeformat syspref: 24h
       - item is due without a specific time, only date (after-checkout green box)
    7. backdate 23:59 timeformat syspref: 24h
       - note the yellow confirm box has only the date
       - item is due at 00:00 (after-checkout green box)
    8. tomorrow 11:23 timeformat syspref: 24h
       - item is due at 11:23 (after-checkout green box)
    9. backdate 11:23 timeformat syspref: 24h
       - note the yellow confirm box has the date and time
       - item is due 11:23 (after-checkout green box)
    10. apply patch
    11. create checkouts with the following params and results
    12. tomorrow 11:59 PM timeformat syspref: 12h
        - item is due without a specific time, only date (after-checkout green box)
    13. backdate 11:59 PM timeformat syspref: 12h
        - note the yellow confirm box has the date and time
          - CHANGE COMPARED TO BEFORE THE PATCH
        - item is due without a specific time, only date (after-checkout green box)
          - CHANGE COMPARED TO BEFORE THE PATCH
    14. tomorrow 11:23 AM timeformat syspref: 12h
        - item is due 11:23 AM (after-checkout green box)
    15. backdate 11:23 AM timeformat syspref: 12h
        - note the yellow confirm box has the date and time
        - item is due 11:23 AM (after-checkout green box)
    16. tomorrow 23:59 timeformat syspref: 24h
        - item is due without a specific time, only date (after-checkout green box)
    17. backdate 23:59 timeformat syspref: 24h
        - note the yellow confirm box has the date and time
          - CHANGE COMPARED TO BEFORE THE PATCH
        - item is due without a specific time, only date (after-checkout green box)
          - CHANGE COMPARED TO BEFORE THE PATCH
    18. tomorrow 11:23 timeformat syspref: 24h
        - item is due at 11:23 (after-checkout green box)
    19. backdate 11:23 timeformat syspref: 24h
        - note the yellow confirm box has the date and time
        - item is due 11:23 (after-checkout green box)
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12dfbe7f037dae1c4825de53932a10c29e7b3852
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 12 11:11:38 2020 +0100

    Bug 24378: DBRev 19.12.00.088
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3f9fc43a71c92d5394955efce9e2108c83894f79
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 11 15:44:32 2020 +0200

    Bug 24378: (QA follow-up) fix minor issues
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cf0a6f48202d3a2c5170db2afb658c47bacce03f
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun May 10 17:06:17 2020 +0000

    Bug 24378: (follow-up) Format due date as due date
    
    Changes the due date formatting as was already done
    for the new sample files on bug 23787.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d5fa69df93e5efda3d7ab87dbf90e822b006876c
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Apr 11 17:52:30 2020 +0000

    Bug 24378: Database update to rewrite notice if left unchanged
    
    The database update makes the same changes as done by
    Andrew on the old database entry. We check for full sentences
    left unchanged to minimize issues with changes made by the library.
    
    Test plan of first patch applies.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eba7a32df59093b02a5f707b06f636a85be465f7
Author: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
Date:   Wed Mar 11 00:15:58 2020 +0000

    Bug 24378: Change wording of auto_renewals notice in updatedatabase
    
    On the template of AUTO-RENEWALS the wording is grammatically incorrect:
    
    [% IF checkout.auto_renew_error == 'too_many' %]
    You have reach the maximum of checkouts possible.
    
    This should say
    [% IF checkout.auto_renew_error == 'too_many' %]
    You have reached the maximum of checkouts possible.
    
    Test plan:
    - Make sure you have the AUTO_RENEWALS notice with the problematic
      spelling
    - install patch
    - update database
    - confirm changes to notice name and wording
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Kept Andrew's change on the original updatedatabase entry,
    but removed the database update to be done a little differently
    in a follow-up patch.
    
    Amended test plan.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 278df89bb5f86c8f7369405a8aa5d4a32b739643
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 8 06:46:59 2020 +0000

    Bug 22437: (follow-up) Move deletion of merge requests to DelAuthority
    
    Lines can be moved. Deletion can be done too if skip_merge is not set.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 891307f29be27113475b1605a558799ab9874c01
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Apr 3 08:55:45 2020 +0000

    Bug 22437: Delete older merge requests at new merge time
    
    If you merge A to B, we should remove older AA merges (regular
    merge to itself) in the queue before deleting A.
    
    Test plan:
    [1] Set merge limit in prefs to say X.
    [2] Find three authorities A, B, C with linkcount >X, >X, <X.
    [3] Merge C to B. This creates a 'BB merge' in the queue.
        Auth C is deleted.
    [4] Merge B to A. Creating AA and BA in the queue.
        Auth B is deleted.
        Optionally verify that BB is no longer in the queue.
    [5] Run the merge_authorities.pl cron job.
        Verify that the linkcount to A is the former total of ABC.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Phil Ringnalda <philringnalda@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6b85d1b073bf2f29c9c604a627f15aff7aad12ab
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Apr 6 13:44:46 2020 +0000

    Bug 22437: Add test case to Merge.t
    
    Test proves now that a 'destructive merge' is removed by
    DelAuthority.
    
    Test plan:
    Run t/db_dependent/Authority/Merge.t. Should fail when you
    do not apply the other two patches and pass with them.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 312efadd315fb8b0c1d2a952aab672f77f60672a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 11 14:51:58 2020 +0200

    Bug 25421: Update POD
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6aeeae3e707d449403ad08914acfdb6b7a1e831f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri May 8 10:04:30 2020 -0300

    Bug 25421: Remove use of Koha::Libraries->pickup_locations
    
    The current implementation uses Koha::Libraries->pickup_locations which
    is problematic and due to be removed by bug 24368. This patch makes the
    trivial change of just searching for libraries that are marked with
    pickup_location => 1.
    
    Calls to Koha::Item->pickup_locations and Koha::Biblio->pickup_locations
    are as well adapted to the new arrayref return value.
    
    To test:
    1. Pick a record with only one item
    2. Place a biblio-level hold on it
    3. Edit the items: remove the item
    4. Go to the Holds tab
    => FAIL: It explodes
    5. Apply this patch and restart:
       $ sudo koha-plack --restart kohadev
    6. Go back and go to the holds tab again
    => SUCCESS: No failure!
    7. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Didier Gautheron <didier.gautheron@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6f1e9fe75080b9a02c49730cbdb341cf09ca9826
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri May 8 11:40:15 2020 -0300

    Bug 25421: Make ->pickup_locations only return an arrayref
    
    This patch makes Koha::Item->pickup_locations and
    Koha::Biblio->pickup_locations always return an arrayref.
    
    Test are adjusted to reflect this:
    
    1. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Biblio.t t/db_dependent/Koha/Item.t
    => SUCCESS: Tests pass!
    2. Apply this patch and repeat 1
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Didier Gautheron <didier.gautheron@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1eae01fa14602c32f0e2de925b60b5f3a2b83db1
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 7 13:08:14 2020 +0000

    Bug 25342: Unit test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2a804074030ef02f58ba708db26192ff44fc61cd
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri May 1 14:48:55 2020 +0000

    Bug 25342: Force ES id as string
    
    To test:
    1 - Be using ES
    2 - Find a unique record by searchign for title or seomthing
    3 - Edit the record
    4 - Repeat search and confirm you are returned to the details page
    5 - Go to Tools->MARC modification templates
    6 - Add a template and define an action
    7 - Go to Tools->Batch record modification
    8 - Select Enter a list of record numbers
    9 - Enter the biblionumber of the record you searched for
    10 - Use the marc modification template you setup
    11 - Complete the modification
    12 - Repeat your search
    13 - note you get two results, both pointing to same biblionumber
    14 - Check the ES index, note that you have two entries, one with the biblionumber, and the other with #.0, e.g.:
        curl -XGET 'es:9200/koha_kohadev_biblios/data/14.0?pretty'
        curl -XGET 'es:9200/koha_kohadev_biblios/data/14?pretty'
    15 - Apply patch
    16 - Delete and rebuild ES index
        perl misc/search_tools/rebuild_elasticsearch.pl -d -b
    17 - Repeat 2-12
    18 - No duplication this time
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b7590775792e9c5a05416104a35de3c9a6b20b5
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue May 5 11:56:07 2020 +0000

    Bug 23787: (follow-up) Format due date as due date
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 851f433b77e6e62bd285e4e4671b11710271bab5
Author: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
Date:   Wed Mar 11 00:43:20 2020 +0000

    Bug 23787: Add AUTO_RENEWALS to sample_notices
    
    Removed "\" from "It\'s too late..." -- apparently that doesn't need to get escaped in YAML
    
    To test:
    - create a new English (en) install
    - confirm presence of auto renewal notice
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3aecd0afb0d543b6047d19154bb9f55c0f7c7bce
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Apr 13 15:04:37 2020 +0200

    Bug 23787: Add sample AUTO_RENEWALS notice to translatd installers
    
    This adds the default auto renewal notice to the translated
    installers. Translating will be handled by maintainers of the
    installers, but this way we don't end up with installations
    having a different set of notices than others.
    
    To test:
    - Verify the sample_notices.sql files load correctly
    or
    - Run the web installer for each of those languages and
      verify sample_notices loads correctly.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c9a032a8fc5ff312beae9ebfa84e642b9c3056e1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 11 11:10:20 2020 +0200

    Bug 25301: Removed URI parameter "categorycode" from the toolbar
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b0e0f03c17dec4b7ee3f54798ff0c024e873806
Author: Petro Vashchuk <stalkernoid@gmail.com>
Date:   Thu May 7 12:22:24 2020 +0300

    Bug 25301: removed URI parameter "categorycode" from "circulation.tt"
    
    "Edit details" links in patron's circulation check-out page
    was sending empty query parameter "categorycode" because there is no
    defined template parameter in "circulation.pl"
    
    This patch removes the URI parameter from "circulation.tt" template.
    
    To test:
        1) You need to create or find expired or expiring patron.
        2) Head to patron's circulation check-out page.
        3) Inspect "Edit details" link.
        4) Observe empty parameter "categorycode=" in that link.
        5) Apply patch.
        6) Repeat step 3.
        7) Check that there's no "categorycode=" in the link anymore.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c79108e495951efca4824d458b3736deb4c79de9
Author: Petro Vashchuk <stalkernoid@gmail.com>
Date:   Wed May 6 16:09:01 2020 +0300

    Bug 25301: removed useless URI parameter "categorycode" from template
    
    Both "Edit details" links were sending empty query parameter
    "categorycode" as there is no such template parameter in "moremember.pl"
    defined at all, because template code block looks copy-pasted
    from "circulation.tt".
    
    This patch removes the parameter from "moremember.tt" template.
    
    To test:
        1) You need to create or find expired or expiring patron.
        2) Head to patron details page of that patron.
        3) Inspect both "Edit details" links:
           one in the notification about expiration
           and other one in the "Expiration date:" field.
        4) Observe empty parameter "categorycode=" in those links.
        5) Apply patch.
        6) Repeat step 3.
        7) Check that there's no "categorycode=" in the links anymore.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a57cc4645d38b80ec9a8846afcea2d27f22605b4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 11 15:13:18 2020 +0200

    Bug 25248: (bug 23463 follow-up) Adjust second occurrence
    
    Same as the precedent patch for a single item deletion (vs delete all
    items)
    Item is returned if deletion  successful, not 1
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04ce87c4c0f8e73b1213aca8e9c3591967c6e94e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 8 15:44:55 2020 +0200

    Bug 16547: Remove more multi_holds inconsistencies
    
    There was a bug, on the biblio's hold list view, if the pickup library
    was changed, the next screen was "place a hold for no title"
    
    http://pro.kohadev.org/cgi-bin/koha/reserve/request.pl?multi_hold=1&biblionumbers=
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2b2c605ea7ed0cc907264d82067172fa401c6d75
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 11 12:43:06 2020 +0200

    Bug 8132: Fix failing tests
    
    * Add missing html filter (xt/find-missing-filters.t)
    * Fix AddReserve call
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 575878f0fbfbd4f222cd8a9d5f9b4704ca1ad19d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 11 11:10:41 2020 +0100

    Bug 25184: (RM follow-up) Syntax error correction
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0e0f09ba94e17c89e0bd54162c47b8032c71e18a
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Mon May 4 19:43:32 2020 +0000

    Bug 25130: Reason for accepting/rejecting a suggestion is not visible when viewing (not editing)
    
    The patch adds the suggestion management reason to the display when
    viewing a suggestion.
    
    To test:
    
    1) Edit a suggestion and assign a reason for accepting it.
    2) View the suggestion (/cgi-bin/koha/suggestion/suggestion.pl?suggestionid=XX&op=show, replacing XX with your suggestion ID)
    3) Under suggestion management, the reason you've just assigned does not
    display.
    4) Apply the patch
    5) Check the display again - the Reason should now be visible directly
    under the status.
    
    Signed-off-by: Abbey Holt <aholt@dubuque.lib.ia.us>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d4b8cf126bcb5c6539ffb61930642a0fe6e7481
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri May 8 16:41:03 2020 +0000

    Bug 24963: (follow-up) Fix another instance
    
    This patch corrects the second instance of "auto renewal" in the
    description of the AllowPatronToControlAutorenewal system preference.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d6ca541b5553331da83e5ae4c16b425c1a085ffd
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu May 7 15:16:35 2020 +0000

    Bug 24963: Terminology: Use "auto-renewal" instead of alternatives
    
    This patch updates terminology in the templates so that "auto-renewal"
    is used instead of "auto renewal" or "autorenewal."
    
    To test, apply the patch and set the 'AllowPatronToControlAutorenewal'
    preference to "allow patrons."
    
    - Log in to the OPAC and view the "your account" page.
      - At the top of the "Checked out" tab you should see controls for
        turning auto-renewals on and off. The labels should be correct.
      - Turn off auto-renewals for this patron.
    - In the staff interface, view the detail page for the patron you
      updated in the previous step.
      - In right-hand column of information about the patron you should see
        "Auto-renewal: Patron has opted out."
      - Add "&print=brief" to the page URL. Check that auto-renewal
        information displays correctly on this brief view as well.
    - Go to Administration -> System preferences.
      - Under the "Circulation" tab, check that the description of the
        OPACFineNoRenewalsBlockAutoRenew preference refers to
        "auto-renewal."
      - Under the "Patrons" tab, check the description of the
        AllowPatronToControlAutorenewal refers to "auto-renewal."
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d7168b02bd9373f40882f8b181e1f43cd8b6d39e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 4 15:43:18 2020 -0300

    Bug 25327: Do not call authenticate_api_request to render the spec
    
    The original code for Koha::REST::V1::Auth::under called
    authenticate_api_request when requesting the API spec. This didn't make
    sense, and recent changes on what conditions are tested for public
    routes, broke the route.
    
    We could add another condition, but it really doesn't make sense to call
    authenticate_api_request if it should be publicly available in any
    configuration, as discussed on the bug.
    
    This patch adds a trivial check and the requested route, and lets the
    request through in any case in 'under'.
    
    To test:
    1. Point your browser to:
       http://kohadev.myDNSname.org:8080/api/v1/
       http://kohadev.myDNSname.org:8080/api/v1/.html
    => FAIL: In both cases you get an authorization error.
    2. Apply the regression tests patch
    3. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/auth.t
    => FAIL: The tests reflect the situation, and fail
    4. Apply this patch
    5. Repeat 1 and 3
    => SUCCESS: All good!
    6. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 20d493090ac86a41b2add16625ae8aa88c450f44
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 4 15:43:08 2020 -0300

    Bug 25327: Regression tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5a1f42e793498987d92d18a58a91b54d82e3bcb9
Author: Grace McKenzie <grace.mcky@gmail.com>
Date:   Wed Jan 18 22:55:48 2017 +0000

    Bug 17853: Don't remove () from 780 link text
    
    To test:
    - Catalogue a record with 780, Indicators 00 and $a some text including parentheses.
        e.g. Hospitals (Chicago, Ill. : 1936)
    - Verify that the () are not shown in the link text and are not part of the URL.
    - Apply patch
    - Verify that the () are shown in the link text and are not part of the URL.
    
    Signed-off-by: Felix Hemme <felix.hemme@thulb.uni-jena.de>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    
    Signed-off-by: David Nind <david@davidnind.com>
    
    Bug 17853: Don't remove () from 785 link text and restore link value of 780
    
    The only thing we change for 780 and 785 is, that if the display
    text contains (), they are no longer removed.
    
    To test:
    - Catalogue a record with 785$a some text (including) parenthesis
        e.g. Hospitals (Chicago, Ill. : 1936)
    - Verify that the () are not shown in the link text and are not part of the URL.
    - Apply patch
    - Verify that the () are shown in the link text and are not part of the URL.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e97ca8ab15114adaba7212760b90e5c98072d4ff
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 17 12:24:24 2020 +0200

    Bug 25157: Silent patron deletion cmd line script
    
    Without -v the script will no longer display messages unless the error
    is major.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a0c2012ce9b07b1c74ac80093e082514d2d981d6
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 8 09:39:46 2020 +0000

    Bug 8132: (QA follow-up) Missing filter
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit af495b93c72f275c58ae2bc7cd9a2280648449d7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 3 10:58:57 2019 +0100

    Bug 8132: Adding message when deleting from the UI
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c256a30998763c7962a26c72a7c34de284e04f35
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 3 10:13:38 2019 +0100

    Bug 8132: Delete the items in a transaction and rollback if something wrong
    
    The last_item_for_hold case cannot be guessed (easily), and so we are going to
    delete the items in a transaction. If something wrong happened we
    rollback and display a list of items that caused the rollback.
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e8414baf5b69a239b7c2df43b88c027be84794a4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 2 16:32:13 2019 +0100

    Bug 8132: Adding a new message 'last_item_for_hold' blocking item deletion
    
    If an item is the last one of a biblio that have biblio-level hold
    placed on it, we should block the deletion.
    It takes effect if the hold is found (W or T), to follow existing
    behavior for item-level holds.
    If we want to block deletion for any holds we should deal with it on a
    separate bug report.
    
    Test plan:
    0/ Setup
    Apply the patches
    Create Biblio B1 with 1 item
    Create Biblio B2 with 2 items
    Create Biblio B3 with 1+ item
    Create Biblio B4 with 1+ item
    Create Biblio B5 with 1+ item
    Place a biblio-level hold on B1 and B2
    Place an item-level hold on B3 and B4
    Confirm the item-level hold for the items of B3 to mark it waiting.
    
    1/ Delete those 6 items in a batch
    => delete of item from B1 is blocked on first screen - only 1 item left
    and there is a biblio-level hold on the record
    => delete of items from B2 is *not* blocked on first screen - One of
    them will block the deletion, but so far we are not aware of that
    situation
    => delete of item from B3 is blocked on first screen - there is a
    waiting item-level hold placed on the item
    => delete of item from B4 is *not* blocked - there is a hold but it is
    not found
    => delete of item from B5 is *not* - there is no reason to block its
    deletion
    
    Note that you can only select items from B2, B4 and B5
    
    2/ Select them and confirm the deletion
    => Nothing happened and you get a message saying that one of the 2 items
    from B2 is blocking the whole deletion process
    
    3/ Remove the biblio-level hold from B2
    4/ Repeat 1
    => The deletion has been effective!
    
    => Note that there is something a bit weird as we are blocking items
    from a biblio that has biblio-level holds on it (not found), but we
    do not blocking the deletion of an item with a waiting item-level hold
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2363179198c54cc73c5d314b2367a87b367bcef5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 2 16:15:59 2019 +0100

    Bug 8132: No changes but disable checkboxes
    
    When the list of items is displayed we already know if there will be a
    problem during the deletion. So let's disable the checkbox to tell the
    user in advance that items cannot be deleted.
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 040abebb7dce94bd04fcb5bc0af3eebffbb741e5
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Thu May 7 08:16:57 2020 -0300

    Bug 25410: Sync liblibrarian and libopac descriptions
    
    During translations some subfields show different
    descriptions for intranet/opac
    
    Just a little string change
    
    To test:
    1) Check if changes make sense and
    there are no errors
    2) Check if a clean install loads default marc21
    frameworks without problem.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ef55bc44fdd909be94dc7c9ab9918fb8a4edb744
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Apr 13 02:20:30 2020 +0200

    Bug 24098: Standardize Fines/Fees & Charges
    
    This patch suggests to adopt the terminology used in the OPAC
    to only use charges and leave off the Fines or Fees.
    
    To test:
    - Add a charge to your account
    - Check the note on the details and checkouts tabs
    - Check the tab name on the details tab
    - Activate batch checkouts via systempreferences for your
      patron category:
      - BatchCheckouts
      - BatchCheckoutsValidCategories
    - Add a guarantee to your patron and allow to see fines
      (requires: AllowStaffToSetFinesVisibilityForGuarantor)
    - Add a manual fine for the guaranee above NoIssuesChargeGuarantee
    - Go to the batch checkout tab of your patron and verify note there
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bea36d9f09622883e102908c7ca5ca3c04446eeb
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu May 7 14:57:25 2020 +0000

    Bug 25343: Use of item in review/comment feature is misleading
    
    This patch updates the terminology associated with leaving a comment in
    the OPAC. the word "item" is replaced with the more specific "title."
    
    To test, apply the patch and make sure the  reviewson system preference
    is enabled.
    
     - Log in to the OPAC and view a bibliographic record which has no
       comments.
     - Under the "comments" tab, verify that the text in the tab says
       "There are no comments on this title. Post your comments on this
       title."
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9f00c5912e7b1c602847e73187ce0e39082a1130
Author: George Veranis <gveranis@dataly.gr>
Date:   Wed Apr 22 11:43:53 2020 +0200

    Bug 19312: Fix typo in template
    
    This patch fixes a simple typo
    
    Test plan:
    1) Go to Administration -> MARC bibliographic framework
    2) Select a framework and add plugin unimarc_field_121a.pl to 121 field
    3) Open cataloguing screen
    4) Go to 121 field and check if for subfield a shows two times the value
       2-dimensional
    5) Apply the patch
    6) Go to 121 field again and check if it shows 2 different values
    
    Mentored-by: Andreas Roussos <a.roussos@dataly.gr>
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4318d84433062be07fc61764a13f046cb31fcfde
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Thu May 7 18:07:21 2020 +0000

    Bug 25388: There is no link for the "online help"
    
    This patch removes a non-existent link to the online help from the marc
    subfield editor.
    
    To test:
    
    1) Go to Admin > MARC Bibliographic framework > Edit MARC structure >
    Edit subfield (for example /cgi-bin/koha/admin/marc_subfields_structure.pl?op=add_form&tagfield=000&frameworkcode=AR)
    2) Check that the Max Length value in the Advanced constraints area
    contains text saying "See online help"
    3) Apply patch
    4) Check that the reference to the online help has disappeared.
    
    Remove tabs from start of line
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0c0bb0dacf3cb1717feaf2737b4b1d708d8186ef
Author: Nicolas Legrand <nicolas.legrand@bulac.fr>
Date:   Thu Apr 9 16:50:55 2020 +0200

    Bug 25099: Sending a LANG variable to plug-in template
    
    To make internationalised plug-ins, it may be useful to get the lang
    from C4::Languages::getlanguage. This patch adds
    C4::Languages::getlanguage result to a LANG variable which is sent to
    the template plugin.
    
    In your plugin, you can add a i18n directory containing
    lang[-DIALECT].inc files with a TOKENS hash like this:
    
        [%
          TOKENS = {
            PLUGIN_NAME = "Mannequin"
            PRESENTATION = "Voici un example d'outil."
            CLICK_ME = "Cliquez moi !"
          }
        %]
    
    The plugin template can then include such a lang[-DIALECT].inc with a
    hash containing all the plugin strings:
    
        [% TRY %]
            [% PROCESS "$PLUGIN_DIR/i18n/${LANG}.inc" %]
        [% CATCH %]
            [% PROCESS "$PLUGIN_DIR/i18n/default.inc" %]
        [% END %]
    
    The strings are then printed in the template with something like:
    
        [% TOKENS.PRESENTATION %]
    
    Test plan:
    
    1. apply patch
    2. install, enable and run BULAC Mannequin plugin
    3. it should print stuff in english by default
    4. install french French (fr-FR)
    5. change you Koha lang to French
    6. run again the plugin
    7. ho là là! French!
    
    Thanks to Tomàs Cohen and his pay via paypal plug-in from which most
    ideas in this patch are taken.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cc4b6b34c0541f4c56bf85755bc80fca6ea17e36
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue May 5 11:43:39 2020 +0000

    Bug 25082: Don't remove characters from string
    
    At the moment, show-lang-041 will either get a code
    or an AV description to deal with. If it's a description,
    we don't want to remove spaces and other chars from it.
    
    To test:
    - Repeat tests from first patch with an AV in LANG category
      that consists of multiple words, has a - and other possible
      punctuation.
    - The description should show correctly in OPAC and staff.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8cfe35b0440f7b9331b51f24224d80783b03a4da
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Apr 12 16:30:05 2020 +0000

    Bug 25082: Make 041 descriptions display, if authorised value list is used
    
    When 041$a or another subfield is linked to an authorised value list,
    Koha will replace the codes with the descriptions from the authorised
    value in the MARCXML before passing it to the XSLT.
    
    The XSLT was made to translate codes into descriptions - as there is
    no code now, this fails and 'unknown language' is shown.
    
    The patch changes the handling so that when the XSLT is handled something
    that doesn't match a known code, it displays the subfield without
    processing.
    
    To test:
    - Create some records with 041.
      Examples: http://www.loc.gov/marc/bibliographic/bd041.html
    - Verify this displays nicely in staff and OPAC
    - Apply patch
    - Verify display is unchanged
    - Remove the patch
    - Change one of your MARC frameworks (use another framework than
      for your first test records)
      and link the 041 subfields to the LANG authorised value list
    - Go to administration and create some entries for LANG with language
      codes and descriptions
    - Catalog a 041 using the normal editor (not advanced)
    - You can now use a pull down to select the values you want
    - Verify the display is now 'Unknown language' for this record
    - Apply patch
    - Verify all records display the language descriptions now, using
      an authorised value or not
    - Run misc/maintenance/generate_MARC21Languages.pl
    
    Verify the output at the end reads like:
    <xsl:otherwise>
        <!-- when 041\$a is mapped to an authorised value list, this will show the description -->
        <xsl:value-of select="\$code" />
    </xsl:otherwise>
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 72f013937c7f616554a25f57ef61c9b7f69037be
Author: Frédéric Demians <f.demians@tamil.fr>
Date:   Tue May 5 19:21:15 2020 +0200

    Bug 25325: ElasticSearch mapping export lacks staff_client/opac fields
    
    Run test:
    prove t/db_dependent/Koha/SearchEngine/Elasticsearch/ExportConfig.t
    
    Or:
    
    Run export_elasticsearch_mappings.pl script. See that opac/staff_client fields
    are exorted.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f08e7ff8b583ffc547e4ac1faeee7101811fc6df
Author: Frédéric Demians <f.demians@tamil.fr>
Date:   Tue May 5 19:19:26 2020 +0200

    Bug 25325: Test ES lack of staff_client/opac fields
    
    Run this test to see that export_elasticsearch_mappings.pl doesn't export
    staff_client/opac fields.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f806adf0ea9b39076d41b2b7a74fff9b5f505790
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 11 08:57:47 2020 +0100

    Bug 25184: DBRev 19.12.00.087
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 82e866fcb549d25a6269d7a25138ae047c95bdb4
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Apr 21 12:52:38 2020 -0400

    Bug 25184: Add syspref
    
    It's entirely possible that some libraries are relying on the current
    before for part of their workflow. Do to this possibility, it seems like
    a good idea to control this behavior via a system preference.
    
    Test Plan:
    1) Apply this patch set
    2) Run updatedatabase.pl
    3) Set TrapHoldsOnOrder to "don't trap"
    4) Set an item's notforloan value to -1
    5) Place a hold on that item
    6) Check in the item
    7) Note the item is not trapped for hold
    9) Set TrapHoldsOnOrder to "trap"
    10) Check in the item
    11) Koha should now ask if you'd like to trap the item for the hold!
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cc938e6be18ae4e81207bfdbd6a0a438529c60cc
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 17 14:06:32 2020 -0400

    Bug 25184: Items with a negative notforloan status should not be captured for holds
    
    Negative notforloan statuses should allow holds to be placed but not captured.
    
    Due to coronavirus, we have libraries setting all returned materials to a negative notforloan value of Quarantine for several days.
    They're using UpdateNotForLoanStatusOnCheckin to set that status automatically. However, those items are still capturing for holds,
    even though those items cannot be checked out until the notforloan status is removed.
    
    In cases like an On Order item where we do want the hold to fill at checkin,
    UpdateNotForLoanStatusOnCheckin should be used to clear that notforloan status so the hold can fill.
    
    In master, if I set an item to a not for loan but holdable status ( < 0 ) I can place the hold,
    capture the hold and set it to waiting, but *not* check it out to the patron!
    This does not make sense. I should not be able to trap an item for checkout unless it can be checked out.
    
    Test Plan:
    1) Set an item's notforloan value to -1
    2) Place a hold on that item
    3) Check in the item
    4) Trap the item for that hold
    5) Attempt to check the item out to the patron, you will be unable to
       because it is notforloan
    6) Apply this patch
    7) Restart all the things!
    8) Repeat steps 1-3
    9) The screen should no longer ask if the item should be trapped
       to fill the hold!
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Catherine Ingram <Catherine.Ingram@cedarparktexas.gov>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc9ef3a2799f4654b114c319c1955113f7f716c6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri May 8 16:45:49 2020 -0300

    Bug 25423: (follow-up) Fix wrong test
    
    This is confusing: why does it pass on all OSs but Debian 8?
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>

commit fcc6836925e6903cf5c1e27a63551820bd5b9569
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 8 15:17:31 2020 +0200

    Bug 25423: Force call to update and empty with an instanciated object
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 6f6bde3c24e5f9dbe6c3ee8b2bb8569d741c8480
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 8 15:17:07 2020 +0200

    Bug 25423: (follow-up) Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 7c87ac8c3ba78434c29181ad9f2add7c99b51741
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri May 8 08:47:25 2020 -0300

    Bug 25423: Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 02fc6ca6d1b740cf7e0015f190efd5cb7c56883c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri May 8 08:39:10 2020 -0300

    Bug 25423: Add Koha::Exceptions::Object::NotInstantiated
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit b5ff3696b5aebb4865f9b988075cc850068a91cf
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 7 21:00:39 2020 -0300

    Bug 23185: (follow-up) K:C:Register->make_default should use no_triggers
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 74586912c081d0440f49228a2cb08fdc84ddb2a2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 7 19:10:29 2020 -0300

    Bug 17355: (QA follow-up) Fix used package name
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>

commit b422e017eca6ad74f0f66d5fea181b01e48d661e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 7 18:20:57 2020 -0300

    Bug 23185: Realistic POD for Koha::Objects->search
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>

commit fdea245e991aca4ca3ddad9d1a15d511e427fc0a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 7 18:05:29 2020 -0300

    Bug 23185: ->update can only be called on instantiated classes
    
    Since our use ok Koha::Objects, there's been an implicit instantiation
    happening in ->search that has somehow hidden the fact that classes need
    instantiation...
    
    This change in ->delete and ->update made it clear because of the
    failures/hangs on the tests.
    
    This patch instantiates Koha::Patron::Categories before attempting to
    call ->update.
    
    The original patches for this bug are correct and the only issue here is
    that we need to document better than for some methods, instantiation is
    not implicit and is required first. This is awkward and I would prefer
    to force everyone to call ->new first. But I understand it would be
    inconvenient.
    
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/Template/Plugin/Categories.t
    => FAIL: Notice it hangs, Ctrl+c to abort
    2. Apply this patch
    3. Repeat 1
    => SUCCESS: Tests dong hang, and in fact pass
    4. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>

commit 185d88bac6745f7b76799600f6fd0a16cf09ac93
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 7 17:05:32 2020 +0200

    Bug 20443: (follow-up) Remove C4::Members::AttributeTypes

commit 4071924f7f9438c344e878a86d29792f83c06704
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 5 14:58:40 2020 +0100

    Bug 18308: (RM follow-up) Clarify intent of tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d97c44b8e733235e6fc70c461c4c9ff943f1368
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 5 10:44:52 2020 +0200

    Bug 17355: Fix failing tests
    
    This patch makes the tests pass without deleting mandatory AV cats
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cdf786b0aa0dc1d9fed489335fcfb0bf2cf9ea43
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 5 11:14:49 2020 +0100

    Bug 24163: DBRev 19.12.00.086
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5eb07b28eb8db9b2e3a72b13b740a0a003eb1d84
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat May 2 16:02:27 2020 +0200

    Bug 24162: Add quantity column to the columns settings config
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 563d316bba4deda338aff3e0f20ee46622083b9c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat May 2 16:00:27 2020 +0200

    Bug 24162: Add missing filter
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dccf4518d46e94970b1b39082d8ec1e326de35ff
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 9 17:28:09 2020 +0100

    Bug 24162: Add quantity column to the late orders page
    
    This patch add a new column "quantity" to the late orders page
    
    Test plan:
    1. Create some orders, close the basket
    2. Go to the "Late orders" page
    => You should see a new column "quantity" that contains the number of
    items of the order
    
    Sponsored-by: Cork Institute of Technology
    Signed-off-by: Devinim <kohadevinim@devinim.com.tr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a02f0b077752d0a686afae5aa7428c3fab1c4cd2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat May 2 15:57:16 2020 +0200

    Bug 24163: UTF-8 encode the output
    
    Specify the UTF-8 charset in the header and Encode the output to avoid encoding issues
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2042cb65310072a5c00205fe1d632deac00e639e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat May 2 15:46:13 2020 +0200

    Bug 24163: Add the new CSV profile to other installer files
    
    export_format is not populated for other languages apparently...
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a5cdfa37fbd5c66fdd8a33f91c843278fb2a0c8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat May 2 15:42:18 2020 +0200

    Bug 24163: (QA follow-up) Fix wordings
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit af4d8a5751ed024bdf0de023394b028175744475
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 17:32:46 2019 +0100

    Bug 24163: Add the csv into the DB - as an example
    
    Sponsored-by: Institute of Technology Tralee
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Angela O'Connor Desmond <angela.oconnordesmond@staff.ittralee.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3cf6d99948e81a5037bd956a1823e7485a65bd91
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 17:24:17 2019 +0100

    Bug 24163: Allow to define CSV profile for late orders export
    
    This new enhancement adds the ability to create a CSV profile for the late
    orders export.
    Prior to this, the CSV profile was hardcoded in a template and not
    editable (unless you modify the .tt file of course).
    
    The main difficulty of the request was to make the multiple claims dates
    accessible from the CSV profile. So far we only accept columns from the
    database. However we would like to use the Koha::Acquisition::Order
    object to make things easier (it had a ->claims method to access the
    different claims).
    To acchieve this, we are going to accept the TT syntax for that CSV profile.
    It means that only CSV profiles created for 'late_orders' will have the
    capability to use the TT syntax (can be extended later of course if
    needed).
    The alternative was to use specific placeholders, like %claims_count%,
    %claimed_date%, but it sounded more powerful and flexible to allow the
    TT syntax instead.
    
    Note that the former export (template based) still exists and is the
    default option.
    
    Test plan:
    0. Apply the patches and execute the update database entry
    1. Create some orders, close the basket
    2. Claim some of the orders
    3. Note the new button at the bottom of the table that have several
    entries.
    => The first entry will generate a CSV file using the previous method
    => The second entry will generate it using the new CSV profile, note
    that the number of claims as well as the different claims date are
    displayed.
    
    4. Bonus point: Edit the CSV profile (Home › Tools › CSV export
    profiles) that is named "Late orders (csv profile)", or create a new
    one, and modify it.
    Export the late orders using this CSV profile and confirm that the
    generated CSV file is the one you expect.
    
    Sponsored-by: Institute of Technology Tralee
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Angela O'Connor Desmond <angela.oconnordesmond@staff.ittralee.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3ebfa1a74a1f2265f6af8121dc5c9d36cb95ea68
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Apr 11 14:09:27 2020 +0000

    Bug 15727: Add MARC21 385 - Audience to detail pages
    
    This add 385$m$a to the staff and intranet detail pages.
    
    To test:
    - Catalog different variations of 385 and verify the
      display in the OPAC and staff client is ok
    
    Examples can be found in the LOC MARC21 documentation:
    http://www.loc.gov/marc/bibliographic/bd385.html
    
    Signed-off-by: Stina Hallin <stina.hallin@ub.lu.se>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 48d887c2363b7611036cf336b3abf83aea3381fe
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 4 11:25:35 2020 -0300

    Bug 24769: Regression tests
    
    When regressions are found, we introduce regression tests :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6ec2d13b9da8ca42a2553ca4e6b781d807678240
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 24 11:31:33 2020 +0200

    Bug 24769: (bug 14711 follow-up 2) Fix typo in parameter name for AddReserve
    
    This patch fixes 2 other occurrences. The first one is in POD of
    AddReserve, the other one fixes SIP code
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 05b39b50e0d2a2776b38c2ef17dc78ffb8cfc573
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 24 11:25:43 2020 +0200

    Bug 24769: (bug 14711 follow-up) Fix typo in parameter name for AddReserve
    
    The parameter is branchcode, not branch.
    
    Test plan:
    Place a hold on a biblio using ILSDI
    Check that the branchcode is correctly filled with the patron's library
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 031e53958a400d491a502a1c32bf89d3bcfeb0dd
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Apr 13 04:42:37 2020 +0200

    Bug 22335: Fix comment on suggestions.STATUS in kohastructure.sql
    
    The description on STATUS was incomplete, missing 2 status and
    the SUGGEST_STATUS category.
    
    To test:
    - Later this will show up in schema.koha-community.org, but
      for now it can only be verified reading the patch.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0a8775cfabd674207112f0c205dc1bd2578040e1
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Thu Apr 23 08:36:38 2020 -0300

    Bug 7947: (follow-up) fix 490 subfield visibility (IT)
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2cbe7bc17a80760d4ed849d95b1de02ce8f1a402
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Thu Apr 23 08:36:09 2020 -0300

    Bug 7947: (follow-up) fix 490 subfield visibility (DE)
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 09ccb2e96844ddfcbbe4d3007a71ed614fe371d3
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Thu Apr 23 08:35:35 2020 -0300

    Bug 7947: (follow-up) fix 490 subfield visibility (EN)
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9569c5e31f9df0bac0c8989f7dafd0b0d8088e4e
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 11:23:54 2020 +0100

    Bug 7947: Update MARC21 440/490 mapping and visibility in uk-UA installer
    
    440 has been obsoleted in the standard for a long time.
    490 is now used for series information.
    
    Changes made here only apply for new installations:
    - Hide 440 subfields by default
    - Make 490 avx visible by default
    - Add mapping biblioitems.seriestitle to 490a
    - Add mapping biblioitems.volume to 490v
    
    To test:
    - Run the web installer for this language and verify changes
      in all frameworks
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f298b30fe3a7cb8f64cecb6d20e2cb157defd537
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 11:25:40 2020 +0100

    Bug 7947: Update MARC21 440/490 mapping and visibility in ru-RU installer
    
    440 has been obsoleted in the standard for a long time.
    490 is now used for series information.
    
    Changes made here only apply for new installations:
    - Hide 440 subfields by default
    - Make 490 avx visible by default
    - Add mapping biblioitems.seriestitle to 490a
    - Add mapping biblioitems.volume to 490v
    
    To test:
    - Run the web installer for this language and verify changes
      in all frameworks
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f06bd7be16596a4fb189f60137c86d727e279336
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 11:26:57 2020 +0100

    Bug 7947: Update MARC21 440/490 mapping and visibility in nb-NO installer
    
    440 has been obsoleted in the standard for a long time.
    490 is now used for series information.
    
    Changes made here only apply for new installations:
    - Hide 440 subfields by default
    - Make 490 3avx visible by default
    - Add mapping biblioitems.seriestitle to 490a
    - Add mapping biblioitems.volume to 490v
    
    To test:
    - Run the web installer for this language and verify changes
      in all frameworks
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fee4fe4f88a23a4fa109b4ccc829e03773cef43b
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 11:29:11 2020 +0100

    Bug 7947: Update MARC21 440/490 mapping and visibility in pl-PL installer
    
    440 has been obsoleted in the standard for a long time.
    490 is now used for series information.
    
    Changes made here only apply for new installations:
    - Hide 440 subfields by default
    - Make 490 3avx visible by default
    - Add mapping biblioitems.seriestitle to 490a
    - Add mapping biblioitems.volume to 490v
    
    To test:
    - Run the web installer for this language and verify changes
      in all frameworks
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2b72cd6b12f01d574462512f68a8f8035ad0c6bb
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 11:30:44 2020 +0100

    Bug 7947: Update MARC21 440/490 mapping and visibility in it-IT installer
    
    440 has been obsoleted in the standard for a long time.
    490 is now used for series information.
    
    Changes made here only apply for new installations:
    - Hide 440 subfields by default
    - Make 490 3avx visible by default
    - Add mapping biblioitems.seriestitle to 490a
    - Add mapping biblioitems.volume to 490v
    
    To test:
    - Run the web installer for this language and verify changes
      in all frameworks
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a722e5970b6a3a7f268086a6d7fee30466fb7d7
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 11:28:37 2020 +0100

    Bug 7947: Update MARC21 440/490 mapping and visibility in fr-FR installer
    
    440 has been obsoleted in the standard for a long time.
    490 is now used for series information.
    
    Changes made here only apply for new installations:
    - Hide 440 subfields by default
    - Make 490 3avx visible by default
    - Add mapping biblioitems.seriestitle to 490a
    - Add mapping biblioitems.volume to 490v
    
    To test:
    - Run the web installer for this language and verify changes
      in all frameworks
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 13773753448f3cad6922e868ffca49dd4991474d
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 11:18:37 2020 +0100

    Bug 7947: Update MARC21 440/490 mapping and visibility in de-DE installer
    
    440 has been obsoleted in the standard for a long time.
    490 is now used for series information.
    
    Changes made here only apply for new installations:
    - Hide 440 subfields by default
    - Make 490 3avx visible by default
    - Add mapping biblioitems.seriestitle to 490a
    - Add mapping biblioitems.volume to 490v
    
    To test:
    - Run the web installer for this language and verify changes
      in all frameworks
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 05b21df1db4726e3f94252bbb032a984607a3991
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 11:28:06 2020 +0100

    Bug 7947: Update MARC21 440/490 mapping and visibility in en installer
    
    440 has been obsoleted in the standard for a long time.
    490 is now used for series information.
    
    Changes made here only apply for new installations:
    - Hide 440 subfields by default
    - Make 490 3avx visible by default
    - Add mapping biblioitems.seriestitle to 490a
    - Add mapping biblioitems.volume to 490v
    
    To test:
    - Run the web installer for this language and verify changes
      in all frameworks
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 21d0d69b4fc126c8c2242c57950b8cf1d45bf482
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Apr 19 13:39:08 2020 +0200

    Bug 18670: Remove RewriteLog and RewriteLogLevel from sample config files
    
    It looks like RewriteLog will no longer work with Apache 2.4 and later.
    
    RewriteLog
    Those familiar with earlier versions of mod_rewrite will
    no doubt be looking for the RewriteLog and RewriteLogLevel
    directives. This functionality has been completely replaced
    by the new per-module logging configuration mentioned above.
    http://httpd.apache.org/docs/current/mod/mod_rewrite.html
    
    All lines removed were commented out, so there should be
    no change in behaviour or side effects.
    
    To test.
    - Verify every mention of RewriteLog has been removed from Koha
    - Verify patch by reading it
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8457804bcf6b6b51703a2fa1143d0dfd539e4e4b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 5 10:57:07 2020 +0100

    Bug 23185: (RM follow-up) Minor POD wording update
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fe2ac51b2732befe9e4f9b8d2c85d6d94de525a3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 4 09:54:30 2020 -0300

    Bug 23185: (QA follow-up) Add POD for Koha::Objects->update
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 633befb5f0e23306586aedf3219fefab5fa719f0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 1 14:12:09 2020 +0100

    Bug 23185: (QA follow-up) Semantics, split fields and options
    
    This patch improves the semantics of the update routine to more clearly
    separate the 'fields' we're modifying from the 'options' we wish to
    apply to the modification.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6235d0cfa16e5278a32ba6a4814f67ee4ad575b1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 28 17:14:41 2020 +0200

    Bug 23185: Make Koha::Objects->update loop on the object set if needed
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 085cc7c4d21fdf30e79d3b15844fc8f872f5114b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 28 17:14:35 2020 +0200

    Bug 23185: Add tests
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cd141a74458f739ce74e627376b97ea72df0c0c6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue May 5 10:26:55 2020 +0200

    Bug 18308: fix failing tests
    
     #   Failed test 'check_password hook tests'
     #   at t/db_dependent/Koha/Plugins/Patron.t line 83.
     [The password was rejected by a plugin]# Looks like your test exited with 255 just after 5.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0575bc22d14b7a14ba38df51432114f53230bd2f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 5 10:49:07 2020 +0100

    Bug 18308: (RM follow-up) Fix failing tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a6985d167e11eaafee985b51cb0188a693405af5
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon May 4 11:33:11 2020 +0000

    Bug 25133: (follow-up) Move changes to timepicker.inc
    
    Witht the changes in calendar.inc there can be a js error where the timepicker is not
    included. Moving the changes to timepicker.inc should resolve this
    
    Note: in previous patches the amnames/pmnames were removed. It is possible they had
    no effect because they were declared in two files, so I have left them in timepicker.inc
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 164b8127e719628aa9013dd2b30fb6511fbc4bf9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 4 13:32:33 2020 +0200

    Bug 24161: (follow-up) DBIC changes
    
    Define koha_object[s]_class methods
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 910acdbcfab3c11a583dd5cb92802fe57355f1ff
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 4 13:29:31 2020 +0200

    Bug 24161: (follow-up) Fix typo in POD
    
     #   Failed test 'POD test for Koha/Acquisition/Orders.pm'
     #   at /usr/share/perl5/Test/Pod.pm line 187.
     # Koha/Acquisition/Orders.pm (43): Non-ASCII character seen before =encoding in 'uivalent'. Assuming UTF-8
    xt/author/podcorrectness.t .. 622/829 # Looks like you failed 1 test of 829.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 67f695001a17556fc3b1796181fff9a1493cae94
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri May 1 18:29:33 2020 +0000

    Bug 25350: Load Emoji picker assets more efficiently
    
    This patch moves the Emoji picker JS assets out of opac-bottom.inc and
    into opac-detail.tt. This prevents the assets from being loaded on every
    page of the OPAC when they're only used on opac-detail.
    
    The patch also combines and minifies the 4 JavaScript files used by the
    feature. opac-detail.tt now loads only the one file.
    
    To test, apply the patch and make sure the TagsEnabled and
    TagsInputOnDetail preferences are enabled.
    
    - Log in to the OPAC and view the detail page for a bibliographic
      record.
    - Click the "Add tag(s)" link
    - Verify that the emoji-picker works for adding emojis
    
    Signed-off-by: David Roberts <david@koha-ptfs.co.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d6ab91721366264d40fd092f6a2e1e7f74dfb8b5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 4 09:26:39 2020 +0100

    Bug 24161: Schema Fixes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a18e944400efd354f2b755459f45e249f8a24468
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 4 09:23:19 2020 +0100

    Bug 24161: DBRev 19.12.00.085
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e294eb1dd7965347fcbcb4aecb81d3eb4140232c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat May 2 15:28:23 2020 +0200

    Bug 24161: (follow-up) DB changes
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1cf3f11bbda3ed0bc71dbee2853da2fbd0778e0b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat May 2 15:26:42 2020 +0200

    Bug 24161: Fix license statements
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6b34eab8570e1899e9a3395ddee2850f53fd1e15
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 23 13:41:04 2020 +0200

    Bug 24161: Display claimed dates vertically
    
    Signed-off-by: Angela O'Connor Desmond <angela.oconnordesmond@staff.ittralee.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a8f3ba98feb6bfbc349d20e696e0ecaec2b3452
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 1 14:30:54 2020 +0200

    Bug 24161: DBIC manual changes
    
    No idea what's happening with the current_timestamp, but previous change
    was wrong.
    
    Signed-off-by: Angela O'Connor Desmond <angela.oconnordesmond@staff.ittralee.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b2de93144a3091e282c3a49e7c6957b91309ae17
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 8 23:47:02 2020 +0100

    Bug 24161: Add tests
    
    Sponsored-by: Cork Institute of Technology
    Signed-off-by: Angela O'Connor Desmond <angela.oconnordesmond@staff.ittralee.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 33745001d1faf1c60a520297f7fad95a2e519604
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 8 21:45:09 2020 +0100

    Bug 24161: Remove GetLateOrders
    
    Sponsored-by: Cork Institute of Technology
    Signed-off-by: Angela O'Connor Desmond <angela.oconnordesmond@staff.ittralee.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2c2e7740fb5fc52e44c6363a217ce6c0f6bda47
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 16 18:35:08 2019 +0100

    Bug 24161: Keep tracks of late orders claims
    
    So far we only record the number of claims and the date of the last
    claim, in the aqorders table.
    To keep track of the different claim dates, this patchset is going to
    make the following DB changes:
      * Create a new table 'aqorders_claims' (id, ordernumber, claimed_on)
      * Remove the two columns from the aqorders table: claims_count and
      claimed_date
    
    This will allow to display the different claim dates where needed: on
    the late orders page, and the basket page.
    
    To avoid additional fetches of Koha::Acquisition::Orders, GetLateOrders
    has been moved to Koha::Acquisition::Orders->filter_by_late
    That way we are going to add consistency, robustness, and cover the
    feature with new tests.
    
    Test plan:
    0/ Create a bunch of new orders. Make sure they are from different
    vendor (with different delivery time).
    1/ Go to the late orders page and claim some orders
    2/ Reclaim some of those orders
    3/ Confirm that you can see the different claim dates for a given orders
    (the history of the late orders claims is kept and displayed)
    
    4/ Bonus point: Regression tests:
    
    a. Modify the closedate of the basket in the database. That
    will allow you to make sure the patch set did not introduce regressions.
    It would be good to test the different filters on the late orders page:
     * delay
     * Estimated delivery date from/to
     * Vendor
    
    b. Confirm that the subtotal and the total values from the late orders
    page is correct.
    
    c. Test the update database entry: do not apply these patches, claims
    some orders against master. Apply the patch, execute the update DB entry
    then confirm that the number of claims is correct (note that the dates
    will not as it is not possible to guess them).
    
    QA note: the branchcode parameter has been removed from filter_by_late.
    At first glance it seems that it was not used.
    
    Sponsored-by: Cork Institute of Technology
    Signed-off-by: Angela O'Connor Desmond <angela.oconnordesmond@staff.ittralee.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b58c1c692b2bf335caac68968aaedd767b7977e2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 16 17:34:12 2019 +0100

    Bug 24161: Add the Koha::Acquisition::Order::Claim[s] classes
    
    Sponsored-by: Cork Institute of Technology
    Signed-off-by: Angela O'Connor Desmond <angela.oconnordesmond@staff.ittralee.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2556e39a34750e6f3cb7061c6d9eeb32dd0f7f53
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 16 17:30:55 2019 +0100

    Bug 24161: DBIC changes
    
    Sponsored-by: Cork Institute of Technology
    Signed-off-by: Angela O'Connor Desmond <angela.oconnordesmond@staff.ittralee.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 878ab699fca320ba30b8f53a4015696a09c4e61d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 16 17:20:31 2019 +0100

    Bug 24161: DB changes
    
    Sponsored-by: Cork Institute of Technology
    Signed-off-by: Angela O'Connor Desmond <angela.oconnordesmond@staff.ittralee.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0963451d65016d6c6c6a4ce4974ef6da18fc011c
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat May 2 04:29:11 2020 +0200

    Bug 24995: (QA follow-up) Terminology: Use checkin and checkout
    
    ... instead of issue and return.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aca15e62532cdc05568c35e9014bc7e233d3a79f
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Thu Mar 26 21:17:42 2020 +0000

    Bug 24995: Add issuedate to table_account_fines and finest
    
    TO TEST:
    1. Have a patron with some fines on an item. Try accruing fines.
    2. Go to the accounting tab and look at both the Tranaction tab and Make a payment Tab
    3. No Issue Date
    4. Apply patch
    5. Check those tabs again and see the issue date displays.
    6. Go to column configuration and try to hide the issuedate, make sure it hides properly. Try this for both tables. Also make sure other columns hide properly.
    7. Sign off!
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1dc361e824dbd60cb8aaade702c9873ea8942e44
Author: Didier Gautheron <didier.gautheron@biblibre.com>
Date:   Thu Feb 27 10:51:19 2020 +0100

    Bug 24740: Use biblio title rather than biblio number in OPAC search result cover images tooltips
    
    In OPAC biblionum doesn't mean much to patrons, use biblio title field if not empty.
    
    Test plan:
    OPAC search
    1) Apply the patch
    2) For each cover images providers available to tester in:
    /cgi-bin/koha/admin/preferences.pl?tab=&op=search&searchfield=Cover
    OPACLocalCoverImages, AdlibrisEnabled, OPACAmazonCoverImages, GoogleJackets, Coce provider.
    3) Enable the provider.
    4) Search a Library Catalog for a book with a cover image.
    6) test mouse over cover image display biblio title.
    
    OPAC Shelves
    1) Enable OPAC virtualshelves preference
    2) Create a list.
    3) For each covers providers available.
    4) Search the List
    5) test mouse over cover image display biblio title.
    
    Signed-off-by: Stina Hallin <stina.hallin@ub.lu.se>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 140079c807b68d48cc5abcd92a3b3cd55fd5e8cf
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat May 2 03:31:30 2020 +0200

    Bug 15668: (QA follow-up) Add date accessioned to column configuration
    
    The date accessioned column in the items table was not
    configurable in the columns settings.
    
    To test:
    - Make sure the Date accessioned is shown in the column list
      on both tables
    - Make sure that configuring it via Adminitration > Configure
      columns works as intended
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 39d904e21d8adce183dc068a26172d8924dc10fa
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat May 2 03:22:44 2020 +0200

    Bug 15668: (QA follow-up) Fix capitalization Course Reserves
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6c4375adb5f1bc9a1e3a70c49af43a3c02e0b8b1
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Mon Mar 16 17:48:26 2020 +0000

    Bug 15668: (follow up) add selector to th
    
    follow up add a selector to the <th> to ensure we count the table in questions.
    Should not affect other pages but is needed on detail.tt where there are two tables to configure
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a867743f94402b475fcc3d62897ec6a23b2bec22
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Thu Mar 12 14:50:57 2020 +0000

    Bug 15668: Add column configuration to the items table in staff detail pages
    
    To test:
    1 - Apply patches
    2 - View biblio details in staff client
    3 - Should be able to toggle columns
    4 - Go to admin columns settings
    5 - Change some settings, verify they work
    6 - Enable SeparateHoldings
    7 - Go to a record that has holdings from 2 different branches
    8 - Change some settings, verify they work.
    9 - Check the Other Holdings Tabs, change some settings make sure they work.
    10. - Test all the dataTable functions like the search box, columns, export. make sure they on both tabs
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a15932117cae6341a91cd0f21bdd05fb2a4c0922
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Fri May 1 17:01:11 2020 +0000

    Bug 25341: Remove whitespace from barcode in add_items.pl
    
    TEST PLAN:
    1. Go to course reserves and trying adding a course with a barcode that has some leading/trailing whitespace.
    2. It doesnt work
    3. Apply patch and restart_all
    4. Try again with leading/trailing whitespace, it should work.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d94be594a2cc55bfac8962473b3e12faa0d294cd
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri May 1 13:23:12 2020 +0000

    Bug 24522: Show alert when trying to add nothing to a list in staff
    
    This patch modifies the JavaScript which handles the process of adding
    items to a list in the staff client. Error-handling is added in the case
    when a set of biblionumbers hasn't been passed to the vShelf function.
    
    To test, apply the patch and perform a catalog search in the staff
    client.
    
    On the search results page, select any list from the "Add to list" menu
    at the top of the search results table without checking any checkboxes.
    
    You should get an alert, "No item was selected."
    
    Also test that adding to a list works correctly after selecting one or
    more titles.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4bad65addf1c19cc736af7c23bfee474ff53068b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 4 09:44:09 2020 +0100

    Bug 13388: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5a861749d911585d64f671c64ec86f8fd07c6748
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri May 1 15:07:07 2020 +0000

    Bug 13388: (QA follow-up) Add id to nav item and use singleBranchMode
    
    This uses the existing singleBranchMode variable to display either
    Library or Libraries depending on the number of existing libraries
    in the installation.
    
    It also adds an id to the navigation item for customization purposes.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 20c3d85b5e4d99e5a9aece8a081e29ca3723c3fe
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 1 15:12:14 2020 +0100

    Bug 13388: (follow-up) Inlcude OpacNav
    
    I believe this page should include the optional OpacNav and
    OpacNavBottom blocks
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e36e73506e7497ef6debf2ad32534ed8a223e994
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri May 1 12:06:03 2020 +0000

    Bug 13388: (follow-up) Remove display of email address
    
    Since the email address configured for a library may not be the email
    address libraries want to use as a contact email address the email
    should not be displayed by default.
    
    This patch removes display of the email address. Libraries may choose to
    add the information to the opac_info column, so there is already a
    built-in alternative.
    
    To test, apply the patch and view the detail page for a library in your
    system which has an email address configured. The email address should
    not display on the page.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 308d67950ea1b2560a2f71b1f69750b45b83834f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Apr 28 19:23:55 2020 +0000

    Bug 13388: Add library pages to the OPAC
    
    This patch adds a script and a template for showing library information
    pages in the OPAC. A "libraries" page lists all the libraries in the
    system, linking to individual pages for each library showing more
    information..
    
    If there is only one library in the system the page shows all of that
    library's information.
    
    To test, apply the patch and rebuild the OPAC CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
     - Go to /cgi-bin/koha/opac-library.pl in the OPAC.
     - Verify that all the correct information is displayed for the
       libraries in your system.
     - Verify that page title and breadcrumbs look correct.
     - Click to view details for a library.
       - The details page should show the full contents of
         branches.opac_info
       - A menu should show links to other libraries' detail pages.
    
    EDIT: This revised patch adds a "Libraries" link to the links under the
    search bar; Corrects encoding in the breadcrumb link; Makes the page
    title more specific when viewing an individual library.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e64d3c8d675040aa8213c1b4d6ee93267b741986
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Fri Oct 20 23:22:13 2017 +0000

    Bug 18308: Increase minPasswordLength default to 8
    
    To test:
    - Run the web installer for any language
    - Verify that minPasswordLength is set to 8 now
    
    Sponsored-By: Catalyst IT
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9776d591ece45b36365f69315e2c958f264bc76f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri May 1 12:43:40 2020 +0000

    Bug 25340: Pass biblio object to OPAC comments template
    
    This patch modifies the OPAC comments system so that the biblio object
    is passed to the template. This allows the biblio-title include to
    properly access the title and subtitle information.
    
    Unrelated change: Remove some custom CSS from the page which was
    obsolete.
    
    To test, apply the patch and make sure the "reviewson" preference is
    enabled.
    
    - Log in to the OPAC and open a bibliographic record's detail page.
    - Under the "Comments" tab, click the "Post your comments" link to
      trigger the pop-up window.
    - In the pop-up window, verify that the item's title is correct in the
      page title and the heading. Author should display correctly, if
      present.
    - Test submitting a comment and editing a comment. Everything should
      work correctly.
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1f00c2a9a911b180d20638bafa26463d5e7a6619
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Sun May 3 19:19:21 2020 -0300

    Bug 24636: (follow-up) - move 'by' into include file
    
    To ease correct translation.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0650c9abdf1605030e86596c1000a91aaac8c5f5
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Apr 28 21:21:09 2020 -0300

    Bug 24636: translate planning sections
    
    This patch adds a new inc file to process
    and translate plannig sections
    
    To test:
    1) Apply patch
    2) Create new language files
    (cd misc/translator; ./translate create xx-YY)
    3) Verify new file is taken into account in
    translation files
    egrep -n budget_planning misc/translator/xx-YY*.po
    check new strings in staff-prog file
    4) Go to Administration > Budgets > Founds > Planning
    select different options, check page title and
    'Planning for...' phrase
    5) Translate strings, install new language, enable it,
    verify the text change with options like point 4)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0e34f36d47fb2a5e7834b5f6b73e453d487d67b7
Author: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
Date:   Thu Apr 30 19:35:51 2020 +0000

    Bug 25335: group by authorised_value in addbiblio.pl
    
    To Test:
    1- Edit your default framework, connect any subfield outside of the 952 to an authorised value (for example, connect the 942$n to the Yes_No auth value)
    2 - Find a record in that framework
    3 - Edit the record and find your subfield
    4 - The subfield shows a dropdown with no contents
    5 - check plack log, see "DBD::mysql::st execute failed: 'koha_kohadev.authorised_values.authorised_value' isn't in GROUP BY "
    6 - apply patch, restart all
    7 - reload edit record page, see your auth value dropdown has contents
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3f752ce2b85bf600cca2e59b1bcd69a5854016aa
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Apr 21 12:06:09 2020 +0000

    Bug 25133: (follow-up) Remove Names as they do no affect display
    
    In testing I couldn't make any changes to the names have an effect
    and everythign worked as expected without these lines
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0610dbd6fce4ffcc1dff0c69424d70703afa722e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 20 10:59:55 2020 +0200

    Bug 25133: Handle 12hr format for dt_from_string
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a8d5b11629f74174c7e6169bfdc5ac969d9ed990
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 17 12:11:25 2020 +0200

    Bug 25133: Fix time part of due date for 12hr
    
    With Timeformat system preference set to 12 hours format:
    
    Prior to 19.05.08, when due date was specified at checkout,
    the time in the box would show in 24hr format (e.g. 15:59)
    while the due date in the patron's checkouts would show
    in 12hr format (e.g. 3:59 PM).
    
    After 19.05.08, the format in the specify a due date box
    shows in 24hr format and the due date in 12hr format
    (in patron checkouts) as before.
    
    But when checking out multiple items using the specify due
    date option for the session, the time changes from PM to
    AM.
    
    To test:
    - Check out an item with specified due date 15:50 PM
    - Check out a second item in same transaction
    - Verify date changed to AM
    - Apply patch
    - Repeat
    - Verify this time the date is kept as set
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 83c65d975f8712c9d50ecf65033cdc1012698986
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 29 11:53:45 2020 +0200

    Bug 25305: Translation process - Open all files specifying the utf8 encoding
    
    To test:
    1) Create translation files for a new language
    ( cd misc/translator; ./translate create xx-YY)
    A new language means one that isn't already in Koha, xx-YY=>something you
    invent.
    2) Verify double encoding
    egrep "Aix-Marseille|Jean Prunier|periodika|Bokm" misc/translator/po/xx-YY-*
    check strange strings
    3) Apply the patch
    4) Create po files again
    ( cd misc/translator; rm -f po/xx-YY*; ./translate create xx-YY)
    5) Verify no more double encoding
    egrep "Aix-Marseille|Jean Prunier|periodika|Bokm" misc/translator/po/xx-YY-*
    check normal string
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Didier Gautheron <didier.gautheron@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ebded0c3326e87aacba57c082d3ddf8fe37b510f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Apr 27 13:20:23 2020 +0000

    Bug 22515: Improve logic determining how to show OPAC suggestions
    
    This patch makes changes to the OPAC suggestions view so that the logic
    around logged in users and the OPACViewOthersSuggestions preference is
    more specific.
    
    To reproduce the bug you should have pending purchase susggestions in
    your system from more than one patron.
    
    1. Set the OPACViewOthersSuggestions preference to "Show."
    2. Log in to the OPAC as a user who has not submitted any suggestions.
    3. Follow the link to the purchase suggestions page from the menu under
       the search bar.
    4. The page will say that there are no  purchase suggestions.
    5. Add "?suggested_by_anyone=1" to the end of the page URL.
    6. You should see suggestions from other users.
    
    To test, apply the patch and repeat steps 2-3 above. The suggestions
    page should show other patrons' suggestions.
    
    Test with different combinations of factors:
    
     - Logged in user, OPACViewOthersSuggestions off
     - No logged in user, OPACViewOthersSuggestions on
     - No logged in user, OPACViewOthersSuggestions off
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 263a889be4f3ec002b779abe0917da664e9b6ade
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Apr 22 12:11:53 2020 +0000

    Bug 25247: Only convert data ot objects when displaying on screen
    
    To test:
     1 - Modify a patron
     2 - Circulate some items to the patron
     3 - Click 'Modification log'
     4 - Verify you see your actions
     5 - Under 'Output' select 'To a file'
     6 - Save the output to a file
     7 - View the file
     8 - Not you have references ot objects in stead of patron/item data
     9 - Apply patch
    10 - Repeat
    11 - Note viewing on screen has not changed
    12 - Note exporting to file inlcudes borrower/item numbers and not references
    13 - Sign off
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 569f3915d7212f580b7a5bf6c7767c6374c279dd
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Apr 29 17:57:44 2020 +0000

    Bug 21565: (follow-up) Make confirmation buttons more detailed
    
    This patch updates the confirmation buttons to be more specific about
    what each one does. My concern was that it wasn't clear that "No" meant
    "No receipt" and not "Cancel logging out."
    
    The patch also updates the modal confirmation code so that the modal
    body is removed if no message is passed for it.
    
    To test, apply the patch and repeat the previous test plan. When you
    click "Finish" you should have the options "Print receipt and end
    session" and "End session."
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4317229ae9096453ece8464d09375488ff322e21
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Fri Apr 24 18:39:02 2020 +0000

    Bug 21565: Add modal to SCO confirm
    
    This patch uses the confirmModal framework to add a modal confirm to
    SCO Finish.
    
    TO TEST:
    
    1. Enable SCO and go to /cgi-bin/koha/sco/sco-main.pl. Make sure
       SelfCheckReceiptPrompt is set to 'show'
    2. Login and click 'Finish' to see the old print alert box.
    3. Apply patch and repeat steps 1 and 2.
    4. Make sure the modal works for confirming and denying a receipt.
       Checkout some items and make sure everything still functions the
       same.
    5. Make sure when printing a receipt that the print dialog automatally
       shows
    6. Set SelfCheckReceiptPrompt to 'Don't show' and confirm behavior is
       acceptable.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3e4409155339139366d7cb586ee775a89d7f4c0b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 10 06:58:43 2020 -0400

    Bug 25107: Remove double passing of $server variable to maybe_add in C4::SIP::Sip::MsgType
    
    At some point some calls to maybe_add got an extra $server var in their
    parameter lists. This doubled parameter does nothing and should be
    removed.
    
    Test Plan: No change in behavior should be noted
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1667a5af935115a812bc95db26d31521ccb5ee44
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Mon Apr 6 23:42:19 2020 +0000

    Bug 23119: MARC21 added title 246, 730 subfield i displays out of order, and should display before subfield a
    
    This patch makes the subfield i display before subfield a in the 246 and
    730 fields
    
    To test:
    
    1) Create a bibliographic record with data in several subfields in tags
    246 and 730.
    2) See that subfield i displays at the end of the field in the 246
    field, and probably not at all in the 730 field. Check in both the OPAC
    and staff client
    3) Apply the patch.
    4) Check your bib record again in both clients. Subfield i should now
    display before subfield a.
    
    Signed-off-by: Heather Hernandez <heather_hernandez@nps.gov>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c6edd2d7f375f624a922bd59c1b275a9bdba6f97
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 29 14:57:57 2020 +0200

    Bug 25309: Limit size of streetnumber field to 10
    
    It's its size in DB (varchar(10))
    
    Test plan:
    Create or editing a patron and confirm that you fill in more than 10
    characters in the streetnumber field
    Save
    => The patron has been correctly created/updated
    
    Signed-off-by: David Roberts <david@koha-ptfs.co.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2c01b24586e3828c87c2bb383d864cebf32a7c4
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri May 1 22:04:15 2020 +0000

    Bug 25311: (QA follow-up) Add misssing filter
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b3e30677315ee304a74ae31c6851030e22b31b27
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 29 14:48:38 2020 +0200

    Bug 25311: Better error handling when updating a patron
    
    Same as the precedent patch for patron's modification
    
    Test plan is identical but with an existing patron
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 580e6fabff5ec0f564e200a6b2fe42955661b5b7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 29 14:38:41 2020 +0200

    Bug 25311: Better error handling when creating a patron
    
    This is still not ideal but brings a bit of enhancement.
    
    One possible problem is that the patron creation will fail if the
    streetnumber field is too long (borrowers.streetnumber is varchar(10).
    
    Test plan:
    0. Don't apply this patch
    1. Create a new patron with a streetnumber longer than 10 characters
    2. Save
    => The patron has not been created and the app explodes
    The error is about extended_attributes and not meaningful
    Can't call method "extended_attributes" on an undefined value at /kohadevbox/koha/members/memberentry.pl line 560
    3. Apply the patch
    4. Repeat 1. and 2
    => You get a warning on the interface and you still see the creation
    form
    5. Check the logs
    => The error is meaningful
    "Data too long for column 'streetnumber'"
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 39138e860ce8e3eb54d2788ba32728baf03122c0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 4 08:35:59 2020 +0100

    Bug 17268: DBRev 19.12.00.084
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e2ace8dfe33c04048a3ef52a5a735cc9aedd54d1
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 4 08:33:02 2020 +0100

    Bug 17268: Schema Update
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7c325fd6319057e8d8746bf829419f99d0ac9dba
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri May 1 21:35:38 2020 +0000

    Bug 17268: (follow-up) Don't show the macro ID in front of description
    
    I believe it's nicer to allow users to organize the macros as
    they want using the descrpitions they prefer.
    
    Submitting as a suggestion.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8adf22c72511c9252cc90cc4d295f868abc1e718
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri May 1 23:33:00 2020 +0200

    Bug 17268: (QA follow-up) Make "Convert old browser macros" translatable
    
    The code was missing the necessary markup to make the string translatable.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 240b52170be0551830d0d1c77967f271d5ae553e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Apr 22 21:13:34 2020 +0000

    Bug 17268: Update patchs per RFC
    
    https://wiki.koha-community.org/wiki/Advanced_editor_macros_endpoint_RFC
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c34eb3c95032b9ae54c04a55a5935bdc9691804c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Mar 27 10:38:04 2020 +0000

    Bug 17268: (follow-up) Fix translatability
    
    This patch moves the error messages to translatable strings
    
    Also includes capitalization fixes and POD adjustment
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b76fb4a6c5b6eec9d9ed7a6656bca28e013b6ca9
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Mar 11 09:39:25 2020 -0400

    Bug 17268: Set boolean for shared column in schema
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Heather Hernandez <Heather_Hernandez@nps.gov>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3db5242ff9d92789ec346d6c278eb54c3bdd7d7d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jan 2 15:02:04 2020 +0000

    Bug 17268: Schema update
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Heather Hernandez <Heather_Hernandez@nps.gov>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e94c5ea20b60401c99cab1ee9c5d0a9b321b9acb
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Mar 11 09:31:39 2020 -0400

    Bug 17268: (follow-up) Fix licenses
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Heather Hernandez <Heather_Hernandez@nps.gov>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1ed4cc6540e48da584763ed24d5571608d14cf61
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Mar 3 13:14:03 2020 +0000

    Bug 17268: Use API to store/retrieve values
    
    To test:
     1  - Enable AdvancedCatalogingEditor
     2  - Add some macros (they don't need to be valid, just have content)
     3  - Apply patches
     4  - updatedatabase
     5  - Set user to have 'create_shared_macros' and 'delete_shared_macros'
     6  - Load the advanced editor (Cataloging->Advanced editor)
     7  - Click on 'Macros'
     8  - Previous macros should not show, but you should have a 'Convert' button
     9  - Convert old macros and confirm they show
    10  - Edit the macros, changing content and the public checkbox, confirm 'Saved' shows in the top right of editor when updating
    11  - Have at least on valid macro and run it, e.g.:
        new 100=Testing this out
    12  - Run the macro, confirm it runs
    13  - Try a macro with gibberish, confirm there is an error when running
    14  - Ensure you have a few macros marked public
    15  - In a private browser window sign in as a patron with neither shared macro permission
    16  - Confirm the public macros load, but cannot be edited
    17  - Grant create_shared_macros permission to this patron
    18  - Reload editor, they should now be able to edit shared macros
    19  - Confirm they cannot delete shared macros
    20  - Grant delete_shared_macros permission
    21  - Reload editor
    22  - Confirm they can now delete shared macros
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Heather Hernandez <Heather_Hernandez@nps.gov>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 537ba245eed721d645387b840d6dbffaf98d57df
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Dec 4 11:39:41 2019 +0000

    Bug 17268: Advanced cataloging editor macros - add endpoint
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Heather Hernandez <Heather_Hernandez@nps.gov>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b6be7cced077e587c00a43080efc548b48fefac
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Oct 2 13:28:39 2019 +0000

    Bug 17268: Add macros table and permissions
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Heather Hernandez <Heather_Hernandez@nps.gov>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3d953d7988df792ca83a13872a39f49480c7e39f
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Apr 28 19:37:52 2020 -0300

    Bug 24808: enable translation on results.js
    
    String sorrounded by "__()"
    
    To test:
    1) create translation files for a language
    (cd misc/translator; ./translate create xx-YY)
    
    2) Check string
    egrep -l "No cover image available" misc/translator/po/xx-YY-*
    present in 2 files, opac-bootstrap and staf-prog
    
    3) Apply patch
    
    4) Create files again
    (cd misc/translator; rm -f po/xx-YY*; ./translate create xx-YY)
    
    5) Check again
    egrep -l "No cover image available" misc/translator/po/xx-YY-*
    present in 3 files, new in messages-js
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 219f000069377f8a6b2790e42870083236b66bd0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 4 07:46:00 2020 +0100

    Bug 17355: DBRev 19.12.00.083
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dc0cb0378cdd8260123bc3d0bbc58fd388b5e650
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri May 1 17:47:07 2020 +0200

    Bug 17355: (QA follow-up) Add description to updatedatabase entry
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 46040fcf862f0c7b6f8bdf9f2b1ecd9f15adf54e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 28 11:53:57 2020 +0200

    Bug 17355: Add the ability to remove authorised value categories
    
    This new patch set is adding a new DB field is_system to distinguish
    internal categories.
    
    The list of internal categories is in the patch "DB changes - set
    is_system for categories" and can be discussed/extended.
    
    Test plan:
    0.
    - Apply patch
    - updatedabase
    1.
    - Create a new AV category
    - Create an authorised value
    - List the AVs for this category
    - Remove all the AVs for this category
    => You see 2 buttons "Add a new authorised value" and "Delete category
    'XXX'"
    - Click the delete button
    => You get a popup
    - Accept
    => The category is deleted
    
    2.
    - List the AV for Asort1 (internal category)
    /cgi-bin/koha/admin/authorised_values.pl?searchfield=Asort1
    - Delete the AVs for this category (if there is any)
    => You do not see the "Delete category" button
    
    3.
    - Create a new AV category 'foo'
    - Create an authorised value
    - Hit /admin/authorised_values.pl?op=delete_category&categor_name=foo
    => You get an error message (expected because the category cannot be
    deleted if it has AV linked)
    => message text:
    => An error occurred when deleting this authorized value category. Check the logs.
    
    4.
    - Hit /admin/authorised_values.pl?op=delete_category&categor_name=Asort1
    => You get an error message (expected because the category Asort1 cannot
    be deleted, it's an internal category.
    => message text:
    => An error occurred when deleting this authorized value category. Check the logs.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 78ce445ae49404c7e7344999945abfc576ad8cac
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 28 11:32:23 2020 +0200

    Bug 17355: DB changes - set is_system for categories
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 02499a45caf241cc55674e89da56e727026391e6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 28 11:23:02 2020 +0200

    Bug 17355: Override delete methods
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 83d78e764e0821037de235b67d269220d7d29f69
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 28 11:05:46 2020 +0200

    Bug 17355: DBIC changes - boolean flag
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77fde261c3e6d199d78c12c631326cd23bea4e6c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 28 11:03:25 2020 +0200

    Bug 17355: DBIC changes
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0ebb62755e56fb4e057ad35db6408e04d237559f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 28 11:01:19 2020 +0200

    Bug 17355: DB changes
    
    This patch adds a new authorised_value_category.is_system boolean/tinyint(1)
    DB field.
    
    Name 'is_system' is coming from existing tables account_credit_types and
    account_debit_types and should not be discussed here (if you disagree
    fill a new bug report and deal with naming issue separately)
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0f3e7691a491d71b4804a527ce4d3a0bd3ed44a5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon May 4 07:40:21 2020 +0100

    Bug 23433: (RM follow-up) One last consistency improvement
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b9cfa36d475e0f897398228a1cfe8b0a71b4d227
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Mar 6 15:06:02 2020 +0000

    Bug 23433: Make consistent use of patron-title.inc in hold confirmation dialogs
    
    Use of patron-title.inc on the checkin page is inconsistent, resulting
    in patron names being displayed differently under different
    circumstances. This patch makes it more consistent.
    
    To test, apply the patch and check in items with the following statuses:
    
     - On hold for a patron at your library
     - On hold for a patron not at your library
     - On hold and already marked 'Waiting'
     - On hold while HoldsAutoFill preference is enabled
     - An item which has been marked with a LOST status in the
       'ClaimReturnedLostValue' system preference.
     - An item which was checked out to a manually-restricted patron and
       checked in with a back-dated checkin date. See test plan on Bug
       24776.
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8e4d0fe9df385be1509d6e636665f55a098af2b2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Dec 11 11:53:51 2019 +0000

    Bug 15751: Add ModDateLastSeen to ProcessOfflineReturn
    
    Test plan:
    1) Before the patch when one checks in something using the KOCT the last seen
    date is not updated.
    2) After the patch when one checks in something using the KOCT the last seen
       date is updated.
    
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 68425749246ef48f198f30f2d3416ae2ae7360e6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 1 17:27:52 2020 +0100

    Bug 23794: (RM follow-up) Make DB update consistent
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d9013a1333ec911f7f88eef6b362f7f4df604839
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 1 16:04:21 2020 +0100

    Bug 24772: Don't revert course item fields when deleting a course item unless it is enabled
    
    Deactivating a from Course Reserves reverts Item's Shelving Location
    correctly, then deleting the same course reverts the Course Reserve
    Items to old shelving location values.
    
    Test Plan:
    1) Add items to a Course - make sure they all have shelving locations
    prior to being added to the course.
    2) When adding items change their shelving location to something else.
       See that Shelving Location has changed; permanent location in
    parentheses
    3) Deactivated course
       See that Shelving Location has changed back to its original location
    4) Deleted course
       See that Shelving Location has changed back to what was picked during
    adding it to the Course.
    5) Apply this patch, restart all the things!
    6) Repeat steps 1-4, note the shelvig location is not lost!
    
    NOTE: Empty commit simply to restore the updated test plan and QA signoff
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Hannah Olsen <holsen@duncanville.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04813346c84157902d5926e3128ec147138cfa49
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 29 10:40:21 2020 -0400

    Bug 24772: Don't revert course item fields when deleting a course item unless it is enabled
    
    Deactivating a from Course Reserves reverts Item's Shelving Location
    correctly, then deleting the same course reverts the Course Reserve
    Items to old shelving location values.
    
    Test Plan:
    1) Add items to a Course - make sure they all have shelving locations
    prior to being added to the course.
    2) When adding items change their shelving location to something else.
       See that Shelving Location has changed; permanent location in
    parentheses
    3) Deactivated course
       See that Shelving Location has changed back to its original location
    4) Deleted course
       See that Shelving Location has changed back to what was picked during
    adding it to the Course.
    5) Apply this patch, restart all the things!
    6) Repeat steps 1-4, note the shelvig location is not lost!
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Hannah Olsen <holsen@duncanville.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 27bc382535dea91f1c5adb353858b2df9ef3f2a3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 20 12:09:27 2020 +0100

    Bug 25127: Use Koha::Number::Price->round for comparison
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 99882e35e1efc5257b084e4d66acd53c7f16856c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 20 09:34:19 2020 +0100

    Bug 25127: Correction to tests
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f195cb45a82d43549647d0efc904fe2107149d2a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Apr 13 12:47:03 2020 +0000

    Bug 25127: Unit tests
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7761db8052329411d6d67ab282f9f8c136feb567
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Apr 11 12:02:03 2020 +0000

    Bug 25119: Fix account type and description for individual writeoffs/payments
    
    When paying or writing off a single line from the list of pending charges,
    the account type displayed the code instead of the description.
    
    And when bug 23483 fixed the display of the description, 2 variables where
    missed. This change is only visible when looking at the page source:
    
    <input type="hidden" name="description" id="description" value="" />
    
    With the patch applied, the value will be filled with the description.
    
    To test:
    - Create one or more manual invoices of different types
    - Try to pay/write off using the buttons within the table
    - Verify the account type shows as code, not description
    - Apply patch
    - Repeat
    - Bonus points: Check the source code for the hidden input with description.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 30906c8b4f5cabf7d2533cbbde1f3368c5e2915c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 1 08:19:27 2020 +0100

    Bug 23794: DBRev 19.12.082
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4689777ba9d50c45345f455a9f9a5d9b489a0fdf
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Dec 11 16:24:50 2019 +0000

    Bug 23794: Convert OpacMainUserBlock system preference to news block
    
    This patch builds on Bug 22318 to move the OpacMainUserBlock system
    preference into the Koha news system, making it possible to have
    language- and library-specific content.
    
    To test you should have some content in the OpacMainUserBlock system
    preference. Apply the patch and run the database update process.
    
     - Go to the OPAC and confirm that the content which was previously in
       the OpacMainUserBlock system preference now displays correctly where
       it was before.
     - In the staff client, go to Tools -> News and verify that the content
       from OpacMainUserBlock is now stored in news items. There should be
       one entry for each of the enabled translations in your system, for
       instance 'opacmainuserblock_en', 'opacmainuserblock_fr-FR',
       'opacmainuserblock_cs-CZ'
     - Go to Administration -> System preferences and confirm that the
       OpacMainUserBlock preference has been removed.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 15595a5f35a204ec26501a9a0fcec2d5a21f0e24
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 27 18:55:59 2020 -0300

    Bug 25297: Consistent return value in K::A::Order->current_item_level_holds
    
    This patch makes the return values for 'current_item_level_holds'
    consistent: they will always be a Koha::Holds iterator.
    
    To test:
    1. Apply the regression tests
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Acquisition/Order.t
    => FAIL: It doesn't work as expected, cannot call ->count on undef, etc
    3. Apply this patch
    4. Repeat 2.
    => SUCCESS: Tests pass!
    5. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e3382d89cd3616f171863e328abd0f83bbcebce8
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 27 18:55:32 2020 -0300

    Bug 25297: Regression tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6ccad9a14a2f72fde26295350aa3353ddcbc6ddd
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Tue Mar 31 17:56:22 2020 -0300

    Bug 24980: (follow-up) return '' when date is null
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 03ea4bd0cc058bd3ca1c2e339371f45afc6c0244
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 25 20:41:45 2020 +0000

    Bug 24980: Only add timezone if passed a date-time
    
    This patch prevents a timezone from being assigned to the js moment if
    the input string is only at the full-date and not date-time resolution
    
    To test:
    1. Do not apply this patch
    2. Set your system time zone to CET
    3. Apply previous patch (It's just for test)
    4. In your browser go to koha main page, open a console and type $date('2020-03-25', {tz:
       'UTC'})
    CHECK => you sould get '03/24/2020' (notice day is 24 instead of 25)
    5. Apply this patch and reload the browser
    6. repeat step 4
    SUCCESS => now you get '03/25/2020' (day is correct)
    7. Sing off
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b2c79f1ea8313f6e0328d3efa2ea190b184c1d1
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Apr 30 11:29:56 2020 +0000

    Bug 24043: (QA follow-up) Fix another TypeError when retrieving status name
    
    Test plan:
    1) Apply first patch, and have the same requests as in previous patch
    test plan
    2) Load ill requests list
    2a) You can see another TypeError in console
    2b) You can notice, the Placed on and Updated on columns have prepended
    another columns with unformatted dates and without header label
    3) Apply this patch
    4) Reload page (be sure it is not loaded from cache - Ctrl+F5)
    5) Errors from 2a and 2b are gone
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2d80fb494c0cb7f142ed1f0e0d29b96ca3dc8640
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Mon Jan 13 10:18:19 2020 +0000

    Bug 24043: Fix retrieval of of status name
    
    This patch modifies the way in which a request's status name is
    retrieved. I think the previous way it was done (which can never have
    worked properly) must have come from a time when we weren't embedding
    the request's backend capabilities in each request. So now we can just use
    the current row.
    
    Test plan:
    
    1. *Before applying the patch*:
    2. Ensure you have at least two requests, from two different backends.
    One of the backends you are using must have a possible status that
    doesn't exist in the other. For example, the BLDSS backend has a status
    of STAT, that doesn't not exist in any other backends.
    3. Ensure that the request who's backend has the unique status is *not*
    the first request in the returned list.
    4. Load the "View ILL requests" page
    5. Observe that the page JS fails with a "Cannot read property 'name' of
    undefined" error
    6. Apply the patch
    7. Reload the page (maybe doing a hard reload to ensure the JS is not
    cached)
    8. TEST: Observe that the error no longer occurs and the requests all
    have their statuses displayed correctly.
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b13df9d3d061f3405d9587cf3d6951f8d8fe12b8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 30 14:15:28 2020 +0200

    Bug 25303: Add a test for ->reset
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c95add2e17be7b48c3218a264b60c8372fe1d9a2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 30 13:24:30 2020 +0200

    Bug 25303: Call ->reset before iterate on the set
    
    In case we already started to iterate.
    
    This fixes a failing tests in t/db_dependent/Koha/Biblios.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 049aee253699102d44fde8cc814a830c146c0b7b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Apr 29 19:12:09 2020 -0300

    Bug 25131: (follow-up) Make sure plugin data is fresh
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 46f5b1ff21b1ee516ced8cd199d2e14ce189b950
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 29 15:47:27 2020 +0200

    Bug 25303: Effectively delete the city to avoid endless loop
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 25c8f087cbca8c3e39e973f3dca10590ea660bd1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 28 14:37:43 2020 +0200

    Bug 25303: Make Koha::Objects->delete loop on the object set
    
    If we call Koha::Libraries->delete but Koha::Library->delete exists
    (ie. Koha::Object->delete is overridden), then we Koha::Objects->delete
    will be called and the overridden will not be executed.
    
    This patch suggests to test if the method is overridden (using
    Class::Inspector->function_exists). If so we loop on the different
    objects of the set in a transaction and call the overridden ->delete method.
    
    Existing tests widely cover this change.
    t/db_dependent/Koha/Objects.t
        subtest 'Return same values as DBIx::Class' => sub {
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e289e400789d2ba6f00004b65564f1201f39f191
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Apr 28 11:31:28 2020 -0300

    Bug 25303: Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4805b9b9dd0a95d79faf450ed1aaaec62d544ec6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Apr 29 09:28:04 2020 -0300

    Bug 25296: Make ->empty work for uninstantiated calls
    
    In OO we would usually instantiate the class and then interact with it
    like in:
        my $rs = Koha::Patrons->new;
        $rs->empty;
    
    Koha's practice is to call things like Koha::Patrons->search without
    instantiating the Koha::Patrons class. To keep consistency, this patch
    instantiates the resultset object on behalf of the caller if required.
    
    To test:
    1. Apply the tests patch
    2. Run:
       $ kshell
      $k prove t/db_dependent/Koha/Objects.t
    => FAIL: Tests fail because it is expected to have the class
    instantiated
    3. Apply this patch
    4. Repeat 2.
    => SUCCESS: Tests pass, instantiation happens implicitly.
    5. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7acc0637093dbb569dc89d1a848114dc010997cd
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Apr 29 09:27:22 2020 -0300

    Bug 25296: Tests for uninstantiated behaviour
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit be67b8c18ed726f0887e36b54a4a13942da0504b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 27 18:33:05 2020 -0300

    Bug 25296: Add a way to force an empty Koha::Objects resultset
    
    This patch adds a new ->empty method to Koha::Objects, that can be used
    to make the underlying DBIC resultset empty. This way, we can have
    consistency in our method's return values without the need to build
    a query that we know in advance that will be empty. No need to hit the
    DB at all.
    
    To test:
    1. Apply this patches
    2. Notice the tests cover what is expected
    3. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Objects.t
    => SUCCESS: Tests pass! Yay!
    4. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fce7094c297acd57f22b99c06d8ae97af04f5596
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 27 18:32:50 2020 -0300

    Bug 25296: Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 78badbdad7be1531c4be2f72c9dd67f2b6236e13
Author: George Veranis <gveranis@dataly.gr>
Date:   Wed Apr 22 13:53:56 2020 +0200

    Bug 19313: Fix typo in in unimarc_field_130.pl value builder
    
    This patch fixes a simple typo
    
    Test plan:
    1) Go to Administration -> MARC bibliographic framework
    2) Select a framework and add plugin unimarc_field_130.pl to 130 field
    3) Open cataloguing screen
    4) Go to 130 field and check if for subfield a shows value for
       'unknown' select it and close the window, check on value on 130$a at
       position 8 to have the value 'd'.
    5) Repeat step 4 and select the value 'mixed emulsion' close the plugin
       window and check at position 8 to have the value 'u'
    6) Apply the patch
    7) Go to field 130, open the plugin window and select value 'unknown'
       close the window and check at position 8 to have the value 'u'
    8) Go to field 130, open the plugin window and select value 'mixed
       emulsion', close the window and check at position 8 to have the
       value 'v'
    
    https://www.ifla.org/files/assets/uca/unimarc_updates/BIBLIOGRAPHIC/b_130_update2017.pdf
    
    Mentored-by: Andreas Roussos
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5cb03c39600b455d4848216da24db501b3e15179
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 29 18:57:47 2020 +0100

    Bug 25271: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9aa4a0d65affb029cb206d756bab592659aefd90
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Apr 24 00:51:35 2020 +0000

    Bug 25271: Add floating toolbar to OPAC cart
    
    This patch adds JavaScript to the OPAC cart view so that the toolbar at
    the top of the display "floats" as you scroll down.
    
    The patch also makes a minor correction to the OPAC SCSS affecting the
    display of the buttons in the cart toolbar.
    
    To test, apply the patch and rebuild the OPAC CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
     - Add some items to a cart in the OPAC.
     - Open the cart and confirm that the toolbar sticks to the top of the
       window as you scroll down.
     - Confirm that it works in the "More details" view.
     - Confirm that other JavaScript-based operations are not affected:
       table sorting and all the various toolbar buttons.
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cb390a35d637d8f74cc7103ceff60f0a1a4283fc
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Apr 23 11:50:34 2020 +0000

    Bug 25166: (follow-up) Update icons generated in JS
    
    This patch adds aria attributes to Font Awesome icons generated by
    JavaScript. The icons won't appear under normal circumstances because
    the code for displaying the modal dialog should replace the icons with a
    text label. The icons are a fallback.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7761051a831ffbe135b994ab3b67273e7bdaa63e
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Apr 15 23:14:15 2020 +0000

    Bug 25166: Add "aria-hidden = true" to Font Awesome icons in the OPAC
    
    Font Awesome's accessibility guidelines
    (https://fontawesome.com/v4.7.0/accessibility/) suggest that we include
    'aria-hidden="true"' in the icon markup. This prevents screen
    readers from trying to read the icon. This patch adds the attribute.
    
    To test apply the patch and browse the OPAC looking for any problems
    with icons: On search results, bibliographic details page, the cart,
    lists, etc.
    
    Check the source and verify that Font Awesome icons have the
    "aria-hidden" attribute.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Attribute present, all looks good. The 'aria-label' attribute is
    not translatable, but it's another problem.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit afec0fb4997524cde1c2ac6ac0c0ab66f9c5d67b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Apr 27 15:21:30 2020 +0000

    Bug 25294: Don't show deletion button if user can't delete suggestions
    
    This patch adds logic to the OPAC suggestions template so that when the
    OPACViewOthersSuggestions system preference is enabled and the logged-in
    user is viewing other users' suggestions, the "Delete selected" button
    is only displayed when there are suggestions the user can delete.
    
    To test you should have suggestions in your system from at least two
    users.
    
    - Set the OPACViewOthersSuggestions preference to "Show"
    - Log in to the OPAC as a user who hasn't submitted any suggestions
    - Go to the suggestions page (with "?suggested_by_anyone=1" appended to
      the URL if necessary, see Bug 22515).
    - In the table of suggetions, there should be no titles with a checkbox
      in the first column.
    - At the bottom of the table there should be no "Delete selected"
      button.
    
    - Log in to the OPAC as a user with suggestions.
    - Return to the suggestions page and view all suggestions.
    - There should be titles with corresponding checkboxes and the "Delete
      selected" button should appear at the bottom.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9ea7fbcb30bf4b4879d4eb68c940316024c08760
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Mar 27 23:35:51 2020 +0000

    Bug 25002: JS Includes should be wrapped with template comments
    
    This patch adds HTML comments to Template::Toolkit include files which
    contain <script> tags so that it is clear where the embedded scripts can
    be found in the code.
    
    To test, apply the patch and view source on the following pages to
    verify the presence of the comments:
    
    Acquisitions home page:
      - acquisitions-toolbar.inc
      - validtor-strings.inc
      - js_includes.inc
      - format-price.inc
    Acquisitions -> Add order from new record,
    Acquisitions -> Receive order:
      - additem.js.inc
    Cataloging -> Add/Edit item:
      - columns_settings.inc
      - strings.inc
      - select2.inc
      - calendar.inc
      - str/cataloging_additem.inc
    Authorities home page:
      - authorities_js.inc
    Bibliographic detail page:
      - catalog-strings.inc
    Cataloging -> Advanced editor:
      - cateditor-ui.inc
      - cateditor-widgets-marc21.inc
    Administration -> Item types:
      - greybox.inc
    ILL requests:
      - ill-list-table-strings.inc
    Web installer
      - installer-intranet-bottom.inc
    Web installer -> Onboarding
      - installer-strings.inc
    Lists -> List contents -> Merge records
      - merge-record-strings.inc
    Patrons -> Patron -> Change password
      - password_check.inc
      - str/members-menu.inc
    Patrons -> Patron -> Print summary
      - slip-print.inc
    Circulation -> Check out
      - timepicker.inc
    Administration -> System preferences:
      - str/tinymce_i18n.inc
      - wysiwyg-systempreferences.inc
    Cataloging -> Z39.50 Search:
      - z3950_search.inc
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f0cbb2063aa17b9832cc89bdd7a532d826dc48c8
Author: Andreas Roussos <a.roussos@dataly.gr>
Date:   Wed Apr 15 09:46:50 2020 +0200

    Bug 25149: Fix Zebra language code for Greek
    
    According to the list of two-letter language codes found in ISO 639-1
    (https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes), the correct
    Zebra language option for Greek should be 'el', not 'gr'.
    
    This patch fixes that.
    
    Test plan:
    0) Apply the patch.
    1) Confirm that 'gr' has been changed to 'el' in all relevant files.
    2) Create a new Koha instance using `koha-create --zebralang el testinst1`.
    3) Edit /etc/koha/koha-sites.conf and set ZEBRA_LANGUAGE to 'el'. Then,
       create another Koha instance with `koha-create testinst2`.
    4) Confirm that both instances created in steps 2) and 3) have picked up
       the Zebra CHR file from the /etc/koha/zebradb/lang_defs/el/ directory.
       This is done by inspecting the value of 'profilePath' in these files:
       /etc/koha/sites/testinst{1,2}/zebra-authorities-dom.cfg
       /etc/koha/sites/testinst{1,2}/zebra-biblios-dom.cfg
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e03e5a2ecee3c7c773e1cce418703a88cc53bb53
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Mar 19 12:04:39 2020 -0300

    Bug 24908: Add text-formatted MARC support in /biblios/{biblio_id}
    
    This patch makes the route support requesting (through the Accept
    header) the MARC record to be output as formatted text as in
    $record->as_formatted.
    
    To test:
    1. Apply the unit tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/biblios.t
    => FAIL: Tests fail
    3. Apply this patch
    4. Repeat 2
    => SUCCESS: Tests pass!
    5. Try the route with your favourite API testing tool (Postman?)
    => SUCCESS: Accept: text/plain returns the expected results
    => SUCCESS: Wrong Accept header returns a list of valid formats, and
    includes 'text/plain'.
    6. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cad8d450356a0865ab52880b2e06e9e59e9f3db8
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Mar 19 12:04:27 2020 -0300

    Bug 24908: Unit tests
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cfb73860dcc3ead3fc955ff55303c935aca1f04a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 29 17:11:35 2020 +0100

    Bug 22630: Schema Update
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 94097761d518c37afab52ab91f8149d3b45e29d8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 29 17:11:13 2020 +0100

    Bug 22630: DBRev 19.12.00.081
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18ea57a92f9fefcb471e094a41b8b51a55a42711
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Apr 27 06:23:59 2020 +0000

    Bug 22630: Fix capitalization
    
    Home Library -> Home library
    Holding Library -> Holding library
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5fed21f065592073e197a062375332903073dba5
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Apr 24 11:01:46 2020 +0200

    Bug 22630: Set is_boolean flag for course_items.homebranch_enabled
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a51afd969819eb5fabc8a44d14992aa660c6664c
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Apr 24 10:58:07 2020 +0200

    Bug 22630: Update Koha::Schema::Result::CourseItem
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 605d6c9b6ef6cb6ee3bd10a5d418ca9871f69e13
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Apr 3 14:49:00 2019 +0200

    Bug 22630: Allow to change homebranch in course reserves
    
    Test plan:
    1. Create a course (disabled)
    2. Add a reserve to this course for an item and set a homebranch
       different from the item's homebranch
    3. Enable the course
    4. Verify that the item's homebranch has changed
    5. Disable the course
    6. Verify that the item's homebranch was reset to its initial value
    7. prove t/db_dependent/CourseReserves/CourseItems.t
    
    Sponsored-by: Université de Lyon 3
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Sonia Bouis <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3ecc5d59fe05c70b34a70afd788dc0a1b612f064
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Apr 25 23:06:05 2020 +0000

    Bug 25110: (QA follow-up) Add aria-hidden="true" to FA icons
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d37a3576f21a5eb1ad09efb1080e66fec452c1f6
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Apr 14 16:31:28 2020 +0000

    Bug 25110: Allow patrons to add star ratings to titles on their summary/checkout page
    
    This patch adds the ability for logged-in patrons to add star ratings to
    titles in their list of current checkouts and on the reading history
    page.
    
    The reading history page previously only showed existing ratings. Now it
    will allow the entry of ratings as well.
    
    The JS and markup for the feature are in separate include files to
    facilitate re-use. It includes markup for non-js display of ratings and
    js-driven ratings controls.
    
    To test, apply the patch and set the OpacStarRatings to all, "results,
    details, and user" pages.
    
     - Log in to the OPAC as a user with checkouts.
     - On the "your summary" page, test the features of setting star
       ratings:
       - Any title with existing ratings should show the rating and the
         average rating number.
       - Set a rating. Confirm that it shows a message with your rating.
       - Click the "cancel rating" link, and confirm that your rating is
         removed.
       - Set a rating and reload the page. Confirm that the rating was
         saved.
       - Test the "cancel rating" link on the title you set before you
         reloaded the page. The rating should be cancelled.
     - Test the same functionality on the "your reading history" page.
     - Test these pages with the  OpacStarRatings preference set to "only
       details" or "no." The pages should function correctly.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ddad175f1131442b60513370b2cf00b0d87f1652
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Apr 24 18:29:21 2020 +0000

    Bug 25281: Use modal confirmation when deleting a list in the OPAC
    
    This patch modifies the process of deleting a list in the OPAC so that
    the deletion confirmation alert is replaced with a Bootstrap modal.
    
    In the process, I moved the repeated deletion form markup into a block
    
    To test, apply the patch and log in to the OPAC as a user who has
    multiple lists, including some which have been shared with other users.
    
    Go to the list of your lists and click the "Delete" link next to any of
    your lists. It should trigger a confirmation modal:
    
     - The modal should show the title of the list you're deleting.
     - If the list has titles on it, it show how many.
     - If the list has been shared with someone it should say so.
    
    Next, view a list which is not empty.
    
     - Test the "Delete list" link in the toolbar.
     - You should see the same information in the confirmation message as in
       the previous step.
    
    Do the same with a list which is empty.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 256fe470fcf92e9732d7b65940756a99febb1693
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Apr 24 14:48:21 2020 +0000

    Bug 25280: Use modal confirmation when removing share from a list in the OPAC
    
    This patch updates the process of removing a share from a list in the
    OPAC so that the confirmation request shown to the user is a Bootstrap
    modal instead of a plain JavaScript confirm dialog.
    
    To test you should have the OpacAllowSharingPrivateLists enabled.
    
     - Log in to the OPAC as a user who has multiple private lists.
     - Share two or more lists with another user in the system.
     - Accept the list shares on behalf of the other user and log in to the
       OPAC as that user.
       - In the list of that user's lists, test the process of removing a
         share:
         - Clicking "Remove share" should trigger a modal which asks if you
           want to remove sharing. It should show the name of the list in
           question.
         - Test the funcionality of both the "No" and "Yes" options.
         - Confirm that the "Remove share" button works correctly for any of
           multiple lists.
       - View the contents of a list which has been shared with this user.
         - Test the "Remove share" button at the top of the list's contents.
           - The same confirmation dialog should be triggered.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 11bf5d7afaa92f129acca2644c6f69e0a7850093
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 15 16:38:16 2020 +0200

    Bug 23137: Move cache flushing to the method
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8cd362a422cba66a1728e7e7d083d0b1d390edb3
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Apr 14 10:14:00 2020 +0000

    Bug 23137: Add documentation
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f6913e74c3b7aa7bfa3d76c4879c331daa1f108c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Mar 19 16:37:24 2020 +0000

    Bug 23137: Add reset and delete to koha-elasticsearch
    
    Same as previous test, but use the script to run the reindex
    reset_all to update the scripts or use
    misc4dev/cp_debian_files.pl
    
    sudo koha-elasticsearch --rebuild -r -v
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9fa6bb64014f6474e86846985609d8850e0839df
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Mar 19 16:30:29 2020 +0000

    Bug 23137: Add reset option to rebuild_elasticsearch.pl
    
    Setup:
    1 - Be using Elasticsearch
    2 - Reload mappings from the db
        Admin->Search configuration
        Reset Mappings
    3 - Reindex ES and confirm searching is working
    
    To test:
    1 - Apply patch
    2 - Alter your mappings file for elastic (just change a description for a field)
    3 - perl misc/search_tools/rebuild_elasticsearch.pl -r -v
        Verbose not necessary, but good for letting you know things are progressing
    4 - Confirm the mapping change shows in the interface
    5 - Confirm reindex worked and searching is working
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit feab2cbeb2179589c74524135bd2ff57b660a8e1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 15 16:15:33 2020 +0200

    Bug 21294: Replace BOOLEAN with TINYINT(1) in our DB structure
    
    To match the coding guideline SQL12.
    We do this for consistency.
    Note that we do not need an update DB as BOOLEAN is an alias for
    TINYINT(1).
    
    The is_boolean flags have been added to the schema.
    
    Test plan:
    1. `dbic` should run correctly
    2. kohastructure.sql should be syntaxicaly correct
    3. `git grep -i boolean installer/data/mysql/kohastructure.sql`
    should not return relevant occurrences.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 76bf4dc056f0e234344045569fee2daa63ac2e45
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 21 16:07:23 2020 +0100

    Bug 22828: Add tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4249b20a394ea8f0addf0bcb162323a8f3cc27d5
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 2 11:27:27 2019 +0000

    Bug 22828: Elasticsearch - display errors encountered during indexing on the command line
    
    To test:
     1 - Use the Koha sample data, or insert a blank 245$b into a record (easiest way is using advanced cataloging editor
     2 - Reindex elasticsearch
     3 - Check the ES count on the about page
     4 - Check the count in the DB (SELECT count(*) FROM biblio)
     5 - They don't match!
     6 - perl misc/search_tools/rebuild_elastic_search.pl -v -v
     7 - No errors indicated
     8 - Apply patch
     9 - perl misc/search_tools/rebuild_elastic_search.pl -v
    10 - You should be notified of an error
    11 - perl misc/search_tools/rebuild_elastic_search.pl -v -v
    12 - You should be notified of the specific biblio with an error and a (somewhat) readable reason
    13 - perl misc/search_tools/rebuild_elastic_search.pl
    14 - No output
    
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5fdd436558c4a9c84e4cfac2a4d6663ee41adc9a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 24 12:45:04 2020 +0200

    Bug 23495: Fix if no sms provider defined
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 985c8f1da93192622b9fdc6c9a1c410391bb983f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Apr 23 18:50:18 2020 +0000

    Bug 23495: Add SMS provider to moremember.tt
    
    To test:
    1 - Enable SMS using the Email driver
    2 - Add an SMS provider under admimistration
    3 - Add an SMS number and provider to a patron
    4 - Note on the patron details you don't see the provider :-(
    5 - Apply patch
    6 - Reload
    7 - Note you do see the provider :-)
    8 - prove t/db_dependent/Koha/Patrons.t
    9 - Sign off!
    
    Signed-off-by: Lisette <lisetteslatah@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b99b6525e876dc6a1e12a117c62ea41d1bf0e43
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Apr 21 21:19:49 2020 +0000

    Bug 25234: Update OPAC search results pagination with aria labels
    
    This patch updates the include file which generates OPAC search results
    pagination so that it has better semantic markup and correct aria
    labels.
    
    To test, apply the patch and do a search in the OPAC which will return
    multiple pages of search results.
    
    View the source to confirm the markup changes:
    
     - <nav> instead of <div> surrounding the list of links, with a
       corresponding aria label
     - Navigation links should have labels indicating which page in the
       results they point to.
     - The current link should have "aria-disabled," and "aria-current" set.
     - Numbered links should have aria labels that indicate their number.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 738f8fe2a53b2679d15d1577d813fb072b162070
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Apr 21 17:30:00 2020 +0000

    Bug 25231: Rename button instead of alert/confirm when replacing record
    
    This test plan applies to the basic editor only
    
    To test:
    1 - Edit an existing record
    2 - Click 'Z3950 Search'
    3 - Note the confirmation box
    4 - Add a new record
    5 - Click 'Z3950 Search'
    6 - Note no popup
    7 - Apply patch
    8 - Edit existing record
    9 - Note button now says 'Replace record via Z3950 search'
    10 - Add a new blank record
    11 - Note the button says 'Z3950 search'
    12 - Confirm editing/saving/replacing works as in the past
    
    Signed-off-by: Phil Ringnalda <phil@chetcolibrary.org>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0bb0b6c7b42428320603896233f45ea5f4af670c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Apr 2 18:40:49 2020 -0300

    Bug 25048: Make successful resource deletion return 204
    
    This patch adapts the spec and the controllers so existing routes return
    204 and an empty response body when a successful deletion happens.
    
    Right now we have a coding guideline but haven't adapted the existing
    routes.
    
    To test:
    1. Apply the regression tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/*.t
    => FAIL: Some tests fail
    3. Apply this patch
    4. Repeat 2.
    => SUCCESS: Tests pass!
    5. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b33d69684f24249fd14c668fd2164cea380697db
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Apr 2 18:38:33 2020 -0300

    Bug 25048: Regression tests
    
    This patch adds regression tests for the response bodies and statuses on
    DELETE actions against existing API routes. This is just enforcing the
    existing (voted) Coding guidelines for the API (tm).
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/*.t
    => FAIL: Several routes have problems
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b6d25fbb674ed58c727987b0a952efaadf27a305
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 15 11:02:39 2020 +0200

    Bug 25032: Add missing utf8 flag in koha-common.postinst
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d36a311fe7dfcd99fd4ac31abca606cc815b280
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Apr 14 17:50:58 2020 -0300

    Bug 25032: Chomp stringified exception
    
    If we catch a Koha::Exception-derived exception, the log is put in a
    single line. If the code 'dies' then a newline character is appended to
    the string. This patch chomps it so it displays in a single line.
    
    To test:
    1. Tweak Koha::REST::V1::Cities::list in the try block so it dies before
       render
    2. Restart plack and try the original test plan
    => FAIL: Notice two lines are logged
    3. Apply this patch
    4. Repeat 2
    => SUCCESS: Only one line in the logs
    5. Verify rendering a Koha::Exception works as well:
       Koha::Exceptions::Exception->throw("Nada!");
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit af60dd912a1a3b732bce359b63cfd88a93217cd5
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Apr 2 14:43:27 2020 -0300

    Bug 25032: Make existing controllers use unhandled_exception
    
    This simple patch removes 'just in case' handling of specific exceptions
    and makes the current routes controllers use the unhandled_exception helper.
    
    Most possible exceptions are already catch by our tools (Koha::Object,
    etc) and the existing code is not looking for known possible exceptions
    but has just been copied and pasted since our beginings.
    
    Anytime a situation in which an unhandled exception is caught, we (the
    devs) should report it and specific exception handling discussed and
    solved. But this has just been useless scaffolding so far.
    
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/*.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat 1.
    => SUCCESS: Tests still pass
    4. Sign off :-D
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 665d651e95145ed38e2a5c796c70bf7b43f48042
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Mar 31 18:43:02 2020 -0300

    Bug 25032: Generic unhandled exception handling on API
    
    This patch adds Koha::Logger as the default logger for the API, and
    introduces a new helper plugin that takes care of handling the unhandled
    exceptions. Basically, with this we would write something like this in
    our controller methods:
    
        try {
            ...
        }
        catch {
            if ( know_exception ) {
                handle_known_exception($_);
            }
    
            $c->unhandled_exception($_);
        }
    
    Without this, we end up adding more and more handling 'just in case'.
    
    To test:
    1. Edit the Koha/REST/V1/Cities.pm 'list' method adding
       die("Nada"); before the render step.
    2. Restart plack and try the endpoint
    => FAIL: A generic error is displayed, and no traces of the original
    problem are found on the logs.
    3. Apply this patches, make sure your instance's log4perl has the
       introduced lines for API with the right path.
    4. Repeat 2
    => SUCCESS: The message is still generic, but you see something is
    logged in /var/log/koha/kohadev/api-error.log
    5. Change die("Nada"); for a real exception like:
    
        use Koha::Exceptions;
        Koha::Exceptions::DuplicateObject->throw("Nada");
    6. Repeat 2.
    => SUCCESS: The message is generic, but a meaningful text is added to
    the logs.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9d879dd1eedd99791e9c7e8acb9f5e6dbea81434
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Mar 31 18:42:25 2020 -0300

    Bug 25032: Add 'api' target to log4perl.conf
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fa1d3a5a4858bd30e3e6b1d1ccd169f731aadb45
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Wed Apr 15 21:42:36 2020 +0000

    Bug 25072: Fix details.tt print CSS
    
    TO TEST:
    -Search for something in the catalog and go to the details page.
    -Try to print either for the Print button in Koha or File->Print...
    -Notice the large amount of whitespace on the left
    -Apply patch
    -Reload detaials page and attempt to print again.
    -No whitespace on left side
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a6fbb69c96f695df162e15486da568d27b70fa0f
Author: David Cook <dcook@prosentient.com.au>
Date:   Tue Apr 28 11:40:23 2020 +1000

    Bug 25299: Show soon to expire patron date
    
    This patch fixes the call to show the patron expiry date
    on the Details page when the patron is soon to expire.
    
    Test plan:
    0. Do not apply patch yet
    1. Create a patron
    2. Set patron's date expiry to 3 days from today
    3. Go to Details tab
    4. Note message "Expiration: Patron's card will expire soon.
    Patron's card expires on Renew or Edit details"
    5. Apply patch
    4. Note message pattern "Expiration: Patron's card will expire soon.
    Patron's card expires on XX/XX/XXXX Renew or Edit details"
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4df3899bc9d09e41138162f7d469221df23dd3bf
Author: David Cook <dcook@prosentient.com.au>
Date:   Tue Apr 28 12:00:15 2020 +1000

    Bug 25300: Fix typo in "Edit details" for expiring/expired patron
    
    This patch removes a typo in the argument to the "op" parameter
    for the "Edit details" link when editing an expiring/expired patron
    on the Details page.
    
    Test plan:
    0. Do not apply patch yet
    1. Create patron
    2. Set expiry date to 3 days from now
    3. Go to Details tab in patron record
    4. Click "Edit details" in "Library use" section
    5. Note the form is blank and has no patron data in it
    6. Apply the patch
    7. Reload the Details page in patron record
    8. Click "Edit details" in "Library use" section
    9. Note the form now contains your patron data and will
    work for editing the details
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a357079d66b1038e536de72b916dcb7bdb5bf1f9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Apr 28 11:25:22 2020 +0000

    Bug 25282: (follow-up) More corrections
    
    This patch adds more corrections missed in the first patch:
    
    - Tools -> Patron clubs (in the Clubs table)
    - Circulation -> Article requests (removed a couple of divs made
      redundant by the re-used BLOCK)
    - Tools -> Plugins home
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 58bec27564ad92a19ce2eed71f49f3630dbd7c98
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Apr 27 21:41:08 2020 +0000

    Bug 25282: Correct Bootstrap dropdown button markup
    
    Incorrect markup surrounding Bootstrap dropdown buttons causes display
    problems with the buttons are in a DataTable. Dropdown wrapper <div>s
    must have a "btn-group" class.
    
    To reproduce the problem, look at the MARC bibliographic frameworks
    page. The "Actions" menu when triggered will not line up with the
    button.
    
    In almost all cases, dropdown buttons inside tables should also have the
    "dropup" class on their wrapper so that the menu appears above the
    button. This prevents the menu from disappearing off the bottom of the
    window when the button is positioned low in the viewport.
    
    To test, apply the patch and test the button menus in tables on the
    following pages:
    
    - Acquisitions -> Invoices
    - Acquisitions -> Add to order -> From external source -> Results
    - Acquisitions -> Suggestions
    - Administration -> Budgets
    - Administration -> Funds
    - Administration -> Authority types
    - Administration -> Authority types -> MARC structure
    - Administration -> MARC bibliographic frameworks
    - Administration -> MARC bibliographic frameworks -> MARC structure
    - Administration -> OAI sets configuration
    - Administration -> Z39.50/SRU servers
    - Authorities -> Authority search results
    - Authorities -> New from Z39.50/SRU -> Search results
    - Cataloging -> Edit items
    - Cataloging -> New from Z39.50/SRU -> Search results
    - Circulation -> Article requests
    - Reports -> Saved reports
    - Tools -> Patron lists
    - Tools -> Rotating collections
    - Serials -> Serials search results
    
    Signed-off-by: Phil Ringnalda <phil@chetcolibrary.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e53d94882bc9abbbfb397b4b980b85aad72e630
Author: Didier Gautheron <didier.gautheron@biblibre.com>
Date:   Mon Apr 27 14:42:49 2020 +0200

    Bug 25291: Escape barcode in ReturnClaims table display
    
    Test Plan:
    
    1) Set ClaimReturnedLostValue
    2) Create a checkout
    3) Claim a return
    4) Change the barcode to something with html inside, </a> will do
    
    Without this patch cgi-bin/koha/members/moremember.pl claim tab barcode link is broken.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b72e7d6669ea67b73686d6a57ae014707ca0ba0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 6 09:00:08 2020 +0000

    Bug 24815: Add additional tests
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c901dfdeaa5350303e8df5bd2bb92d8e925fe20d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 5 16:11:33 2020 +0000

    Bug 24815: Correct return values of Koha::Cash::Register relations
    
    This patch correct all cases of return undef to instead return an empty
    resultset.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 971acda4808cda708ec320f997c7f8702e7e2f62
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Apr 27 11:37:13 2020 +0000

    Bug 25229: (follow-up) Move QueryBuilder test to Elasticsearch dir
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7fa460486ddd887d1bebe00844d6a8e7eba85cce
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Apr 21 13:47:59 2020 +0000

    Bug 25229: Return authid of record rather than 001
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1cd34826643ab0443d4bebef4e106e7f03cd6587
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Apr 27 11:28:51 2020 +0000

    Bug 25229: Unit test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2d53878f6020bff540fc9249b793e5effb3f0dd
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Apr 27 07:07:12 2020 -0400

    Bug 25227: Display correct message if item is withdrawn and withdrawn returns are allowed
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 21ed06369c83ceaf4a4ed67cd4df424acc8efb85
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Apr 21 07:11:08 2020 -0400

    Bug 25227: Display correct message if item is lost and lost returns are allowed
    
    Even if a library allows returns of lost items, the SIP server returns the error message "Item lost, return not allowed" if the checkin was not ok for any reason other than it being withdrawn ( and withdrawn items not being returnable ).
    
    The most clear example of this is that when a lost item is not checked out to a patron and is returned. SIP returns that message even though lost items *can* be returned. The actual problem being that the item was not checked out.
    
    Test Plan:
    1) Ensure you can return lost items
    2) Mark an item as lost
    3) Check it in via SIP
    4) Note the message you get back is "Item lost, return not allowed"
    5) Apply this patch
    6) Restart your SIP server
    7) Repeat steps 2 and 3
    8) Note you no longer get the incorrect message!
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 02e8368fad7c566ec8956d5dc9ca5c851931fe12
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Apr 27 08:04:07 2020 -0400

    Bug 25227: Add unit tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f00a2570eb93f012b13d8cec04375164e6103a84
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 28 06:55:56 2020 +0100

    Bug 24897: (RM follow-up) Drop tests for es-ES notices
    
    This follow-up removes the tests for the presence and validity of the
    spanish translated notices.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f597c66934f5d97fca47f3ebaaddab8a532ec899
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 27 14:22:21 2020 +0100

    Bug 24298: (RM follow-up) Re-introduce TransferTrigger drop through
    
    A rebase lost the fall through for TransferTrigger as a message. This
    patch simply adds back in the dropped elsif statement.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 733874e24eb20b10e8387d2a9df565fad284b510
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 27 13:42:11 2020 +0100

    Bug 25045: (RM follow-up) Correction to updatedatebase.pl
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1a40ed3887f19fa40ac8a1d517fdc48434b70a2b
Author: Phil Ringnalda <phil@chetcolibrary.org>
Date:   Tue Apr 21 21:34:33 2020 -0700

    Bug 25235: Rename the button instead of alerting when replacing an existing record
    
    Test plan:
    
    Pre-patch
    1 - Go to the main Authorities page, search for any authority, click
        the Actions menubutton and choose Edit
    2 - Note the button saying Z39.50 search
    3 - Note the modal alert forcing you to click it
    4 - Cancel and cancel again, and in the New authority menubutton choose
        Default
    5 - Click the button saying Z39.50 search again, note that it warns you
        about replacing your totally blank record
    
    Apply this patch
    6 - Edit an existing authority, note the button says "Replace record via
        Z39.50/SRU search"
    2 - Click the button, verify it still opens the search window with the
        main entry of the record filled in without an alert
    3 - Create a new authority, note the button says "Z39.50/SRU search"
    4 - Click the button, verify it still opens the search window but
        without an alert
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 19a241c131f03a2640044ac3280759b2e6fd35bc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 27 11:51:08 2020 +0100

    Bug 25045: (RM follow-up) Add the RESTPublicAnonymousRequests syspref
    
    The atomic update alos included a quoting mistake
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d77db27691f22f697c665821f5fb3ddaa69be14
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 27 12:47:08 2020 +0200

    Bug 25045: (follow-up) Add the RESTPublicAnonymousRequests syspref
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a852fae89a8d358f314d93dc7554dea72492e285
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue Apr 14 10:45:01 2020 +0000

    Bug 17232: Make sure all fields are copies when creating a new framework from another
    
    Some digging revealed that when you create a new framework
    and use an old framework as the base, some information would
    not be copied to the new framework as they were missing from
    the SQL command used here.
    
    - Tag: Important
    - Subfield:
      - Important
      - Default value
      - Max length
      - Is a URL
      - Link
    
    To test:
    - Pick one of the existing frameworks and change the
      fields listed above. Take note of what you changed.
    - Create a new framework
    - Go to "Marc structure" of the new framework
    - You are offered the option to copy an existing framework
    - Use your prepared framework
    - Verify the fields weren't copied - your config was lost
    - Apply patch
    - Create another new framework
    - Repeat the duplication and tests
    - Verify that now all fields have been copied correctly
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 79f51b92c51cde6e815461e7a90d1d33fda49bda
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 22 15:54:29 2020 +0200

    Bug 25249: (bug 19791 follow-up) Display Circulation log when showing patron's log
    
    When viewing a patron if you click the 'Modification log' tab you are presetned with both their circulation and members logs:
    https://staff.arcadiapl.bywatersolutions.com/cgi-bin/koha/tools/viewlog.pl?do_it=1&modules=MEMBERS&modules=CIRCULATION&object=152309&src=circ
    
    However, in bug 19791 the modules were locked to 'MEMBERS' if the src=circ
    
    We need to add CIRCULATION in as well
    
    Test plan:
    For master follow the test plan on bug 25250.
    
    Bug 24982 is not in stable branch, so test plan for stable branches:
    1. Modify a patron, add them a fine, and do a checkout
    2. Click the "Modification logs"
    => You see the Patrons and Circulation logs
    3. Click submit
    => You see all patron logs only
    4. Apply this patch
    5. Click the "Modification logs"
    => You see the Patrons and Circulation logs
    6. Click submit
    => You see the Patrons and Circulation logs
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7b23e92d5f77d930f504739ca61789f44e416313
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Apr 22 14:40:17 2020 +0000

    Bug 25250: (bug 24982 follow-up) Don't disable checkboxes if modification log
    
    If we are coming from the "Modification logs" of the patron module we
    should not disable the checkboxes (that are not visible).
    Otherwise the logs are not longer filtered and all are visible.
    
    Test plan:
    0. Don't apply this patch
    1. Modify a patron, add them a fine, and do a checkout
    2. Click the "Modification logs"
    => You see the Patrons and Circulation logs
    3. Click submit
    => You see all the logs (KO)
    4. Apply this patch
    5. Click the "Modification logs"
    => You see the Patrons and Circulation logs
    6. Click submit
    => You see the Patrons only (KO)
    7. Apply the patch from bug 25249
    8. Click the "Modification logs"
    => You see the Patrons and Circulation logs
    9. Click submit
    => You see the Patrons and Circulation logs (OK!)
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40cc8075588523913ca1f97b87831a9e68b53cb3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 27 11:39:19 2020 +0100

    Bug 23081: DBIC Update
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 93c0f4420d22a510d56dd04bf11fad6b413e657c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 27 11:34:29 2020 +0100

    Bug 23081: DBRev 19.12.00.080
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 652f16d19419d56d9f5258c77b7494889f113d81
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 27 11:55:15 2020 +0200

    Bug 23081: Adjust tests
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit abc00eb1cfd1ee018396d6df04e6f28d7b363dbb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 27 11:51:35 2020 +0200

    Bug 23081: Revert "Bug 24443: Consider NULL as 0 for issues in items search"
    
    This reverts commit 80f1374f262544a750b5d81a7d9605c8708c53b1.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e116f744a02b1f2cdf040c7bdf25498641bbc674
Author: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
Date:   Sun Apr 26 23:53:26 2020 +0000

    Bug 23081: atomicupdate for change to existing installs
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ec1bfd2b749b8ed9bd8688abdd47b9736ba872d0
Author: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
Date:   Sun Apr 26 23:51:25 2020 +0000

    Bug 23081: set default to 0 for items.issues and deleteditems.issues
    
    To test:
    - save and run this sql query in reports: select sum(if(issues is null,1,0)),sum(if(issues=0,1,0)) from items
    - you should see a lot of nulls and no zeros
    - apply patch
    - updatedatabase
    - re-run your query and see that your nulls have changed to zeros
    - create a new item
    - rerun your query and see your new item is counted in the zeros, not the nulls
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b50641b4791f68a119ce5060c852e02cdb523956
Author: Joe Sikowitz <joe@flo.org>
Date:   Sat Apr 18 16:06:05 2020 -0400

    Bug 24750: Instructor Search Results
    
    Adds regex to the split() of the passed parameters to improve searching.
    
    Test plan
    1. Go to Course Reserves module.
    2. Press New course button.
    3. Make active the instructor search box.
    4. Start typing the last name of a patron that exists in your database.
    5. At the end of the last name type ", " and try to add a first name.
    6. The search should fail.
    7. Apply the patch.
    8. Follow steps 1-5 again.
    9. You should now be able to search using the following methods
    9a. surname, firstname
    9b. firstname surname
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 866c6850e07411b37aae15f00444802ef1919c1b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 21 14:30:19 2020 +0200

    Bug 5161: Keep patron's attributes on warning/duplicate
    
    When a patron is added or modified and a warning appears (duplicate,
    inconsistent data, etc.) the form lost the patron's attributes.
    
    Test plan:
    Create some attribute types for patrons
    Create a new patron, use an userid that already exists and fill the attributes
    => You get a warning and the attributes are kept
    Modify the userid and save again
    Edit the same patron
    Modify the attributes, as well as the userid (to get the duplicate warning)
    => You get a warning and the attributes are kept with the modified
    values
    Modify the userid and save again
    => The new values are saved
    Edit the attributes from the detail page (so not with the full edit form)
    Modify them and save
    => The new values are saved
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 41873b21c894a4be1459b5ba1d93a28fa3b45ea4
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Tue Apr 21 21:33:03 2020 +0000

    Bug 25233: Staff XSLT material type label "Book" should be "Text"
    
    This patch makes the staff client XSLT stylesheets consistent with the
    ones for the OPAC, it also makes consitent the use of 'Text' when the leader6 = 't'
    
    TO TEST:
    1. Have a record with leader06 = 'a' and leader07 = 'c' 'd' or 'm'.
    2. Check the staff client results and details page. See that the
       material type label says "Book"
    3. Check the OPAC client results and details page. See that the
       materila type label says "Text"
    4. Apply patch.
    5. See that both staff client and OPAC results/details all now say
       "Text"
    6. Set the leader6 = 't' and make sure that is says 'Text' on both the
       staff client and OPAC
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 917a0761ead775e4d35cc3be499e76cf7d6c8da7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 27 11:26:22 2020 +0100

    Bug 25276: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 67a73e5481168bb49388822c9267d4bbe4605327
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Apr 24 14:24:07 2020 +0000

    Bug 25276: Correct hover style of list share button in the OPAC
    
    This patch adds missing "btn" classes to the OPAC share button so that
    its style is consistent with similar controls.
    
    The patch also makes some general changes to the OPAC CSS to make sure
    link color and hover color are applied with enough specificity. This
    corrects the hover color of the share button but should not change any
    other existing style.
    
    To test you should have the OpacAllowSharingPrivateLists preference
    enabled.
     - Rebuild the OPAC CSS
       (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
     - Log in to the OPAC as a user with one or more private lists.
     - Go to Lists -> Your lists.
     - In the list of lists there should be a "Share" link for each list.
       Hovering your mouse pointer over the link should change the style in
       the same way the "Edit" link does.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 43a83aab9f7f9033e4659e89235a9a5ea8a07fb4
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Apr 20 11:38:41 2020 +0000

    Bug 25211: Add missing share icon to OPAC lists page
    
    This patch adds a Font Awesome icon to the "Share" links on the list of
    lists in the OPAC.
    
    To test, apply the patch and log in to the OPAC as a user who has one
    or more private lists.
    
      - Go to Lists -> Your lists
      - In the table of your lists, each list should have a "Share" link
        with an icon.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ec743f54256d219a9d26e6020a28126ef4be61c4
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Tue Apr 21 20:11:17 2020 +0000

    Bug 24957: OpenLibrarySearch shouldnt display if nothing is returned
    
    TO TEST:
    1. Turn on OpenLibrarySearch
    2. Do an OPAC search that returns results that have results with Open Library results and some that do not.
    3. Notice results that return nothing simpliy say "Open Library:" with nothing afterwards.
    4. Some results return a png from OpenLibrary or "Not found"
    5. Apply patch and look at records again.
    6. The results that return nothing for OpenLibrary API should now to hidden.
    
    Signed-off-by: Heather Hernandez <heather_hernandez@nps.gov>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6c1a4312c4c6416eeed9220982db69c2ae5cd8f3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 27 11:17:33 2020 +0100

    Bug 25045: DBRev 19.12.00.079
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3d3a07c5ee0098c3fe504009144b5c0545c0e75f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 13 11:47:30 2020 -0300

    Bug 25045: (follow-up) Add a note to OpacPublic
    
    This patch tweaks the OpacPublic system preference description so users
    don't expect, incorrectly, this syspref to disable the public API
    anonymous access.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ec99043a2ede2f994dae72ee2f68884174f94d4c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 13 11:40:48 2020 -0300

    Bug 25045: Allow restricting anonymous requests on the public API
    
    This patch introduces a check on the authenticate_api_request method for
    the RESTPublicAnonymousRequests system preference. If disabled,
    anonymous  requests get rejected.
    
    The idea is to replicate the homologous OpacPublic system preference
    behaviour.
    
    To test:
    1. Apply the Unit tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/auth_authenticate_api_request.t
    => FAIL: Tests fail, 200 is answered instead of 401 on the route.
    3. Apply this patch
    4. Repeat 2.
    => SUCCESS: Tests pass!
    5. Sign off :-D
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 78cb447c7cd13bd37a48f7b3e2d2aa47b5d7b4d9
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 13 11:40:44 2020 -0300

    Bug 25045: Unit tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5394e8443fcba3e307c4add97bef1216fcaa2b11
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 13 11:36:12 2020 -0300

    Bug 25045: Add the RESTPublicAnonymousRequests syspref
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b97158dd1342ea060a29297df3d691f05065c227
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Mar 19 17:04:31 2020 -0300

    Bug 24909: Add unprivileged route to get a bibliographic record
    
    This patch adds a route to get bibliographic records without privileged
    access. This needs to match the OPAC expected behaviour.
    
    Some things were considered on the implementation:
    - The ViewPolicy filter that hides/shows things based on the frameworks
      needded to be used, as in the OPAC.
    - OpacHiddenItems and OpacHiddenItemsExceptions need to be considered
      for hiding records the same way the OPAC is expected to.
    - Avoid using OpacHiddenItemsExceptions, but rely on the patron category
      instead (use Koha::Patron::Category->override_hidden_items abstraction
      is used instead so it should keep working once 22547 is moved
      forward).
    - Tests should cover all the use cases:
      * logged in user
      * anonymous user
      * logged in with category that overrides
      * logged in with category that doesn't override
    
    This is all implemented on the tests.
    
    To test:
    1. Apply the tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/biblios.t
    => FAIL: Route not implemented
    3. Apply the rest of the patches
    4. Repeat 2
    => SUCCESS: Tests pass!
    5. Try it with your favourite API tool (Postman?)
    6. Sign off :-D
    
    Note: please notice there isn't a default fallback behaviour for when
    you don't specify the Accept header, so testing this on a regular
    browser will just print the accepted mime types instead of the record
    itself.
    
    To test this with a tool (like Postman) you should enable
    RESTBasicAuthe and make the tool use Basic authentication with valid
    credentials. And you need to specify any of the following strings on the
    Accept header:
    - application/marcxml+xml
    - application/marc-in-json
    - application/marc
    - text/plain
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 572f486697c18337ea6bb804a0b624e9c8912744
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Mar 19 17:03:53 2020 -0300

    Bug 24909: Route spec
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c66f9f320eab62cb7a0440fc6fc02142558eb1d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Mar 19 17:03:23 2020 -0300

    Bug 24909: Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6f3c1d5af804e16243433b11751f9ad3677aab37
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Apr 12 03:19:03 2020 +0000

    Bug 21927: Acq - Add blank values in pull downs of mandatory item subfields
    
    This is the same fix as on bug 14662, which fixed the behaviour in
    cataloguing, but for the item form in acquisitions.
    
    The code assumes that if a subfield is marked as mandatory, there
    should be no empty entry in the pull downs.
    
    This assumption is not correct, as it leads to the first entry of the
    pull down being preselected if there is no default set. As the field
    can never be 'unset', there will never be a 'required' warning.
    Furthermore, it might be counterproductive to use mandatory fields,
    as it might be easily forgotten to change the preselected value and
    those mistakes will be hard to find.
    
    Correct behaviour would be to preselect the empty value when there is
    no default. This means on saving the item an error message is triggered
    and the cataloger is forced to set the value.
    
    To test:
    - This is best tested with an ACQ framework, but default can be used
      when no ACQ framework was created.
    - In your MARC bibliographic framework:
      - In 952 make itemtype, classification source and some other pull downs
        like location or collection mandatory and set them to visibel if needed
    - Create a new basket with 'items created while ordering'
    - Add a new order, an existing record with 942$c set will work best
    - Add items for your order line
      - Verify that the first value of each pull down is preselected,
        there is no way to trigger the 'required' error
    - Apply patch
      - Add a new order line
        - Verify that classification source is preselected according to the
          DefaultClassificationSource system preference (try unsetting it later)
        - Verify all mandatory fields can be set to empty
        - Verify that you can't save before correctly setting them
      - Change your frameworks and set a default for itemtype (Ex: BK) and
        another mandatory and non-mandatory field of your choice
      - Add a new order line and item and verify the defaults are selected
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c39093b3d397790003f82a56ed2a506c3556cc9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Apr 24 11:49:21 2020 +0000

    Bug 25274: Don't initialize DataTable if table isn't present
    
    This patch modifies the OPAC basket JavaScript so that a check is added
    for the existence of the "itemst" table. This avoids an error if the
    "More details" view is selected and hte "itemst" table isn't present.
    
    To reproduce the error, add some items to the OPAC cart and open the
    cart window. Open the JavaScript console in your browser and click the
    "More details" link. You'll see an error.
    
    To test, apply the patch and perform the same test as above. The error
    should not be present. Test that table sorting in the "brief" view words
    correctly.
    
    Signed-off-by: David Roberts <david@koha-ptfs.co.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 69b1a62aa46ce9c378eef678357318714ba8744c
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Thu Mar 19 07:12:51 2020 -0300

    Bug 24897: Remove es-ES installer data
    
    With installer data in YAML format and it's translations,
    there are no need for localized installer files.
    
    This patch removes es-ES installer files.
    
    To test on top of Bug 24871
    1) Apply the patch
    2) Translate to spanish
       cd misc/translator
       ./translate update es-ES
       -/translate install es-ES
    3) Do a clean install using es-ES,
       check no problems during install
    4) Verify MARC21 frameworks, they must
       be translated
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b5719a0e76cd0cb69ada67ff8a147a2a703c8a7
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Sun Mar 15 18:15:32 2020 -0300

    Bug 24871: Add new *-installer*.po translation files
    
    This patch simply adds new po files for each supported
    language.
    
    The are not created on update, so the need to add this files.
    
    To test:
    1) Update your preferred language
    2) Check missing *installer*po files
    3) Create new translation files:
       cd /misc/translation
       ./translate create xx-YY
    
       check *installer*po files
    4) Apply patch
    5) Repeat 1, verify installer files are updated
       see last modification time
    
    Pre-filled translations for some languages
    (https://translate.koha-community.org/projects/marc21/)
    
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2dac989f1d92a4b5429d1210845cae9cf54e5377
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Dec 4 21:51:16 2019 -0300

    Bug 25257: Preserve prolog on translated XML files
    
    This patch fix the missing xml prolog in translated
    files, XML or TT.
    
    Is fixed teaching C4::TTParse not to ignore <?..?> constructs,
    then teaching xgettext.pl to ignore those strings. Net result is
    that they are copied in the translated file.
    
    To test:
    1) Update & install your preferred language,
    (cd misc/translator/; perl translate update xx-YY; perl translate install xx-YY )
    
    2) Compare the first lines (head -2) of:
    koha-tmpl/opac-tmpl/bootstrap/en/xslt/compact.xsl
    koha-tmpl/opac-tmpl/bootstrap/en/modules/opac-opensearch.tt
    koha-tmpl/intranet-tmpl/prog/en/xslt/plainMARC.xsl
    and
    koha-tmpl/opac-tmpl/bootstrap/xx-YY/xslt/compact.xsl
    koha-tmpl/opac-tmpl/bootstrap/xx-YY/modules/opac-opensearch.tt
    koha-tmpl/intranet-tmpl/prog/xx-YY/xslt/plainMARC.xsl
    
    Check the missing prolog
    
    3) Install this patch, repeat 1 and 2, now the prolog is present
    on translated files.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 68df51562aaba611511702affbe136a69c3934c4
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Apr 14 11:52:17 2020 +0000

    Bug 25118: Return claims has some translation issues
    
    This patch adds the right function calls to checkouts.js so that English
    strings can be picked up by the translator. The resolution message has
    been reformatted so that it can be clear without including "on" and
    "by" in the middle of the string.
    
    To test you should have a patron with at least one return claim. Open
    the checkout page for that patron and open the "Claims" tab. Test the
    process of editing, deleting, and resolving claims.
    
    TESTING TRANSLATABILITY
    
    - Update a translation:
    
    > cd misc/translator
    > perl translate update fr-FR
    
    - Open the corresponding .po file for the staff
      client: misc/translator/po/fr-FR-messages-js.po
    - Locate strings pulled from checkouts.js for translation, e.g.:
    
      #: koha-tmpl/intranet-tmpl/prog/js/checkouts.js:920
      msgid "Double click to edit"
      msgstr ""
    
    - Edit the "msgstr" string however you want (it's just for testing).
    - Install the updated translation:
    
    > perl translate install fr-FR
    
    Switch to the udpated translation and test the functionality under the
    "Claims" tab again to confirm that your translated strings appear.
    
    Note that "untranslatable string" failures reported by the QA script are
    false positives.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5e93e9df4bdd648d2f815c1a753a835311f8a64c
Author: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
Date:   Tue Apr 21 17:41:29 2020 +0000

    Bug 25224: Show large print format in search results XSLT
    
    To test:
    1: find a bib with 008 type Book
    (Leader position 6 = 'a' and leader position 7 = 'm' -- use bib number 1 in master data)
    2: set 008 position 23 to 'd' for large print
    3: check your book record in opac and intranet search results, note that your change is not reflected in the "format" note in line with material type
    4: find a bib with 008 type Continuing Resource
    (Leader position 6 = 'a' and leader position 7 = 's' -- use bib number 44 in master data)
    5: set 008 position 23 to 'd' for large print
    6: check your continuing resource record in opac and intranet search results, note that your change is not reflected in the "format" note in line with material type
    7: apply patch, restart_all
    8: reload search results from steps 3 and 6, confirm they now say "format: large print"
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c748a445c0b237932c0a220a9c7f70fa17151962
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Apr 22 13:30:06 2020 +0000

    Bug 25248: (bug 23463 follow-up) Item is returned if deletion successful, not 1
    
    To test:
    1 - Have a record with some items
    2 - Click 'Delete all' under 'Edit'
    3 - Confirm deletion
    4 - Note you are redirected to additem.pl
    5 - Add an item
    6 - Apply patch
    7 - Delete all items again
    8 - Note you are redirected to detail.pl
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ca5b112376f8b74d573f8b8d6c1512a59040ba60
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 14 13:22:44 2020 +0200

    Bug 25142: Fix wrong grep logical test
    
    To test and understand what's going on, you can try that bit of code:
    my @a = qw( a b c a);
    my @b = qw( b c d );
    my @c;
    @c = grep { 'a' eq $_ } @a ? 'ok' : ();
    say @c;
    @c = ( grep { 'a' eq $_ } @a ) ? 'ok' : ();
    say @c;
    @c = grep { 'a' eq $_ } @a ? ('ok') : (undef);
    say @c;
    
    The problem here:
    Have patrons in 3 branches CPL, MPL, SPL
    Have a non superlibrarian with edit_borrowers permission but
    without view_borrower_infos_from_any_libraries, from CPL
    Create a library group with CPL, MPL
    Use that non superlibrarian to search for patrons
    You can search for patrons fro CPL and MPL
    BUT, edit the value for CPL, use SPL (edit the DOM)
    Search and... oops
    
    Apply this patch, try again
    
    Also use a superlibrarian patron (and/or with view_borrower_infos_from_any_libraries)
    and confirm that they can see all patrons
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4452036d1c100910c17a7ac7ac54cb83c0120620
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Mar 27 18:16:58 2020 -0300

    Bug 25009: Avoid leakages in opac-showmarc.pl
    
    This patch cleans opac-showmarc.pl so it doesn't allow retrieving
    records from import batches without requiring any permissions in the
    OPAC.
    
    it does so by just removing the code portion that does that.
    
    It also cleans the record fetch operation and how the record processor
    is initialized to it actually works :-D
    
    To test:
    1. Perform a successful Z39.50 search in cataloguing (this fetches 20
       records usually)
    2. Query your DB for a valid import_record_id:
      $ koha-mysql kohadev
      > SELECT * FROM import_records LIMIT 1;
    3. Notice some of the MARCXML details (title, author, etc), and the
       import_record_id
    4. Point your browser to the opac-showmarc.pl URL like this:
       http://kohadev.mydnsname.org:8080/cgi-bin/koha/opac-showmarc.pl?importid=20
    => FAIL: You get the record! (Bonus: no field/subfield takes place)
    5. Hide some obvious subfield on the framework for a known (to you)
       biblionumber
    6. Point your browser to:
       http://kohadev.mydnsname.org:8080/cgi-bin/koha/opac-showmarc.pl?id=<biblionumber_here>
    => FAIL: No filtering takes place
    7. Apply this patch
    8. Repeat 4
    => SUCCESS: You get an error because you did a bad request (no id param)
    9. Repeat 6
    => SUCCESS: Subfield filtering actually works!
    10. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95dc574501a331e603cbe385fa4e5f70dc1c5ef2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jul 14 13:51:21 2016 +0200

    Bug 16922: Add RewriteRule to apache-shared-intranet for dev package installs
    
    As a simple alternative to the solution in bug 9949 or just as an
    additional measure, this patch adds a rewrite rule for intranet
    in order to intercept potential misuse of perl scripts that could be
    reached on a dev package install via the cgi-bin/koha scriptalias.
    
    It simply rewrites them to the nonexistent "notfound", resulting in a
    regular 404 error.
    
    The rewrite rule does not harm regular installs and is just a little extra
    step in securing a dev install. You should have more security measures in
    place to secure your staff client.
    
    QA Note: Although a rewrite rule may not be our first choice, this one
    rule is more elegant and easier to maintain than e.g. a whole bunch of
    aliases.
    
    Note: This patch should have a regular and a dev install signoff.
    
    Test plan:
    [1] Make sure that this rewrite rule is inserted in your actual apache
        config via /etc/koha/apache-shared-intranet.conf. Restart Apache.
    [2] For regular package installs:
        Try one of the URLs in step 3.
        Verify that your staff client still operates as usual. Test a few
        URLs inside some modules.
    [3] For dev installs:
        Try some URLs like below.
        Expect 404 errors only, not 500s. If you do not see a 404, go back!
        /misc/stage_file.pl
        /t/db_dependent/default_search_class.pl
        /installer/data/mysql/updatedatabase.pl
        /Makefile.PL
    [4] Do you see an additional directory to add to the regex? Please report.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b50d891c099d0f21f2528c5a6d5bbb586cf1612e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 22 16:40:08 2020 +0200

    Bug 25172: Fix Auth_with_ldap.t
    
      #   Failed test 'checkpw_ldap tests'
      #   at t/db_dependent/Auth_with_ldap.t line 324.
      {UNKNOWN}: Configuration not defined at /usr/share/perl5/Log/Log4perl/Config.pm line 579. at /kohadevbox/koha/Koha/Patron.pm line 395
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 37e6fe6ae59469aeb2078c52b4419c1fe5f3dea8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Apr 20 13:16:11 2020 -0400

    Bug 25172: Add missing filter
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7283a3a3e7777b1d34a7bf8c3974a4efc6fbe3d7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 16 17:16:59 2020 +0200

    Bug 25172: Identify and display possible problems on the about page
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 16a030ebf64ce2a43af097f235cee1bc78a760e3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 16 16:50:50 2020 +0200

    Bug 25172: Adjust tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fb9268417bfd9e39f50053e948291c77530609a1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 16 16:12:32 2020 +0200

    Bug 25172: Remove _recheck_logfile
    
    I don't understand how that could be useful. We do not want to test if
    the logfile is writable every time we log something!
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bfa921665abfc4fcf8c5c3bc5f115769bf2c9f55
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 16 16:11:02 2020 +0200

    Bug 25172: Make Koha::Logger explode if init went wrong
    
    We do not want to fail silently for the logger.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 10b60d577053843c2b8935be696ecbf762d7f584
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Apr 11 14:43:41 2020 +0000

    Bug 5614: Organize 'patron' system preferences
    
    Until now, there was only "General" and "Privacy". This patch
    breaks the "General" prefs up into multiple sections.
    
    To test:
    - Go to Administration > Patrons
    - Verify the current state of things
    - Apply patch
    - Reload patch
    - Verify headings make sense and groups make sense as well
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a40ef6ece7211ef139e9440a3022ebda7492ff47
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Oct 2 14:53:42 2019 +0000

    Bug 20816: Make SIP tests pass under ES
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 41b5db64b352a9cf33595171ca9c2bee70ca4f1a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jun 19 17:59:14 2019 +0000

    Bug 20816: Add ability to define custom templated fields in SIP patron responses
    
    To test:
     1 - You will need to enable SIP on your testing instance
        cp etc/SIPconfig.xml /etc/koha/sites/kohadev/
        sudo koha-start-sip
        add a user listed in the SIPconfig to your system and give them permissions (superlibrarian works)
        on koha-testing-docker you should be able to start sip with user koha/koha without any adjustments
     2 - If you copied the above file you should be set to get custom field DE with dateexpiry
         Otherwise edit the sip login for the user to have a custom section like:
                      <login id="koha"   password="koha"  delimiter="|" error-detect="enabled" institution="kohalibrary" encoding="utf8" >
                              <custom_patron_field field="DE" template="[% patron.dateexpiry %]" />
                      </login>
     3 - send a status test using the sip cli tester:
         perl misc/sip_cli_emulator.pl -a 127.0.0.1 -p 6001 -su koha -sp koha -l kohalibrary --patron 23529001000463 -m patron_status_request
     4 - send an information test using the sip cli tester:
         perl misc/sip_cli_emulator.pl -a 127.0.0.1 -p 6001 -su koha -sp koha -l kohalibrary --patron 23529001000463 -m patron_information
     5 - confirm you receive the DE field with a dateexpiry
     6 - Add your own custom fields and confirm it works with several
             <custom_patron_field field="EW" template="Phone: [% patron.phone %] Email: [% patron.email %]" />
     7 - prove -v t/db_dependent/SIP/Patron.t
     8 - prove -v t/db_dependent/SIP/
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5f586e3d963be70dc1d3b5f55494f40227e43adf
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Mar 17 18:44:23 2020 +0000

    Bug 16962: Remove the use of "onclick" from serial collection template
    
    This patch removes the use of event attributes like "onclick" from the
    serial collection template. Events are now defined in JavaScript.
    
    To test, apply the patch and go to Serials
    
    - Locate or create a subscription for which an item record is NOT
      created when receiving.
      - On the serial collection page for this subscription, test that the
        "Multi receiving" button works correctly.
      - For any subscription, test that the "Generate next" button works
        correctly.
      - In each tab, test that the "select all" and "clear all" links work
        correctly and affect only that tab.
      - On a subscription which has expired, test that the "Renew" button
        works correctly.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 74b8c05cfb72146c738d41e88da13346c47d4d22
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 20 11:13:40 2020 +0200

    Bug 25186: Fix accordion sections height in columns configuration page
    
    The height for each section was the height of the highest section.
    Now the height is set to the length of the section.
    
    Test plan:
    Go to Administration > Column configuration
    Open the sections and confirm that the height fits its content.
    
    QA: note that I guess "autoHeight: false" was meant to achieve that,
    but it does not exist in the API of the plugin.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 82090e2673f44aea18a205ee3cf9deb04bd91c80
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 22 12:24:27 2020 +0100

    Bug 24183: (RM follow-up) Remove re-introduced UseKohaPlugins
    
    We removed UseKohaPlugins in bug 20415 but incidentally added a
    reference to it bug 24183. This patch corrects that error.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4a84f7a9e0d13898d9a17071e3bd74f904a1e4f8
Author: Phil Ringnalda <phil@chetcolibrary.org>
Date:   Sun Apr 19 02:37:49 2020 +0000

    Bug 20501: Don't cut strings when unhighlighting in intranet search results
    
    When you click Unhighlight on the search results of a search in the staff client
    when the search terms contain the same word twice, like "ma ma", the highlighted
    words disappear, and don't reappear if you click Highlight.
    
    This patch makes the same change to the intranet copy of jquery.highlight-3.js that
    bug 5844 made to the OPAC copy.
    
    Test plan:
    1) Without this patch, search in the intranet for ma ma and verify you have at least
       two matching records.
    2) Notice that the Ma in Material type: Book is highlighted.
    3) Click Unhighlight, and notice that it has become terial type: Book
    4) Apply this patch, repeat the search with a shift+reload to reload the .js
    5) Click Unhighlight, and verify that Material type: Book remains Material
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 03ece9452a5eef8ca76dab413f4f5177f69797d1
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Apr 20 18:41:37 2020 +0000

    Bug 25223: Make join of aqbasket and aqorders explicit
    
    This is simply a SQL change that makes things a bit easier to read
    and also prevents too much data being returned in a large system
    
    To test:
    1 - Have some orders in your system in the ordered status
    2 - Click the 'Ordered' amount for your budget from Acquisitions home
    3 - Note the view of orders, possibly screen shot
    4 - Apply patch
    5 - Restart all the things
    6 - Reload the ordered page
    7 - Confirm nothing has changed
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c42674cfd98a2774881f48db5454bdb3392c57c8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 21 12:33:47 2020 +0100

    Bug 24913: DBRev 19.12.00.078
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3d022f0f27e3c2cfa42dbcad3b472acb5232fc71
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Apr 14 04:51:41 2020 +0000

    Bug 24913: Add PatronSelfRegistrationConfirmEmail syspref
    
    To test:
    1) update database, restart memcached/plack
    2) Go to Administration -> System preferences -> OPAC tab. Enable the
    new PatronSelfRegistrationConfirmEmail system preference. Enable other
    required self registration sysprefs.
    3) Go to the OPAC home page. (You may need to log out). Click the
    'Register' link so you are redirected to the member entry form.
    4) Notice the 'Confirm primary email' field after the 'primary email'
    field. Put 'a@a.com' in primary email, and 'b@b.com' in the confirm
    field. Scroll to the end of the form and Submit.
    5) Confirm the form is not successfully submitted, and an error message
    is shown to indicate the email addresses do not match.
    6) Confirm you cannot cut, copy or paste in either the primary email or
    confirm primary email fields. Confirm the right click menu doesn't work
    in these fields.
    
    7) Disable javascript in your browser.
    8) Repeat steps 3 and 4.
    9) Confirm there is an error message to indicate the email addresses do
    not match.
    
    10) Re-enable javascript. Fill in the form correctly with matching email
    addresses and confirm it successfully submits.
    
    11) Disable the PatronSelfRegistrationConfirmEmail syspref.
    12) Attempt to register an account on the OPAC again. Confirm the
    'confirm email address' field is gone and form works as expected.
    13) Re-enable the PatronSelfRegistrationConfirmEmail syspref.
    14) Log in to the OPAC and go to your personal details
    15) Edit the primary email field
    16) Confirm you are able to submit your changes (you should not see an
    error about emails not matching).
    
    Sponsored-by: Bibliotheksservice-Zentrum Baden-Württemberg (BSZ)
    Signed-off-by: holly <hc@interleaf.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7d067667c4c2494505b736553b19150d1838464
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 20 08:37:10 2020 +0100

    Bug 25123: (QA follow-up) Re-used variable name
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d306ff2ffb399a66e179e1d9e4cf45246dc83af
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Apr 13 11:38:28 2020 +0000

    Bug 25123: Count the current fine when reducing for maxFine
    
    If maxFine is set, we total the patrons outstanding fines when making an adjustment, however, we neglect to count the amount of a currently updating fine when doing so.
    
    To test:
    1 - Set maxFine to 5
    2 - Create an overdue amount of 4.99 for a patron
    3 - Set an itemtype to have a fine of $.10 per day
    4 - Checkout an item of that type to a patron and backdate the due date so it is overdue
    5 - Run fines.pl with -v
    6 - Note the fine is reduced from $.10 (or a multiple) to .01
    7 - Run it again, a second cent is added
    8 - Repeat and note it keeps happening until the amount of the fine is reached, exceeding the maxFine setting
    9 - Apply patch
    10 - Note the fine is now reduced to 0 and nothing is added to account
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 49c15f06ac545a4374441076a7f8192f576b1f26
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Apr 13 11:38:23 2020 +0000

    Bug 25123: Unit tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4a2cc4e9039dbeeb77d776ff8ae1099aa84fde30
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Apr 12 22:06:05 2020 +0000

    Bug 14369: Only show 'Create labels' link on staged records import when status is imported
    
    The label creator won't be able to add a batch for items, if they are
    not imported into the database (missing itemnumber). This patch hides
    the link, when the status is not imported, to avoid the error situation.
    
    To test:
    - Export a record with items from your Koha installation
    - Delete items and record from Koha
    - Stage the record with the items - the "Create labels" link should be showing
    - Try to create the labels - note error
    - Apply patch
    - Retry - the link should no longer show
    - Import the records - the link should show now
    - Create labels again - a new batch should have been created
    - Verify the link on the batch # leads to the batch in the labels module
    
    Bonus: Moves the message from the .pl file to the template to make
    it translatable.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e94ea221df93bb0bcbc3a2e90b4b8ff5daab761a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 21 12:14:13 2020 +0100

    Bug 20484: (RM follow-up) Highlight ES disablement
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7de19f4e5c00025a29b6b8db2d095592bf48e20c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Apr 21 10:54:56 2020 +0000

    Bug 20484: Implement blocking_errors for ES config page
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 80dc5c36b823be0113ff7b456d17ad81e1da368e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 20 12:38:05 2020 +0200

    Bug 14229: Remove extra spaces
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2dc31f65aef1357d98c20872eaa9a2a6f3b98beb
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Apr 16 00:29:57 2020 +0200

    Bug 14229: Add link from patron search results fine to accounting tab in patron account
    
    This adds a link to the accounting tab from the patron search results by
    making the amount in the Fines column clickable.
    
    To test:
    - Make sure you have some patrons with fines, credits and 0,00
    - Search for your patrons using the patron search, make sure you
      get more than one result for your search
    - Check the results table - the amount should always be linked
      and lead to the patron account accounting > transactions tab.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e5001c5a37f4df02cad9f0490376fc2179aa966b
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Apr 13 18:22:04 2020 +0000

    Bug 24819: (follow-up) Rename suggestor to suggester
    
    I believe I suggested a typo - trying to fix it here.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 14783dabbee9817329c50972f18d63cf22b2edf2
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Tue Mar 24 14:52:31 2020 +0100

    Bug 24819: (follow-up) Rename suggestion_search to suggestor_search
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fa580344912781d8b010f81fab8e1e4298c493e7
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Thu Mar 5 16:41:25 2020 +0100

    Bug 24819: Allow the librarian to choose a patron when entering a purchase suggestion
    
    Sometimes librarians are creating purchase suggestions that came from patrons
    which didn't use the opac (but sent an email, or told the librarian verbally...)
    
    This patch allows the librarian to change the creator of the purchase suggestion
    when entering it.
    
    This way, the patron will be able to receive notifications during the purchase
    suggestion workflow.
    
    Test plan:
    
     - Apply the patch
    
     - Check that you can change the default creator of the purchase suggestion when
       creating a new suggestion by clicking on 'Set to patron'
       (Home > Acquisitions > Suggestions management > New purchase suggestion)
    
     - Check that you can also change the creator of the purchase suggestion when
       editing an existing suggestion
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b331d19e8df506991fc1deafc372c27a1554015a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Apr 8 10:11:38 2020 +0000

    Bug 20484: Allow configuration of ES before switching to ES
    
    To test:
    1 - Set SearchEngine syspref to Zebra
    2 - Be a user with permission to manage search engine configuration (manage_search_engine_config)
    3 - Confirm you do not see 'Search engine configuration' on Admin main page
    4 - Apply patch
    5 - Confirm you see it with '(Elasticsearch)' appended
    6 - Be a user without above permission
    7 - Confirm you cannot see the 'Search engine configuration'
    8 - Confirm you cannot access directly:
        /cgi-bin/koha/admin/searchengine/elasticsearch/mappings.pl
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e5870e30de55129b5b1037a00283aa9c6aa4095d
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Apr 13 17:45:22 2020 +0000

    Bug 25135: Improve clarity and navigation of columns settings administration
    
    This patch makes some modifications to the columns setting
    administration template so that the headings are a little clearer.
    In-page navigation is added for each section.
    
    To test, apply the patch and go to Administration -> Columns settings.
    
     - Confirm that the collapsing panels work correctly.
     - Expand a section and confirm that the "jump to" links work correctly.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Looks good, works good.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 93fbfcb1bfb420a415c75d850b3eef0dacb2df06
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Apr 17 13:32:35 2020 +0000

    Bug 23349: (follow-up) Correct translation function
    
    This patch corrects the translation function inside results.js. It
    should be two underscores instead of one.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 743f40a202ba915dccbf35058e5b7ecf707e3e67
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Apr 6 20:39:35 2020 +0000

    Bug 23349: Add batch operations to staff interface catalog search results
    
    This patch adds three new options to the staff interface catalog search
    results for users with cataloging permission: batch edit, batch delete,
    and merge. The choices are found in an "Edit" menu which is disabled by
    default. Checking any boxes in the search results table enables the
    button.
    
    To test, apply the patch and log in to Koha as a user with
    edit_catalogue permission.
    
     - Perform a search in the catalog
     - You should see a disabled "Edit" button in the toolbar at the top of
       the search results table.
     - Check a single checkbox. The button should become enabled.
       - Test the "Batch edit" and "Batch delete" menu items. They should
         work correctly.
       - Test the "Merge records" item. It should warn you that you must
         select at least two records.
     - Check more than one checkbox and test each menu item again. All
       should work as expected.
     - Log in to the staff client as a user who does not have edit_catalogue
       permission. The "Edit" menu should no longer appear on the search
       results page.
    
    Signed-off-by: Abbey Holt <aholt@dubuque.lib.ia.us>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c54654c12944250ed75bbdd011e6ac6cacf58d3f
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Apr 13 21:45:22 2020 +0000

    Bug 13557: Add hint for on-site checkouts to list of current checkouts in OPAC
    
    In the list of checkouts it's currently not possible for the
    patront or tell the difference between normal checkouts (item
    is at home with them) and on-site checouts (items remained at
    the library). This patch adds a hint to the list of checkouts to
    allow differentiating these kinds of checkouts.
    
    To test:
    - In your patron account, have multiple checkouts, some on-site,
      some others, overdue items, etc.
    - Go to: OPAC > your summary > Checked out
    - Verify that there is no hint for the on-site checkouts
    - Apply patch
    - Check again, there should now be a note
    
    The note also has a class, so would be easy to be hidden
    or formatted differently: class="onsite_checkout".
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3ba823db6ea9c77e74dcdaa4d3a88f424ea7695d
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue Apr 14 13:14:37 2020 +0000

    Bug 21211: Add patron toolbar to suggestions, discharges and ill requests tabs
    
    When paging through the patron account in staff, using the tabs on
    the right, you notice that some pages are missing the patron toolbar
    on top and that the headings, where they exist, vary in size.
    
    This patch adds the patron toolbar to 3 more tabs and changes headings
    to h1 to be consistent with older tabs. It has also been suggested on
    another tab that this is preferrable for screen readers.
    
    Note: Modification log was left out for now, as this is also used in tools.
    
    To test:
    - Activate ILL (ILLModule pref)
    - Activate discharges (UseDischarge pref)
    - Go to any patron account, tab through the tabs...
    - Verify that discharge, purchase suggestions and ill requests are
      missing the toolbar
    - Apply patch
    - Verify that the toolbar now appears on these pages and works
      correctly
    - Also veriy that the headings are now consistently h1 on all pages
    
    Signed-off-by: David Roberts <david@koha-ptfs.co.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8218653df75cc61676ce40f2feea70bb5671614b
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue Apr 14 16:57:38 2020 +0000

    Bug 18680: Add an empty entry by default to sort1/sort2 values in patron account
    
    When using sort1/sort2 with authorised values to create a pull down
    list, there will be no empty entry unless one is manually added to
    the authorised values list.
    
    This is not a good default behaviour, as it can easily
    cause errors on patron creation. Without the empty entry, the first
    alphabetic value is pre-selected and will be saved if not explicitly
    changed. It also doesn't allow to mark sort1/sort2 as mandatory,
    as the value is always 'set', the required message won't be triggered.
    
    This adds an empty parameter to av-build-dropbox.inc to allow selectively
    adding this empty entry without causing side-effects in other places
    this include is used.
    
    To test:
    - Create authorised values for either Bsort1 or Bsort2 authorised
      value category
    - Create a new patron:
      - you should see a pull down list on one and an input field for the other
      - for the pull down list, there will be no empty entry and the first
        alphabetic value will be preselected
    - Make your sort1 and sort2 mandatory using BorrowerMandatoryField
    - Verify there is still on empty entry
    - Apply patch
    - Repeat tests and verify that the behaviour is as expected
      - There should now be an empty entry
      - When the field is marked mandatory and empty is left, the required
        warning will be shown.
    
    Signed-off-by: David Roberts <david@koha-ptfs.co.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 563120a004f03a96c935b179af36cace874f708c
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Apr 13 03:46:25 2020 +0200

    Bug 10561: Rephrase DisplayOPACiconsXSLT and DisplayIconsXSLT slightly
    
    As the pref removes the whole 'line' of information, this tries to makes
    the behaviour a little clearer by adding a 'and descriptions' to the pref
    text. It now reads:
    
    [Show|Don't show]  the format, audience, and material type icons and
    descriptions in XSLT MARC21 results and detail pages in ...
    
    To test:
    - Check both preference descriptions in the staff client
    - Verify the text reads correctly and this helps things
    
    Signed-off-by: David Roberts <david@koha-ptfs.co.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d8dd31142c0bfd9b09f9fa8e02fc292cf9deed2c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 17 11:22:04 2020 +0200

    Bug 13518: Delete patron's modifications along with the patron
    
    The table borrower_modifications has no FK constraint on the borrowernumber
    and will remain untouched when the patron is deleted.
    If the borrowernumber doesn't exist in the database, the modification entry is no longer visible in Koha.
    
    The problem is that this table is used for the borrower modifications and the self-registration features.
    
    So far borrowernumber is the PK (int(11) NOT NULL DEFAULT '0'), for the self-registration feature we can have borrowernumber that is not defined (0 is used)
    
    Ideally we would like to have borrowernumber a DEFAULT NULL, and use NULL for self-reg, but then we will loose the PK (PK cannot be NULL).
    
    As we cannot keep the correct constraints at DB level anyway, we will need to handle consistency at code-level.
    
    Test plan:
    Create a new patron
    Do some modification at the OPAC
    Delete the patron
    Confirm that the modifications as been removed (directly in DB)
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 510ee153c0d0d0bc01ca1abc3cd6aa28a4d0f9ff
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 20 12:17:44 2020 +0100

    Bug 25176: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8758cffcd2b3573561eda9d28ce45bb920a6978d
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Apr 17 11:40:36 2020 +0000

    Bug 25176: Fix style of checkout form
    
    This patch makes a small CSS change in order to fix a display problem
    with the checkout form where the form's width doesn't match that of the
    "last checked out" message.
    
    To test, apply the patch and regenerate the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    Check an item out to a patron. Confirm that the green-bordered "Checked
    out" message under the checkout form matches the width of the form.
    
    Signed-off-by: David Roberts <david@koha-ptfs.co.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4b290b9833293d4e56e2e4597e9645e331bc1ee1
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 16:05:43 2020 +0100

    Bug 24768: (RM follow-up) Add missing koha_object_class's
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eed7aa216c2096f2ac329d143b7ccbcb2c81139c
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Apr 11 10:36:36 2020 +0000

    Bug 24768: Add 'Return claims' to column configuration for checkouts tables
    
    The checkouts tables on the checkouts and details tabs in the staff
    patron account support column confiugration, but the new column
    "Return claims" was missing.
    
    This patch adds the column to the column configuration.
    
    To test:
    - Make sure to test with a patron having return claims and without
    - Verify cou can toggle the visibility of the return claims column
      from top of the tables in the checkouts and details tabs
    - Go to administrastion > column configuration
    - Change the settings for the issues tables in the Patrons and
      Circulation sections
    - Verify the changes have been applied to the tables as configured
    
    Signed-off-by: David Roberts <david@koha-ptfs.co.uk>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 54630c842e800efefd95a4facf9907cd29a5b9cb
Author: Mengü Yazıcıoğlu <kohadevinim@devinim.com.tr>
Date:   Thu Apr 16 11:09:54 2020 +0000

    Bug 25138: (follow-up) Terminology: Point of sale should use library instead of branch
    
    Signed-off-by: Devinim <kohadevinim@devinim.com.tr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ca452f07d5a04eb0159b35b3dc97173241a78f82
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Apr 12 02:25:48 2020 +0000

    Bug 25138: Terminology: Point of sale should use library instead of branch
    
    This fixes the navigation on the Point of sale page:
    Branch details => Library details
    
    And the heading and the 'no register defined for this branch/library'
    message on the page it links to.
    
    To test:
    - Activate cash registers and point of sales features
    - Go to the point of sales page
    - Verify text on the menu to the left
    - Click on the Branch/library details - verify text and heading
    
    Signed-off-by: Devinim <kohadevinim@devinim.com.tr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 66135bc4c5e805b6b525a5dacbb208f696ee6b39
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 13:48:47 2020 +0100

    Bug 23727: DBRev 19.12.00.077
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a65730c0fdae9c1c866a5e4b6471fc3bb6754c6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 20 17:15:57 2020 +0000

    Bug 23727: (QA follow-up) Fix for boolean flags
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8e4bf7608e233a7e6284b39262a77b23867b6f67
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 20 17:10:49 2020 +0000

    Bug 23727: (QA follow-up) Fix script tags
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d15ff34043aeb2a812a1139aba084cf4c1bc136
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Feb 14 15:22:17 2020 -0500

    Bug 23727: Editing course reserve items is broken
    
    Adding an item to course reserves and trying to edit any values in a second step does not work. Values are not saved and the table shows all values as "Unchanged".
    
    This patch set adds two new sets of columns to the course_items table.
    
    The first set determines if the specified column should be swapped or
    not. The was previously 'implied' by the column being set to undef which
    has been the root problem with that way of knowing if a column should
    swap or not.
    
    The second set of new columns are for storing the item field values
    while the item is on course reserve. Previously, the column values
    were swapped between the items table and the course_items table,
    which leaves ambiguity as to what each value is. Now, the original
    columns *always* store the value when the item is on course reserve,
    and the new storage columns store the original item value while the
    item is on reserve, and are NULL when an item is *not* on reserve.
    
    Test Plan:
    1) Apply this patch
    2) Add and edit course items, not the new checkboxes for enabling fields
    3) Everything should function as before
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6229b51d663b868532102e60a4517ae2d4fb44cd
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Feb 14 08:57:05 2020 -0500

    Bug 23727: Add Koha Object(s) related to course reserves
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 27716ceef8b5b97405bb4807eac2b58fe3d5e11b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Feb 14 08:45:11 2020 -0500

    Bug 23727: Update Schema
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e08eae728ce36b0ee6913501fd44a4a3b5ae976b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Feb 14 08:41:28 2020 -0500

    Bug 23727: Add new columns
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 96bc0afee25f16953279c4c91f21c9cf2fc62f4b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 13:36:39 2020 +0100

    Bug 21901: (RM follow-up) Use TestBuilder to fix tests
    
    A few tests failed due to missing values for foreign key relationships.
    Switching to TestBuilder for data mocking resolves this elegantly.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a1437dae8d175e4d6fe15ea10cfb5b6923f76c08
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 17 10:42:21 2020 +0200

    Bug 23463: Remove double store call
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2b7ac72d7086c66d14b9d08337eecea94c4d8929
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 10:20:27 2020 +0100

    Bug 22887: (RM follow-up) Restore warnings in updatedatabase
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0e9d45e7b4cb2e6a6d6b9559671b5d91c0e6fab4
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 10:17:32 2020 +0100

    Bug 21901: DBRev 19.12.00.076
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d09c46cf7e049f1e32c6bb57f49c46288d486f5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Apr 17 08:04:14 2020 +0000

    Bug 21901: (QA follow-up) Add a few NOT NULL constraints in dbrev
    
    We need to specify NOT NULL on subscription and -history as well.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cd5be730420ebed9d66a4feaae19df79a4c3559d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 9 15:25:29 2020 +0100

    Bug 21901: Add a warning if we removed entries
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 021598e8a4043433a8d435298dd584ac8127aacc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 31 13:21:41 2020 +0000

    Bug 21901: (QA follow-up) Ensure consistent data before adding keys
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9287585f3823b9375d5bdbbc7128e0141dafb4f6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 11 08:29:27 2019 +0100

    Bug 21901: Add FK on subscription and serial tables
    
    In order to improve performance in the serial modules and add DB constraints,
    this patch is going to add missing foreign key on the following columns:
     * serial.biblionumber
     * serial.subscription
     * subscriptionhistory.biblionumber
     * subscriptionhistory.subscriptionid
     * subscription.biblionumber
    
    Once done, some code can be removed from the Del* subroutines, as the ON
    CASCASE clause will make the RDBMS handles the deletions.
    
    Test plan:
    0/ It would be useful to test the update DB entry on a big and old
    production DB, to make sure the constraints will be added correctly.
    We could remove the entries before creating the constraints, but it can
    be unecessary
    1/ Make sure you can recreate a fresh install with the kohastructure.sql
    from this patch
    2/ Make sure you can upgrade from a master install
    3/ Create a subscription, serial, etc. and delete the biblio
    => The subscription/serials should have been deleted from the DB
    4/ Create a subscription, serial, etc. and delete the subscription
    => The serials should have been deleted from the DB
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2484fb6ac508e7709de9473694512ce09b12aff9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sun Mar 29 00:19:39 2020 +0000

    Bug 25016: Coce should not return a 1-pixel Amazon cover image
    
    This patch adds an onload function to the JavaScript which loads images
    from Coce. In the case where the image is 1 x 1 pixel the image should
    be removed.
    
    To test you should have Coce enabled and Amazon.com included in the list
    of sources.
    
     - Apply the patch and view the bibliographic details page under a
      variety of conditions:
       - A title which has a matching Amazon image:
         - The image should load as expected.
       - A title which doesn't have a matching Amazon image
         - The image should not be found in the source at all after the page
           has loaded.
      - Test with local cover images enabled
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1be518588b69db80b43ef21c442f2bf8e74f044a
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 24 12:52:13 2020 +0000

    Bug 24715: Cache repeatable subfield in TransformKohaToMarc
    
    Implemented by calling GetMarcSubfieldStructure and improving
    _check_split which may check repeatability in a specific framework,
    and return the framework hash.
    
    Test plan:
    Run t/db_dependent/Biblio/TransformKohaToMarc.t
    Optionally, follow the test plan of bug 21800#comment7.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7426cb6432ce35434335f08b7d391ef83acd3705
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 31 14:51:22 2018 -0300

    Bug 20116: Cache language list
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4de218561460290cc5807c6770bafa597a416cce
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 16 17:26:09 2018 -0300

    Bug 20116: Flush the caches
    
    When languages are added or removed when need to flush the caches to
    keep the interface consistent
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d7efe9ffbbff7dc641f4840bd01b1a969b6d5c4f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 31 14:36:22 2018 -0300

    Bug 20116: Prepare the ground
    
    Just refactoring to make the next patch more readable
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f300af96a7fd1ad96f8dfd132882bafcec8a8426
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Mar 27 23:48:56 2020 +0100

    Bug 25011: Improve display of MARC21 508 - Production credits in staff and OPAC
    
    Makes some tiny changes to improve display and consistency between
    OPAC and staff:
    - Capitalization fix: Production Credits - Production credits
    - Changes div to span avoiding display issues
    - Make sequence of fields in display match (505, 508, 586)
    
    To test:
    - Catalog one or more records with none, one and multiple 508 $a
    - Check and compare the staff and OPAC detail pages, both
      should display the production credits information correctly
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52339bcef0d735b39a9ca9c198dd3d54d092fba7
Author: Kyle M Hall <kyle@bywatetsolutions.com>
Date:   Tue Jan 30 11:10:07 2018 -0500

    Bug 20101: Cronjob automatic_item_modification_by_age.pl does not log run in action logs
    
    C4::Log::cronlogaction() was never implemented in automatic_item_modification_by_age.pl.
    
    Test Plan:
    1) Apply this patch
    2) Enable CronjobLog
    3) Run automatic_item_modification_by_age.pl succesfully
    4) Note the run is noted in the action logs
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2d5d9a54bd9b8927b82066b35dcaec20cad764ea
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 09:13:13 2020 +0100

    Bug 25086: DBRev 19.12.00.075
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 039afd0936871670598b8b7f24dc5a9be93dd240
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed Apr 8 16:53:43 2020 -0300

    Bug 25086: Set changed_fields column as nullable
    
    This patch changed_fields column as nullable.
    
    To test:
    1. Do not apply any patch
    2. Set PatronSelfRegistrationVerifyByEmail preference to require
    3. Fill self registration form in opac and submit
    CHECK => OPAC dies with a nasty message, that says Field 'changed_fields' doesn't have a default value
    4. Apply this patch and updatedatabase
    5. Repeat step 3
    SUCCESS => Registry process continues as expected
    6. Sign off
    
    Sponsored-by: Orex Digital
    Signed-off-by: Victor Grousset/tuxayo <victor@tuxayo.net>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 081a4c75be2431e1a6fc470a5b8834fa866e2453
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 09:02:58 2020 +0100

    Bug 25147: (RM follow-up) Update pref references.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ed79b1709a846d3f084590586c49e04aeac4896f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 08:30:40 2020 +0100

    Bug 25147: (RM follow-up) Update display
    
    I missed the display change in the preference name change.. oops.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit edee0266c477c627d9be5f86d09182c042d2607c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 08:24:57 2020 +0100

    Bug 25147: DBRev 19.12.00.074
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aa1d792a149a59473e3ddcb7d9b471b8e07e1a79
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 08:18:44 2020 +0100

    Bug 25147: Clarify section name
    
    Clarify the preference section headings for Self-checkout and
    Self-checkin.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7fb2524a9a144e96cf0b57a3f8cf4a13a917ad67
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 08:16:10 2020 +0100

    Bug 25147: Rename preference
    
    This patch renames the preference from the ambiguous 'AllowSelfCheckReturns'
    to 'SCOAllowCheckin' which is more consistent with other preferences
    affecting this module.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 67c7b281aea90bdda7bd15e1d2fdd657caefac74
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 07:55:09 2020 +0100

    Bug 25152: (RM follow-up) Correction to update description
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4e9a8b6413a0ce64e5757842a61ed122d8fe8d15
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 17 07:51:16 2020 +0100

    Bug 25147: AllowSelfCheckReturns is in the wrong system preference section
    
    This reverts commit 8aa9f2cc078932a0a4db434f8bd793de29a8ff7b.
    
    I agree with the following comment and as such have reverted the patch.
    
    Quoting Phil Ringnalda <phil@chetcolibrary.org>:
    
      Everything currently in the chunk labelled "Self Checkout" is
      preferences used to control sco-main.pl, a feature that does checkout
      and renewal, and optionally with the preference AllSelfCheckReturns,
      also checkin.
    
      Everything currently in the chunk labelled "Self check-in module" is
      preferences used to control sci-main.pl, a separate feature that does
      only checkin, and does checkin whether or not AllowSelfCheckReturns is
      set.
    
      I'd think a better solution would be to either rename the preference,
      which is actually AllowReturnsInSelfCheckout, or rename the chunks to
      make it more clear that they are preferences for two different features.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8aa9f2cc078932a0a4db434f8bd793de29a8ff7b
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Wed Apr 15 16:34:40 2020 +0000

    Bug 25147: AllowSelfCheckReturns is in the wrong system preference section
    
    This patch moves the AllowSelfCheckReturns system preference to the "Self check-in module" section of the Circulation system preferences.
    
    To test:
    
    1) Check that the AllowSelfCheckReturns system preference is currently
    in the "Self Checkout" section of the Circulation system preferences.
    2) Apply the patch
    3) The preference should now be in the "Self check-in module" section of
    the Circulation system preferences.
    
    Signed-off-by: Devinim <kohadevinim@devinim.com.tr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 665c8328d11cb3ff83c9b48e25bc583757daaf7d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 16 11:51:32 2020 +0200

    Bug 25136: Join the 2 ifs
    
    Highlight that we only need this for action="new"
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dbf604e141429fb32501bc13ed74919823d8c7ee
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Wed Apr 15 22:46:23 2020 +0000

    Bug 25136: Make PatronSelfRegistrationLibraryList only effect new registration
    
    This patch makes it so PatronSelfRegistrationLibraryList will only effect the registration from and not the modification form.
    TO TEST:
    1. Turn on self reg and add some libaries to PatronSelfRegistrationLibraryList.
    2. Notice that the libaries that display in the borrower_branchcode dropdown are the ones you selected on both the new registration from and the modification form.
    3. Apply patch.
    4. Now only the new registration from should show libaries on PatronSelfRegistrationLibraryList.
    5. The modifciation dropdown should still show all libraries.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 429c57d8d6fd88053f2bff93465ab78f1ef82aa3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sat Mar 28 17:42:50 2020 +0000

    Bug 25007: (follow-up) Fix the way image check alters layout
    
    A question in the bug report asks: Why is is necessary to change the
    Bootstrap class to col-xs-12? The JavaScript which checks for the
    existence of an Amazon cover image is designed to remove the Amazon
    cover's container if there is none. Changing the class of
    cover image column is gone.
    
    However, the check is incorrect because it doesn't account for Local
    Covers. There might be both a 1 x 1 pixel Amazon image and a local cover
    image, so the layout shouldn't be changed unless there are no images
    present.
    
    To test, apply the patch and view the bibliographic details page of
    various titles including:
    - Amazon cover present, no local cover
    - No Amazon cover, local cover image present
    - Both Amazon and local cover image
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a348fc18e414d3d68916ae863c18344233eafdc9
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Fri Mar 27 20:40:30 2020 +0000

    Bug 25007: Check for normaalized ISBN when building Amazon link
    
    TO RECREATE:
    -Have Amazon images turned on and local images too.
    -Have a record with a local cover image
    -Make sure the record has no ISBN in 020 field.
    -Load detail page of that record and see that the local cover images is
     not on the right hand side like it should be but forced underneath
     'catalogue_detail_biblio' in an odd spot.
    -Apply patch and reload page
    -The image should be back in its normal spot
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 75f3cb5680693cfca0a0d9e57f52bfcc57ed7481
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Apr 15 11:48:23 2020 -0300

    Bug 25131: (QA follow-up) Move test for needs_install outside the plugin
    
    This follow-up patch moves the check outside the register routine. The
    Mojo plugin won't be loaded unless there's no need to install.
    
    As the original tests rely on V1.pm to be able to load the plugin, they
    are still valid, and they should still pass as there's no behaviour
    change.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit be618ab400bc15e4c3804ffdbdbc3e8c3e659ba3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Apr 14 16:24:38 2020 -0300

    Bug 25131: Skip loading API plugins if Koha is not installed
    
    This patch adds a check on Koha being actually installed to the
    PluginRoutes Mojolicious plugin.
    
    If Koha is not installed, plugin routes won't be tried to get installed.
    This has the effect of making the webinstaller functional again (when
    enable_plugins is set to 1).
    
    To test:
    1. Apply the regression tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/REST/Plugin/PluginRoutes.t
    => FAIL: Tests fail!
    3. Apply this patch
    4. Repeat 2
    => SUCCESS: Tests pass!
    5. Reset your working branch
    6. Delete your database (e.g. in koha-testing-docker):
       $ mysql -hdb -ppassword
       > DROP DATABASE koha_kohadev;
       > CREATE DATABASE koha_kohadev; \q
    7. Set enable_plugins to 1 in koha-conf.xml
    8. Restart all:
       $ service memcached restart
       $ koha-plack --restart kohadev
    9. Open the staff interface
    => FAIL: Hangs, the logs show nasty errors (koha-plack-err)
    10. Apply this patches
    11. Restart all
    12. Repeat 10
    => SUCCESS: The web installer shows up :-D
    13. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8992bb2e6f9b6eb5f9dbe96b28df62904f82bfba
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Apr 14 16:24:33 2020 -0300

    Bug 25131: Regression tests
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2633bed5c4f5e07db0e69719c4750f03e6151782
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Apr 14 16:21:37 2020 -0300

    Bug 25131: Add C4::Context->needs_install
    
    This trivial patch adds a new convenient way to ask if Koha is
    installed. It uses the same approach as C4::Auth:730
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ t/Context.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 48188a1065b11a4e83e67d5b2e08c45552b80f1e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 15 15:17:11 2020 +0200

    Bug 24131: Prevent the first description to be displayed twice
    
    If there are several lines to display, the first one was displayed
    twice:
    Upgrade to 19.12.00.071 done [13:10:22]: Bug 22887 - Add unique constraint to authorised_values
                                                       - Add unique constraint to authorised_values
                                                       - WARNING - Cannot create unique constraint on authorised_value(category, authorised_value)
                                                       - The following entries are duplicated: COUNTRY:aaa (2)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 36cb0e6ae423c1c3c7176d219bba953554ff08df
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 15 15:04:16 2020 +0200

    Bug 22887: Remove superfluous warn statements
    
    We print them in the description later
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c6b6b0a42746bd19653216e607ed048846aaab5b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 15 15:03:15 2020 +0200

    Bug 22887: Fix SQL syntax for MySQL 5.5
    
    This does not happen on MySQL 8 or latest MariaDB, but does on MySQL 5.5
    
    "Non-grouping field 'c' is used in  HAVING clause"
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4da2a353b71f0d9ae9f508704dddb65fa493e457
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 15 12:37:24 2020 +0100

    Bug 25152: DBRev 19.12.00.073
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b87fdec6da2c3bee74180b5a8611645a718e1e5b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 15 11:29:21 2020 +0200

    Bug 25152: Make subscription.closed tinyint(1)
    
    https://wiki.koha-community.org/wiki/Coding_Guidelines#SQL12:_Booleans
    
    Boolean fields must be tinyint(1), not int(1)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e83ed955fdd7c01b0be49ef78fdf1bdc7168efa2
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Apr 13 04:32:56 2020 +0200

    Bug 22468: Standardize on labelling ccode table columns as Collections
    
    We now display the descriptions everywhere, so we should drop the
    'code' from labels.
    
    This changes text in a lot of playes in Koha, including:
    
    - The relatives checkouts table when displayed for the guarantor
    - The new order and order receive forms in acquisitoins (item creation)
    - The description of CCODE in the authorised values table
    - The column description on results in item search
    - The branch tranfers page
    - Course reserves: add reserve items (one and in batch)
    - Patron account > statistics tab
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 24d1e78575ee9b5e80115bb608a3263794fa67a7
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Apr 13 04:18:36 2020 +0200

    Bug 24939: Fix capitalization of labels in sys pref editor
    
    The headings/labels of sections in the sys pref editor didn't follow
    Koha's capitalization rules.
    
    To test:
    - Go to Administration > System preferences
    - Check all tabs for the spelling of the headings
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0f3c451c9dcb7597e9906a44a1c623a736cc7e5e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 15 12:30:12 2020 +0100

    Bug 24380: DBRev 19.12.00.072
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3175067e2343b282b7df29b0e7b2fdd20c8fd806
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 15 12:44:47 2020 +0200

    Bug 24380: (QA follow-up) Simplify condition
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 88239d126c1bb0c6e08ca15619df2eb7762718ed
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 15 12:48:44 2020 +0200

    Bug 24380: (QA follow-up) Do not use compare float with precision
    
    Forbidden pattern: Do not use compare float with precision (bug 24408).
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 806bee5a2e5f58235200f0201a9b9c21314f9c5f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 8 10:39:28 2020 -0400

    Bug 24380: Add syspref CalculateFinesOnBackdate
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 21e39818e42088ef316d7a29637094cd164c01b9
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jan 8 15:27:31 2020 -0500

    Bug 24380: Backdated returns do not update fines unless CalculateFinesOnReturn is enabled
    
    In Koha 18.11 backdating a return triggered a recalculation of the fine. This was removed in bug 14591, and I believe it was in error. The bug report itself has no justification for the change in behavior.
    
    Test Plan:
    1) Disable CalculateFinesOnReturn
    2) Backdate an overdue with fines, note the fine does not change
    3) Apply this patch
    4) Repeat step 2
    5) The fine should be updated!
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4b60a9f2bc54d52c01e8f942f751f395caacdeed
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jan 22 14:01:14 2020 -0500

    Bug 24380: Unit Test
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b0e930aad8d58f9f9be791e7a6dbe996986f8560
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Apr 11 13:40:39 2020 +0000

    Bug 25120: Make accounting the default tab when opening the pref editor
    
    The default/active tab when opening the sys pref editor used
    to be 'Acquisitions' as the first tab, but should now be the new
    first 'Accounting'
    
    To test:
    - Go to Administration > System preferences
    - Verify the Aquisition tab is second and preselected
    - Apply patch
    - Repeat
    - Verify now Accounting is selected
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c0f79717eeaca4b1ca703148ea7d61bb0311689c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Apr 14 17:02:24 2020 -0300

    Bug 22784: (QA follow-up) booleans should be TINYINT
    
    As per the coding guidelines, they should be TINYINT(1).
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ae297d8f0284c06e479ca8b4c96c92f008935b0d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 15 11:51:12 2020 +0100

    Bug 24820: (RM follow-up) Fix test after switch to 'date' field
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cc6c3f581593e4b9c6e31b5209c95d01f7a30ae4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 14 12:00:01 2020 +0200

    Bug 25137: (bug 23084 follow-up) Fix incorrect grep ternary condition
    
    The lack of parenthesis makes the condition evaluated wrong.
    
    Test plan:
    - confirm you have a branch with code X
    - enter X in PatronSelfRegistrationLibraryList
    - go to cgi-bin/koha/opac-memberentry.pl (either as a logged in patron or as a self-reg patron)
    - confirm branch dropdown is not empty and contain X
    - empty out PatronSelfRegistrationLibraryList
    - reload cgi-bin/koha/opac-memberentry.pl and confirm branches show
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 909e172c17d0bb69fa9f9a25bf7d075b7dcc99c2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 6 11:38:03 2020 +0000

    Bug 24820: Use 'date' instead of 'timestamp' for cashup
    
    Prior to this patch we were comparing cash register action timestamp to
    accountlines date fields to fetch the list of outstanding accountlines.
    
    accountlines.date is a transient field used as 'updated_on' and so this
    was a logical mistake. We should be using the 'date' field which is
    fixed 'created_on' time.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0a1fdaf9f22016dddc1c324a62e4ff52276e9aba
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 14 10:16:58 2020 +0100

    Bug 25139: Corrections to date picker handling
    
    It would appear one has to format the dates in the controller rather
    than in the template for input fields.. I wasn't aware of this caveat
    until now.
    
    Test plan
    1/ Prior to applying patch attempt to look at previous transactions
    ensuring you enter a 'to' date.
    2/ Note a catastrophic failure
    3/ Apply patch
    4/ Look at the same date range and note you no longer get a failure but
    are instead faced with the requested transactions.
    5/ Signoff
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0ef1e1a24ca0ecc53c81d2c1dae218004e7730b6
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 20 12:10:57 2020 +0000

    Bug 24697: Split items.uri on staff detail view
    
    If there are more URIs, we split on vertical bar and show the real URL
    instead of duplicated text. Otherwise display depends on the pref
    URLLinkText.
    
    Test plan:
    Create item with uri = A | B | C
    Create another item with uri = D
    Check the results on staff detail view (items table).
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 60f4104626e4c846f089789fdf67adcf7db3e8f3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 14 19:51:45 2020 +0100

    Bug 22887: (RM follow-up) Fix Charges Test
    
    The charges test added a duplicate authorised value needlessly (it's
    already present in the sample data).
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3999741d4a753ba593e4716618deac2141c4c889
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 14 17:21:25 2020 +0100

    Bug 22887: DBRev 19.12.00.071
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 66b62058d6d95469bc0fe1add52f7319a0839401
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 14 10:12:57 2020 +0200

    Bug 22887: Remove dup fr-FR for existing installs
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 234262fae33a73d96d9c04e1ede0a48eca1fd5d2
Author: Lari Taskula <lari.taskula@hypernova.fi>
Date:   Tue Apr 7 11:47:44 2020 +0000

    Bug 22887: Schema changes
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d117a7d3eadbb9ce019b92e18187ed53b2ef3249
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 26 10:29:11 2020 +0100

    Bug 22887: Rely on unique constraint in av admin
    
    Test plan:
    Try to create 2 AV with the same code for the same category.
    You should see a warning
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Lari Taskula <lari.taskula@hypernova.fi>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 323e1a2a2f28881e6aed13c78df1d0a3d5069c4e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 26 10:36:03 2020 +0100

    Bug 22887: Remove dup in fr-FR av.sql
    
    https://en.wikipedia.org/wiki/Cocos_(Keeling)_Islands
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Lari Taskula <lari.taskula@hypernova.fi>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b925d88de16e5e391a91f32d62dc32355095be84
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 26 10:28:50 2020 +0100

    Bug 22887: Warn if duplicates exist
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2ce0327480b95c7fbb6b556966524d7c803ef2d7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 10 15:32:03 2019 +0100

    Bug 22887: Add unique constraint to authorised_values
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dcaba0ac4eb969abddcdb7d79c0c2c6f6e0f8dff
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Mar 10 07:12:07 2020 -0400

    Bug 24620: Fix test, remove replaced code, use dt_from_string
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c132946cc075f0d622440054c439f69ff38544b5
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Feb 10 18:19:07 2020 +0000

    Bug 24620: Close existing transfers when setting item to waiting
    
    This patch adds a clause in ModReserveAffect to check if there
    are existing transfers and close them when setting a hold to waiting
    
    To test:
     1 - Set AutomaticItemReturn to Do
     2 - Checkin an item from Library B at Library A
     3 - Confirm item is in transfer (check the details page)
     4 - Place a item level hold for pickup at library A
     5 - Checkin the item at Library A
     6 - Confirm the hold
     7 - View the details page
     8 - Note the item is in transit and waiting
     9 - Apply patch
    10 - Delete hold and repeat
    11 - Confirm that transfer is closed when hold marked waiting
    
    Signed-off-by: Sally <sally.healey@cheshirewestandchester.gov.uk>
    Signed-off-by: Stina Hallin <stina.hallin@ub.lu.se>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0a70b46119c5df2c610a396393887161be9b3f85
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Feb 10 18:18:45 2020 +0000

    Bug 24620: Unit tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2fbae01c9b127516953bbeafd77d1a030379f3a8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 14 10:18:31 2020 +0200

    Bug 23571: (QA follow-up) Remove perlcritic warning
    
    Bareword file handle opened at line 138, column 5.  See pages 202,204 of PBP.  (Severity: 5)
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e5e26645ee411488f01502892f841ba54a79604e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 13 15:50:54 2020 -0300

    Bug 23571: (QA follow-up) Add missing newline in warning
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d4fed889904c5eeba05f12bdbf8d14f0e3ae0a8
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Sun Apr 12 10:27:57 2020 -0300

    Bug 23571: Prevent concurrent execution of fines.pl
    
    This patch introduces locking in fines.pl. It does so by leveraging on
    bug 25109, which introduces a generic locking implementation on
    Koha::Script.
    
    The introduced changes:
    1. Try to get the lock
    2.a. If success, normal execution happens
    2.b. If rejected, cronlogaction is called with a meaningful message and
      a normal exit happens, so we don't flood the logs in vain. --verbose
      will make the script print the same message on STDERR, as already is
      the case with this script
    
    To test:
    1. Apply this patch
    2. In two separate consoles run:
       $ kshell
      k$ perl misc/cronjobs/fines.pl --verbose
    SUCCESS => The first one runs normally, the second one exists really fast
      and prints a message about the lock.
    3. Sign off :-D
    
    Sponsored-by: Orex Digital
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 83cde3858e5bfaf0619ecd4e9075d47e7063f199
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 13 15:45:50 2020 -0300

    Bug 25109: (QA follow-up) Add a test for lockdir writable in about.pl
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 17afb2b9ba6e9c38c9ed106deb7c2cf1023d7a5c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 13 12:02:29 2020 -0300

    Bug 25109: (QA follow-up) Fix typo in configuration entry name
    
    This patch fixes an error in the configuration retrieving line.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 29f399f1f8608310172b8f6963ad79a077783225
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Apr 13 08:43:10 2020 -0300

    Bug 25109: Add 'wait' tests
    
    This simple patch introduces a test for the lock waiting scenario. It
    replicates the previous tests, but calls a script that passes the wait
    => 1 parameter to ->lock_exec.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5793a29221cb9b687ec43381d6e1562d1b948e55
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Apr 10 19:37:31 2020 -0300

    Bug 25109: Add ->new and ->lock_exec to Koha::Script
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2e4fa2d677873778d53b92422642b62e9034cd77
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Apr 10 19:36:41 2020 -0300

    Bug 25109: Add entry in about.pl about the configuration lockdir entry
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 936976a1fe9d0996c22e1b3727d5782a9f114cb2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Apr 10 19:36:09 2020 -0300

    Bug 25109: Add lockdir configuration entry
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ec6c143f1b26f219f1e9ab5852436da09c857758
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Oct 22 14:31:08 2019 +0200

    Bug 23871: data inconsistencies - check title exists
    
    In biblio records, a field must be linked to biblio.title.
    200$a in UNIMARC, 100$a MARC21 (and other).
    
    If this field is undefined, some pages like checkouts table can fail.
    
    Test plan :
    1) Remove biblio title in SQL :
       UPDATE biblio SET title='' WHERE biblionumber=XXX
    2) Run misc/maintenance/search_for_data_inconsistencies.pl
    3) You see the record as an inconsistency
    4) Reset a title
       UPDATE biblio SET title='50 shades of Grey' WHERE biblionumber=XXX
    5) Run misc/maintenance/search_for_data_inconsistencies.pl
    6) Record is no longer an inconsistency
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 74c63d27c7f250da99255d7e64cfdad08a1702aa
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Mar 11 17:39:18 2020 +0300

    Bug 21865: allow test arg alone
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e788ac4e5838ad530424eeff24302f5aee4c452a
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Nov 19 15:45:49 2018 +0100

    Bug 21865: add confirm to remove_unused_authorities.pl script
    
    Like in most scripts in misc, add confirm argument
    to ensure script is not run without knowing what it does.
    
    Test plan:
    1) Run misc/migration_tools/remove_unused_authorities.pl -h
    2) You see help line for confirm
    3) Run misc/migration_tools/remove_unused_authorities.pl
    4) You see help and script does nothing
    5) Run misc/migration_tools/remove_unused_authorities.pl -c
    6) Script runs like wanted
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc4cffe1f0ac1379ddd1ce621189f1ef2d55d1fa
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Nov 19 15:19:46 2018 +0100

    Bug 21865: ES compatiblity of remove_unused_authorities.pl
    
    The script misc/migration_tools/remove_unused_authorities.pl directly checks if Zebra search is OK.
    
    This patch changes so that this test is only if Zebra is the search engine.
    It also adds a test on the search off any authority number indexed (index 'an').
    With Zebra its : an,alwaysmatches=''
    With ES its : an:*
    This test ensure that biblios records are indexed and that not all autorities will be deleted.
    
    Test plan:
    1) On a catalog create a new authority
    2) Use Zebra in systempreference SearchEngine
    3) Stop Zebra server
    4) Run misc/migration_tools/remove_unused_authorities.pl -c
    5) The script does nothing and says :
       Zebra server seems not to be available. This script needs Zebra runs.
    6) Restart Zebra server
    7) Delete biblio index base
    8) Run misc/migration_tools/remove_unused_authorities.pl -c
    9) The script does nothing and says :
       Searching authority number in biblio records seems not to be available : an,alwaysmatches=''
    10) Use ElasticSearch in systempreference SearchEngine
    11) Delete biblio index base
    12) Run misc/migration_tools/remove_unused_authorities.pl -c
    13) The script does nothing and says :
        Searching authority number in biblio records seems not to be available : an:*
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bf60a9c88cd223e53acd1d8e58508eb6d1febbb5
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Nov 19 14:46:05 2018 +0100

    Bug 21865: improve remove_unused_authorities.pl script
    
    remove_unused_authorities.pl script can be improved.
    
    This patch changes changes verbosity so than test mode can be used
    to know the autorities that are used and those that can be deleted.
    It also writes a line in output if limited authority type(s).
    
    This patch also removes the unused vars $thresholdmin and $thresholdmax.
    
    It also changes the query to use SQL with parameters for authority types.
    
    Test plan :
    1) On a catalog create a new authority
    2) Be sure catalog is well indexed
    3) Run misc/migration_tools/remove_unused_authorities.pl -t
    4) You will see the line :
       *** Testing only, authorities will not be deleted. ***
    5) You will see lines of :
       authid=x type=y : used X time(s)
    6) You will see the line for the authority created in 1) :
       authid=x type=y : can be deleted
    7) You will see at the end :
       x authorities parsed
       y can be deleted because unused
       z unchanged because used
    8) Run misc/migration_tools/remove_unused_authorities.pl
    9) You don't see the line :
       *** Testing only, authorities will not be deleted. ***
    10) You will see lines of :
       authid=x type=y : used X time(s)
    11) You will see the line for the authority created in 1) :
       authid=x type=y : deleted
    12) You will see at the end :
       x authorities parsed
       y deleted because unused
       z unchanged because used
    13) Run misc/migration_tools/remove_unused_authorities.pl --auth NP --auth CO
    14) You see the line :
        Restricted to authority type(s) : NP,CO.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc29f2afa177fd3c497bcf5ec4bdb9299d396dc9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 14 16:52:49 2020 +0100

    Bug 22774: DBRev 19.12.00.070
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f3e02aedf38b7f72207df5263c184d3e6af60f52
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Apr 13 20:28:06 2020 +0200

    Bug 22774: (QA follow-up) Rephrase OPAC notes
    
    I've changed the OPAC notes a little bit, main change is
    the removal of the <b> tags used to highlight single words
    in one sentence as they would result in splitting up the
    sentence into multiple parts which makes proper translations really
    hard.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 860264af6f6e3b51fb8b6eac4da25599c8568931
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Apr 13 20:11:00 2020 +0200

    Bug 22774: (QA follow-up) Add syspref descriptions to database update and sysprefs.sql
    
    Moves the updatedatabase entry to the new format and
    adds information for the explanation column of the
    systempreferences table.
    
    Also slightly rephrases the description in the system preference
    editor.
    
    To test:
    - Verify database update still works the same with addition
      of explanations
    - Verify the sys pref description makes sense
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 70ea3e39a883a4feb85f894e4fb25b59d21d5688
Author: Nazlı Çetin <nazli@devinim.com.tr>
Date:   Mon Mar 23 13:30:48 2020 +0000

    Bug 22774: (follow-up) Limit purchase suggestion in a specified time period
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 675ab180b098af15c2a24d90c1015a2291fd9126
Author: Mengü Yazıcıoğlu <kohadevinim@devinim.com.tr>
Date:   Thu Jan 9 10:48:15 2020 +0000

    Bug 22774: Limit Purchase Suggestion in a specified Time period
    
    Test plan:
     1 - Apply this patch
     2 - Run updatedatabase.pl
     3 - By default the preferences are blank and do not limit.
     4 - Set the limits to 3 in 30 days
     5 - Go to purchase suggestion page from OPAC as a logged in patron
     6 - Place 3 suggestions and confirm you cannot place any more
     7 - Alter one of the suggestions to have been made more than 30 days ago
        UPDATE suggestions SET suggesteddate = '2020-01-01' WHERE suggestionid=3;
     8 - Confirm you can place another suggestion
     9 - Log out of OPAC
    10 - Make sure AnonSyggestions is set to 'Allow' and AnonymousPatron is set
    11 - Confirm anonymous suggestions are not limited by the syspref
    12 - Confirm that a blank value in either  MaxTotalSuggestions  or  NumberOfSuggestionDays  does not limit suggestions
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Rhonda Kuiper <rkuiper@roundrocktexas.gov>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 294d6f54e5e57279168c042f76c209eb2b0e346e
Author: Nazlı Çetin <nazli@devinim.com.tr>
Date:   Fri Feb 21 14:08:16 2020 +0000

    Bug 22774: New systempreferences for suggestions added to sysprefs.sql
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b32c8fb91bf6c19124e7626a45191e3c50e0b73e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 15 19:38:29 2019 -0300

    Bug 20728: Remove the 2 GetLastOrder* subroutines
    
    At this point the 2 subroutines are no longer in used.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 91f9f8cdfd1ecbf56bbc4771d7c58cd9b468fc64
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 15 19:37:52 2019 -0300

    Bug 20728: Replace the calls by their Koha::Acq::Orders->search equivalent
    
    There are 2 subroutines from C4::Acquisition that could be removed:
    - GetLastOrderReceivedFromSubscriptionid
    - GetLastOrderNotReceivedFromSubscriptionid
    
    After bug 20726 only GetLastOrderReceivedFromSubscriptionid will be used
    (from acqui/neworderempty.pl) and this call could be replaced easily with Koha::Acquisition::Orders
    
    The code (+ tests) related to these 2 subroutines could then be removed.
    
    The parameters for the search is basic and does no really deserve its own subroutine.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 220c4906bf1bc399e639d5bd1c2c84319c54e3b8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 15 19:24:19 2019 -0300

    Bug 20728: Proof that there is no cheating
    
    To make sure the replacing code will acchieve the same things as the
    actual one, we replace the raw SQL query with the DBIC version of it.
    Then the tests will show us that they are equivalent.
    
    Test plan:
    Apply only this patch, run the tests, confirm they pass.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 82244a30b75435ee7e37d07e499c49844732d941
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 14 16:37:43 2020 +0100

    Bug 23591: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f843e8be51edfd3f7d01e79d3d63bb1f389bc8f1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 19 17:35:09 2019 +0100

    Bug 23591: Hide archived suggestions
    
    However we are adding a note on top of the table to tell how many
    suggestions are archived. It seems that there is no good reason to
    display the archived suggestions on this table.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 97876fa76dc3f618e76c6ff246da68be197a74dd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 18 16:37:43 2019 +0100

    Bug 23591: Use same css for suggestion notes
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6380c479b64ee78f6533312fc9c97530a843ac08
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 18 15:50:55 2019 +0100

    Bug 23591: Display a new "Suggestion detail" tab on the bib detail page
    
    This patch adds a new "Suggestion detail" tab on the bibliographic
    detail page. It will help suggestion management.
    
    Test plan:
    - Create several suggestions for a given biblio
    - Go to the detail page of the bibliographic record and confirm that
    there is a new "Suggestion detail" tab with all the suggestions you
    created.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 41e6f0447c00a817ff982ce70bbf98f78b968712
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 18 15:52:57 2019 +0100

    Bug 23591: Add some useful methods to Koha::Suggestions
    
    Those are methods initially written for bug 23991. I finally need them
    before than expected.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f5b8b6b38c4db29ab66d5aeaf50eb6f1ab4e6e19
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 17 17:21:03 2020 +0100

    Bug 23596: (follow-up) Add missing use statement and set correct variable name
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6f6f68d55b0a2740fde5c75364c12736b00bd020
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 8 15:50:57 2019 +0100

    Bug 23596: Edit suggestion's reason when receiving
    
    This patch displays and let the librarian edit the suggestion.reason
    information when receiving an order.
    
    Note that if no reason was given the edit is not possible (easily
    modifiable if needed but it seems that we do not want to display too
    much details unnecessarily)
    
    Test plan:
    - Create a suggestion and fill the reason
    - Create an order from this suggestion
    - Close the basket and start receiving the order
    => The reason is displayed and editable
    - Modify the reason and click Save
    - Receive again
    => The reason has been correctly modified
    - Play with the "Others..." option and give a specific reason
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 468047c383536d802e1e02e3fefb2168dc9d27c7
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Sat Apr 4 23:13:00 2020 +0000

    Bug 25053: Clarify the description of syspref PatronSelfRegistrationExpireTemporaryAccountsDelay
    
    This patch changes the wording of this system preference.
    
    To test:
    
    1) Check the current wording of this system preference.
    2) Install the patch.
    3) Check that the wording of this system preference has changed to "Delete patrons still in the category indicated by PatronSelfRegistrationDefaultCategory X days after account creation."
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 86db304cd45ad2fc2f59bde30ae261b18831e8c6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 14 16:25:31 2020 +0100

    Bug 22784: DBRev 19.12.00.069
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e98e77bd7323876c45854280ab9788f01c41503c
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Apr 11 09:39:31 2020 +0000

    Bug 22784: Fix small display issue with fa icon in suggestions table
    
    The <i> was not closed resulting in the "Archived" displaying in
    the wrong font. Might be a browser specific issue, but adding the
    closing </i> fixed it and follows the existing pattern.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cd268bdbb2a9dfd2c70bc3f1fe1057b5860d06b4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 27 07:55:52 2020 +0100

    Bug 22784: DBIC changes
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d6fc05891b5558fd5f2bb95c1fd200bcc43e2806
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 14 16:41:40 2019 +0100

    Bug 22784: Add a cronjob to archive suggestions given age or status criteria
    
    In order to deal automatically with suggestions that need to be
    archived, this cronjob will help to add the "archived" flag following
    their age or status.
    
    Test plan:
    - Execute the script with the --help parameter and read the documentation.
    - Does it make sense?
    - Use it without the --confirm flag and try several combination
    
    For instance you will want to archive suggestions that have been
    rejected for more than a week:
      perl misc/cronjobs/archive_purchase_suggestions.pl
      --age-date-field=rejecteddate --age=weeks:1
    
    or even suggestion that have been suggested for more than a year and
    have a ORDERED status:
      perl misc/cronjobs/archive_purchase_suggestions.pl
      --age-date-field=suggesteddate --age=years:1 --status=ORDERED
    
    - Use it with the --confirm flag and make sure the suggestions have been
    archived.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2d2ffbd075c95eb465fcc32c53b19f11d67cb4b6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 18 15:16:24 2019 +0100

    Bug 22784: Do not display an empty table
    
    This is terrible and highlight that the whole script must be rewrite.
    GetDistinctValues does not handle the "archived" flag (and we do not
    want to put our hands there), so let's hack that and plan to rewrite the
    whole script.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77b7014f883e4f48310c3e03ca56f50a6ffa60f2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 18 14:56:05 2019 +0100

    Bug 22784: Bugfix - do not modify #description build Debian packages from a git repository
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d3a6cc48d0b7c6557d8d263580a96e1d87d79814
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 13 16:34:56 2019 +0100

    Bug 22784: Add the ability to archive/unarchive a purchase suggestions
    
    There are performance issues when searching suggestions if there are
    thousands of suggestions.
    To prevent that we are going to add the ability to archive purchase
    suggestions, in order to remove them from the search list (by default).
    
    Test plan:
    0. Apply all the patches, execute the updatedatabase.pl script, restart
    all
    1. Create some suggestions
    2. Search for them
    3. Use the "Archive" action button for one of them
    4. Restart the search
    => The archived suggestion does no longer appear in the list
    5. Use the filter "Included archived" in the "Suggestion information"
    filter box
    => The archived suggestion is now displayed
    6. Use other filters
    => The "archived" filter is kept from one search to another
    7. Use one of the action at the bottom of the suggestion list (change
    the status for instance)
    => The "archived" filter is still kept
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd831a07883993e8437fa80cb631cff3d4ed27ed
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 13 15:06:23 2019 +0100

    Bug 22784: DB Changes
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6aee18111ed9c4efa92a242974c5ac439aa38880
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jan 30 10:29:05 2020 -0500

    Bug 24547: Add more action logs for holds
    
    It seems like ModReserveFill and ModReserveAffect should both produce action logs for holds.
    
    Test Plan:
    1) Apply this patch
    2) Place a hold
    3) Check in the item to trap the hold
    4) Check out the item to fill the hold
    5) Check the action logs for that reserve id
    6) Note the new logs!
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 63b44f2ddd9cb67b80b840a7ad2bd3d77971cb2d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 14 15:57:58 2020 +0100

    Bug 21190: DBRev 19.12.00.068
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 73fd85fd02c2ea5aa69c93413e3d7fcd00c12b15
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jan 30 09:27:56 2020 +0000

    Bug 21190: (follow-up) Save patron id in failure when available
    
    The wrong password might belong to an existing user. If that is the case,
    we have a $patron.
    Note that logaction will save the object info but has no user in the
    context environment for a failure.
    
    Test plan:
    Login with good user, bad pw and bad user, bad pw. Check logviewer.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a2f24f8e58410cd6d7ceed131182131dd3ce46aa
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Oct 28 10:06:11 2019 +0000

    Bug 21190: Add tests for authentication success and failure
    
    Test plan:
    Run t/db_dependent/Log.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jon Knight <J.P.Knight@lboro.ac.uk>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 79754df526d4b0225419678b76ece8315000d671
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 25 10:12:16 2019 +0000

    Bug 21190: Allow browsing the system logs for AUTH events
    
    Trivial change, adding AUTH to viewlog template only.
    
    Test plan:
    Look for the Authentication log lines in viewlog.pl (intranet tools).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jon Knight <J.P.Knight@lboro.ac.uk>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8a049803665d3e600f19ae70158c53132ec5a505
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 25 09:55:32 2019 +0000

    Bug 21190: Add authentication logging to checkpw
    
    Add optional logging for successful and failing login attempts in
    checkpw.
    
    Test plan:
    Enable the preferences
    Perform a good login and a bad attempt
    Check action_logs
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jon Knight <J.P.Knight@lboro.ac.uk>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c0f615fe533b802dec0e4a49923556e117ceca78
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 25 09:36:03 2019 +0000

    Bug 21190: Introduce preferences AuthFailureLog and AuthSuccessLog
    
    Test plan:
    Run atomic update.
    Check the Logs tab of preferences.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jon Knight <J.P.Knight@lboro.ac.uk>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2598feedb90faedf31e12c0f1f90e7707b11f846
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 25 08:21:20 2019 +0000

    Bug 21190: Remove t/Log.t
    
    Since we have t/db../Log.t and t/Log.t simply does nothing, we would
    better remove it.
    
    No test plan either :)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jon Knight <J.P.Knight@lboro.ac.uk>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 467dbcc60962dcef31c109a4efb93e2085af6696
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 25 08:10:18 2019 +0000

    Bug 21190: Add interfaces parameter to POD in C4::Logs
    
    Just fixing documentation along the way.
    No test plan, just read the patch.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jon Knight <J.P.Knight@lboro.ac.uk>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 135ab4c26ad8f32f4aed291578145b82574ab075
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 25 07:32:56 2019 +0000

    Bug 21190: Add subtest to Log.t for GDPR logging
    
    Apart from a new subtest, doing some more cleanup:
    [1] Copyright statement
    [2] Removing the (unneeded) flush
    [3] Removing C4::Log from the BEGIN block; we seem to skip that nowadays.
    [4] $succes goes to the subtest, $schema and $dbh are global our vars.
        Not required but just what we should do if it would run under Plack.
    
    Test plan:
    Run t/db_dependent/Log.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jon Knight <J.P.Knight@lboro.ac.uk>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1709388c3a9c59f8d5bcd9d73add2236acdda84f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 25 07:14:18 2019 +0000

    Bug 21190: Prepare Log.t for further changes
    
    This patch only makes cosmetic changes:
    [1] It moves the existing tests at 'root level' inside a new subtest.
    [2] It obviously adds indentation for step 1.
    [3] It fixes some whitespace (tabs, space before newline)
    
    Test plan:
    Run t/db../Log.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jon Knight <J.P.Knight@lboro.ac.uk>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 51dbb84a78e7ad833ab2ce6104ed54954ded6835
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 31 16:39:12 2020 +0200

    Bug 25027: Use localStorage instead of sessionStorage for results browser
    
    Staff side, when a search a done and a result clicked, a browser appears
    on the left, to navigate between the different results.
    
    We use sessionStorage to know the list of biblionumber from the result.
    
    As sessionStorage is only for the current tab, we do some ugly things,
    to catch the click events, then open the new tab, attach it to the
    current window, and put the focus back on the result list.
    
    We really should not do that, and let the user decide what they want to
    do with their clicks!
    
    To do so, let use the correct storage, localStorage, and have the
    results shared between the windows.
    
    We may need to clear that at some point, isn't it?
    
    Test plan:
    Launch a search, click result (left or middle), confirm you see the
    browser and that the window/tab opened like any other websites
    (depending on your web browser settings).
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 30ea935720f8848be8a9a467d9dda89275d4557b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 14 15:54:17 2020 +0100

    Bug 20754: (RM follow-up) Fix DB Update
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1cae1929d366d16e36f7a777537bbef9a906d62c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Apr 14 08:53:15 2020 -0300

    Bug 25044: (follow-up) Fix wrong tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ca46310b26e2f2f1f048b76aae8bdf63058dd029
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 14 11:08:32 2020 +0100

    Bug 22534: (RM follow-up) Remove errant hidden file
    
    An nfs share file got commited by mistake :(
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d13fbc0bdad3b9b75f112ca0de5a26d8f4bdc193
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 14 09:13:17 2020 +0100

    Bug 23173: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 65c5407d41fd5ba8a37f163b1a02e9c5a8cfa9f8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 2 16:03:17 2020 +0200

    Bug 25044: Remove the need to define koha_object[s]_class for standard object class names
    
    In Koha::Object[s]->prefetch_whitelist, there is a call to the koha_object[s]_class DBIC resultset class. We should not, otherwise those 2 methods will have to be defined all the time, even when we can guess it easily.
    
    Koha::Item <> Schema::Result::Item => standard
    Koha::Acquisition::Order <> Schema::Result::Aqorder => non-standard
    
    sub _get_object_class {
        my ( $type ) = @_;
        return unless $type;
    
        if( $type->can('koha_object_class') ) {
            return $type->koha_object_class;
        }
        $type =~ s|Schema::Result::||;
        return ${type};
    }
    
    Test plan:
     % prove t/db_dependent/Koha/Object.t t/db_dependent/Koha/Objects.t
    should return green before and after this patch
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 81c141d41aef41d2dbdd50b1874f4964b83d6767
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Mon Apr 13 01:22:07 2020 +0000

    Bug 20370: Misleading comment for bcrypt - #encrypt it; Instead it should be #hash it
    
    This patch changes the wording of the comment
    
    To test:
    
    1) Check the wording of Line 67 of Koha/AuthUtils.pm
    2) Apply the patch
    3) Check that the wording has changed from "Encrypt it" to "Hash it"
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 967c781259ead4367b55cc37bf50938b1d7c984e
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Thu Apr 9 15:50:04 2020 +0000

    Bug 24993: fix increment
    
    Aparently ((i++)) isn't portable, changed for an admittedly uglier
    but functional increment.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a9ee30774a748e23e315228b9c706acf80cc9a38
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 8 11:57:06 2020 +0200

    Bug 24993: Make sure we are not going to loop indefinitely
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 51e504cbfe2fe046da840a4c23090d476fcdb6f8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 2 12:36:16 2020 +0200

    Bug 24993: Make sure SIP server is stopped before restarting it
    
    Sometimes doing koha-sip --restart instance happens too fast and
    the SIP server is not started.
    
    To test:
    - have SIP enabled and running for your instance
    - issue a restart, make sure it restarts
      sudo koha-sip --restart inst
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0004816118483dc132c98d27c417f1b59255441f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Mar 30 10:06:43 2020 -0300

    Bug 25008: Overload Koha::RecordProcessor->options to update filters
    
    This patch overloads the 'options' accessor generated by Class:Accessor.
    It does so the passed options are used to refresh the loaded filters.
    
    Tests are added for this overloaded method as well.
    
    To test:
    1. Apply this patches
    2. Run:
       $ kshell
      k$ prove t/RecordProcessor.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7bcfa8219739312f60eb2e36f642d7ac685d9879
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Mar 30 10:20:11 2020 -0300

    Bug 25008: Tests for ->options
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12243e35962e09b04fd247150477cbc2cfda7254
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Mar 27 17:53:32 2020 -0300

    Bug 25008: Regression tests
    
    This patch highlights a behaviour of Koha::RecordProcessor that is
    unexpected: if you change the original options using ->options, the
    loaded filters don't pick the change. That's because the filter objects
    are loaded on ->new, and they are never updated.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/RecordProcessor.t
    => FAIL: Test prove ->options doesn't update the filters!
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d9842a7cc969571c53c9e1fafdc145bbd6036c7
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Thu Mar 26 22:46:26 2020 +0000

    Bug 24764: TinyMCE shouldnt do automatic code cleanup when editing HTML in News Feature
    
    TEST PLAN:
    1. Make a new news item and use the TinyMCE editor, click on the <> icon to go to the Source code editor
    2. Add some HTML like <i class="fa fa-facebook-official" aria-hidden="true">TEST</i> and save it.
    3. Go back in and notice that TinyMCE has changed it to: <p><em class="fa fa-facebook-official">TEST</em></p>
    4. It should not auto clean up and also it should not autowrap with <p> tag.
    5. Apply patch patch, and repeat step 2. Save again.
    6. It should not have automatiicly changed any HTML or added any <p> wrapper.
    
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit daf033945746edb60d7b76ab69204d1e859fe3ed
Author: Marcel de Rooy <mdry@live.nl>
Date:   Thu Mar 19 14:39:14 2020 +0100

    Bug 24903: Add tests for _handle_seqno
    
    Trivial tests.
    
    Test plan:
    Run t/Serials/ModSerialStatus.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d54376a52374a2b83eadd40dd35d8bbfcba2de63
Author: Marcel de Rooy <mdry@live.nl>
Date:   Thu Mar 19 14:20:38 2020 +0100

    Bug 24903: Special characters like parentheses in numbering pattern cause duplication in recievedlist
    
    Test plan:
    Use serial with a numbering pattern with parentheses like "2018 (No. 1)".
    Mark serial issue as arrived, check receivedlist on summary.
    Edit issue again, check if not duplicated on receivedlist.
    Mark issue as missing or not available, check missinglist.
    Mark missing issue as not missing, check list again.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Laurence Rault <laurence.rault@biblibre.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0e2119570d9c8deb0b15b8bff92975cfdfa5c3f4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 7 13:25:09 2020 +0200

    Bug 25038: Fix tabs on the OPAC reading history view
    
    OPAC reading history table has three tabs for different checkout types: All, Checkouts, On-site checkouts.
    
    However, all of your checkouts are visible every tab regardless of checkout type.
    
    Test plan:
    1. Enable OnSiteCheckouts system preference
    2. Perform two checkouts: one normal checkout, one on-site checkout
    3. Go to OPAC /cgi-bin/koha/opac-readingrecord.pl
    4. Observe your checkouts all are visible in first tab
    5. Select second tab and notice that the table is now filtered
    6. Same with third tab
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Lari Taskula <lari.taskula@hypernova.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3336147258cd71c446026919469ba052a62b6bac
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Apr 10 06:43:51 2020 -0400

    Bug 24966: Add unit tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ed69870da5253a3cca853d841d2e3adb844b31fb
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Apr 10 09:50:13 2020 +0000

    Bug 24966: (QA follow-up) Fix return value of hold_patron_bcode
    
    It is used in list context, but we need a scalar value.
    Can be fixed by adding scalar's, or returning empty string as here.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3dd79180f33bcdf810251638ae3984cbc832e024
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 3 11:16:39 2020 +0100

    Bug 25040: monkeypatch Schema::Loader for recent MariaDB
    
    Recent versions of MariaDB changed the output of 'DESCRIBE' for
    timestamp columns with defaults from `CURRENT_TIMESTAMP` to
    `current_timestamp()`.  As such the code inside
    DBIx::Class::Schema::Loader which catches such cases and outputs
    `\"current_timestamp"` as a sensible cross platform default is missed
    and this leads of inconsistent class files and bugs with out default
    lookup code in Koha::Objects.
    
    This patch serves as a backport of the code I have submitted upstream
    such that out developers can continue to use update_dbix_class_files.pl
    to build their schema classes from the database and regardless of their
    db server version get a consistently correct output.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9ac2ddda0b1506ea09a7c95a98926ea9e9c36bcf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 6 12:44:13 2020 +0200

    Bug 25069: Fix AddressFormat="fr" behavior
    
    Something went wrong during a rebase of bug 13618
      commit dcd1f5d48c758aee17b6c6f069c6146b42efe117
      Bug 13618: Add html filters to all the variables
    
    Several changes related to AddressFormat are wrong:
    
    -    [% IF Koha.Preference( 'AddressFormat' ) %]
    -        [% INCLUDE "member-main-address-style-${ Koha.Preference( 'AddressFormat' ) }.inc" %]
    -    [% ELSE %]
    -        [% INCLUDE 'member-main-address-style-us.inc' %]
    -    [% END %]
    +    [% SWITCH Koha.Preference( 'AddressFormat' ) %]
    +        [% CASE 'de' %]
    +            [% INCLUDE 'member-main-address-style-de.inc' %]
    +        [% CASE # us %]
    +            [% INCLUDE 'member-main-address-style-us.inc' %]
    +     [% END %]
    
    Test plan:
    Create a patron with all the address fields filled
    Play with the 3 option values of AddressFormat, and confirm that the address is displayed correctly
    on the patron's view, and in the patron module (top left)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9e2f3200eaf2d09c0124fbf506d114b95b2f1920
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 7 13:32:51 2020 +0200

    Bug 25005: (bug 22868 follow-up) Fix suggestions pending on main page
    
    There is a "Suggestions pending approval" link on the main page that is
    displayed if there are new suggestions and the logged in user has the
    permission to manage them.
    
    On bug bug 22868 the permission changed from
    acquisition.suggestions_manage to suggestions.suggestions_manage
    
    But in the template, one occurrence has not been replaced correctly
    (certainly because it was already wrong actually).
    
    Test plan:
    Create a suggestion at the OPAC
    Create a patron with the suggestions permission
    Use this patron to login at the staff interface
    => Without this patch the link does not appear on the main page
    => With this patch applied the link appears
    
    Signed-off-by: David Roberts <david@koha-ptfs.co.uk>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 25966df4d7164e931e35ae5a640ae85eb2644ce3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 11 13:01:52 2020 +0100

    Bug 24800: Handle inexistent return date on self checking
    
    See bug 24800 comment 0 for a description of the problem.
    
    We do not want the SIP server to crash if it receives a checkin request
    with a return date that is not given.
    
    The option this patch chose is to parse it only if provided.
    
    Signed-off-by: Clemens Elmlinger <clemens.elmlinger@bsz-bw.de>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a57efe865921c4d4945245d3970b3391490de249
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 11 12:56:41 2020 +0100

    Bug 24800: Add tests
    
    Signed-off-by: Clemens Elmlinger <clemens.elmlinger@bsz-bw.de>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a22315ef6153d5c64b4dfd763cf6802a3035e941
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 3 12:14:27 2020 +0000

    Bug 25050: Adjust marc_records_to_documents to search entire mapping array
    
    There was an assumption in the ES code that match-heading mappings will appear in
    a specified portion of the mappings array.
    
    Certain mappings setups will not meet this assumption.
    We need to move our searching up one level
    
    The key seems to be having a mapping for a complete field, say 150, in both the
    match-heading and another field as well as having mappings for ungrouped fields like
    150a 150ab etc.
    
    The unit test coverage should be sufficient for testing
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f7cb46560322ef77858c6f489ae332962942616d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Apr 3 12:12:49 2020 +0000

    Bug 25050: Unit tests
    
    This patch simplay alters the data we use for the tests, doing so causes them to fail
    
    To test:
    1 - Apply only this patch
    2 - prove -v t/Koha/SearchEngine/Elasticsearch.t
    3 - It fails!
    4 - Apply next patch
    5 - It passes!
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f406aa2ae35c0d49a91316d00a4fca0cd0109c5c
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Mar 16 22:09:51 2020 +0000

    Bug 24266: (alternate patch) Only use defined borrowernumbers in reconcile_balances.pl cron
    
    I believe the error is triggered when borrowernumbers are left empty in
    the accountlines table. Not sure why this would happen, but it appears
    to be what causes the problem.
    
    Do not apply the first patch if testing this patch.
    
    To test:
    1) sudo koha-mysql INSTANCENAME
    2) Create a test borrower, add any payment etc to create an accountline,
        then delete this borrower
    3) ensure the AccountAutoReconcile syspref is disabled
    4) Go to another borrower's accounting tab
    5) Create a manual credit or debit. Confirm this shows in the 'Make a
    payment' tab as an amount that COULD be applied, but isn't automatically
    applied
    6) in your terminal, run the reconcile_balances.pl script
    7) Confirm the error does not show in the logs and the balance for
    the borrower is correctly reconciled.
    
    Sponsored-by: Horowhenua District Council
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04e4656cd252759efae3606b8e368cfab1dbff5f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Apr 9 08:24:44 2020 -0400

    Bug 25095: Remove warn left in FeePayment.pm
    
    It appears that a debugging statement was accidentally left in FeePayment.pm by bug 5605.
    
    Signed-off-by: Devinim <kohadevinim@devinim.com.tr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f5447b33de9ded3868d97fcf033c7acda33cc168
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 8 10:52:23 2020 -0400

    Bug 22778: Add unit test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 94ed64e5b1e348fcd06d2d41b880c52b6822df57
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Apr 25 15:50:35 2019 -0400

    Bug 22778: Suggestions with no "suggester" can cause errors
    
    If one tries to modify a suggestion that has no suggester you will get the following error:
    
    Can't call method "lang" on an undefined value at /usr/share/koha/lib/C4/Suggestions.pm line 506
    
    Koha assumes that every suggestion has a borrowernumber in suggestedby
    
    Test Plan:
    1) Create a suggestion with an unpopulated suggestedby
    2) Attempt to modify that suggestion
    3) Note the error
    4) Apply this patch
    5) Restart all teh things
    6) Attempt to modify that suggestion
    7) No error!
    
    Signed-off-by: David Roberts <david@koha-ptfs.co.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 479474e532dca6ded90770fc7a0c00500ea4f787
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 8 16:11:54 2020 +0200

    Bug 24027: Add POD about the new parameter in Koha::Item->store
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6fa71e82f80c838f4182587f691d1c329a0941bd
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Apr 8 10:17:32 2020 -0300

    Bug 24027: (QA follow-up) Fix POD warning
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3eec846d7f49c39cb4b4079818eeb42268aca769
Author: Andrew Nugged <nugged@gmail.com>
Date:   Mon Apr 6 19:11:35 2020 +0300

    Bug 24027: Call ModZebra once after all items added/deleted in a batch
    
    Issue description:
    - call to ModZebra was unconditional inside 'store' method for Koha::Item,
      so it was after each item added, or deleted.
    - ModZebra called with param biblionumber, so it is the same parameter
      across calls for each items with same biblionumber, especially when we
      adding/removing in a batch.
    - with ElasticSearch enabled this makes even more significant load
      and it is also progressively grows when more items already in DB
    
    Solution:
    - to add extra parameter 'skip_modzebra_update' and propagate it down to
     'store' method call to prevent call of ModZebra,
    - but to call ModZebra once after the whole batch loop in the upper layer
    
    Test plan / how to replicate:
    - make sure that you have in the admin settings "SearchEngine" set to
      "Elasticsearch" and your ES is configured and working
      ( /cgi-bin/koha/admin/preferences.pl?op=search&searchfield=SearchEngine )
    - select one of biblioitems without items
      ( /cgi-bin/koha/cataloguing/additem.pl?biblionumber=XXX )
    - press button "add multiple copies of this item",
    - enter 200 items, start measuring time and submit the page/form...
    
    On my test machine when adding 200 items 3 times in a row (so 600 in
    total, but to show that time grows with every next batch gradually):
    
    WHEN ElasticSearch DISABLED (only Zebra queue):
    - 9s, 12s, 13s
    WHEN ElasticSearch ENABLED:
    - 1.3m, 3.2m, 4.8m
    WITH PATCH WHEN ElasticSearch ENABLED:
    - 10s, 13s, 15s
    
    Same slowness (because also same call to ModZebra) happens when you try
    to delete all items ("op=delallitems"). And same fix.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aa967afa8ec12988a8118ba3b41dd3df3f3fe18f
Author: Theodoros Theodoropoulos <theod@lib.auth.gr>
Date:   Wed Apr 8 08:21:12 2020 +0100

    Bug 23514: Split Call Numbers for all layout types
    
    This patch ensures call numbers are properly split for layout types
    other than 'BAR'.
    
    Test plan:
    
    1. Go to Label Creator and choose/create a Label Layout with "Choose
    layout type: Biblio"
    2. make sure you have at least "itemcallnumber" in Bibliographic data to
    print/Data fields
    3. check "Split call numbers" box and save the layout (ie testlayout)
    4. create a label batch, using items that have a call number (ie
    DC611.B848 H84 1997). LCC is used here, but you may try with Dewey as
    well.
    5. export selected batch using any template and the layout you created
    in previous step to a PDF
    6. Call numbers are splitted (as expected) in the resulting PDF file
    7. edit the layout you created in the previous step (ie testlayout) and
    change the  "Choose layout type:" to either Biblio/Barcode (BIBBAR) or
    Barcode/Biblio (BARBIB)
    8. export the same batch using the same template and layout as before
    9. Call numbers are NOT splitted at all
    
    After patch is applied, call numbers splitting functions are applied
    even in Biblio/Barcode (BIBBAR) or Barcode/Biblio (BARBIB) layout types.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 78b67d21c5f15bccdc7ae8f180d4f0a266196e9f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 8 13:18:46 2020 +0100

    Bug 7046: (RM follow-up) Add Filters
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 94ec55d767cd9a61368757154e36e6e0d5bcafcf
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 8 10:43:54 2020 +0100

    Bug 24840: (follow-up) Catch some further cases of DateTime->now
    
    This patch corrects a few additional cases where DateTime->now is called
    directly instead of via Koha::DateUtils.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6ac037f817def256c85706413036bee3f78ed40e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Mar 26 11:05:32 2020 +0000

    Bug 24840: Replace DateTime->now with dt_from_string
    
    We should use Koha::DateUtils instead of Date::Time directly
    
    This patch simplay replaces calls to now() with a call to dt_from_string()
    which does effectively the same thing.
    
    Probably reading the code and verifying changes is sufficient but...
    
    To test:
    1 - confirm the files all compile
    2 - confirm all tests pass
    3 - confirm Koha still works
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c878a9e825ab740c2d1bc820875485cc816ed492
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 8 11:45:51 2020 +0200

    Bug 25081: Fix wrong comment
    
    Not directly related to previous patch, coming from 23435.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bb527d54f598f91e4373282032fbc1ab9b0515d3
Author: Janusz Kaczmarek <januszop@gmail.com>
Date:   Tue Apr 7 22:23:20 2020 +0200

    Bug 25081: Fix creation of new item for a received issue
    
    The Bug 23435 introduced the idea of multiple copies added while
    receiving a new issue.  Unfortunately, under some circumstances, it
    causes no items being added at all.  It occurs stochastically, only
    under some conditions.  But it is quite likely to happen while receiving
    a supplemental issue.
    
    The reason fot hist is that, in serials-edit.pl, line ca 292 and infra,
    @num_copies is treated in the same way as @tags, while it should be
    treated similarly to @bibnums.  It will be obvious after examining the
    content of parameters tag, subfield, field_value, ..., number_of_copies.
    In other words, for every edited issue number_of_copies is a scalar.
    
    Nota bene:
    a) beter to initialize $countdistinct with zero;
    b) note that in master, now, before applying the patch,
    $itemhash{$item}->{'num_copies'} is treated once as a scalar
    and in the next line--as an array:
    
    $itemhash{$item}->{'num_copies'} //= 1;
    
    for (my $copy = 0; $copy < $itemhash{$item}->{'num_copies'}[$index];){
    
    TEST PLAN
    =========
    1. Have a subscription with the option "Create an item
    record when receiving this serial" active and try to receive a
    supplemental issue.  Control that a new item under the biblio record
    (usually) will not be created.
    2. Apply the patch.
    3. Repeat p. 1 -- a new item should be created.
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 947b16b322b9fe719a1bef6c25d4172db3d7cc8e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 27 12:01:05 2020 -0400

    Bug 22937: Add hint to groups editor
    
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b3e15a720578b2f03ffea818bac4df585741b1a1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 8 11:28:31 2020 +0200

    Bug 25046: Add test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77457a496a43d9d3bd0330d2ed511b0d1388d8b0
Author: Andreas Roussos <a.roussos@dataly.gr>
Date:   Thu Apr 2 19:14:57 2020 +0200

    Bug 25046: Include borrowers.othernames in SELECT statement
    
    In C4/Utils/DataTables/Members.pm, the SELECT statement that fetches
    patron data from the database does not include borrowers.othernames
    in the field list. As a consequence, when the output is in the form
    of a DataTable, the Template Toolkit files that refer to .othernames
    (such as the patron-title.inc include) won't display the information
    from the 'Other name' input field if that field has been filled in.
    
    This patch fixes that.
    
    Test plan:
    0) Have a few patrons with some data in the 'Other name' field.
    1) Perform a generic search in Home > Patrons to ensure you will get
       a DataTable with results.
    2) Observe that the 'Name' column does not include 'Other name' info.
    3) Apply the patch, and restart Plack if necessary.
    4) Repeat your search: this time you should see the information from
       the 'Other name' field, it will be next to the patron's First name
       and within parentheses.
    
    Sponsored-by: Eugenides Foundation Library
    Signed-off-by: Devinim <nazli@devinim.com.tr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c88c8e5322d1205ca4e39409b34f8d02311182ad
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 8 10:42:41 2020 +0200

    Bug 7046: Preselect dropdown option and prefill input
    
    With previous renew values
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d132c10bfcff87b117ff454bb431fdbd1f08c92c
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Mon Nov 27 15:31:35 2017 +1300

    Bug 7046: Implemented subscription renewal dropdown sub length element
    
    To make this work I moved the _get_sub_length function from
    subscription-add.pl to C4/Serials.pm so that the subscription-renew.pl
    script could also call it to store the sublength for the appropriate
    field of the subscriptions database table.
    
    Test plan:
    1. Create a subscription and notice that there is a dropdown box for sub
       length containing the values: issues, weeks, months
    2. Renew the subscription and notice that there are 3 input text boxes:
       'number of num', 'number of weeks' and 'number of months'
    3. Input a 'Number of weeks' value of 2
    4. Query the subscription database table and notice that the value of 2
       has been stored in the weeklength field for the subscription record you
       just renewed
    5. Apply the patch
    6. Renew the subscription and notice that there is now a sublength
       dropdown box containing issues, weeks and months
    7. Set the month value to 3
    8. Query the database and notice that 3 was stored in the monthlength
       field for the subscription record
    9. Create a new subscription and select the sub length values of issues
       and 3
    10. Query the database and notice that the numberlength field for the
       subscription you just created is set to 3 showing that the sublength
       dropbox is still working for creating a new subscription
    
    Sponsored-By: Catalyst IT
    Signed-off-by: Dilan Johnpullé <dilan@calyx.net.au>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e925568a3067e77173f4d21f476b28f8aa068571
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 11 16:21:06 2020 +0100

    Bug 24826: Remove warnings from Sendmail
    
    Use of uninitialized value $mail{"Cc"} in substitution (s///) at /usr/share/perl5/Mail/Sendmail.pm
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9789a43025d139d4d0b872fa0b51c0dc1df0d7dc
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Fri Apr 3 15:23:01 2020 +0000

    Bug 24940: Serials statistics wizard: order vendor list alphabetically
    
    This patch changes the dropdown from being sorted by aqbookseller.id to
    aqbookseller.name
    
    To test:
    1) Add at least 2 vendors:
     - First: ZZZZ
     - Second: AAAA
    2) Add subscriptions for each of the vendors
    3) Check the pull down in the serials statistics wizard and verify it
    lists them as ZZZZ, AAAA
    4) Apply the patch
    5) Re-check the pull down in the wizard and check that the vendors are
    now listed AAAA,ZZZZ
    
    Signed-off-by: Devinim <kohadevinim@devinim.com.tr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit df58c3e2c9af7b0218f6db957dbb781f0cb1f278
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Mar 30 09:39:13 2020 -0300

    Bug 25019: Make the ViewPolicy filter initialization standard
    
    This patch makes the ViewPolicy filter use the 'params' accessor instead
    of relying of ->{options} which has no accessor. This will allow
    interacting with the filter object be similar through all the filters in
    the chain.
    
    To test, we just need to verify no behaviour change takes place:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/Filter_MARC_ViewPolicy.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat 1
    => SUCCESS: Tests still pass!
    4. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2f2db163bd108e165b2e54a7258ec1176c213285
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 3 11:42:59 2020 +0200

    Bug 25041: Restore #ASKED anchor in suggestions table
    
    On commit 4494e8ba6ca7d28972fcc1161c680ecf0b091f62
       Bug 23594: Batch modification for itemtypes on suggestions page
    The anchors of the tabs on suggestion.pl has been replaced with
    tab_$count instead of the status code.
    There was a need at the time, but I cannot remember it.
    I restored the previous behavior, and did not find any regressions.
    
    Test plan:
    1 - Add several suggestions to Koha
    2 - Set them in different status, leaving at least one pending
    3 - Go to home page, note it shows count of pending
    4 - Click the link on home page
    5 - It takes you to correct tab
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bad8c7089addceca18aacae14d9b7ed30a4722aa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 8 08:47:49 2020 +0200

    Bug 24801: (follow-up) Display all the libraries - Selenium fix
    
    We have it failing now for the delete link..
    14:26:50 selenium_1   | 05:26:50.451 WARN - Exception: Unable to locate element: {"method":"xpath","selector":"//*[@id=\"delete_library_UT_BC\"]"}
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2633796e1fd68c6f8f4af0d81085ad89d6d0799b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 7 12:43:43 2020 +0100

    Bug 23355: (RM follow-up) Restore lost ID's
    
    Some ID's were lost during a QA followup, this patch restores them.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f8d173cb1529f02dc1be860189583e9cc642096f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 6 13:02:54 2020 +0100

    Bug 4944: (RM follow-up) Add OpacNoItemTypeImages to UsageStats test
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c80ced404fa0eff291509b42280c81b7d23d0ad6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 6 12:28:36 2020 +0100

    Bug 20754: DBRev 19.12.00.067
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 875108d46e0dacec4221261a29e680023fa5167d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 4 10:42:38 2018 +0200

    Bug 20754: DB revision to remove double accepted shares
    
    [Originally submitted for bug 11943, parked at 20754.]
    [Attempt to revive it now.]
    
    Although it is no problem to have them, we could do a cleanup.
    This patch just removes duplicate rows from the table.
    
    Note: I considered adding a unique index like:
        ALTER TABLE virtualshelfshares ADD UNIQUE INDEX (shelfnumber, borrowernumber, invitekey);
    But the possible NULL values in borrowernumber and/or invitekey require
    additional code changes. So I left it alone.
    
    Test plan:
    [1] Create two records with same borrowernumber and shelfnumber in the shares
        table, if not present already.
    [2] Run updatedatabase.pl
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da3606ac3ff10df6fb111d96070d6d33d0b37f34
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Feb 6 16:15:43 2020 +0100

    Bug 24604: Add 'Pay' button under Transactions tab in patron accounting
    
    It does the same thing as the 'Pay' button under 'Make a payment' tab.
    It is nothing more than a shortcut.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ce940939d445aad121a6b48f72c6c93bd79c0157
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 6 11:25:02 2020 +0100

    Bug 4461: DBRev 19.12.00.066
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a5301a99ab015423fe9315eb5e7ccbf25aa9f118
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 3 15:06:53 2020 +0200

    Bug 4461: Use inbound_email_address to know if we display the dropdown list
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c98d6f14ee588e5648c97ad75dfa07d0a719739f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 3 13:52:12 2020 +0200

    Bug 4461: Correctly deal with encoding/escaping chars
    
    This patch deals (hopefully) correctly with encoding and escaping chars.
    It also remove OPACBaseURL from the url stored in DB, and readd is on
    display, to avoid possible attacks.
    
    Test plan:
    Go to the authority search
    fill term with something hacky
    <script>alert('booh!')</script>And Ŝ♥m€ E★tr₳
    Search
    Click the "Report a problem" link
    Fill the form and make sure the url is displayed correctly
    submit
    Check problem_reports.problempage in DB => Should be correctly displayed
    Go to staff interface, "OPAC problem reports"
    => Confirm the link is correctly display
    Click it
    => Confirm that you are at the OPAC, and the URL is correct
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0885344e8056f34dd2cd9f38626fcaf321dda961
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 3 14:40:16 2020 +0200

    Bug 4461: Extend problem_reports.problempage to TEXT
    
    255 chars is not enough if want want to store any kind of URL, for
    instance an authorities search can be much longer
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bbb72bbd8d0b43c5b16401ee3c27a60fcc089093
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 3 14:39:45 2020 +0200

    Bug 4461: dbic schema update
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fb1bdea6d1eefba754d0eb384a8c2e4b03ffd150
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Apr 3 14:04:38 2020 +0200

    Bug 4461: Hide link if KohaAdminEmailAddress is not set
    
    opac-reportproblem.pl returns a 404 in that case
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d6134c29174494e5fd85cb1d3c2a8f733c769a8f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 2 12:51:39 2020 +0200

    Bug 4461: Fix OPAC link from staff
    
    QA: We have a security issue here, we should not make this link
    clickable from the staff side.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 01c3067a7ca66e358b89ddf34eb08b48df0c5d1b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 2 11:25:31 2020 +0200

    Bug 4461: get_effective_email has been renamed inbound_email_address
    
    On commit 027051c938924a33a64014794705526ab68351af
       Bug 22823: Rename method with ->inbound_email_address
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3509f9cff86da2faea2ccc53ecdd0fdee70366c5
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Mar 18 22:50:50 2020 +0000

    Bug 4461: Fix status and borrowernumber fields in problem_reports and more
    
    status varchar(6) with readable statuses
    borrowernumber not null default 0
    hide form if message successfully sent
    fixing hide viewed and hide closed filters
    adding recipient column
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dcc93ec356dbc5a4a94b3e9f63a9c4073a3f4176
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 11 09:08:52 2020 +0000

    Bug 4461: DBIC Schema Files
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b8b2301f1320c2b7978b202cd1d196ae838dd8b5
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Mar 19 00:26:33 2020 +0000

    Bug 4461: Checks on library email before enqueuing letter
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f12da2c1dd7333578324b2e9b6a5e78190a1e7f6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 12 12:51:27 2020 +0100

    Bug 4461: Update license statements
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fefb95b2e7cba0a0bfd47eacae92c1319ad5d496
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 11 09:06:09 2020 +0000

    Bug 4461: (follow-up) Add missing relationship accessor
    
    I think this was a simple case of Aliesha missing a file when commiting.
    
    So I could proceed with testing I just quickly re-implimented the patron
    relationship accessor.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 185adc167433133626710edd296555db2d27865c
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Mar 11 01:52:27 2020 +0000

    Bug 4461: Manage problem reports on the staff client
    
    Test plan:
    
    - Update database and upgrade schema files (if you haven't already).
    Restart memcached
    - Check your user's permissions and ensure the 'problem_reports'
    permission is ticked. Confirm the OPACReportProblem syspref is enabled
    - Log into the OPAC and submit a problem report
    - Log into the staff client
    - You should see a box at the bottom of the main page showing your
    pending problem report
    - Click the link and confirm it takes you to the new page for managing
    problem reports
    - Go to Administration
    - Confirm you can see a link to 'OPAC problem reports' under the
    'Additional parameters' heading
    - Click 'OPAC problem reports'
    - Confirm your problem report is showing in the table
    - Open the OPAC in another tab and submit at least two more problem
    reports (so you should have at least three in the table after
    refreshing)
    - Try the different buttons
        - selecting multiple problem reports and using the big 'mark
        viewed', 'mark closed', 'mark new' buttons. Confirm there are no
        failures and that the number of selected problem reports is correct
        - select all, clear all, hide viewed, hide closed, hide new, show
        all
        - individual 'mark viewed', 'mark closed', 'mark new' buttons for
        each problem report. Confirm the status shows and the correct button
        is disabled while others are enabled
    - Confirm the problem page link works as expected
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12d2d3f69bbd04889e21ccd4568a1b40dadfad2c
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Mar 10 22:52:29 2020 +0000

    Bug 4461: Add problem reports link to mainpage and admin home
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c95ae98d6085495e055d6d6775fb8e0acc1e1cc5
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Mar 10 22:27:56 2020 +0000

    Bug 4461: Adding user flags for managing OPAC problem reports
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 282b85ef69b7e1fb55409d609e870832383ef710
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 2 15:18:33 2020 +0000

    Bug 4461: Use get_effective_email from bug 22823
    
    Use the get_effective_email from Koha::Library to get an appropriate
    inbound address for the branch as aposed to using branchemail directly.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc8f2d261bbf6a1850c9f8fa2de230550e27a616
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 2 15:16:37 2020 +0000

    Bug 4461: Drop 'from_address' use 'reply_address'
    
    This patch adds support for using the reply-to field added in bug 10269
    and drops 'from_address' as it will get defined at a later stage in the
    emailing process anyway.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7de7d4095a6092bc4b3dacd1f2e3b5c616fc572f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 2 14:58:15 2020 +0000

    Bug 4461: Remove hard requirement on OpacKohaUrl
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ffb5a071cbf8a5d54ecfcf26994fd0349b994180
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 12:15:42 2020 +0100

    Bug 4461: Better error handling
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d198aaec04d5dc9ee26a702fb81fdad62d4edde6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 11:59:34 2020 +0100

    Bug 4461: Simplify recipients code
    
    As the feature is now turned off without KohaAdminEmailAddress, we only
    need to check if the email address of the library if defined.
    Not that we should not check for $library->branchreplyto or
    ReplytoDefault, but only $library->branchemail, as we do everywhere else
    (I think)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a0775299e2109fb54fef1c104616290a5b2d929e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 11:41:39 2020 +0100

    Bug 4461: Redirect to 404 if KohaAdminEmailAddress is not defined
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7fd92fcce9efdb45cc4fb6f309bfccbd3779a415
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 11:28:30 2020 +0100

    Bug 4461: Use our local_referer instead of HTTP_REFERER
    
    Cannot remember why exactly, but it seems that we should not use
    HTTP_REFERER directly.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fa23374d06f75f47e674cb46298b8e2a8325e404
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 11:08:51 2020 +0100

    Bug 4461: Use KohaAdminEmailAddress pref as 'from'
    
    We usually do not specify the from_address on enqueuing the notice, but
    when sending it (from _send_message_by_email). That way a) the code is
    centralized (as we must use $patron->notice_email_address) and b) the
    email used is the one that is in the DB when the letter is effectively
    sent.
    Here I guess you need to give it when the notice is enqueued as you want
    to default to the koha admin address.
    
    I do not think it's a good idea, we should not send an email with "from"
    if not really sent by the user.
    We have the borrowernumber anyway to know who filled the form.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 499c6e45d271c507a757deb58d9dd42f4323a47d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 10:58:38 2020 +0100

    Bug 4461: Rename report date with created_on
    
    And make it a timestamp type column
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 96883e69b577e1861741d5d5c4ea48d40f4eca1d
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 25 04:04:43 2020 +0000

    Bug 4461: (follow-up) Creating sample notice and other fixes
    
    - filters
    - capitalisation
    - atomic update
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 414da449ddc341624c8ae35ebb1e86f07ecf70fb
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 11 19:48:30 2020 +0000

    Bug 4461: (follow-up) Redirect to 404 if OPACProblemReport not enabled
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d05b4d01c6393c4566fc10d080f14717f881798
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 11 03:16:11 2020 +0000

    Bug 4461: Submit a problem report
    
    To test:
    1) Apply patch, update database, rebuild schema file
    2) Restart koha-common and memcached
    3) Confirm that your user has an email address.
    4) Confirm that your library does NOT have an email address.
    5) Confirm that syspref KohaAdminEmailAddress and syspref ReplytoDefault are not filled. Enable the OPACReportProblem syspref.
    6) Log into OPAC
    7) Click the 'Report a problem' link at the bottom of whatever page
    you're on
    8) Notice that there is no form is and there is an error message alerting that reports cannot be submitted
    9) Add an email address for your library (in either the email field or the replyto field). Refresh the OPAC problem report page. The form should now show, and the recipient field should say 'library'.
    10) Complete the form and submit. Check the message_queue in the database and confirm the to_address is correct. Confirm there is a success message.
    11) Add an email address for the syspref KohaAdminEmailAddress and refresh the OPAC problem report page again. The recipient field should now be a dropdown. Select the Koha Administrator option.
    12) Complete the form and submit. Check the message_queue in the database and confirm the to_address is the value in KohaAdminEmailAddress. Confirm there is a success message.
    13) Ensure all details in the message_queue are correct.
    14) Log out of the OPAC
    15) Click the Report a problem link again and confirm you are forced to log in
    
    Sponsored-by: Catalyst IT
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5877fcf2c9caacfb7c0417403a2bdf209c94e230
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 11 00:00:11 2020 +0000

    Bug 4461: Problem Report Koha objects
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87c3a1fa6316552650aacc4699555beafc1be24b
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Feb 10 00:50:51 2020 +0000

    Bug 4461: Database and syspref changes
    
    Adding problem_reports table and OPACReportProblem syspref
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d6d0c4b7921a80ff62336efcd8ca01bf562c0f02
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 6 11:11:12 2020 +0100

    Bug 23173: DBRev 19.12.00.065
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5523fb02734a91aa86d44c2e6aac30050adcc85e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 1 15:13:06 2020 -0400

    Bug 23173: (follow-up) Fix QA script errors
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 910815a49ca0dbec4f31fd8a62ea075ccba269f1
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 1 15:09:48 2020 -0400

    Bug 23173: (follow-up) Small improvements in efficiency
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fb482d2767c7a70d7e60c4bd892aa334447f3938
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Mon Mar 16 12:06:03 2020 +0000

    Bug 23173: (follow-up) Display available partners
    
    When selecting partners for search during the "Place request with
    partner libraries" workflow, there was no indication of which partners
    could actually be searched (i.e. are attached to a Z target and enabled
    for partner search). We now list them
    
    Signed-off-by: Niamh Walker-Headon <Niamh.Walker-Headon@tudublin.ie>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 48e1716a8a5c0bd7de2de7f76fd12c8f18c88715
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Mon Feb 17 12:29:19 2020 +0000

    Bug 23173: (follow-up) Allow for customisable display name
    
    We now allow for the service to return a name that can be specified in
    the plugin config. This patch switches to using that, rather than just
    the plugin name defined in the plugin's metadata hashref
    
    Signed-off-by: Niamh Walker-Headon <Niamh.Walker-Headon@tudublin.ie>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2a2da6c0ea1e323fb3ab5c9a44db45acc906b1b4
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Thu Feb 6 11:08:41 2020 +0000

    Bug 23173: (follow-up) Allow for wide characters
    
    The conversion of the metadata into Base64 for passing in the API call
    to the plugin API routes was failing if the metadata contained a wide
    character, so we now encode it into UTF-8 first
    
    Signed-off-by: Niamh Walker-Headon <Niamh.Walker-Headon@tudublin.ie>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd1d8f35a9330c9edc01627ef806c463ff31db80
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Tue Sep 10 16:32:49 2019 +0100

    Bug 23173: Add unit tests
    
    Test Koha::Illrequests::Availability
    
    Signed-off-by: Niamh Walker-Headon <Niamh.Walker-Headon@tudublin.ie>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f5edd39e612656d7fffbedc29f7112a49cd5999b
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Thu Jul 11 14:15:55 2019 +0100

    Bug 23173: Provide core infrastructure
    
    This patch adds the required infrastructure to enable ILL availability
    plugins to intercept the request creation process and, using the
    supplied metadata, search for and display possible relevant items from
    whichever availability plugins are installed.
    
    Currently three availability plugins exist:
    
    z39.50 - Searches any number of the Koha instance's configured Z targets
    https://github.com/PTFS-Europe/koha-plugin-ill-avail-z3950
    
    EDS - Searches the EBSCO Discovery Service
    https://github.com/PTFS-Europe/koha-plugin-ill-avail-eds
    
    Unpaywall - Searches the Unpaywall API for possible open access versions
    of the requested item
    https://github.com/PTFS-Europe/koha-plugin-ill-avail-unpaywall
    
    The Unpaywall plugin is intended to serve as a "reference" plugin as the
    API it deals with is extremely simple
    
    Signed-off-by: Niamh Walker-Headon <Niamh.Walker-Headon@tudublin.ie>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a592317d864148c80c09d4f3a7d17a2a1506a1ac
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Fri Jun 21 10:17:03 2019 +0100

    Bug 23173: Add ILLCheckAvailability syspref
    
    This patch adds the new syspref "ILLCheckAvailability"
    
    Sponsored-by: Public Health England
    Signed-off-by: Niamh Walker-Headon <Niamh.Walker-Headon@tudublin.ie>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit be853b43039832a9b7a7fbca4b74602b10ec43dc
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Apr 1 00:11:19 2020 -0300

    Bug 18227: (QA follow-up) Add fix to koha-common.postinst
    
    Now koha-common.postinst has a way to patch log4perl configs on
    instances, we should patch the Z3950 responder config accordingly,
    before it is backported to 19.11 or the 20.05 release :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 67daec2e5a3bf3eea207fe8250db43878ed7ffc3
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Wed Mar 8 12:51:43 2017 +0200

    Bug 18227: Handle utf8 in Koha::Logger
    
    No more wide characters in print when logging to a file with Koha::Logger.
    
    Test with this string
    
    "♯Turpo :"
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd55209f251dfbb34a6c95266ea6e0fd4d6580d8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Apr 1 06:19:24 2020 -0400

    Bug 24537: Tidy code
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cede9bbe43f39d44317b7cd9ba742a71d45e67f9
Author: David Cook <dcook@prosentient.com.au>
Date:   Thu Jan 30 14:53:09 2020 +1100

    Bug 24537: Allow IP ranges in ILS-DI:AuthorizedIPs using Net::Netmask
    
    This patch uses Net::Netmask to match IPs from ILS-DI:AuthorizedIPs
    against $ENV{REMOTE_USER}. By using Net::Netmask, we can use addresses
    in a variety of formats. This includes 127.0.0.1, 192.168.1.0/24,
    10.0.0, and so on.
    
    To Test:
    1. Apply the patch
    2. Empty the 'ILS-DI:AuthorizedIPs' system preference
    3. Send a request to '/cgi-bin/koha/ilsdi.pl?service=LookupPatron&id=1&id_type=cardnumber'
    3b. Note that the request is successful
    4. Set the 'ILS-DI:AuthorizedIPs' system preference to a subnet including
    your IP address (e.g. 192.168.1.0/24)
    5. Send a request to '/cgi-bin/koha/ilsdi.pl?service=LookupPatron&id=1&id_type=cardnumber'
    5b. Note that the request is successful
    6. Set the 'ILS-DI:AuthorizedIPs' system preference to a subnet that doesn't include
    your IP address (e.g. 1.1.1)
    7. Send a request to '/cgi-bin/koha/ilsdi.pl?service=LookupPatron&id=1&id_type=cardnumber'
    7b. Note that your request is refused
    8. Try a variety of permutations including bad values (e.g. 192.168.1.) or multiple values
    (e.g. 10.0.0.0/8,192.168.1.0/24) or multiple values including a mix of good and bad values
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2e1e9c5b4846b057ac707f3e5fc84427c1dd71d9
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Mar 30 15:16:36 2020 +0000

    Bug 23601: Prevent default for auxclick
    
    The issue appears to be that the default action is not prevented for middle click because it registers
    an 'auxclick' event as opposed to a 'click' event
    
    To test:
    1 - Perform a search in staff client
    2 - Shift-click and hold on a result
    3 - Note a new tab opens
    4 - Release the click, no change
    5 - Middle click and hold on a result
    6 - New tab opens
    7 - Release, a second new tab opens
    8 - Apply patch
    9 - Reload page
    10 - Middle click and hold
    11 - New tab opens
    12 - Release
    13 - No new tab
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 25fa93a40683870c0e9c0fd96d839878aa2229c6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 6 11:44:18 2020 +0200

    Bug 24964: Restore pagination for patrons for owner/users of funds
    
    admin/add_user_search.pl sets 'patrons_with_acq_perm_only', to only
    retrieve patrons with acq (order_manage) permissions.
    
    The original bug was hidden in the existing code, but the behavior was
    terrible.
    To prevent patrons matching the permissions contrainst to be hidden, we
    fetched ALL the patrons from the DB, then filtered them depending on
    their permissions. This might have awful performance on DB with lot of
    patrons.
    
    So basically with this patch we are adding the pagination back to the
    "owner/users for funds" feature, as the permission filtering is now done
    at DB level.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 57333cda12111dd9582eabaa06069eda2dd154f5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 6 10:56:04 2020 +0100

    Bug 4944: DBRev 19.12.00.064
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7fe2c9147b6dd7a53969204586ca7b7460e30a05
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 31 14:45:14 2020 +0200

    Bug 4944: Do not rely on the values from cache during the update DB process
    
    We never know, as we insert values direcly to the DB, the cache may not
    be correct.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 27dd3feafde45c4a949d63829035885e995120f2
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Mar 27 06:00:29 2020 +0000

    Bug 4944: Add OpacNoItemTypeImages system preference
    
    At the moment noItemTypeImages pref controls staff and OPAC
    display. With this patch, there will be a separate OpacNoItemTypes
    preference that allows to control display of each separately.
    
    To test:
    - Apply patch and run database update
    In Administration:
    - Search for 'noItemTypes' preferences
    - Verify the settings of both prefs match
    - Toggle prefs, verify everything works ok
    - Go to the item types configuration page
    - Try different settings for both prefs:
      - Both set to No: Only a message with a link to the prefs should show
      - Both set to Yes or either set to Yes: image configuration options
        should show
    In the OPAC:
    - Check the following pages with item-level_itypes = record
      - advanced search
      - detail page
      - place hold page
    - Check the following pages with item-level_itypes = item
      - result list
      - a list (opac-shelves)
      - checkouts and overdues tabs in patron account
        (Note: this didn't work right before, but will now.)
      - reading history in patron account
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8cec8d548ce2924eaf4cc9a668ed7f9b7258460e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 6 10:48:09 2020 +0100

    Bug 22534: DBRev 19.12.00.063
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd0d2fa1c99126de9942ca7802baf18a42c2680e
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Mon Mar 23 04:14:39 2020 +0000

    Bug 22534: Added syspref for defining what guarantee fields are pre filled
    
    Librarians should be able to define what sections in member entryfields in 'Main address',
    'Contact' and 'Alternate contact' in member entry form for guarantee's are pre-filled from guarantor's record
    
    The 'Guarantor surname, 'Guarantor first name' and 'relationship' fields
    in the 'Contact' section should not be filled from guarantor patron
    record as those fields are intended for guarantor's without patron
    records in Koha.
    
    Test plan:
    1. On an adult patron's record (which has all fields filled out in the
    'Main address', 'Contact' (Except for 'Guarantor surname', 'Guarantor
    first name', and 'relationship'), 'Alternate address', and 'Alternate contact') select 'Add guarantee'
    
    2. Observe:
    
    * Fields in 'Main address' are all automatically pre-filled
    from guarantor record
    
    * Fields in 'Contact' (except 'Guarantor surname', 'Guarantor firstname'
    and 'relationship') are all automatically pre-filled from guarantor
    record
    
    * Fields in 'Alternate address' (except for Contact note) are pre-filled from guarantor record
    
    * None of the fields in 'Alternate contact' are pre-filled from guarantor
    
    4. Apply patch
    
    5. Run database updates
    cd installer/data/mysql
    sudo koha-shell <instancename>
    ./updatedatabase.pl
    
    6. Restart plack:
    sudo koha-plack --restart <instancename>
    
    7. Go to Administration > Global system preferences and search for the
    new PrefillGuaranteeField system preference
    
    8. Observe this syspref contains checkboxes and the following are
    selected by default:
    Contact - Primary email
    Contact - Primary phone
    Main address - Address
    Main address - City
    Main address - Country
    Main address - State
    Main address - ZIP/Postal code
    Main address - street number
    
    Please note: 'Contact - Guarantor surname', 'Contact - Guarantor first
    name', Contact - relationship' are not in PrefillGuaranteeField syspref
    as they are for non Koha patrons and so should not be pre-filled from a Koha
    patron.
    
    9. Repeat step 1 and observe the following fields are prefilled from guarantor:
    In Main address section -
    streetnumber
    address
    city
    state
    zipcode/postal code
    country
    
    In Contact section -
    Primary phone
    Primary email
    
    10. In the PrefillGuaranteeField syspref click '[Select all]' checkboxes
    
    11. Repeat step 1 and observe all fields in 'Main address', 'Contact'
    (except Guarantor surname, Guarantor first name, and relationship),
    Alternate address and Alterate contact are filled from guarantor record.
    
    i.e. The values in guarantor's 'Alternate address' fields fill the
    guarantee's 'Alternate address' fields
    
    12. Change a few of the prefilled field values and 'Save' and observe your changes
    have been saved in addition to the unaltered pre-filled values in other
    fields
    
    13. Amend PrefillGuarantee field syspref to have no checkboxes selected
    
    14. Repeat step 1 and observe none of the fields in Main address,
    Contact, Alternate address and Alternate contact are pre-filled
    
    15. Run tests:
    sudo koha-shell <instancename>
    prove xt
    prove t
    
    Sponsored-by: Waitaki Distict Council, NZ
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.go.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8a56f176c083f7156584d07af7650162d13814e2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Dec 5 17:42:50 2019 +0000

    Bug 24183: Add before_send_messages hook
    
    This patch adds a simple hook to the process_message_queue cronjob
    to allow plugins to pre-process messages in the messaging queue before
    they are sent.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 26d4b7fd5e35f784f951c4f9e9bb084a9f4612a4
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 20 14:43:43 2020 +0000

    Bug 24699: Split items.uri in OPAC detail view
    
    Same change as in bug 24697 for staff. If there are more URIs in 952u,
    we split them and show the real URL instead of Link to resource or the
    value of pref URLLinkText.
    
    I introduced a few template variables here to make the code a bit more
    compact and readable.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 93244efa3cbb66ff9e98d1eb4871da56a7565e5f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 13 10:48:11 2020 +0100

    Bug 16547: Do not display "multi holds" view if only one is selected
    
    If a hold is selected from the result list, we should let the ability to
    select an item-level hold.
    
    Test plan:
    I. Detail page
    1/ Go to a bibliographic record detail page
    2/ Click "Place hold"
    3/ Select a patron
    => No change expected, you can select an item
    
    II. Search result, multiple holds
    1/ Search for an item with more than one search result
    2/ Select several items, click 'Place hold'
    3/ Enter a patron card number
    => No change expected, item level holds are not available.
    
    III. Search result, single hold
    1/ Search for an item with more than one search result
    2/ Select only one item, click 'Place hold'
    3/ Enter a patron card number
    => With this patch applied, item level hold is available. The screen is the same
    as when you place a hold from the bibliographic record detail page
    => Without this patch you cannot place an item-level hold
    
    QA notes: We could go a bit further and remove the 2 biblionumbers and
    biblionumber from hold script, as well as remove the checkMultiHold in
    request.tt. We should not have a biblionumbers param that contain a list
    of biblionumber separated by '/' but several biblionumber parameters
    instead.
    
    QA notes 2: About placerequest.pl, see bug 19618 comment 27.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f2efa1898db8b4d8d73bbc99de95571815561750
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Apr 6 10:36:35 2020 +0100

    Bug 24492: (RM follow-up) Varaible name corretion
    
    Bug 24492 was not correctly rebased after bug 23355 and did not account
    for a variable name change in the 'add_cashup' action. This patch deals
    with that.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e065b86abd51f36340fa940ca211931e21689fad
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 30 16:11:51 2020 +0200

    Bug 25020: Preserve time part when batch extending due dates
    
    When selecting a new hard due date, we should keep the time part of the
    original checkouts.
    
    Test plan:
    1 - Checkout an item specifying a date due
    2 - Checkout an item without specifying a date due
    3 - Use Tools->Batch extend due date
    4 - Select a hard due date
    5 - On the confirmation screen you should see that the time part has
    been kept
    6 - Confirm
    7 - Make sure the correct values hava been inserted in DB
    8 - Try now using the other option, give a number of days
    9 - Repeat 4-7
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9d6362145ff335cec81e64874021c8f7a4479f23
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Mar 31 14:20:23 2020 +0000

    Bug 25022: Display problem in authority editor with repeatable field
    
    This patch corrects an error in the structure of the authority editor
    template so that repeating subfields do not generate invalid markup. The
    correction was found by comparing with addbiblio.tt.
    
    If you are viewing the diff, please note that some minor whitespace
    changes have been made.
    
    To reproduce, clone and and populate any repeatable subfield, save, and
    open the authority for editing again. The clones subfield will be
    formatting incorrectly, showing bullet points on each line.
    
    To test, apply the patch and reload the authority editor showing the
    record with the cloned subfield. It should display correctly.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 866f0c04a8707b06a00940267cc8aa405b8983f0
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Mar 31 14:54:41 2020 +0000

    Bug 25004: Search results place hold button not enabled when checking result checkboxes on opac-search.pl
    
    This patch makes a minor correction to the markup of the OPAC search
    results page so that the event handlers attached to the checkboxes work
    correctly. The broken markup broke the jQuery selector used to control
    the event.
    
    An extra </div> was added by mistake by Bug 14715.
    
    To test, apply the patch and test the process of selecting multiple
    titles by checking the checkbox. Doing so should activate the "Place
    hold" and "Tag" controls.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 86d93a5d4119c37a635dfa844f3e11212ce9555f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Apr 1 10:58:28 2020 +0200

    Bug 25024: Do not escape $
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dc6998cea9233072e34d8a7e94c6dcc800b9f49a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Mar 31 13:55:21 2020 +0000

    Bug 25024: Make grep match full string
    
    To test:
    1 - Create or have a branch with code CPL
    2 - Create two new branches 'ACPL' and 'CPLA'
    3 - In branch transfer limits disallow some itype or collection from another branch (FPL) to ACPL and CPLA
    4 - Set UseBranchTransferLimits to 'Enforce'
    5 - Find a biblio with one item belonging to FPL
    6 - On opac, attempt to place a hold
    7 - Note that ACPL and CPLA don't show in dropdown, OK
    8 - Note that CPL is disabled, NOT OK
    9 - Apply patch
    10 - Place hold
    11 - CPL is now enabled
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Joel Sasse <jsasse@plumcreeklibrary.net>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd1a48f0448c71ab0ccc063a9146faa40b89d86e
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Mar 26 22:30:52 2020 +0000

    Bug 17938: Fix display of label for repeated MARC 583 - Action note fields
    
    When there are mulitple 583 on a record, the label "Action note" will be
    repeated for each. This fixes it, so that the label only appears once and
    multiple fields are separated by | following the existing pattern.
    
    Also makes sure there is a space between $z and other subfields.
    
    Note:
    Ind. 1 = private - These won't display in the OPAC
    Ind. 1 = 0 or empty - These will display in the OPAC
    Staff will display all 583 independent from indicator.
    
    To test:
    - Add one or more records with none, one and muliple 583, at least one including $z
      For examples see:
      http://www.loc.gov/marc/bibliographic/bd583.html
    - Verify display problems
    - Apply patch
    - Verify display is improved - one label and $z is followed by a space
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1aad1ed01ea3fcf417542a36fab014a8602a5cfc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 3 14:28:05 2020 +0100

    Bug 25010: DBRev 19.12.00.062
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e21e40ad8446e79316e476cded7c694207c2c3bf
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Mar 26 21:30:06 2020 +0000

    Bug 25010: Fix typo 'rewewal' in debit types
    
    This fixes a typo in the debit type description of
    RENT_DAILY_RENEW
    
    1) Go to Administration > Debit types
    2) Show all debit types
    3) Check for the typo
    4) Apply patch
    5) Verify that the typo is gone
    6) Check account_debit_types table for type:
       SELECT * FROM account_debit_types;
    7) Run database update
    8) Repeat and verify typo is gone
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c9818c528bc47458015f89a74c9192f543ca7bb
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 01:22:35 2020 +0100

    Bug 24941: Serials - Fix link to basket from acquisition details information
    
    Adding orders from subscriptions makes acquisition information visible
    in the serials module. In the table of acquisition data is a link back
    to the basket - but this link is missing the basket number parameter -
    it doesn't work. This patch fixes the TT variable to make it work.
    
    To test:
    - Add a subscription
    - Add a new basket
    - Add a order line using "Add from subscription"
    - Go to the subscription details page, check the acquisitions tab
    - Try the link to the basket - it should not work
    - Apply patch
    - Try the link again - now it should bring up the basket page with
      the order.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f1c779343e7980d3df5b0a64ea5dfe179267289d
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 00:46:55 2020 +0100

    Bug 25012: Fix class on OPAC view link in staff detail page
    
    Probably a copy & paste error: the OPAC view link on the staff
    detail page currently has the class succeeding_entry_note.
    
    This patch changes it to opac_view to allow for independent
    styling of the link.
    
    Note: The link will only be visible when OPACBaseURL is set.
    
    To test:
    - Use the element inspector or check the source code for
      the class used on the OPAC view link on the staff detail page
    - Apply patch
    - Repeat and verify that the class has changed to opac_view
    
    Signed-off-by: David Roberts <david@koha-ptfs.co.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 09a76a440ea8f0101bea2a7dac46e58fb87ac3dd
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 00:54:21 2020 +0100

    Bug 25013: Fix capitalization: Edit Items on batch item edit
    
    Fixes a tiny string issue: Edit Items --> Edit items
    
    To test:
    - Go to tools / batch item edit
    - Enter a barcode
    - Check the heading above the edit item form
    - Apply patch
    - Verify the heading is now properly capitalized
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5f323dbe49aa68515f5cbab7fba2e31843759408
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Mar 28 01:05:14 2020 +0100

    Bug 25014: Fix capitalization for "Call Number" in staff and OPAC sort options
    
    There are some ocurrences of "Call Number" in the sort option lists in
    staff and OPAC. The patch changes them to "Call number".
    
    To test:
    - Check the sort option list in staff and OPAC for the typo
    - Apply patch
    - Verify it's now all corrected
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 09c0c7a555219e2346d769e57585caa128d5bb61
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 3 14:15:34 2020 +0100

    Bug 24996: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 41174f60eafdf68ef2f94b18f19905af302097ec
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Mar 27 01:36:22 2020 +0000

    Bug 24996: Unwanted CSS change unhides OPAC results sorting button
    
    This patch adds back a CSS selector which was incorrectly removed by Bug
    23915. The "Go" button associated with the OPAC search results resort
    operation should be hidden if JavaScript is enabled.
    
    To test, apply the patch and rebuild the OPAC CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client)
    
     - Perform a search in the OPAC
     - On the search results page, there should be no "Go" button next to
       the re-sort/results per page selection fields.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 55b9b8e17de19bbc2f5c4e0fa1d2e5937a6c3eaf
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Mar 27 16:38:15 2020 -0300

    Bug 25006: Make Koha::Item->as_marc_field skip undefined subfields
    
    This patch makes as_marc_field skip subfields that don't have a value or
    contains an empty string (replicating C4::Items:1021 logic).
    
    To test:
    1. Apply the regression tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Item.t
    => FAIL: Tests fail because the generated MARC::Field contains undef
    subfields.
    3. Apply this patch
    4. Repeat 2.
    => SUCCESS: Tests pass! Undefined and empty subfields are skipped!
    5. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e986d4d0ad98cb5ac8d54d8d30cbf2f4fcb14417
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Mar 27 16:36:25 2020 -0300

    Bug 25006: Regression tests
    
    This patch introduces regression tests for as_marc_field. It makes sure
    there are empty subfields and then uses List::MoreUtils' all to verify
    all generated MARC subfields contain something (i.e. the undef ones are
    skipped).
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 192b9d55a05414bf3e8d64eeaba1926a20ec8ba8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 30 11:35:35 2020 +0200

    Bug 19475: Clear the caches at the end of the tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a99923a27ba327111819dea144da6d1d10b82c9c
Author: Emmi Takkinen <emmi.takkinen@outlook.com>
Date:   Wed Mar 4 13:54:34 2020 +0200

    Bug 19475: Don't copy holiday if it already exists in target calendar
    
    Calendars copy tool created duplicate values to database.
    Holidays in target calendar weren't checked before
    inserting new holidays. This patch fixes this.
    
    To test:
    1. Add holidays for branch A
    2. Copy branch A calendar to branch B
    3. Repeat copy to branch B
    => Check database, branch B has now duplicate holidays
    4. Delete holidays from branches A and B
    5. Apply patch
    6. Repeat steps 1-3
    => Check database, no duplicates
    
    Sponsored-by: Koha-Suomi Oy
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 502af90868a9fe58a59ebd0d6c2ff960ce897335
Author: Emmi Takkinen <emmi.takkinen@outlook.com>
Date:   Thu Mar 12 12:35:39 2020 +0200

    Bug 19475: Add unit tests
    
    To test prove:
    t/db_dependent/Holidays.t
    
    Sponsored-by: Koha-Suomi Oy
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ebb73e373805380cc5399488793139758adc0ce5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 3 14:10:07 2020 +0100

    Bug 9422: (RM follow-up) Rebase Correction
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 563784bcf5afc2989d354dcf2e91cf3fa667e67d
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Feb 10 12:09:08 2019 +0100

    Bug 9422: Don't allow access to 'Upload patron images' when patronimages syspref is off
    
    In addition to checking the patron image upload permission, this
    adds a check for the patronimages system preference to the tools
    home page and sidebar.
    
    To test:
    - Check that the patron image upload tool only displays when
      - system preference patronimages is set to 'Allow'
        and user is either
      - superlibrarian or
      - has bath_upload_patron_images permission
    - Save URL of patron image uploader page
    - Turn off patronimages
    - Verify you get redirected to the home page of Koha when trying
      to access the page
    
    Note: this redirect is already used by the stock rotation feature.
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2823fee5cfb08cec398e9d02cfc9e1d65b8fde57
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 3 14:04:48 2020 +0100

    Bug 24474: DBRev 19.12.00.061
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 416ae0768858452609cc6d62d1a00601c2a49613
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 31 09:43:34 2020 +0100

    Bug 24474: (QA follow-up) Fix failing test
    
    The test was assuming default data and would fail if you ran through the
    test plan (and disabled all but `onpayment` for the
    'MarkLostItemsAsReturned' preference) on the data before running the
    included unit tests.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3ed641b33a5969e9c5d2eb027b9bbce761d06ed8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Feb 14 10:39:21 2020 +0000

    Bug 24474: (follow-up) Add LOST_FOUND logic to Koha::Account::pay
    
    This patch adds the same updated logic as found in
    Koha::Account::Line->apply to handle LOST_FOUND credits being applied
    against their associated LOST debit.
    
    Currently a 'LOST_FOUND' credit is never created via the pay method and
    so the additional test will always pass, but the addition here accounts
    for possible future uses.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f756aa917cfb13c6c2729c5dc07dbd6db5e7441b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Feb 10 10:31:37 2020 +0000

    Bug 24474: (follow-up) Add onpayment to sysprefs file
    
    This patch adds the required line to the circulation.pref file to
    dispaly the onpayment option in the MarkLostItemReturned preference
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 39c872a71e8d8448310a3daeb6224d4b21a2d162
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 5 13:10:49 2020 +0000

    Bug 24474: Filter out LOST_FOUND
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 08322a6f639bd2946b9db70fe6906d5ca12f26bd
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 5 10:14:05 2020 +0000

    Bug 24474: Add `onpayment` option to `MarkLostItemsReturned`
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dab0f06a4622ba2ddb178824d0c03f7e260a224a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 4 15:13:47 2020 +0100

    Bug 24474: Add tests
    
    This does the following using the interface:
    - Unselect all the options from MarkLostItemsAsReturned except for
      'onpayment'
    - Check an item out
    - Create a manual invoice LOST for the checked in item
    - Renew the item
    - Check that the item was not returned
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 145b0116582630121d9fe90181134040e8fca9ea
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Mar 19 04:37:34 2020 +0000

    Bug 24900: Checks in MARC mod templates for when from field does not equal conditional field
    
    When MARC modification template actions are applied, they assume that
    the from field is the same as the conditional field. This patch adds
    checks for this, as well as tests to confirm the behaviour is correct.
    
    CASE 1: Delete 1st field 020 if 651$z exists
    BROKEN BEHAVIOUR (before patch): deletes the 2nd instance of 020 instead
                                     of 1st
    EXPECTED BEHAVIOUR (corrected by patch): deletes the 1st instance of 020
    
    CASE 2: Delete 1st field 020 if 651$z matches Berlin. (must include '.')
    BROKEN BEHAVIOUR (before patch): deletes the 2nd instance of 020
    EXPECTED BEHAVIOUR (corrected by patch): deletes the 1st instance of 020
    
    CASE 3: Delete field 020 if 650$2 does not match fast
    BROKEN BEHAVIOUR (before patch): deletes all 020 fields even though
                                     650$2 does match fast
    EXPECTED BEHAVIOUR (corrected by patch): does not delete 020 fields
    
    Confirm tests pass: t/db_dependent/MarcModificationTemplates.t
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Frank Hansen <frank.hansen@ub.lu.se>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c800ef7e594d9c1edc37ba563b4d508f656e940c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 31 17:56:41 2020 +0200

    Bug 22001: Errors are no longer logged by default (!)
    
    This is one of the biggest part we will have to deal with when we will
    switch to DBIC handler for UI as well.
    The DBI errors will not be logged if we do not deal with them correctly.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ddbe2753bab8a24f062d8ee4b3313c8827a88402
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 31 17:55:28 2020 +0200

    Bug 22001: execute reports in an eval
    
    Otherwise the tests will fail. We will certainly log twice the error
    when run from the UI, but not a big deal. This definitely needs more
    attention in a follow-up bug report.
    We want to raise proper exceptions here.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c89e0a18d65ddbcfcdbbcf552db5bfa1190d916e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 31 17:54:36 2020 +0200

    Bug 22001: Fix Koha/Patrons.t
    
    The message is only printed once
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 41905c7eaac8c294668d1ba712d1cad8ab0102d9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 31 17:53:47 2020 +0200

    Bug 22001: Make the DBD error regex less strict
    
    Now the message is looking like
    DBIx::Class::Storage::DBI::_dbh_execute(): DBI Exception: DBD::mysql::st execute failed: Duplicate entry
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8e6cebb6b4553bc15c2ee95de9f3e6b3f895e258
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 31 17:27:12 2020 +0200

    Bug 22001: Add the DBI error message
    
    Using DBIx::Class error handler, we should not hide the error when
    encapsulating it
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3533aacef8772d43a471b558c4ae581b63a90ee7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 31 15:58:21 2020 +0200

    Bug 22001: Set unsafe only if RaiseError is not set
    
    Sooooo....
    
    That was tricky, and the solution looks trivial.
    However it's not.
    We have unsafe set for "historical reason".
    Having it on when RaiseError is on have the effect of overwritting the
    DBIC error handler.
    
    The problem is:
    t/db_dependent/Circulation/MarkIssueReturned.t (and other tests) is failing with:
    
      # expecting: Koha::Exceptions::Object::BadValue
      # found: DBIx::Class::Exception ({UNKNOWN}: Can't locate object method "rethrow" via package "DBD::mysql::st execute failed: Incorrect datetime value: 'bad_date' for column 'returndate' at row 1 [for Statement "UPDATE `issues` SET `returndate` = ? WHERE ( `issue_id` = ? )" with ParamValues: 0='bad_date', 1=238] at /usr/share/perl5/DBIx/Class/Storage/DBI.pm line
    
    In Koha::Object->store, the exception is not a DBIx::Class::Exception object (as we except), but
    a string (on which we cannot call rethrow).
    
    Swithing unsafe off restores the expected behavior.
    To make sure the UI will not be affected, it is only turned off when
    RaiseError is set.
    
    The situation is still wrong (for UI), from the POD https://metacpan.org/pod/DBIx::Class::Storage::DBI (/unsafe)
    """
    Note that your custom settings can cause Storage to malfunction, especially if you set a HandleError handler that suppresses exceptions and/or disable RaiseError.
    """
    
    And also https://metacpan.org/release/DBIx-Class/source/lib/DBIx/Class/Storage/DBI.pm#L1531
    
    Many thanks Tomas for the digging exploration!
    
    We need to turn RaiseError and remove the unsafe flag, for UI as well,
    but that should be done at the beginning of a dev cycle.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c383aa286fee5a29c6f084873f2eb6644bad64f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 23 17:21:24 2020 +0100

    Bug 23463: (follow-up 3) Fix timestamp default value
    
    This is the only situation I found where:
     * t/db_dependent/Koha/Item.t is passing
     * t/db_dependent/Koha/Object.t is passing
     * MySQL 8 is happy (and not fail with "Column 'timestamp' cannot be null"), which is certainly what I missed in the previous follow-up
    
    About the change to Object.t: the next store was called without the
    generated timestamp, so it is needed to call discard_changes.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit af1275ce7d285aaf179f9d25403b5a578b4f0d01
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 30 11:04:51 2020 +0200

    Bug 22001: Fix Object.t - handle correct RaiseError and PrintError
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9816e240aa5d629bca98d9f0cb3e327bf2bc5a77
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 30 10:16:23 2020 +0200

    Bug 25018: Use new KOHA_TESTING envvar to detect environment testing
    
    In some tests we want to know if we are in a testing environment.
    When run the usual way, our trick works, the perl interpreter matches 'prove':
      $ENV{_} eq 'prove'
    
    In other situations, we have the KOHA_NO_TABLE_LOCKS environment variables, for the SendCirculationAlert race conditions (see bug 15854 and bug 18364).
    
    For unknown reasons, Jenkins runs the tests with /usr/bin/perl.
    
    This patch suggests to rename KOHA_NO_TABLE_LOCKS and use KOHA_TESTING
    instead, when prove is not used (or not correctly detected as it it the
    case for Jenkins)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 624a24b8203624d94cbe0efdb37106065cf6cd92
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 27 17:09:27 2020 +0100

    Bug 24614: Fix Reports/Guided.t
    
    DBD::mysql::st execute failed: Column 'public' cannot be null [for Statement "UPDATE `saved_sql` SET `last_modified` = ?, `notes` = ?, `public` = ?, `report_group` = ?, `report_name` = ?, `report_subgroup` = ?,
    `savedsql` = ? WHERE ( `id` = ? )" with ParamValues: 0='2020-03-27T16:03:04', 1=undef, 2=undef, 3=undef, 4='Just another report', 5=undef, 6=undef, 7=25] at /usr/share/perl5/DBIx/Class/Storage/DBI.pm line 1836.
        # Looks like you planned 17 tests but ran 6.
    
    update_sql expect all the paramters to be set, otherwise it will be
    nulled.
    
    The best way to fix it is at test level. There is only 1 occurrence in
    controller/module, and it sends all the parameters. That is the correct
    way to do and will make things easier when we will removed them to use
    Koha::Reports directly
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ff19fd48060aee94eb98ae5e0ae883c86f81475a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 27 16:46:30 2020 +0100

    Bug 18177: (follow-up) remove aqbooksellers.currency
    
    There was an occurrence in tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d8ddfb675e4dba64d7b2e6ec6348ace0f9aa4e3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 27 16:36:08 2020 +0100

    Bug 23204: Fix tests swapping fields (they are not ordered)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2cf5ae07f1751303830209f278b943d25e8750cb
Author: Nazlı Çetin <nazli@devinim.com.tr>
Date:   Fri Mar 27 12:25:46 2020 +0000

    Bug 25000: SQL report not updated
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e684fac28dee49184339a05b9372d9152c1955a9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 27 12:32:14 2020 +0000

    Bug 23204: DBRev 19.12.00.060
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b4eb87483f4f04ed57fd70221de6b8e762d98b2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Mar 27 09:43:55 2020 +0000

    Bug 23473: (QA follow-up) Fix number of tests
    
    => Looks like you planned 158 tests but ran 159.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 68776ef2e685fa7f4dc6f38769a28e48b56af621
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Feb 4 12:14:51 2020 +0000

    Bug 23473: (follow-up) Fix QA complaints (tabs, filters, Dumper)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 214d78309d6452da82054fe6a481548ae48084d7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jan 8 15:02:08 2020 +0000

    Bug 23473: Don't allow staff password changes for imports
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a6134710d6651d0594c1b2eaaec59024bb37aea
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jan 8 14:24:04 2020 +0000

    Bug 23473: Don't allow setting blank passwords via import
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8c7ae857a286a2b73573f6f216eedfb90ea46753
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 5 12:58:45 2019 +0000

    Bug 23473: (follow-up) Catch and show password exceptions
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 481bc59de55432aca4c63ef9bd0ad53f72ecf5d7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Oct 29 10:24:42 2019 +0000

    Bug 23473: (follow-up) check if overwrite_passwords is set
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c6517d05b6dbbced1a4c27ed2bc7ee3f515cc7a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 3 13:08:53 2019 +0000

    Bug 23473: (follow-up) Make passwords 'secure' for tests
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6464ada6c6801ab9a10d7a64154212ba30428ab9
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Aug 19 16:16:30 2019 +0000

    Bug 23473: Allow overwrite of passwords during import
    
    To test:
     1 - Have some patrons in your system
     2 - Export some of their info via reports
        SELECT cardnumber, userid, surname, firstname, password, branchcode, categorycode
     3 - Edit the file from above, changing all the password lines
     4 - Import the file with overwrite
     5 - Confirm passwords have not changed (run the report again and confirm the hashes are the same)
     6 - Apply patch
     7 - Restart all the things
     8 - Check the new box on import screen to overwrite passwrods
     9 - Import file again
    10 - Confirm passwords have changed
    11 - Signin using new password to verify the hash is the password as supplied
    12 - Repeat via commandline import supplying --overwrite_passwords option
    13 - Verify works as expected
    14 - Prove -v t/db_dependent/Koha/Patrons/Import.t
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Ron Marion <ron.marion@goddard.edu>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a444f643ad10a1e77edbe65543429059fdcd6539
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 27 12:19:26 2020 +0000

    Bug 18177: DBRev 19.12.00.059
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f50fee2546c8a97da9654e7de79f6f09bafb579b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 24 16:22:33 2020 +0100

    Bug 18177: Do not remove columns if at least one value exists
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 57788803e0e13b7cceb30665666f0e77c2e97fa2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 17 09:55:39 2020 +0100

    Bug 18177: DBIC changes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 287416fcad8deed10601b1e45b561bfc6f12724e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 17 09:50:18 2020 +0100

    Bug 18177: DB changes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 93ed21862a667f24159ec51c71f049fec5848d6b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 17 09:53:04 2020 +0100

    Bug 18177: remove aqbooksellers.currency
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 607049246275e00a0ecd4721e8ed8688424c2dce
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 17 09:47:46 2020 +0100

    Bug 18177: remove aqbooksellers.bookselleremail
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a961487d65dce0d6c49757834f9fd642490f119b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 17 09:43:13 2020 +0100

    Bug 18177: remove aqbooksellers.booksellerurl
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d9ff747a221eb53769982f36894c755757a1491
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 17 09:42:37 2020 +0100

    Bug 18177: remove aqbooksellers.booksellerfax
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b1122cf0f3e1b242a94b4feaca1ff0596d117585
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 17 09:40:04 2020 +0100

    Bug 18177: remove aqbooksellers.othersupplier
    
    This patchset removes some columns from the aqbooksellers table that are
    not used:
     * booksellerfax
     * booksellerurl
     * bookselleremail
     * othersupplier
     * currency
    
    The first 3 ones are certainly leftover from bug 10402.
    
    Test plan:
    For each for these fields you will make sure that they cannot be edited
    from the interface.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 97913b8a648b607401a45b15525914f5e1d4d209
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Feb 14 15:07:16 2020 +0000

    Bug 23888: (follow-up) Wrap English string in translation function
    
    This patch makes alert added in subscription-add.js translatable using
    the new __() function.
    
    To test, apply the patch and confirm that the alert still works
    correctly when submitting the subscription edit form with an invalid
    vendor id.
    
    Test that the string can be translated (using fr-Fr for example):
    
    1. cd misc/translator && ./translate update fr-FR
    2. Translate strings in misc/tranlator/po/fr-FR-messages-js.po
    3. cd misc/translator && ./translate install fr-FR
    
    Switch to the fr-FR translation and confirm the the alert shows your
    translated string.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c52e15689f123faa083626d725420def07dbfdc5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 11 12:14:50 2019 +0100

    Bug 23888: Do not allow invalid vendor id on creating a subscription
    
    It will avoid crash and invalid data when creating/updating a
    subscription.
    
    This could have been done with a AJAX query but seems more convenient
    this way.
    
    Test plan:
    - Create or update a subscription
    - In the "Vendor" input try an empty string, a valid vendor's id, and
    invalid one.
    => With an empty string you get the existing alert message
    => With a valid id you do not get any messages
    => With an invalid id you are not allowed to go to page 2
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 01551437c0c99b9e6308e109ceeef5bc3f7b5cec
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jan 9 15:53:45 2020 +0000

    Bug 24386: Prevent double form submission on adding orders to basket from a file
    
    To test:
     1 - Have a marc record file
     2 - Go to Acquisitions, find a vendor, then an open basket
     3 - Add to basket from a new file (if you already have one staged you can choose that instead)
     4 - Import the file, then add to basket
     5 - On the page where you select the records and set info select a record, set matching to 'Do not check' fill in the fund for the order
     6 - When ready, click save as many times as you can
     7 - When you go to the basket there are many copies of the order added
     8 - Don't despair, apply the patch
     9 - Repeat above
    10 - When ready to add orders, click furiously
    11 - The order is only added once!
    12 - Success!
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5982159f351f65865652c7b357a71b370b351482
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 27 12:12:31 2020 +0000

    Bug 24883: (RM follow-up) Use Koha::Script
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52b131415482f4c8e6881380eed65e478dcef653
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Fri Mar 20 19:35:29 2020 -0300

    Bug 24883: Add POD entry and remove unused variable
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1439abcfe22b1ae8477bd2df8fdd2cac95753909
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 19 13:09:33 2020 +0100

    Bug 24883: Move new sub from load_yaml.pl
    
    Use the sub from C4::Installer to avoid dup of code.
    
    Note:
    We are going to modify the script and so will do more stuffs.
    We may want to rename it, maybe installer_utilities.pl,
    misc/installer/yaml_utility.pl, any suggestions?
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 30c0f96aa056a63f8f74d06aeafc1a70f7faf122
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 19 12:20:23 2020 +0100

    Bug 24883: Move to a flat array with all values to an array of arrayref
    
    For the following SQL query:
    INSERT INTO cities(city_name, city_country) VALUES ('Madrid', 'Spain'), ('Buenos Aires', 'Argentina');
    
    We move from:
    [ 'Madrid', 'Spain', 'Buenos Aires', 'Argentina' ]
    to:
    [ [ 'Madrid', 'Spain' ], [ 'Buenos Aires', 'Argentina' ] ]
    
    Which make more sense to split, build and construct the queries
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 876d12375cd96b26e4ab7cfade783f2ee53cd257
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 19 12:05:25 2020 +0100

    Bug 24883: Centralize code to load YAML installer files to a sub
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f52c9fde3f9d13339b24c4acbe756b872e762c09
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Mon Mar 16 18:44:44 2020 -0300

    Bug 24883: Command line utility to load yaml files
    
    This patch adds a command line utility to load
    yaml files.
    
    To test:
    1) Apply the patch
    2) Try loading a file, e.g. sample notices
     a) mysql -e "delete from letter"
     b) misc/load_yaml.pl -f installer/data/mysql/en/mandatory/sample_notices.yml
    3) Try loading a file with a syntax error,
       edit previous file adding ':' at the end of a field without quotes
       then load again
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 93393036e5fd425e6bc1b8e107b34664c2018720
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 27 12:08:54 2020 +0000

    Bug 23204: (RM follow-up) Use Koha::Script
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7dbc27420e74c7921b85a5c1bf66941e1c73c03
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 26 15:15:11 2020 +0100

    Bug 23204: Adjust copyright and license
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e944f2f6fde2127b542605c96a622451522ddda1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 26 15:12:25 2020 +0100

    Bug 23204: Update the mappings.yaml file with the output generated
    
    We need to be consistent and provide the mappings.yaml file generated by
    the script.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e578d0b36b9232ed1883f73692fac1b732cf7a85
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Mar 25 17:10:40 2020 +0000

    Bug 23204: Fix ordering of fields in exported file
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0c9585333dcb0fe2082662c82d3f65823ab72c7c
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Nov 12 17:15:14 2019 +0100

    Bug 23204: (follow-up) Also sort by marc field
    
    Test plan :
    Launching script several times and see that marc field is alway ordered increasing
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c338829aba6f244fb50fe2cc8d98f72dde531ae5
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Oct 3 07:23:07 2019 +0000

    Bug 23204: Sort search fields by name
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e160af97a65d687e3da62555bcdcb1ab0e55aafe
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Tue Aug 13 10:41:03 2019 +0200

    Bug 23204: Add exec permission on the script
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 32ea7a6378373386658e073f0bdabf309d6c8227
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Tue Aug 6 08:03:18 2019 +0000

    Bug 23204: Export field weights
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 85f3a3a3027017e39a3450e406af0faf0739dd00
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Tue Aug 6 07:45:39 2019 +0000

    Bug 23204: Move code in a unit tested sub
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e1f85223918ed330f4a0b02454e0f1106b2d4e8b
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Tue Jun 25 14:14:19 2019 +0000

    Bug 23204: Add script for exporting Elasticsearch mappings
    
    Test plan:
    
      - launch perl misc/search_tools/export_elasticsearch_mappings.pl >
        /path/to/my_mappings.yaml
      - set koha-conf.elasticsearch_index_mappings to
        /path/to/my_mappings.yaml,
      - go to admin -> Search engine configuration,
      - click on "Reset mappins",
      - check that your search fields and mappings are as expected
    
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 70109d4f94ecdd8f9fca49de180d0a5165afb93b
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Thu Feb 20 16:17:58 2020 +0200

    Bug 24700: Avoid validating REST API spec multiple times
    
    This patch changes the spec loading so that it is fully loaded and merged with any plugin routes before validation. The individual parts are separately validated only if the resulting complete spec is invalid. Note: the OpenAPI plugin validates the spec given to it, so normally no manual validation is necessary.
    
    Test plan:
    1. prove -v t/db_dependent/Koha/REST/*
    2. prove -v t/db_dependent/api/v1/*
    
    Sponsored-by: The National Library of Finland
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a44ce976f61299f893b415dc27a1864e1a028445
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Mar 26 11:14:59 2020 -0400

    Bug 24982: (follow-up) Retain checkbox selections after for submit
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c6bd0bfee25352e07eefd3cf7a475c95927527a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Mar 26 09:49:04 2020 -0400

    Bug 24982: (follow-up) Move checkboxes to left side of label
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8470d0ea7ca903dfce96a69252fd6949ffdb4877
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Mar 26 12:48:02 2020 +0000

    Bug 24982: (follow-up) Give checkboxes more structured layout
    
    This patch makes minor markup changes and adds some CSS so that the
    module and actions checkboxes are laid out a little more clearly.
    
    The patch includes some whitespace changes, so diff accordingly.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b81d95f280259fe1de7775a0dbac52929b10bcb0
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Mar 24 16:00:41 2020 +0000

    Bug 24982: Use checkboxes in Log Viewer
    
    So we can see all options at once, and more easily select more than one
    option.
    
    Test plan:
    1) Go to Tools -> Log viewer
    2) Notice the new checkboxes under Modules, Actions and Interface. 'All'
    should be selected by default for all three options
    3) Confirm you can deselect 'All' and the other options are enabled.
    Confirm selection all of the other options automatically selects 'All'
    and disables the options again.
    4) Confirm the results still work as expected when clicking 'Submit'
    button
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 39aa01a996da0de45a4578f0932019d703939deb
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Mar 2 09:36:47 2020 -0500

    Bug 24765: Updated on date in Claims returned starts off as 12/31/1969
    
    When an item is claimed returned by staff, there is a column called Updated On - this date field column should remain blank until this claimed returned has been updated.  Currently, when an item has been claimed returned, the date in the updated column states 12/31/1969. This date only shows up in the display, it is doesn't show up in the database like this.
    
    Test Plan:
    1) Enable return claims
    2) Make a claim
    3) Note the 'updated on' column has the date 1969-12-31
    4) Apply this patch
    5) Reload the page ( you may need to clear your browser cache )
    6) Note the field is now blank
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bb637c825bfc81066f430d5f396480bab87d531c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 27 11:12:41 2020 +0000

    Bug 22001: (RM follow-up) Allow RaiseError tests in Reports/Guided.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 600217eb69abf8218b68c32b8eaca223c87ceec3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 14 13:30:02 2018 -0300

    Bug 22001: Enable RaiseError for tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 46ecd9def51f2bb48f962d2492cddfc567bc2162
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 14 13:30:27 2018 -0300

    Bug 22001: Add tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2849b188c885bb6752e9e5c7db381e291ed4bb30
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 14 13:30:52 2018 -0300

    Bug 22001: Remove the RaiseError occurrences from tests
    
    Unless it is needed!
    Also remove $dbh when not used later.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dcc93816914d467191481542f318c1c8ca415105
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 30 12:26:57 2020 +0100

    Bug 22685: Use DBIx::Class relationships in Koha::Acq::Bookseller methods
    
    To match PERL15 we change the behavior of Koha::Object methods to make
    them use the DBIx::Class relationships.
    
    Test plan:
    - Create a vendor, basket and contact
    - Edit the vendor => the contact must appears
    - Go to the view of a vendor => you cannot delete the vendor, it has
    a basket attached
    - Create another vendor, without basket
    - Go to the view of the vendor => You can delete it
    
    Additionally:
     % prove t/db_dependent/Koha/Acquisition/Booksellers.t
    must return green
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 11a91d6e0cde1711c51a771a2aa38abf761f7114
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Wed Mar 25 21:14:06 2020 +0000

    Bug 20648: Attribute option 'Display in check-out' should be renamed
    
    This patch rewords the 'Display in check-out' option in the patron
    attribute policy
    
    To test:
    
    1) Apply patch
    2) Go to /cgi-bin/koha/admin/patron-attr-types.pl?op=add_attribute_type
    3) Check that the 8th line down has been renamed to "Display in patron's
    brief information:"
    4) Check the description of this same option has been changed to "Check
    to show this attribute in the brief information panel in the patron's
    record (staff client)."
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2611789b1ffad7be201cad50cff263428f688e53
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Mar 26 07:41:46 2020 -0400

    Bug 24475: Cronjobs don't always live in misc
    
    In git installs, cronjobs live in misc, but for package installs, they
    live under bin. Let's just still with 'misc/cronjobs' which is always
    cromulent.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c923f2f622b39bd2345561a7c8c74f30db61daf4
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Wed Mar 25 21:59:22 2020 +0000

    Bug 24475: Reword FinesMode system preference
    
    This patch changes the wording of the FinesMode and
    CalculateFinesOnReturn system preferences explanations
    
    1) Install Patch
    2) Check that the wording of the FinesMode system preference has changed
    to "NOTE: If the misc/cronjobs/fines.pl cronjob is being run, accruing
    and final fines will be calculated when the cron runs and accruing fines
    will be finalized when an item is returned. If CalculateFinesOnReturn is
    enabled, final fines will be calculated when an item is returned."
    3) Check that the wording of the CalculateFinesOnReturn system
    preference has changed to add "NOTE: This system preference requires
    FinesMode to be set to 'Calculate and charge.'" to the existing note.
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 70aee86791d17754fa2300c38908ee8049cb7106
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Mar 19 10:51:40 2020 -0300

    Bug 24905: Make installer update log4perl.conf for instances
    
    This patch makes koha-common.postinst check if the log4perl.conf files
    on the instances need tweaking. If they do, it appends the relevant
    configuration text.
    
    To test:
    1. Install Koha 19.11 or earlier using the packages
    2. Create an instance:
       $ koha-create --create-db test1
       $ koha-create --create-db test2
    => FAIL: /etc/koha/sites/test1/log4perl.conf doesn't include an entry for
    z39.50
    3. Apply this patch and run:
       $ docker run \
          --volume=/path/to/your/clone:/koha \
          --volume=/dest/path/for/debs:/debs \
          --privileged
          --env VERSION=19.12.00.047 \
          koha/koha-dpkg:master
    Note: Paths need to be adjusted
    4. Grab the .deb files and put them on the machine you're testing this
    5. Edit /etc/koha/sites/test2/log4perl.conf and add the following text
       at the bottom: log4perl.logger.z3950
    6. Install the debs:
       $ sudo dpkg -i koha-perldeps koha-deps koha-common
    => SUCCESS: Install process doesn't explode due to the addition
    => SUCCESS: /etc/koha/sites/test1/log4perl.conf has a new entry for log4perl.logger.z3950
    => SUCCESS: /etc/koha/sites/test2/log4perl.conf doesn't have a new entry for log4perl.logger.z3950
    7. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7f606ff6bf108c2e70d6698e51e7194759d5151a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Mar 19 09:47:25 2020 -0300

    Bug 24905: Add missing entry in log4perl-site.conf.in
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a8ea4c1df8b3c325f6c6da4e91d81c1dc1a3943d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Mar 26 13:38:07 2020 +0000

    Bug 24988: Default to autorenew_checkouts for new patrons
    
    To recreate:
    1 - Create a new patron on the staff interface
    2 - Note that 'Allow auto-renewal of items' defaults to 'no'
    3 - Apply patch
    4 - Create another patron
    5 - 'Allow auto-renewal of items' defaults to 'yes'
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Devinim <kohadevinim@devinim.com.tr>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a5576f62ebe2e6b22437312cc130b522e7cd9eae
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Mar 26 08:53:59 2020 -0400

    Bug 24964: Fix perl critic warning
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 693d56d0e94a01deb71b1f26d6e9ad848ff7598a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 25 13:50:45 2020 +0100

    Bug 24964: Prevent random failures sorting by borrowernumber
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a23ba31664b241410d695527583b898992c5705
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 25 11:21:15 2020 +0100

    Bug 24964: Do not filter patrons after they have been fetched
    
    The svc/members/search script is called in different places.
    In some places (Set owner for a fund, add users to a fund, or set a
    manager to a suggestion), we need patrons to be filtered depending on
    the permissions they have.
    For instance you can only set a fund's owner with a patron that has
    acquisition.order_manage.
    
    Currently we have fetching X (default 20) patrons, then filter them
    depending on their permission.
    Says you have 3 patrons that have the correct permissions but are not in
    the 20 first patrons, if you do not define a search term, the search
    result will be empty.
    
    This is not ideal and we should filter when requesting the DB.
    
    Test plan:
    - Have more than 20 patrons, remove them their permissions
    - Create 3 more:
    1 superlibrarian
    1 with the full acq permission
    1 with acquisition.order_manage
    - Create a fund and set a owner
    - Search for patrons, without specifying a search term (to get them all)
    => Without this patch the new patrons you created are not displayed
    => With this patch they are!
    
    Same test plan apply to set a manager to a suggestion (freshly pushed,
    see bug 23590), with suggestions and suggestions.suggestions_manage
    
    Note: The code has been written that way to rely on
    C4::Auth::haspermission, but the SQL query is quite trivial and the gain
    is important.
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f1bc7201d71f89adc84ab03d2a3e2447bad873ba
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 25 11:20:20 2020 +0100

    Bug 24964: Add tests
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ed5f3ecc05be45038293588e429d796760476c96
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Wed Mar 25 20:52:19 2020 +0000

    Bug 24976: Guided report - "Save" button on last step is misleading
    
    This patch changes the text of the save button on the final step.
    
    To test:
    
    1) Build a guided report (the selections are immaterial)
    2) Note that after you have been through the six stages, the button on
    the "Confirm custom report" screen should be labelled "Save"
    3) Install patch
    4) Repeat Step 1. Note that on the "Confirm custom report" screen, the
    button is now labelled "Next".
    5) Run the report to check that the functionality still works.
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Devinim <kohadevinim@devinim.com.tr>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77f481a37b9e97aab7f8db1b7e9215fd0ca5d904
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 27 08:20:47 2020 +0100

     Bug 20415: (follow-up) DBRev 19.12.00.056
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>

commit 39e8fd30d73f804054bb2fe42441abb445a73bfc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 26 15:51:54 2020 +0000

    Bug 13881: (RM followup) Fix incorrect idempotency test
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1597f2f007e4a7d097f9d8501f3153f95381f62c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 26 15:29:04 2020 +0000

    Bug 20399: (RM follow-up) Fix update statement
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 31fdbb999cf0af2453198f969c00a08d2d850051
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 26 12:01:57 2020 +0000

    Bug 14715: DBRev 19.12.00.058
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fa8cfc96c5b9005ccdc827b49e1c4ee94a061d2b
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Mar 25 20:47:40 2020 +0000

    Bug 14715: (QA follow-up) Remove limit on Zebra
    
    Found in testing that this appears to work well for Elasticsearch -
    so removing everything that made this Zebra only.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit df4dcd9ccb1efc778b720047e2df35d26e09f8c2
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Mar 25 20:08:53 2020 +0000

    Bug 14715: (QA follow-up) Add missing filters
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit db0b15ab37115bcfabac3c1c39cbbce235c6a41a
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 25 20:40:57 2020 +0000

    Bug 14715: (follow-up) Keep results per page setting when selecting facets and sorting results
    
    Also adding missing filters
    
    ALSO ensuring you can switch back to library default on staff side
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 22b44f3d874502df0572fa5de04497290cad7bb3
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Nov 5 02:53:26 2019 +0000

    Bug 14715: Results per page dropdown for catalogue search
    
    This patch utilises an unused search facet to handle results shown per
    page.
    
    Sponsored-by: Region Halland
    Signed-off-by: Gabriel DeCarufel <gabriel@inlibro.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d0ec2d414ffd37ddaac67b94e8406ba6bcd245f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Mar 24 12:14:21 2020 +0000

    Bug 16457: (follow-up) Enable click event on dynamically-created elements
    
    This patch moves the click handler for patron attribute actions ("new",
    "clear") from the links themselves to the container. This allows jQuery
    to correctly target dynamically-created copies of the links.
    
    To test you should have extended patron attributes enabled and you
    should have some repeatable attributes defined.
    
     - Create or edit a patron record
     - In the "Additional attributes and identifiers" section, test the
       "Clear" and "New" links. Confirm that the controls work with both the
       original instance of the field and those created by clicking "New."
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2f998ab38d213ceb8868380a8042c05e41209deb
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Mar 17 23:57:06 2020 +0000

    Bug 16457: Remove the use of "onclick" from the patron entry form
    
    This patch removes several event attributes from the patron entry form
    and replaces them with event handlers in the <script> block.
    
    Some event attributes were removed altogether because they weren't
    functional: Onchange events on jQueryUI datepickers don't work, and they
    would have been redundant even if they did work.
    
    To test you should have some patron attributes configured
    (Administration -> Patron attribute types). At least one attribute
    should be configured to apply to one particular patron category.
    
    Apply the patch and begin the process of adding a new patron.
    
    1. Try to add a patron with details matching a patron which already
       exists. You should get a confirmation message on screen which asks if
       the patron is a duplicte. Test the link which shows the existing
       record. It should trigger a popup window with details about the
       patron.
    
    2. Test the process of setting a patron's date of birth. Selecting a
       date should trigger the display of the patron's age immedately below
       the field.
    
    3. Test that you cannot set a patron's expiration to a date which
       precedes the date in the registration date field.
    
    4. Test that you can add a manual restriction's expiration date, and
       that the "Clear date" link works correctly.
    
    5. Test that the "clear" and "new" controls links work with additional
       attributes and identifiers.
    
    6. Test that changing the patron's category correctly affects the
       display of available attributes and identifiers: The attribute you
       have associated with a particular patron category should only show if
       that category is selected under "Category."
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b3806e24e0b3b4b3af7685c659321e9375bfdf47
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 26 11:57:26 2020 +0000

    Bug 20399: DBRev 19.12.00.057
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4bdb6da03052fd3e3ddb7d73e5cfd608f0b8238f
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Mar 25 21:34:46 2020 +0100

    Bug 20399: (QA follow-up) Remove mention of INTRAdidyoumean from text and delete commented code
    
    Removes some last "remains" of INTRAdidyoumean.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7a7420f259d03e2b2ced173658e29edc957cd42
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu Mar 19 17:59:39 2020 +0300

    Bug 20399: Remove "did you mean" for the staff interface
    
    The amdin page for the "did you mean" feature has two block for setting it up in the staff interface, and a note saying this isn't implemented on the staff interface yet.
    We remove the part about the staff interface until it actually is implemented.
    
    Test plan :
    1) Apply patch
    2) Go to Administration > Did you mean?
    3) See there is only the OPAC block
    4) Change some checkboxes
    5) Save configuration
    6) Check that configuration is saved
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f2579bd8d2d1776ac91cec199f6c6cd420bf1756
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 26 11:54:44 2020 +0000

    Bug 20415: DBRev 19.12.00.056
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f00eda15f06fc56a9fff3ea9a7a634d60c9e1182
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Mar 25 09:27:30 2020 -0400

    Bug 20415: Add POD
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 21c9b685bfdb255a872ce27d4e0570673d0de8e7
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu Mar 19 17:22:30 2020 +0300

    Bug 20415: Remove UseKohaPlugins system preference
    
    Owen Leonard 2018-03-16 10:47:47 UTC :
    <<
    I don't think the system preference adds any security. There are already multiple permissions required for working with plugins:
    
    - Configure plugins
    - Manage plugins ( install / uninstall )
    - Use report plugins
    - Use tool plugins
    
    And even with those permissions your server must be configured to allow the use of plugins.
    >>
    
    Test plan :
    1) Install kitchen sink plugin https://github.com/bywatersolutions/koha-plugin-kitchen-sink
    2) Run misc/devel/install_plugins.pl
    3) Set config enable_plugins=1
    4) Check all parts of the plugin are working
    5) Set config enable_plugins=0
    6) Check all parts of the plugin are disabled
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f6c322e3253a8c9893144d19da111e5b5c8a55cf
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu Mar 19 17:01:13 2020 +0300

    Bug 20415: add Koha.ArePluginsEnabled Template Toolkit method
    
    In order to remove UseKohaPlugins syspref, adds to Koha Template Toolkit
    plugin a method ArePluginsEnabled().
    
    Test plan:
    1) Set syspref UseKohaPlugins enabled
    2) Set config enable_plugins=1
    3) Check you see "Tool plugins" in "Tools" home page and menu
    4) Check you see "Manage plugins" in "Koha administration" home page
    5) Check you see "Report plugins" in "Reports" home page and menu
    6) Set config enable_plugins=0
    7) Check you don't see in 3) 4) 5)
    8) Run prove t/Koha_Template_Plugin_Koha.t
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a29e0d480251055040438cb53238424d5a75af26
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 11 17:21:38 2020 +0100

    Bug 24614: Use Koha::Reports from save_report and update_sql
    
    In order to get the default value defined at DBMS level, we use
    Koha::Reports (to inherit from Koha::Object->store) from the 2 add/edit
    methods of C4::Reports::Guided.
    A second step would be to remove completely those CRUD subroutines and
    use directly Koha::Reports instead.
    
    Test plan:
    1. Add and edit some reports
    2. Disable memcached, create a report, edit it
    => Should not crash
    3. Make sure the tests make sense and that they pass after the second
    patch.
    
    The error was:
    DBD::mysql::db do failed: Column 'cache_expiry' cannot be null [for
    Statement "UPDATE saved_sql SET savedsql = ?, last_modified = now(),
    report_name = ?, report_group = ?, report_subgroup = ?, notes = ?,
    cache_expiry = ?, public = ? WHERE id = ? "] at
    /kohadevbox/koha/C4/Reports/Guided.pm line 633.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d84a36d24259a9dfc9dd24af708c79b2f759f4a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 11 17:21:15 2020 +0100

    Bug 24614: Add tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b372daa298f984715745268d721d67b4fb2fbd3a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Mar 9 09:33:54 2020 -0400

    Bug 24829: ClaimReturnedWarningThreshold is always triggered if patron has one or more claims
    
    ClaimReturnedWarningThreshold is supposed to display a warning if a patron has more than the number of claims specified in the system preference. Currently the warning is displayed for any number of claims over zero.
    
    Test Plan:
    1) Make 3 return claims for a patron
    2) Set ClaimReturnedWarningThreshold to 4
    3) Note the claims warning displays for the patron on circulation.pl
    4) Apply this patch
    5) Reload circulation.pl, the warning should go away
    6) Set ClaimReturnedWarningThreshold to 2
    7) Reload the page, the warning should reappear
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 066ff4e7875bbbb16734853d139a721829004142
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Mar 23 20:10:15 2020 +0000

    Bug 24959: Fix id/label pairs in saved reports table
    
    This patch adds a unique id attribute to each checkbox in the table of
    saved reports. Also updated is the corresponding <label>'s "for"
    attribute so that clicking the report id will toggle the checkbox.
    
    To reproduce, go to Reports -> Use saved and click a number in the ID
    column. Nothing happens.
    
    After applying the patch clicking the number should check or uncheck the
    corresponding checkbox.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Works Ok, no errors.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e87908078fe7866f6a31815d41e4c9409de57719
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 17 11:37:12 2020 +0100

    Bug 24878: Add auth check for copy-holidays
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2b2c61ff99c660be510339b8d83e719b9e054e4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 16:26:48 2020 +0100

    Bug 24878: Add authentication checks to the calendar tool
    
    There is a security hole in 2 scripts that are used by the UI to edit
    holidays.
    
    To test:
    1) Go to Tools -> Calendar, for Centerville
       Check no holiday for 30/4/2020
    2) To add a new holiday without login execute
       a curl command with necessary parameters
    3) Reload page from 1), verify the new holiday
       edit and delete the holiday
    4) Apply the patch
    5) Do 2) again, this time you get a lengthy output,
       with the magic words:
    
       <title>Koha &rsaquo;
           Log in to Koha
       </title>
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 649bfe1ee2dc4825d44e7d9d200e8a21f8d8d430
Author: David Cook <dcook@prosentient.com.au>
Date:   Mon Feb 17 06:50:49 2020 +0000

    Bug 24673: Add CSRF token support to opac-messaging.pl
    
    This patch adds CSRF token support to opac-messaging.pl,
    which allows users to manually update their messaging preferences,
    but prevents bad actors from tricking people into updating their
    preferences from cross-site requests.
    
    Test plan:
    0. Set SMSSendDriver global system preference to "Test" if unset
    1. Log into the OPAC
    2. Navigate to a URL in your browser like the following:
    http://localhost:8080/cgi-bin/koha/opac-messaging.pl?modify=yes
    &1=email&digest=1&2-DAYS=5&2=email&digest=2&4=email&SMSnumber=0444444444
    3. Observe that the preference and SMS number update
    
    4. Apply the patch
    
    5. Navigate to a URL in your browser like the following:
    http://localhost:8080/cgi-bin/koha/opac-messaging.pl?modify=yes
    &1=email&digest=1&2-DAYS=5&2=email&digest=2&4=email&SMSnumber=0444444444
    6. Observe that you get an error message of "Wrong CSRF token" instead
    of the previous behaviour
    7. Navigate to a URL in your browser like the following:
    http://localhost:8080/cgi-bin/koha/opac-messaging.pl
    8. Update "Advance notice" to 3 and update "SMS number" to 61111111111
    9. Observe that the "Advance notice" and "SMS number" fields update
    correctly
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6902efac2263d839f6468b62a18baf0182d81e38
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 26 09:59:32 2020 +0100

    Bug 24801: Display all the libraries - Selenium fix
    
    Same as for categories.
    
    22:41:28 koha_1       | STRACE: /usr/share/perl5/Try/Tiny.pm:104 in Selenium::Remote::Driver::catch {...}
    22:41:28 koha_1       |         /usr/local/share/perl/5.20.2/Selenium/Remote/Driver.pm:353 in Try::Tiny::try
    22:41:28 koha_1       |         (eval 1337):1 in Selenium::Remote::Driver::__ANON__
    22:41:28 koha_1       |         (eval 1339):2 in Selenium::Remote::Driver::__ANON__
    22:41:28 koha_1       |         /usr/local/share/perl/5.20.2/Selenium/Remote/Driver.pm:1330 in Selenium::Remote::Driver::_execute_command
    22:41:28 koha_1       |         /usr/local/share/perl/5.20.2/Selenium/Remote/Driver.pm:1330 in (eval)
    22:41:28 koha_1       |         /kohadevbox/koha/t/lib/Selenium.pm:174 in Selenium::Remote::Driver::find_element
    22:41:28 koha_1       |         /kohadevbox/koha/t/lib/Selenium.pm:166 in t::lib::Selenium::click_when_visible
    22:41:28 koha_1       |         t/db_dependent/selenium/administration_tasks.t:128 in t::lib::Selenium::click
    22:41:28 koha_1       |
    22:41:28 selenium_1   | 14:41:28.273 INFO - Executing: [take screenshot])
    22:41:28 selenium_1   | 14:41:28.873 INFO - Done: [take screenshot]
    22:41:31 koha_1       |
    22:41:31 koha_1       | SCREENSHOT: https://framapic.org/0nvX5dhLHpU1/tAEnENSeLRXB
    22:41:31 koha_1       | An element could not be located on the page using the given search parameters: //div[@class="main container-fluid"]//a[contains(@href, "/admin/branches.pl?op=add_form&branchcode=UT_BC")],xpath at /kohadevbox/koha/t/lib/Selenium.pm line 174.
    
    The screenshot was obvious, the UT_BC was not on the first page.
    There was a total of 33 libraries at this point, which is not expected,
    maybe data not deleted from previous selenium tests.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 45a127812b77b9ec1ed7d27bac1da3bc9e1f4eed
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 25 13:40:04 2020 +0000

    Bug 24455: (follow-up) Document function
    
    This patch just adds some minimal documentation to the main exported JS
    function.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9222c0b1c4206692274237b53925aa4b2d21f10a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Mar 4 08:51:42 2020 -0500

    Bug 24455: Add Moment.js to About page
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8412c19c50c8d7e051071053459cdc1a5b7b8637
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri Jan 17 16:19:30 2020 -0300

    Bug 24455: Add JS functions to format date and datetime strings
    
    This patch adds the a js-date-format.inc file on each opac and staff interface (date-format.inc whas not available as name)
    
    When you include that file in your TT, you'll get the following functions available:
    
    1. $date(raw_date_string, options)
    
       This function parses a date string, as produced by an api call, and returns the corresponding date formatted according to 'dateformat' and 'TimeFormat' parameters.
    
       For example:
    
       // dateformat: us
       // timeformat: 12hr
       // Timezone: UTC
    
       $date('2020-03-23T15:00:00+01:00') // You will get '03/23/2020'
    
       $date('2020-03-23T15:00:00+01:00', {withtime: true}) // You will get '03/23/2020 14:00'
    
       $date('2020-03-23T15:00:00+01:00', {withtime: true, tz: 'Europe/Paris'}) // You will get '03/23/2020 15:00+01:00'
    
       Options:
    
       * dateformat: override date format as configured in staff interface (accepts also 'rfc3339')
    
       * timeformat: override time format as configured in staff client (available options are '12hr' and '24hr')
    
       * withtime: also print the time part (default false)
    
       * tz: set the timezone
    
    2. $datetime(raw_date_string, option)
    
       The same as $date but sets withtime to true
    
    3. $time(raw_date_string, option)
    
       The same as $datetime but shows only the time part
    
    To test you must implement and test bug 20936, where it will be used
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e7c240224f31ab01a28e5596d084a0b47bff7c54
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri Jan 17 18:04:55 2020 -0300

    Bug 24455: Add moment-timezone library in staff
    
    This patch adds koha-tmpl/intranet-tmpl/lib/moment/moment-timezone-with-data-10-year-range.min.js in order to use the moment library with timezones (https://momentjs.com/timezone/)
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d298ab457e81769693fa06e1a5d3d79b61924e06
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri Jan 17 16:19:30 2020 -0300

    Bug 24455: Add moment-timezone library in opac
    
    This patch adds koha-tmpl/opac-tmpl/bootstrap/lib/moment-timezone-with-data-10-year-range.min.js in order to use the moment library with timezones (https://momentjs.com/timezone/)
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bbfadf00d96c732d8134785c2fbcc2d8d0a5b77c
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri Jan 17 18:03:48 2020 -0300

    Bug 24455: Add moment library in staff
    
    This patch adds koha-tmpl/intranet-tmpl/lib/moment/moment.min.js in order to use the moment library (https://momentjs.com/)
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e762264835eea364100955443c2fcabbfc997e27
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri Jan 17 16:19:30 2020 -0300

    Bug 24455: Add moment library in opac
    
    This patch adds koha-tmpl/opac-tmpl/bootstrap/lib/moment.min.js in order to use the moment library (https://momentjs.com/)
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a185bc87b5e904128a07ee208ef66b5b12b51e9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Mar 23 19:48:25 2020 +0000

    Bug 24886: (follow-up) Add markup comments
    
    This patch adds comments to the template to highlight the markup
    structure.
    
    This patch should have no effect on the interface or functionality.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ae955d641074ea5ad3e15e94ccfbe26ab2cd3158
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Mar 17 00:55:05 2020 +0000

    Bug 24886: Reindent reports template
    
    This patch reindents the template for saved reports, replacing tabs with
    spaces and making indentation consistent. Some lines have been split up.
    
    To test, apply the patch and go to Reports -> Use saved.
    
     - Test adding, editing, viewing, and running reports
     - Test filtering by group and subgroup
     - Test the process of adding a guided report
    
     Everything should work as expected.
    
     Use your preferred method for checking the differences between files
     while ignoring whitespace. I use diff with the  "-w" flag, but I'm not
     your dad. The only changes you see should be split lines.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a91378ad71071aa83c21fed776afd819be40b79b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 23 09:33:27 2020 +0100

    Bug 24158: Add missing html filters
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fe9be399815eaa15675b41f181a54ee4c5d15bf0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 4 17:40:17 2019 +0100

    Bug 24158: Convert actual cost in an other currency when receiving
    
    This patch adds a currency dropdown list to the Actual cost field when
    receiving items in the acquisition module.
    The idea is to let the librarian entered a price in a foreign currency
    that will automatically be converted in the local currency ('active').
    This converted value will be use as the actual cost once the form is
    submitted.
    
    Test plan:
    - Create several currencies with different rates
    - Create an order, close the basket and receive
    - On the receipt page you will notice a new "change currency" checkbox
    right close to the 'Actual cost' input.
    - Check it
    => The 'Actual cost' input is readonly and a new line appears at the
    bottom.
    - Enter a number and select a currency
    => The 'Actual cost' input is automatically filled with the converted
    value
    - Save
    => The converted Actual cost has been inserted in the database.
    
    Sponsored-by: Athlone Institute of Technology
    Signed-off-by: Devinim <nazli@devinim.com.tr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b772d1fd3ddd44ac79e44a9fdd39431b45e3b398
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 9 14:53:05 2020 +0000

    Bug 24828: Add ability to specify cash register in SIP config
    
    This patch adds the ablity to specify a cash register id to link to
    payments taken via SIP2 clients.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 740ef078f40e4d0bd7c452cbe993dfec3bcd2491
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 25 12:45:13 2020 +0100

    Bug 23590: Add notice template for translated installer files
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit be3c868169b049a33e477bf31fa63e8c3a431899
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 25 11:19:17 2020 +0000

    Bug 23355: (RM follow-up) Make DB update idempotent
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7ce4122131a6c3d7f0fe7c953dc95fd5d831bf7f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Mar 24 12:42:11 2020 +0000

    Bug 24745: (follow-up) Correct return statement in news plugin
    
    Subroutine should "return;" instead of "return 0;"
    We also prevent ProhibitExplicitReturnUndef by not returning "undef"
    explicitly.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b1523255a8c53d50175ac55f94330995663e6937
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Feb 27 01:31:37 2020 +0000

    Bug 24745: OPAC news block plugin should evaluate as false if there are no items
    
    This patch changes the way news is returned from GetNewsToDisplay in
    KohaNews.pm so that the template variable will evaluate as false instead
    of simply being an empty data structure.
    
    To verify the bug, remove your opacheader news entry and view source on
    any page in the OPAC. You should find some empty markup right after
    '</div> <!-- /navbar -->'
    
    <div class="container-fluid">
        <div class="row-fluid">
        </div>
    </div>
    
    To test the fix, apply the patch and reload the OPAC page. The empty
    divs should be gone. Add content to the opacheader news item and confirm
    that it displays correctly.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18ad5f5eea8aab8414783f4b75408cfebd2518da
Author: Andrew Nugged <nugged@gmail.com>
Date:   Wed Jan 15 00:50:49 2020 +0200

    Bug 24185: Make holds page fast when 'on shelf holds' set to 'If all unavailable'
    
    When "reserve/request.pl -> C4/Reserves.pm::IsAvailableForItemLevelRequest" called many times with hundred of items and "on shelf holds" parameter set to "If all unavailable" for these items + patron, it goes slow.
    
    It happens because in subloop it is checking if all items available so it is O(n^2) and it re-checks each time the same info for each item with repeating DB/data requests.
    
    Fix:
    The inner loop 1:1 picked out into separate subroutine and called outside of the loop, saving data in 'items_any_available' variable once, this variable passed to IsAvailableForItemLevelRequest to be used inside as the precalculated result.
    
    This made algorithm O(n) instead of O(n^2) so there is noticeable speed increase.
    
    How to reproduce:
    
    1) on freshly installed kohadevbox create/import one book,
    remember that biblionumber for later use it in down below,
    
    2) add 100 items for that book for some library,
    
    3) find some patron, that patron's card number we will
    use as a borrower down below to open holds page,
    
    4) check for the rule or set up a single circulation rule
    in admin "/cgi-bin/koha/admin/smart-rules.pl",
    that rule should match above book items/library/patron,
    check that rule to have a non-zero number of holds (total, daily, count) allowed,
    and, IMPORTANT: set up "On shelf holds allowed" to "If all unavailable",
    ("item level holds" doesn't matter).
    
    5) open "Home > Catalog > THAT_BOOK > Place a hold on THAT_BOOK" page
    ("holds" tab), and enter patron code in the search field,
    or you can create a direct link by yourself, for example, in my case it was:
    /cgi-bin/koha/reserve/request.pl?biblionumber=4&findborrower=23529000686353
    
    6) it should be pretty long page generation time on old code, densely increasing for every hundred items added. In the case of this solution, it's fast, and time increases a little only, linear.
    
    I tested on my computer in VirtualBox for page generation times,
    did 3-5 runs for same case to check if results are stable, and got such values:
    
    (old code):
      100 items:    50 seconds
      200 items:   3.2 minutes
      300 items:   7.3 minutes
    
    (version with fix):
      100 items:   4.4 seconds
      200 items:   7.5 seconds
      300 items:  10.4 seconds
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d3a37911cfbddfa99f50d06e9c423a4a05e89557
Author: Andrew Nugged <nugged@gmail.com>
Date:   Tue Jan 14 22:51:57 2020 +0200

    Bug 24185: Make holds page faster: Preparatory refactoring
    
    This is just refactoring. extracting logically independent code
    to separate sub + tests update. No logic change yet.
    
    Searching for "any_available" item among all biblionumber items was done
    inside of "elsif on_shelf_holds == 2", and it is logically very independent
    piece of code (this "@items" loop), it needs just biblionumber and patron
    as parameters so it can be extracted into separate subroutine, and
    later also called/reused from somewhere else.
    
    This ability to call from another place also made for future patch
    to remove O(n^2) problem with nested loops.
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit edef63e5a890a80d4cd9b02a4b6cbd7fe3d72890
Author: Andrew Nugged <nugged@gmail.com>
Date:   Thu Dec 19 18:20:24 2019 +0200

    Bug 24185: Make holds page faster - Call to subroutine moved below "if"
    
    `$on_shelf_holds` was assigned before "return .. if" but not used in that code piece,
    so sometimes it was useless. Moved assignment after "return .. if".
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7ecd21a1e463db9c504b0d8929b11f7cfdcdb031
Author: Andrew Nugged <nugged@gmail.com>
Date:   Thu Dec 19 18:16:33 2019 +0200

    Bug 24185: Make holds page faster - Improved "if"
    
    `$can_item_be_reserved eq 'OK'` moved in `&&` before `IsAvailableForItemLevelRequest`
    to cut away with static known values before calling to more resource consuming subroutine.
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a0b8805ce39fb5ea8ba147466f82f5af41815cd0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 25 09:38:32 2020 +0000

    Bug 23590: DBRev 19.12.00.055
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3edf95f6b0e419842a71f1fbb52abeb240e63ff7
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue Mar 24 14:53:26 2020 +0000

    Bug 23590: (QA follow-up) Fix links to patron records (TT variable confusion)
    
    Fixes links to the patron accounts from the edit and list view of
    suggestions.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a55f89c4beb57d866237dfbf5f51b079c756f20c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 24 13:05:19 2020 +0100

    Bug 23590: DBIC Changes
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2eff7c0faff8faf73200d173f2f893ef52ea0b25
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 24 12:12:06 2020 +0100

    Bug 23590: Fix 'select manager' when creation a suggestion
    
    On creating the TT var managedby_patron does not exist yet
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d1ca63aada1c471baabb7d55d3963895e819921
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 18:46:22 2020 +0100

    Bug 23590: Create a separate template notice NOTIFY_MANAGER
    
    To separate the two feature we want to create a distinct template
    notice.
    A new NOTIFY_MANAGER notice is added.
    A follow-up patch will be added for other languages, when this one will
    be approved by QA.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 822936b79b93ebf5485f6512a4e4e665e3efd7c5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 18:31:05 2020 +0100

    Bug 23590: Fix ergonomic issue if last modification by is empty
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 565fb64783bb83dca108755c9c7c897349667aa5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 18:21:56 2020 +0100

    Bug 23590: Update new fields with relevant values
    
    We are filling lastmodificationdate and lastmodificationby depending on
    the max dates between manageddate, accepteddate and rejecteddate
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f148272e0636e478d89951fab06a88ba203a2c4b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 3 11:19:46 2020 +0100

    Bug 23590: Remove unused variable
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5ce2d5cb7fb5e47e12554b9483459329ec693b91
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Jan 31 21:18:29 2020 +0000

    Bug 23590: (QA follow-up) Fix some problems created by recent changes and updatedatabase statement
    
    - Ensure that the sequence of columns will be the same for new
      and updated installations (add AFTER ...)
    - Fix permissions (see bug 22868)
    - Fix column configuration (see 16784)
    - Remove '- ' displying before the date
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 39e127b000554d403788ff1107c9241c0cbafef0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 31 14:35:39 2020 +0000

    Bug 23590: (QA follow-up) Add missing filters and drop script type
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c023185a8846564b9337d1156085547360480dcd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 13 17:49:59 2019 +0100

    Bug 23590: Fix select manager on list for all tabs
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a956d7f97b0ce2cd7e18d50a4d405ce7fc2fe19
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 13 16:39:18 2019 +0100

    Bug 23590: Remove JS error on the suggestion list
    
    The notify option is only available from the edit view
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dbdcae1ccbd52334121b5a3ecb827c3c17b6c8a7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 13 15:55:19 2019 +0100

    Bug 23590: Add atomic update file
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit def0cd93b29eab3732c925dbd8c6a214d6638f25
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 7 15:32:50 2019 +0100

    Bug 23590: Add lastmodification by and date columns
    
    No tests are provided for the changes made to SearchSuggestion. It is
    going to be remove very soon as it is super ugly...
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1a36c26ac5a49c812a6e5efbb77610757dbf77e9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 7 14:42:12 2019 +0100

    Bug 23590: Add the ability to notify a new manager
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cdcb7474b9c73f3707257477fe6b7b2c1a3b0023
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 19:59:21 2019 +0100

    Bug 23590: Only return patrons that have the suggestions_manage permission
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2de3d34de4d2e49e53a1ecd9e73a78828659f30
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 19:41:36 2019 +0100

    Bug 23590: Batch update manager for suggestions
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 91b9c09bf2d96ae88a299d37891f8b0dc10abd0b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 19:17:32 2019 +0100

    Bug 23590: Cleaning - Remove op_* vars
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0370e0dcd2585c3de0245718c6da43ad86f82ae8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 19:16:57 2019 +0100

    Bug 23590: Clean TT variables for patrons
    
    Just a bit of cleaning
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit efa3525c8df4650ae057a8d8e61e6200b0c461f0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 19:05:05 2019 +0100

    Bug 23590: Add ability to edit the manager of a suggestion
    
    Prior to this patch there was an hidden behavior that set the manager to
    the logged in user when a suggestion was edited. This patch proposes to
    let the librarian pick another manager.
    Other small adjustements will be added to polish this new behavior:
     * Create 2 new DB columns: suggestions.lastmodificationby and
     suggestion.lastmodificationdate
     * Choose a manager when editing a suggestion
     * Batch modify suggestions and set a manager for them
     * Let notify the new manager using the TO_PROCESS letter
     * Display the manageddate, lastmodificationby and lastmodificationdate
     info where appropriate
    
    This first patch adds a new "Select manager" link when editing a
    suggestion.
    
    Test plan for the whole patchset:
    0/
      a. Execute the update DB entry, generate the new DBIC file and restart all
      b. Create at least 2 patrons with the suggestions_manage permission
    1/ Submit a new suggestion (OPAC or staff, not important)
    2/ Accept it
    3/ Edit it
    => "Last modification by" is empty
    => You see that you are the manager of this suggestion
    4/ Click "Select manager" and search for a new manager
    => The patron search will only display patrons with the
    suggestions_manage permission
    5/ Save
    6/ Edit again
    => The manager is set to you, but there is a note saying that previously
    it was the patron you picked
    => The "Last modification by" is set to you
    7/ Click "Keep existing manager"
    => The manager is now set to the previous manager
    8/ Select another manager (which has a valid email address defined)
    9/ Click the "notify" checkbox
    10/ Save
    11/ Confirm that a TO_PROCESS notice has been generated into the
    message_queue table
    12/ Create at least one other suggestion
    13/ List the suggestions
    => There is a 4th action column to assign a manager to several
    suggestions in one go.
    14/ Use this new button and confirm that it works as expected
    15/ Go to your purchase suggestion list (OPAC and staff)
    => You see the "managed date" displayed in a new column
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2754423879e289046b35dcd18c9cbc04a1f7252a
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Mar 20 12:38:29 2020 +0000

    Bug 24754: (QA follow-up) Add timestamp, remove 11th parameter
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b3ecb4644ef3cd953df3a3bff75d8d4e26ad58d4
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 28 14:46:37 2020 +0000

    Bug 24754: Set userenv for ilsdi requests
    
    Currently ILSDI scripts do not have a userenv set. This affects both
    action_logs and statistics.
    
    For action_logs we either get no user or, if there is an active session, we use that one. This can have unintended consequences and we should explicitly set the env so that system user (0) is recorded
    
    For statistics we need to specify a branch to record for actions like renewals. With bug 24759 we add an items method for this. We should take advantage of this method and use the 'opac' interface as the ilsdi scripts live there.
    
    To test:
    1 - Enable ILSDI in systempreferences
    2 - Checkout an item to a patron
    3 - Enable Renewal logs
    4 - Ensure you will be able to renew the item several times
    5 - Open an incognito/private browser
    6 - Renew item via ilsdi:
        http://localhost:8080/cgi-bin/koha/ilsdi.pl?service=RenewLoan&patron_id=5&item_id=1128
    7 - Check action logs, interface may be random, user should be 0, if not make sure the user in step 9 is a different one
    8 - In private browser open a new tab
    9 - Sign in to staff client
    10 - Return to other tab
    11 - Refresh page to repeat renewal
    12 - Check action_logs
    13 - The second renewal indicates it was renewed via intranet by logged in staff member
    14 - Apply patch
    15 - restart_all
    16 - Ensure staff client still signed in
    17 - Repeate renewal again
    18 - Check logs, renewal now indicates opac again (as it should), user is 0 even if logged in on other tab
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit de7a1ff61e586f7388ff0423d53d89038f16da70
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Mar 24 12:15:26 2020 +0000

    Bug 22771: (QA follow-up) Fix POD
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9d5eba32e6b915062e1d3e7f2939448946c4fc3b
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Fri Mar 6 14:07:53 2020 +0100

    Bug 22771: Fix mistakes in list of nonfiling character fields
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da6d7f5e3345bc64bc40dd5e6cf9df8351fdb5e4
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Wed Feb 26 16:14:36 2020 +0100

    Bug 22771: Respect nonfiling indicators for search fields
    
    Strip initial characters from search fields in accordance with
    nonfiling character indicators.
    
    To test:
    
    1) Apply patch
    2) Run tests in t/Koha/SearchEngine/Elasticsearch.t
    3) All tests should pass
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bc25e2c1008e322ed446bc79273ff5b90e92578b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 25 09:28:16 2020 +0000

    Bug 13881: DBRev 19.12.00.054
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit de5a0b15a39fba67242fd90b16453717c6d340e5
Author: Nicolas Legrand <nicolas.legrand@bulac.fr>
Date:   Wed Oct 2 14:28:43 2019 +0200

    Bug 13881: Update Schema
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 50e476d00fb9ebd1fe0ee37c8a8a89b1ab6901a3
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue Mar 24 11:24:52 2020 +0000

    Bug 13881: (QA follow-up) Some documentation and terminology fixes
    
    - Branchcode = Library
    - Desk id = Desk ID
    - Show library name on desk list and when deleting desk instead of code
    - Some small changes to the database documentation.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b602048a224f8538ff014b446eaa7af548e06f2
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue Mar 24 11:24:33 2020 +0000

    Bug 13881: (QA follow-up) Check for manage_libraries permission
    
    The .pl was checking for a new permission desks_management not
    (yet) added. As the templates already checked for manage_libraries
    the .pl was changed accordingly to also use it.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c5f4a558c6cfe054de3b5d624431444d2cfd2c46
Author: Nicolas Legrand <nicolas.legrand@bulac.fr>
Date:   Wed Oct 2 14:09:21 2019 +0200

    Bug 13881: Add desk management
    
    Add a desk and linked it to a library (branch). That's it. In the
    future it'll have super features like being able to link waiting
    reserve to a specific desk.
    
    Test plan:
    
    1. go to the administration page and notice there isn't any mention of
    desk whatsoever
    2. apply patches
    3. ./installer/data/mysql/updatedatabase.pl
    4. prove t/db_dependent/Koha/Desks.t
    5. you now have desks links in admin-home and admin-menu
    6. click the link
    7. add a desk
    8. add another one
    9. delete one
    10. you should have a fair list of all current desks defined
    11. Done
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 730519ed5ca75b8a703fd05f5d61e0d8fc4bbafc
Author: Nicolas Legrand <nicolas.legrand@bulac.fr>
Date:   Wed Oct 2 14:25:50 2019 +0200

    Bug 13881: Datebase changes, kohastructure and atomicupdate
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e0bc64cae79c73a82e927762e62efc8450bfe8a9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 25 08:04:26 2020 +0000

    Bug 21800: (RM follow-up) Fix unit tests
    
    We were not setting the repeatable flag for the default framework in the
    Item2Marc tests and we also needed to flush the cash to get our
    framework changes to be recognised.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2b8900e62c40e78d9b9ea1ab59880a382ca22ca8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 24 16:25:07 2020 +0000

    Bug 21443: (RM follow-up) Fix failing tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b3b58d406ee7857a973e4f07f9732bf94f70452a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 20 11:08:23 2020 -0300

    Bug 24461: Add to_api_mapping to Koha::Acquisition::BasketGroup
    
    This patch adds to_api_mapping to the Koha::Acquistion::BasketGroup
    class.
    
    To test:
    1. Compare the mapping with the one on the RFC
    => SUCCESS: They match
    2. Sigh off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 09f2b5f90b96d3548f0d6801f8b2d64050317865
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 24 09:41:06 2020 +0100

    Bug 24962: Do not display the toolbar when editing a patron and dup is found
    
    Whe a duplicate patron is found, the toolbar to save is display without
    the button.
    We must hide it completely, user has to use the 2 buttons from the dup
    message "Editing existing" or "Save as new".
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b1c6d14d14951ace480667d778e88013460c059e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 24 11:04:28 2020 +0100

    Bug 21503: Restore existing ternary operator logic
    
    This syntax is much more readable IMO. Precendent patch also missed the
    case where the parameter was undef.
    I think we are good now.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e90641cd64e42b10079e75f092f63ee6f6281a4
Author: Christopher Brannon <cbrannon@cdalibrary.org>
Date:   Wed Oct 17 21:19:43 2018 +0000

    Bug 21503: Changed logic for checking values
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 99831b25e16b0a6b296b7312b8686c15cb44f688
Author: Christopher Brannon <cbrannon@cdalibrary.org>
Date:   Wed Oct 17 21:15:36 2018 +0000

    Bug 21503: Tests clarification for debugging
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit def50e034d0529be75641b1b0bf8b6ba8d69c12d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 15 10:45:55 2018 -0300

    Bug 21503: Tests cleanup and highlight a missing case
    
    This patch does the following changes:
    - Use build_object to create the MSS
    - Store the generate AVs. That was not the case before and so we were
    not testing the right things
    - Split the tests into 2 parts: staff and OPAC, for readability
    - Update the tests' descriptions
    - Highlight a problem: If descriptions are missing for both OPAC and
    staff, undef is returned. Is that what we expect? It seems that it is
    not what were expecting the tests.
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2e90a02fdd63be5693b481b9bdd08bf0e4c52885
Author: Christopher Brannon <cbrannon@cdalibrary.org>
Date:   Fri Oct 12 18:45:29 2018 +0000

    Bug 21503: Fix AV to fail to other values
    
    To Test (Test both detail.pl and opac-detail.pl for functionality):
        1) Apply patch (restart_all)
        2) Look up an item that has a shelving location with a description
            defined (opac description too).
        3) Remove opac description from shelving location.  Refresh
            opac-detail.pl and note that description fails back to the
            regular description.  Refresh detail.pl and note no change.
        4) Remove regular description from shelving location.  Refresh
            opac-detail.pl and detail.pl.  Note that both default to the
            shelving location code.
        5) Remove the shelving location from the LOC table all together.
            Refresh opac-detail.pl and detail.pl.  Note that both default to
            the requested shelving location code.
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ba630130651b87d83b94c1fbf4dcb149b23edefe
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 8 16:21:25 2018 -0300

    Bug 21503: Tests for the existing behavior
    
    This patch introduces 7 tests for the current behaviour for the
    AuthorisedValues template plugin.
    
    To test:
    - Apply this patch
    - Run:
      $ kshell
     k$ prove t/db_dependent/Template/Plugin/AuthorisedValues.t
    => SUCCESS: Tests pass, all green!
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 187e80d0a805f97e88bf8fd773898cb3a79be106
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Mar 13 20:52:24 2020 +0000

    Bug 24877: Add link from vendor to linked subscriptions
    
    Koha shows the number of subscriptions linked to a vendor,
    but there is no way to look them up. This adds a link to the
    subscription search with the vendor name, so there is an easy way
    to find the subscriptions.
    
    To test:
    - Be superlibrarian or have serials permission
    - Make sure you have one or more subscriptions linked to vendors
    - Go to the vendor's detail page in acquisitions
    - Verify the number of subscriptions is now a link
    - Verify the search results are correct when clicking on it
    - Remove permissions (no serials, not superlibrarian)
    - Verify now the number shows, but is not linked
    
    Signed-off-by: Nazlı Çetin <nazli@devinim.com.tr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3cdd94065c1158eb9695faa13e006c7729239fde
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Mar 13 20:30:06 2020 +0000

    Bug 24875: Remove extra punctuation from tools start page
    
    The patron clubs note was ending with .., but patch also removed
    some single . to be consistent with the majority of entries on the
    tools page.
    
    To test:
    - Check the tools start page for ending . in the notes
    - Apply patch
    - Verify the punctuation is now consistent
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 33bbbdd1a3af058896c00617f64c8972f5144a64
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 24 11:26:17 2020 +0000

    Bug 24476: DBRev 19.12.00.053
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 964a63b486ca47a6c32c31916d9d9d9f44bae1af
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue Mar 24 10:14:55 2020 +0100

    Bug 24476: (QA follow-up) Move new option below warnings and messages in OPAC account
    
    This makes it so the new option appears right above the table of checkouts etc.
    but below any warnings, messages or dialogs.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc4434d5fd43ae1bca67e4aa92241ce28fb11352
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 28 19:16:52 2020 +0000

    Bug 24476: Add boolean for TINYINT
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9933cc7b592e7a733c8eca9dddd45e850616b9fd
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Mar 23 11:48:47 2020 +0000

    Bug 24476: Schema changes
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cf1f99a017a84e867587211088996874ba5ce8c2
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Mar 22 17:07:57 2020 +0000

    Bug 24476: (QA follow-up) Standardize on 'auto renew(al)' and improve db update
    
    There were several versions: auto renew, auto-renew, autorenew
    I've decided to use auto renew (from automatic renewal) to keep
    things a bit more consistent.
    
    The DB update was missing AFTER and IGNORE for the sys pref.
    Also fixed a tiny typo (tp > to)
    Also changed
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ec4b769ddbee9c06563c8f8c80dc09b086a0b120
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 28 20:06:32 2020 +0000

    Bug 24476: Allow direct editing of autorenew_checkouts by patron
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e3c6c4beedaa7b1fafc9d7ad93d85b6b0284336a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 28 17:30:07 2020 +0000

    Bug 24476: Rename autorenewal to autorenew_checkouts
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 47f9ec94464c45830f273e560eddd5fe31ce5699
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jan 23 02:38:50 2020 +0000

    Bug 24476: Allow patrons to opt out of auto-renewal
    
    To test:
    1 - Verify on staff side that patron can be edited to opt in our out of auto renewal
    2 - Check out some items to a patron opted in to auto renewal
    3 - Ensure the items are checked out and set to autorenew
    4 - Login on the opac at the patron
    5 - Verify items cannot be renewed as scheduled for auto-renewal
    6 - On staff side, opt patron out of auto renewal
    7 - Verify on opac items are no longer marked for auto renewal
    8 - Run the auto renewal cron job, items are not renewed
    9 - Set 'no renewal before' to a setting that would prevent renewal
    10 - Verify that opting patron in or out of auto renewal changes only the reason items cannot be renewed
    11 - Set 'no renewal before' to a setting that would allow for renewal
    12 - Verify that opting patron in/out changes their ability to renew
    13 - Verify that when opted out cron does not renew
    14 - Verify that when opted in the item is auto renewed
    15 - Reset the due date, opt out, verify manual renewal succeeds
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7182ebe4567eb764b432bb147b7aae76d9fb4981
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jan 23 02:37:19 2020 +0000

    Bug 24476: Change CanBookBeRenewed and adjust tests
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4e69b19de8c95f66eabae245950224c21cf8d039
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jan 23 02:36:29 2020 +0000

    Bug 24476: API Updates
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 012af329ab2fead6426c37d2eaa9d3b5e02b0aeb
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jan 23 02:35:38 2020 +0000

    Bug 24476: Database updates
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f6028a3d34ba8a3d92362b624fe213b05df165f3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Dec 20 08:20:23 2019 +0000

    Bug 24276: Add unit tests for mandatory parameter of FillWithDefaultValues
    
    Test plan:
    Run t/db_dependent/Acquisition/FillWithDefaultValues.t
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 806b664aef0836ede9984edee6c6e131dba59d60
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Dec 19 14:17:39 2019 +0000

    Bug 24276: Add FillWithDefaultValues call in neworderempty
    
    Apply mandatory defaults from the ACQ framework to records from external
    source in Acquisition.
    
    Test plan:
    [1] Add 'BK' as mandatory default in ACQ framework for 942$c.
    [2] Add order to basket via external source.
    [3] Check 942$c on detail page of new record, MARC tab.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bb4a582a449c370faa862f98e7888f203993b8f3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Dec 19 13:46:21 2019 +0000

    Bug 24276: First change indent
    
    No other changes than whitespace, guys.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 01fcb6fe3f8c3c739ad75fa81c50bd430f2c0129
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 23 12:47:27 2020 +0000

    Bug 24951: Add id to payout modal confirm button
    
    This patch adds an ID to the payout confirmation modal on the
    borrower account details page.
    
    Test plan:
    1/ Apply patch
    2/ Attempt to issue a payout to a patron
    3/ Inspect the page and note the presence of an ID for the confirm
       button
    4/ Signoff
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fe3817a8b7d631009b60f2d408bb4115ab96ec33
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 24 11:12:51 2020 +0000

    Bug 21443: DBRev 19.12.00.052
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 17ec659f85e1a41d6fddc69709bc75f99c99a915
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Mar 23 08:06:08 2020 -0400

    Bug 21443: Remove the dependency on finesCalendar
    
    Considering that the the use of finesCalendar for this calculation is
    already a binary choice, it makes sense to remove the use of
    finesCalendar here. It is an uneccessary complication that could
    introduce confusion. Allowing this new setting to directly control
    the behavior makes it clear and obvious what is going on.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1230f0815b995080b4c0c4722961ed187c26689a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Mar 23 06:50:05 2020 -0400

    Bug 21443: Mark new columns as boolean in schema file
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 55e42a172e6541b8310267c4c82b67cc39d8c7cd
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Mar 9 13:36:22 2020 -0400

    Bug 21443: Unit tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marti Fuerst <mfuerst@hmcpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c5b6b9aa65c5869b12e0b566aecc773729a8c2da
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Mar 9 13:28:16 2020 -0400

    Bug 21443: Add ability to exclude holidays when calculating rentals fees by time period
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marti Fuerst <mfuerst@hmcpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 38ac98ffbc16aabb54d3f862c6b26c561f95507d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Mar 9 13:13:46 2020 -0400

    Bug 21443: Update Schema
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marti Fuerst <mfuerst@hmcpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f6f1a56a98119507e5f455448518a4fb23546b6b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Mar 9 13:11:55 2020 -0400

    Bug 21443: Update database
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marti Fuerst <mfuerst@hmcpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4fdc914cdd11cba4f4a08b529a5b36a39ded9343
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Mar 13 18:03:12 2020 +0000

    Bug 24837: Rename selectbranchprinter.pl to set-library.pl
    
    This renames the selectbranchprinter.pl file to the more
    fitting set-library.pl.
    
    To test:
    - Change the library with "Set library" from
      - The menu in the top navigation bar
      - The circulation start page
    - Verify the help link on page leads to the correct
      section in the manual
    - Read the code... and verify all occurences have been caught
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 287b1313696f07568d05fa41b4c4223c734d5757
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 24 11:03:54 2020 +0000

    Bug 24953: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2502a54682f1fa02aaa39373515624a2fdd6e7eb
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Mar 23 12:24:34 2020 +0000

    Bug 24953: Minor corrections to hold ratios report sidebar
    
    This patch makes some minor corrections to the sidebar form on the hold
    ratios report page:
    
     - Correct markup errors
     - Change the text of labels from "included" to "include"
     - Move checkboxes to the left of labels
    
    To test, apply the patch and rebuild the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client)
    
     - Go to Circulation -> Hold ratios
     - In the sidebar, confirm that the labels "Include ordered" and
       "Include suspended" appear to the right of their associated
       checkboxes.
     - Validate the source of the page. There should be no errors.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 637bb133da798d885189fddedd254c8bb058378d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 23 12:32:34 2020 +0000

    Bug 24952: Add id to refund modals confirm buttons
    
    This patch adds an ID to the refund confirmation modals for both
    borrower account and point of sale register details pages.
    
    Test plan:
    1/ Apply patch
    2/ Attempt to issue a refund to a patron
    3/ Inspect the page and note the presence of an ID for the confirm
       button,
    4/ Attempt to issue a refund via point of sale register details page
    5/ Inspect the page and note the presence of an ID for the confirm
       button.
    6/ Signoff
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a9a94a2686288565fae3120aa095f6fced1042d6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Mar 19 13:29:50 2020 +0000

    Bug 24907: Add 'include suspended' to holds ratio report
    
    Some libraries would like the option to ignore suspended holds when using the holds
    ratio report
    
    Note: this report fails with strict mode enabled, please disable to test
    
    To test:
    1 - Add enough holds to a record (3) to make it show on the holds ration report
    2 - Browse to Circulation->Holds ratio
    3 - Run with default settings and confirm the title shows up
    4 - Suspend one of the holds
    5 - Run report again and confirm title still shows
    6 - Apply patch
    7 - Reload the report
    8 - Note new option
    9 - Run report - title does not show
    10 - Lower ratio to 2 and confirm the hold shows
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 02adf70507e6ee7a5bd9abc09c811e38230cee11
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Aug 15 10:59:46 2019 +0000

    Bug 23409: (follow-up) Allow HTML in circulation note and add line breaks in OPAC user account
    
    This patch makes 2 changes:
    - bug 22702 allowed adding HTML to the circulation note, so this patch
      restores that ability.
    - display OPAC note and messages as multi-line in OPAC
    
    To test:
    - Add a circulation and an OPAC note with line breaks and HTML tags
      to the patron account
    - Add a message with line breaks to the patron account
    - Check line breaks don't show on
      - OPAC > patron account > my summary page
      - Staff > patron account > details
    - Apply patches
    - Repeat test
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd1bc426e10c6ebf1bc2477c4fbee279a7546cbf
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Aug 1 14:48:31 2019 +0200

    Bug 23409: show borrowernotes and opacnote's lines feeds
    
    Test plan:
      - Fill borrowernotes and opacnote with lines separated by lines
        endings,
      - save and check the content is displayed on a single line,
      - apply this patch,
      - check lines endings are displayed
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ce6229cd7535866d9394605ece70cd35a2a1952a
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Mar 27 09:44:34 2019 +0000

    Bug 22589: Remove C4::Overdues::BorType
    
    Test plan:
    0) Apply patch
    1) try to run affected scripts and ensure the amounts are corectly
    calculated for different patron categories:
        installer/data/mysql/fix_unclosed_nonaccruing_fines_bug17135.pl
        misc/cronjobs/fines.pl
        misc/cronjobs/staticfines.pl
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8986310a60e9174558c24ef6c346bb5fb239332a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 21 15:51:22 2020 +0100

    Bug 24468: Remove unused C4::Reserves::_get_itype subroutine
    
    Since bug 21206, C4::Reserves::_get_itype is not longer used and should
    be removed.
    
      commit 31c29fd31f557306233e6a2936148a5bb10b89a1
      Bug 21206: Replace C4::Items::GetItem
    
    UPDATE: In the meanwhile another occurrence was added to Reserves.t, but
    easy to replace
    
    Test plan:
      % git grep _get_itype
    must not return any occurrences.
    
    If one needs it, Koha::Item->effective_itemtype must be used instead.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 817e795df793e85f7238f280ae573db2014c9583
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Mar 22 15:06:35 2020 +0100

    Bug 22098: (QA follow-up) Improving documentation
    
    Improves the documentation of the script a bit, but makes one
    important change:
    
    -If no prefix is submitted, or prefix does not contain only
    -numbers, it returns the inserted code (= keep a field unchanged)
    +If no prefix is submitted, or the prefix does contain only
    +numbers, it returns the inserted code (= keep the field unchanged).
    
    To test:
    - Add an authorised INVENTORY value with 2020 as prefix
    - After linking the stocknumberAV.pl to the 952$i in the frameworks
    - Edit an item
    - Add 2020 in the stocknumber field
    - Trigger plugin
    - Verify nothing happens
    
    If the prefix contains only numbers... nothing happens.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ae89a44a374a7ab2585713eeedc2916a1c8f01f9
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Jul 9 00:52:31 2019 +0000

    Bug 22098: (follow-up) fix grammar/formating Perldoc
    
    - nubers => numbers
    - some vertical spacing
    - !}fmt -w65
    - "contains of letters" => "containing letters"
    
    TEST PLAN
    ---------
    perldoc cataloguing/value_builder/stocknumberAV.pl
    apply patch
    perldoc cataloguing/value_builder/stocknumberAV.pl
    -- after the patch is more readable.
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 19f2e37468e91d07f0edf2843d013f561b079106
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Jan 11 09:25:00 2019 +0000

    Bug 22098: Update stocknumberAV cataloguing plugin to use objects
    
    This patch:
    - changes SQL to Koha::AuthorisedValues
    - remove type param from script tag
    - fixes the plugin description
    
    0) Do not apply the patch
    1) Set the plugin
    1.1) Update a biblio framework and link plugin stocknumberAV.pl to some item
    subfield
    1.2) Add authorised values category called "INVENTORY"
    1.3) Add some authorised values: authorised value is prefix and
    description is a current stock/inventory number
    2) Add an item and try to use this plugin to ensure you set it
    correctly
    2.1) Use a defined prefix to see if the number is correct
    2.2) Ensure the number is correctly incremented in authorised values
    2.3) Use not defined prefix to see the error message
    2.4) Insert a not prefix string (eg number) to see it is not changed
    3) Apply the patch
    4) Repeat 2) and see it is working the same
    5) Look into patch and confirm the description does make sense and is
    rigth according to what you see in UI
    6) Sign off :D
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 47dafa24e7b9441c01228ccac701dff843c42e39
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 20 08:56:03 2020 +0000

    Bug 21800: Add tests for _check_split
    
    This new subroutine supports checking the repeatable tag from another
    framework. (It will be useful for the item editor.)
    
    Test plan:
    Run t/db_dependent/Biblio/TransformKohaToMarc.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 01219b09bae98576344e1844f1acdb87633d10e3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 13 14:35:42 2020 +0000

    Bug 21800: Check the correct framework for the repeatable tag
    
    This depends on the framework parameter. Which should be added back to
    the call in C4::Items.
    
    Test plan:
    [1] Mark in Default framework one subfield A repeatable and B not repeatable.
    Go to item editor. (Work on a biblio in Default framework.)
    Check saving and reopening these subfields with VAL1 | VAL2.
    Subfield A should be cloned, B should be glued as entered.
    
    [2] Mark in another Framework A not repeatable and B repeatable.
    Change framework for this biblio.
    Go to item editor again. Reopen item. Behavior subfields in reverse?
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f952067cb23f548a4d804bc64329fcba848b6b29
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 13 11:33:15 2020 +0000

    Bug 21800: Make TransformKohaToMarc aware of non-repeatable subfields
    
    If a kohafield (in Koha to MARC mappings) contains a pipe char (say A | B),
    we split it up into two subfields A and B in MARC.
    We will only do that for repeatable subfields now. If the field is not
    repeatable, the value will just be 'A | B'.
    
    Note 1: As bug 10306 and its friends (19096) made the Default framework
    authoritative, we do no longer have the frameworkcode in this routine.
    Formally, we should check the corresponding framework.
    
    Note 2: Does this impact the reverse operation in TransformMarcToKoha?
    No, the check on repeatable subfields is done in the interface and not
    in TransformMarcToKoha. This routine simply translates two instances of the
    same subfield, say A and B, into the value 'A | B' for a kohafield. Not
    allowing two instances of a non-repeatable subfield is not in the scope of
    this report.
    
    Test plan:
    [1] Mark an item field as repeatable in the Default framework.
        Edit an item. Insert A|B in this field and another not-repeatable
        field. Save and reopen. Verify that the repeatable field is duplicated
        and the other one contains the pipe character in the text box.
    [2] Look for a repeatable subfield in MARC like e.g. 260$c.
        Go to the cataloguing editor and add A|B in this field.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 661702e6694da80820020c98cb3e63911ef32e8f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 13 11:55:32 2020 +0000

    Bug 21800: Add tests for repeatable subfields
    
    Test plan:
    Do not apply the second patch [note 1].
    Run t/db_dependent/Biblio/TransformKohaToMarc.t
    Run t/db_dependent/Biblio/TransformMarcToKoha.t
    Apply the second patch and run them again. Both tests should pass now.
    
    Note 1: The TransformKohaToMarc test should fail with something like:
        #   Failed test 'Check 260e'
        #   at t/db_dependent/Biblio/TransformKohaToMarc.t line 60.
        #          got: 'A'
        #     expected: 'A | B'
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 15dd83268bf7a6ed05aeefc2280c41e6ca5af342
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Thu Nov 19 09:52:04 2015 +0100

    Bug 15214: bulkmarcimport should log if an authority has been updated
    
    When importing with bulkmarcimport, authorities may or may not be updated based
    on which authority is newer (005 are compared). This patch allows to keep track
    in the result yaml file if an authority has been updated or not:
    
    Signed-off-by: Jon Knight <J.P.Knight@lboro.ac.uk>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 03fac5d1a1ca0ba03c17d84a6f40c3dbd1d5e0b6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 24 10:54:00 2020 +0000

    Bug 24759: DBRev 19.12.00.051
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7195f371032328242aeb99335f5cbae3e7902063
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Mar 20 15:07:27 2020 +0000

    Bug 24759: (follow-up) Fix tests
    
    Earlier tests delete borrowers before issues, can cause a constraint failure
    
    Wrong test count
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3ffe4d162386916d3761cee0ad33c0d50e376b36
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 3 14:26:06 2020 +0100

    Bug 24759: Test intranet at the same time
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ec179067adff3486f740f7fc20600e7a51edc4da
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 3 14:22:06 2020 +0100

    Bug 24759: Simplify tests
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5ff045a83e6f9429aea6f1c4cebc5c2fe773d93c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Mar 2 17:01:42 2020 +0000

    Bug 24759: Rename renewalbranch to renewal_branchcode
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 290d385625521816f1fc858b1c9180182b5ef80c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jun 26 07:43:53 2019 -0400

    Bug 24759: Unit tests for AddRenewal
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8dfb0adc8c4ce5b75a8d945b58836fb7e41cb685
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 28 13:23:44 2020 +0000

    Bug 24759: CleanUp OpacRenewalBranch values
    
    We had a unique behvaiour where the syspref was set to string 'NULL'
    as opposed to undef, we need to clean that up
    
    To test:
    1 - Set OpacRenewalBranch to 'NULL' in staff interface
    2 - Renew via opac
    3 - Check statistics to ensure branch is blank
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6de018f65fb285620ad17357bd63897f7088b6d5
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 28 13:09:29 2020 +0000

    Bug 24759: Move OpacRenewalBranch code to Koha::Item
    
    This patchset moves all code to calculate the correct renewal branch into Koha::Item.pm
    
    When interface is opac we follow the syspref, otherwise we use the current userenv, or pass through
    a defined branch
    
    To test:
    1 - Check out an item to a patron
    2 - Set allowed renewals in the circ rules to 100 (just so you can keep testing)
    3 - Renew the item in staff interface, confirm it is recorded correctly in statistics table (as signed in branch)
    4 - Renew via the opac, testing with each setting of OpacRenewalbranch
    5 - prove -v t/db_dependent/Koha/Item.t
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f46e3fafe63b51747e0d56efeb7edf7d3097117a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 24 10:40:34 2020 +0000

    Bug 24696: (RM follow-up) Fix spaceing on command line
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f991c52cfc20333f35bccb8db2c15a9d79933a9f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 24 15:17:56 2020 +0100

    Bug 24696: Use strftime
    
    Seems easier to me.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6fd7a79b051f8b4846217e16f524282d76e05953
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 20 14:30:29 2020 +0000

    Bug 24696: Add completion times to updatedatabase
    
    This patch adds completion times to the print statements in
    updateadatabase.pl.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a7a87942fd9ebe98977f249317661654fdb9a1da
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 24 10:12:06 2020 +0000

    Bug 24131: (RM follow-up) Final Rebase
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ff3b6cf7bc0bbf27c548baf51c095b3a27cfc0ae
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 11 12:16:39 2020 +0100

    Bug 24131: Always display bug numbers on 5 characters
    
    To correctly align bug numbers < 10000
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40f6b564245d2c6517c8d4571eafd006126be85e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 11 12:00:25 2020 +0100

    Bug 24131: Remove bullet points for secondary descriptions
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 99bf2a5b04c5c44ac5f022a3d84b72580479cecd
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 10 14:31:20 2020 +0000

    Bug 24131: (QA follow-up) Formatting in web client
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e19292e329b047e225c27d9c9a436ce6809400ec
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Feb 24 13:45:30 2020 +0000

    Bug 24131: (follow-up) Another rebase
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a4101bd4d548ce36af002054e2901b0dbeb5c1f2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 20 14:29:47 2020 +0000

    Bug 24131: (follow-up) Fix and rebase
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 63c9dc8f032263f4e6a837c7dbdd327a24288f22
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 6 13:28:15 2020 +0100

    Bug 24131: Handle several descriptions
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fb74df47defbd24bf196c36429c73e510d9df95f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 6 13:07:35 2020 +0100

    Bug 24131: Move the print statement to a new subroutine
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 39b84b07c36c51da9af72c23844b4a1d20e52331
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 27 08:02:03 2020 +0000

    Bug 24052: Add koha_xslt_security to koha-conf.xml
    
    The line for enabling the unsafe expand_entities option is commented
    and includes a warning to keep it like that ;)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d77a65fe7a3a8f0fb3d7fac2419abb3cc3563d1f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 25 15:09:53 2020 +0000

    Bug 24052: Catch warning between test 5 and 6
    
    Resolve:
    ok 5 - Engine returns error on undefined text
    XSLT::Base: Empty String at /usr/share/koha/Koha/XSLT/Base.pm line 214.
    ok 6 - Engine returns error on empty string
    
    Test plan:
    Run perl Base.t and verify that this warning is no longer printed.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc2c8c37678abd80dc7c4ba2ebedd4b81855e944
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 25 14:56:15 2020 +0000

    Bug 24052: Fix Koha/XSLT/Base.t
    
    Moving the separate small attachments into the test script.
    Creating them now as temporary files or code fragments.
    Deleting original files.
    
    Since Breeding.t also used one of these files, a similar change was made in
    that script.
    
    Test plan:
    Run t/db_dependent/Koha/XSLT/Base.t. Should pass now.
    Run t/db_dependent/Breeding.t again.
    Git grep on XSLT_Handler. You should only find release notes.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2bf171acaf70b821968fec63c2bc637fbf2fa9b3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 25 14:23:55 2020 +0000

    Bug 24052: Rename XSLT_Handler
    
    Should be XSLT::Base now.
    Removes old XSLT_Handler stub too (from bug 23290).
    Result of a git grep | sed statement.
    
    Test plan:
    Run qa tools (so modules compile).
    Run t/db_dependent/Breeding.t
    Run t/db_dependent/Koha/XSLT/Base.t (This test fails when only this patch
    has been applied; see subsequent patch.)
    Enable XSLT use on results and details display. Check search results and
    detail view on OPAC and staff.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5e2fe4418dab6549668eedde28cbee394f036841
Author: Rogan Hamby <rogan.hamby@gmail.com>
Date:   Fri Oct 11 08:47:55 2019 -0400

    Bug 18414: Allow to use other select criteria with delete_patrons.pl
    
    Adds the ability to specify a file with the --file flag that
    should be a list of borrowernumbers for deletion.
    If used without other flags it will delete the list of borrowers,
    if used with other flags it will treat the other criteria
    as filters for the list.
    
    To Test:
    1) Specify a list, e.g. borrowers.txt, of borrowernumbers in the database and put them in a text file with one per line
    2) Invoke the script like ./delete_patrons.pl --file borrowers.txt to delete those patrons
    3) Populate the list with a mix of borrowers in a category and those not, say categoryfoo
    4) Invoke the scirpt as ./delete_patrons.pl --category_code categoryfoo --file borrowers.txt
    5) Only the borrowers in the file that have the specified category will be deleted
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a373a6a27257d8d4d140f7f1c5f1c8d5c334d4a2
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Sun Mar 15 11:39:42 2020 -0300

    Bug 24872: Set languages prefererences after install
    
    This patch set 'languages' and 'opaclanguages' system
    preferences with the language used during install.
    
    To test:
    1. Apply the patch
    2. Do a clean install in a language other than english
    3. Verify that 'languages' and 'opaclanguages' system
    preferences show the language code used during install,
    besides english.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c8718bd4af3e5b1329878cee6ff27a7a5a27091b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 17 14:58:02 2020 +0100

    Bug 24672: (bug 24430 follow-up) Do not get active orders on deleted biblio record
    
    On bug 24430 we replaced the call to CountBiblioInOrders with
    Koha::Biblio->active_orders
    In case the bibliographic record is deleted, the count must be set to 0.
    
    This prevent the app to crash with:
    Can't call method "active_orders" on an undefined value at
    /home/vagrant/kohaclone/acqui/parcel.pl line 244
    
    Test plan:
    Create 2+ orders
    Receive one, delete it, delete the bibliographic record
    Receive the order one
    => Without this patch, on the parcel page you should get the error
    => With this patch applied you must be allowed to finish the receive
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d66e67bd1e8e4f3b47b3a75e01a286191205637
Author: Mason James <mtj@kohaaloha.com>
Date:   Thu Mar 19 20:41:00 2020 +1300

    Bug 24874: Printing is broken on opac-results.pl page
    
    to test:
    
    - search for something in opac
    - print page using file -> print
    - observe printing is broken (pic1)
    
    - apply patch
    
    - search for something in opac
    - print page using file -> print
    - observe printing is fixed (pic2)
    
    it seems this issue was introduced by bug 5287
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9dd63147cfc61a25422c8fb9e166134ce04b4b99
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Mar 22 12:10:43 2020 +0100

    Bug 24876: Fix capitalization on patron search for holds
    
    When placing a hold in the staff interface, the heading on the
    search box reads: Search Patrons or clubs
    The patch changes it to be Search patrons...  instead.
    Also changes club id to club ID.
    
    To test:
    - Place a hold in the staff interface
    - Verify the capitalization error
    - Switch tabs to Clubs, see: club id
    - Apply patch
    - Verify it's all good now
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a2f1247e1bee329719eb733f199fc302e30d4d8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 24 08:09:14 2020 +0000

    Bug 24854: DBRev 19.12.00.050
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 117b55c702e326201a572f1fb3d79e6f579af47d
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Mar 13 17:16:28 2020 +0000

    Bug 24854: Remove IDreamBooks integration
    
    The IDreamBooks service has not seen updates in a long time, so
    we should remove the service from Koha as it's no longer operational.
    
    To test:
    - Apply patch and run the database update
    - Verify that the IDreamBooks related system preferences are gone
    - Verify that opac detail pages and result lists still work
      as expected
    - Run t/db_dependent/UsageStats.t
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8188655897152764f01ba3d883626396893d4f01
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Mar 20 16:05:46 2020 -0300

    Bug 24918: Fix attribute mappings in Koha::Acquisition::Basket
    
    When bug 18731 was written, the official vote on the RFC hadn't been
    held yet. Once it got voted, the mappings were adapted and all the
    dependent work fixed as well. But three attribute names were overlooked
    and they become evident on developing 20212 which required them.
    
    This patch fixes this really tiny mistake.
    
    To test:
    1. Just verify the voted attribute names.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e9e3bb6aa19ad915904e31d51af875b1bf27aa85
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Mar 20 15:53:35 2020 -0300

    Bug 24464: (QA follow-up) Make the method reflect the lack of FK
    
    This patch makes it super obvious to understand by reading the code that
    there's originally no foreign key.
    
    To test:
    1. Run the tests and notice they pass
    2. Spot the # FIXME
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 71354abe5a216e077cfb55206afbb7e0f0cc5c26
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 20 16:00:05 2020 -0300

    Bug 24464: Add K::A::Basket->creator
    
    This patch adds a ->creator method to Koha::Acquisition::Basket to
    retrieve the related Koha::Patron object.
    
    Note: this should be re-done once 22658 is pushed, but at the time
    being, there's not patch submitted, and it is not a trivial task because
    of the column type missmatch. That said, the implementation of ->creator
    in this class is simple enough to just rewrite it once 22658 is
    submitted, and the tests will reflect the expected/unchanged behavior.
    
    To test:
    1. Apply this patches
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Acquisition/Basket.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f85d85f380b2b8edd6fccc3fc2440f2a44b92454
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 20 15:59:59 2020 -0300

    Bug 24464: Unit tests
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7f815b258fca9cf2a76c83ebee1ec569fa7dd2ab
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 20 11:56:36 2020 -0300

    Bug 24463: Add a basket_group relationship for baskets
    
    This patch aims to bring consistency between the accessor name and the
    underlying relationship to ease things when using it from the API.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Acquisition/Basket.t
    => SUCCESS: Tests pass! No behavior change!
    3. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3702194574cc2bdc291a05ca2d17b63e191ee6b3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Mar 10 15:11:07 2020 +0000

    Bug 21708: Sort MARC fields in TransformHtmlToMarc
    
    Instead of pushing 999 in the front :)
    
    Test plan:
    Do not yet apply this patch.
    Edit a record. Save. And open MARC view/view plain on opac-detail.
    Verify that the biblionumber field (MARC21 999) follows leader.
    Apply this patch. Restart Plack.
    Edit a record. Save. And open MARC view/view plain on opac-detail.
    Verify that the biblionumber field is in right position.
    Run t/db_dependent/Biblio/TransformHtmlToMarc.t. Should pass now.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b6891f1d1b2a00db25067df9212b4b5677255572
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Mar 11 13:22:31 2020 +0000

    Bug 21708: Add a few tests in TransformHtmlToMarc.t
    
    Test plan:
    Run t/db_dependent/Biblio/TransformHtmlToMarc.t without the module change
    patch. Verify that the test fails on the order of fields.
    Go to test plan of the second patch.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 60c31d70bbdefc0d67baa514aa481076de55d278
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Fri Jan 3 21:18:27 2020 +0000

    Bug 24324: Resolve error with delete_records_via_leader.pl
    
    To test:
    
    Have a record with the 000 position 5 set to "deleted" (record status)
    Use koha-shell to run the job with the -i flag: perl misc/cronjobs/delete_records_via_leader.pl -c -i -v
    * items and the record should be deleted
    Mark another record with the 000 position 5 set to deleted (record status)
    Use koha-shell to run the job without the -i flag: perl misc/cronjobs/delete_records_via_leader.pl -c -v
    * if the record had items, it will not be deleted
    * if the record did not have items, it will be deleted.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3302ad146194738c247b2ccfa7b8e3cb98478f7d
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Mar 19 09:38:52 2020 +0100

    Bug 24902: Join different mc- limits with AND (elasticsearch)
    
    In the advanced search form, you can enable several limits using syspref
    AdvancedSearchTypes (namely itemtypes, shelving locations, collections)
    When used, the resulting query parts end up being joined with OR, even
    if the field is different. That means that if you pick "Book" under
    itemtypes tab, and "Fiction" under collection tab, it will search
    "itype:BOOK OR ccode:FIC". It should be AND.
    
    For instance, if you select:
        Itemtypes:
            ✓ Book
            ✓ DVD
        Location:
            ✓ Child
            ✓ Adult
    
    it should search:
        itype:(Book OR DVD) AND location:(Child OR Adult)
    
    Test plan:
    0. Do not apply the patch yet
    1. Enable elasticsearch
    2. Set syspref AdvancedSearchTypes = 'itemtypes|loc|ccode'
    3. Create a new itemtype and a new authorised value for categories LOC
       and CCODE
    4. Create a biblio with the new itemtype, another biblio with the new
       location, another biblio with the new collection, and again another
       biblio with the new itemtype, location and collection
    5. Verify that you can find these new biblio records using only the
       "advanced search types" in the advanced search form
    6. In the advanced search form, pick all 3 limits (itemtype, location,
       collection) and verify that it returns the 4 records.
    7. Apply the patch
    8. Repeat step 6, it should now return only the biblio that satisfies
       all criteria
    9. Verify that if you select more than one
       {itemtype|location|collection} it still returns results that
       satisfies any selected criteria
    10. prove t/Koha/SearchEngine/ElasticSearch/QueryBuilder.t
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit acf7ec2d872b3ac55259cf114b32bfc4c9163037
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 23 16:47:11 2020 +0100

    Bug 20443: Add missing use statement
    
    This is a follow-up for commit 836e950d25148ca04ed0561c487772e3b0f7f8ee
        Bug 20443: Remove SearchIdMatchingAttribute
    
    We removed the use of C4::Members::Attributes, that was using Text::CSV
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9ce0dd6b9225328e49098b69201767f240b47270
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 20 10:58:54 2020 +0100

    Bug 20443: Fix merge_with behavior
    
    merge_with were returning Koha::Patron::Attribute for existing attribute
    and hashref for new attribute.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e8c6fcb8a0aff24fae155c1260c37b007da3da4a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 20 09:38:03 2020 +0100

    Bug 20443: Handle non existent attribute when importing patrons
    
    There is much more to do here, but this patch has the same behavior than
    before: a warn is displayed in the log, the UI is not aware of it
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ea5e9f25e9cbeae9e12dd05e17175ae3203a92b2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 9 11:43:14 2020 +0100

    Bug 20443: Fix patron modification approval
    
    There was a mismatch between "value" and "attribute". Before this
    patchset, "value" was sometimes used, but then it comes "attribute" to
    match the DB column's name.
    We must keep both here, when an upgrade is done we could have "value"
    that is still in the borrower_modifications.extended_attributes JSON
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 994ea386c389886ced62dc42bc10d0325557876c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 9 11:02:54 2020 +0100

    Bug 20443: Do not explode if attribute does not have a valid av
    
    Template process failed: undef error -
    Can't call method "lib" on an undefined value at /kohadevbox/koha/Koha/Patron/Attribute.pm line 109.
                                                        at /kohadevbox/koha/C4/Templates.pm line 122
    
    We should not crash as it if the attribute is linked to an invalid
    authorised value (for instance the AV has been deleted)
    
    We must provide a check in the search_for_data_inconsistencies.pl script
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc430529c1ea686d3727ce786a619441f1763a0a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 4 15:44:42 2020 +0100

    Bug 20443: Fix creation of new patron with attributes
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8bcfd1c21177d98b0c7b839092befaa78993baeb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 21 13:03:56 2020 +0100

    Bug 20443: Fix POD
    
    Fixes the following failures:
    
     FAIL   Koha/Patron/Attribute.pm
       FAIL   pod
                    *** ERROR:
                    empty =head3
    
                     in file Koha/Patron/Attribute.pm
    
                    *** ERROR:
                    empty =head3
    
                     in file Koha/Patron/Attribute.pm
    
     FAIL   Koha/Patron/Attributes.pm
       FAIL   pod
                    *** ERROR:
                    empty =head3
    
                     in file Koha/Patron/Attributes.pm
    
       FAIL   pod coverage
                    POD is missing for merge_with
                    POD is missing for object_class
    
     FAIL   Koha/Patrons.pm
       FAIL   spelling
                     paramter  ==> parameter
    
    except the missing pod for object_class, not needed.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4bad6ec25feceb9a1a7701b5f7ac113f9a1ffa1b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 3 19:30:44 2019 +0100

    Bug 20443: Fix add/edit for checkboxes
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6bb806ddf41c8263758948bf82dd0a41dda406b6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 27 15:49:36 2019 +0100

    Bug 20443: Fix Patrons/Import.t
    
    ->get_patrons has been removed but not replaced!
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e1be8d385f681f83112e8dd445dd519cb6b6124
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 27 15:35:07 2019 +0100

    Bug 20443: Use search_with_library_limits for attribute types
    
    Dealt with that previously in the module during the rebase.
    It conflicted with bug 23281.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 569e4080f10bdaf8dc5250cee0a168c31b066909
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 29 11:49:04 2019 -0400

    Bug 20443: Fix Auth_with_ldap.t
    
    Must be a hashref
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e9622786f72b61ed884b554e8dff53c09842867
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Mar 7 07:23:33 2019 +0000

    Bug 20443: (follow-up) Fix t/db_dependent/Koha/Patrons.t
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e3cc65156ecf5bc8d78edb8c741ab5afb2ffdb67
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 9 19:46:35 2018 -0300

    Bug 20443: (follow-up) Move GetBorrowerAttributes to Koha::Patron - ILSDI
    
    Either we display everything, or only the info from the attribute itself
    (i.e. not its type)
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e37bfe3e4b395ef71a54c65226829248847cf1ce
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 17 11:03:49 2018 -0300

    Bug 20443: Remove extended_attributes_code_value_arrayref AND C4::Members::Attributes
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bffb16eb70c4cd08a8127b38d4672073dff37b99
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 17 09:50:10 2018 -0300

    Bug 20443: Remove extended_attributes_merge
    
    TODO We need tests here!
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 836e950d25148ca04ed0561c487772e3b0f7f8ee
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 16 14:23:27 2018 -0300

    Bug 20443: Remove SearchIdMatchingAttribute
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4428d086575cf2df94261f33b89b37150b4215f9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 16 20:34:42 2018 -0300

    Bug 20443: Remove SearchIdMatchingAttribute - prove we are not cheating
    
    Tests are still passing that way, we can continue
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 37e634bb5b99ab4bcdba45062527ad6bfe439f47
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 16 20:17:22 2018 -0300

    Bug 20443: Remove C4::Members::AttributeTypes
    
    We do no longer need this package, we can use
    Koha::Patron::Attribute::Types directly instead.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 837c9cdb21d695604879e7eb47b96234132012b8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 16 19:37:30 2018 -0300

    Bug 20443: Remove num_patron
    
    Replace C4::Members::AttributeTypes->num_patron with
    Koha::Patrons->filter_by_attribute_type
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f1d210019b1f87465a8bad33f57ba6d20bec65f9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jul 16 19:04:03 2018 -0300

    Bug 20443: Move C4::Members::AttributeTypes::GetAttributeTypes to Koha::Patron::Attribute::Types
    
    We can then now start to move methods from C4::Members::AttributeTypes
    as well.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5dd44a8f088c5c8537d0e0046a34d57655f2b7fd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 13 16:40:14 2018 -0300

    Bug 20443: Remove CheckUniqueness
    
    There is already a method in Koha::Patron::Attribute to check the
    uniqueness constraint, let us it to replace CheckUniqueness
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ccfc6572f79eccbf8abae9c4645213ae6d33fa38
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 13 14:11:44 2018 -0300

    Bug 20443: Remove UpdateBorrowerAttribute and SetBorrowerAttributes
    
    This patch replace Koha::Patron->get_extended_attributes with
    ->extended_attributes
    It's now a getter a setter method.
    
    It permits to replace UpdateBorrowerAttribute and use
    create_related from DBIx::Class
    
    Notes:
    * We face the same variable names difference than in a previous patch
    (value vs attribute)
    
    Bug 20443: Remove SetBorrowerAttributes
    
    squash  + RM get_extended_attributes
    
     RM get_extended_attributes
    
    SQUASH Bug 20443: Remove UpdateBorrowerAttribute and SetBorrowerAttribute
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a1e3a79913869619160cea7944b4ad653b8da9a4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 13 13:07:05 2018 -0300

    Bug 20443: Remove DeleteBorrowerAttribute
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6f4460901bd6857c46a557ca7b03b4506cee1a08
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 13 12:42:08 2018 -0300

    Bug 20443: Remove DeleteBorrowerAttributes
    
    This subroutine was only used once, easy to replace.
    SetBorrowerAttributes must replace the attributes for the ones logged-in
    user is allowed to edit, that's why we filter by the library limits
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52949f88e0110e52b965bedbdcb885bdb5b00eaf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 13 12:10:47 2018 -0300

    Bug 20443: Improve filtering method
    
    Koha::Patron::Attributes->search mimicks what is done in
    Koha::AuthorisedValues->search.
    But actually it should be more explicit when the caller use it.
    For instance filter_by_branch_limitation (see discussion on bug 11983).
    
    This will be useful for the following patches as we will need a way to
    replace the $no_branch_limit flag.
    When the $no_branch_limit flag is called, a simple ->search call should
    be done.
    When we want to limit on a specific library we can pass the branchcode
    in paramter of filter_by_branch_limitation (this is not used yet).
    If not passed the logged-in user library will be used by default.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9707167a482894f270549ae9633eaef980f1ed35
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 12 18:26:58 2018 -0300

    Bug 20443: Move GetBorrowerAttributes to Koha::Patron->extended_attributes
    
    The GetBorrowerAttributes subroutine return the attributes for a given
    patron.
    
    Using get_extended_attributes we can acchieve it easily. The problematic
    here is to restore the method's name (value vs attribute,
    value_description vs description of the authorised value, as well as
    display_checkout that should not be a method of Attribute, but
    Attribute::Type instead)
    
    value_description was used when the attribute types were attached to an
    authorised value category. To avoid the necessary test in template and
    controller there is now a $attribute->description method that will
    display either the attribute's value OR the value of the authorised
    value when needed. We should certainly use this one from few other
    places.
    
    Notes:
    * This patch rename Koha::Patron->attributes with Koha::Patron->get_extended_attributes.
    It will be renamed with Koha::Patron->extended_attributes in ones of the next
    patches when it will become a setter as well.
    * GetBorrowerAttributes did not care about the library limits, we still
    do not
    * The opac_only flag was not used outside of test, we drop it off.
    * To maintain the existing behavior we add a default order-by clause to
    the search method [code, attribute]
    * From C4::Letters::_parseletter we always display the staff description
    of the AV, There is now a FIXME to warn about it
    * FIXMEs are not regressions, existing behaviors must be kept
    * TODO add a new check to bug 21010 to search for inconsistencies in
    patron's attributes attached to non-existent authorised values
    * One test has been updated in Modifications.t, order_by is now
    by default set to ['code', 'attribute']
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 85012cc0616371b1c29a4eab39829ef9d250d266
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 13 09:01:03 2018 -0300

    Bug 20443: Move GetBorrowerAttributes to Koha::Patron - ILSDI
    
    FIXME See comment
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1dc9daf5b373a5d8f80fa5f7e3880cff239201c5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jul 12 17:20:57 2018 -0300

    Bug 20443: Move GetBorrowerAttributeValue to Koha::Patron->get_extended_attribute_value
    
    We want to retrieve a specific patron's attribute for a given patron.
    We then add a new method to Koha::Patron.
    
    This patch add a getter method ->get_extended_attribute_value
    to use the DBIx::Class relation
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 37f464e1cf716db97b5b07b5b82811f0d5f64e63
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jul 17 11:13:09 2018 -0300

    Bug 20443: Remove opac_display and opac_editable from Patron::Attribute
    
    Same as previously for methods that have been added by bug 17792.
    It's better to be explicite and tell we are fetch the related attribute's type
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 956c1a2a26f6663e1620492e67c6a9b20ef3fe94
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jul 13 10:41:15 2018 -0300

    Bug 20443: Revert some stuffs from 12159
    
    These methods have been added to Koha::Patron::Attribute but are wrong, see bug 18339
    
    We should use ->type->$method instead
    
    Moreover the tests exist in another subtest, we do not need them.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 757ca57bfdbd4346b90293429e658d239b8d0102
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 23 13:09:07 2020 +0100

    Bug 23463: Fix selenium tests (highlight a bug in date management)
    
    There is something wrong, and a regression has been caught by those
    tests:
    If an invalid date is passed from the add item form, the app now
    crashes.
    Before:
     * if the date was completely invalid, the field was blanked
    silently
     * DateTime::Format::MySQL was used to convert dates, and it's not
     strict at all. For instance, what happened in the selenium tests for
     dateaccessionned: %Y-%m-%d was prefilled by the framework plugin, then
     the biblionumber was added, we ended with something like (eg for today)
     2020-03-234242 (with biblionumber=4242). DateTime::Format::MySQL
     converts that to 2020-03-23
    
    We must deal with invalid dates, but I do not think it is good to add it
    back to Koha::Item->store, we will prefer to raise the error to the end
    user, saying that something went wrong (and more specifically the
    dates).
    
    The (ugly) trick was in C4::Items::_mod_item_dates
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 243a5395de9be3e3971ae8171a8b2b3aa79e74bb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 23 11:36:55 2020 +0100

    Bug 23463: Fix wrong variable name
    
    Fix for t/db_dependent/Labels/t_Batch.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 313b47c94e6397fc0ad0d8c0022941cd1cc3c476
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 23 11:34:43 2020 +0100

    Bug 23463: Fix CourseReserves/CourseItems.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9b9b641ac86a568fc446fe9890dd1a68d90f67b8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 23 11:23:46 2020 +0100

    Bug 23463: Replace a new occurrence of ModItem
    
    This new script have been pushed just before 23463.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2edd08b4d820a9cbecb548c7e238b1322acbca9e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 23 10:31:39 2020 +0000

    Bug 23463: (RM follow-up) Add try block around Illrequest item creation
    
    The recently introduced Ill item creation for circulation feature was
    not properly handling the move from AddItem to Koha::Item->new()->store.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e6d255b5e50b141caec6aad60f5dd440ba4af02f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 20 15:15:17 2020 +0100

    Bug 23463: Fix items.cn_sort vs cn_sort
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6c9cc168bae98d70153b1b589d13a7c684cd059f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 14:56:08 2020 +0100

    Bug 23463: (follow-up 2) Fix timestamp default value
    
    Removing previous change, again.
    But this time in Object.pm
    It fixes t/db_dependent/Koha/Object.t and t/db_dependent/Koha/Item.t is
    still passing.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a881984413d8a09f59b064c9484f0d59533a923f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 14:51:06 2020 +0100

    Bug 23463: Use new method Koha::Object->set_or_blank
    
    This patch fixes an issue when editing items.
    
    * The issue
    Cannot blank a subfield when editing an item.
    If you have an item with itemcallnumber=42, then edit it, blank it and
    save. The itemcallnumber is still 42
    
    * Why? (line numbers from https://gitlab.com/joubu/Koha/-/tree/bug_23463)
    additem (and other item's edition forms) receives a list of tags,
    subfields and values, generates a MARC::Record::XML then calls
    ModItemFromMarc:
    
    717     my $itemtosave=MARC::Record::new_from_xml($xml, 'UTF-8');
    727         my $newitem = ModItemFromMarc($itemtosave, $biblionumber,
    $itemnumber);
    
    And ModItemFromMarc:
     282     my $item = TransformMarcToKoha( $localitemmarc,
    $frameworkcode, 'items' );
     283     $item->{cn_source} = delete $item->{'items.cn_source'}; #
    Because of C4::Biblio::_disambiguate
     284     $item_object->set($item);
    
    ModItemFromMarc never knows that the field has been blank.
    Prior to bug 23463 we had a map of default values, and ModItemFromMarc
    was doing:
     426     my $item = TransformMarcToKoha( $localitemmarc,
    $frameworkcode, 'items' );
     427     my $default_values = _build_default_values_for_mod_marc();
     428     foreach my $item_field ( keys %$default_values ) {
     429         $item->{$item_field} = $default_values->{$item_field}
     430           unless exists $item->{$item_field};
     431     }
    
    I do not want to reinsert that list of default values.
    
    Here I wrote a generic method in Koha::Object to set the value passed in parameter,
    or "blank" if not passed.
    It's nulled if can be set to null in DB, or the default value is retrieved from
    the schema info.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8170645f84be2b1f4c8e527258e58117ae2e0593
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 13:49:01 2020 +0100

    Bug 23463: Replace new occurrence of AddItem
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 34cca6a775abed84c2978b9ebd38bac56ae6a82a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 6 10:40:29 2020 +0100

    Bug 23463: Fix XSLT.t
    
    From commit bf49eecdd87e2b29760226281ab1afc0a185c7f0
         Bug 23463: Replace AddItem calls with Koha::Item->store
    
    in build_sample_item:
    -    my $itype = delete $args->{itype}
    -      || $self->build_object( { class => 'Koha::ItemTypes' } )->itemtype;
    +    # If itype is not passed it will be picked from the biblio (see Koha::Item->store)
    
    So before we generated a new itemtype if not passed, now we pick the one from biblioitem->itemtype.
    
    For this specific test we need to make sure they are different.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 62852241430b9444acd600498fc51912f36a90e7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 6 15:06:07 2020 +0100

    Bug 23463: Fix cn_source for new item
    
    get_dirty_columns only work for existing items.
    
    This fixes t/db_dependent/ShelfBrowser.t
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a494bb1b49d0ec91b0f4a7edb44f7db6a435205f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 6 14:34:36 2020 +0100

    Bug 23463: Fix IsItemIssued.t
    
    It seems that some of those tests could be removed as safe_delete is
    widely tested in Koha/Item.t
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 974caa4304358423c08b9e2ea784ea83af2d09c1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Feb 6 10:24:04 2020 -0300

    Bug 23463: Fix tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit de9ce93cf284aa32f8c5c527387949ebc79cc4ea
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 30 16:15:14 2020 +0100

    Bug 23463: Fix safe_return return value in deletion tools
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 57eb6e42265a830aabb01f5de0bcab49bd090356
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 28 12:54:37 2020 +0100

    Bug 23463: (follow-up) Fix timestamp default value
    
    For discussion, this patch revert the changes made previously.
    
    This line exists in Koha::Item->store as it is the translation of:
        if (exists $item->{'timestamp'}) {
            delete $item->{'timestamp'};
        }
    that was coming from _do_column_fixes_for_mod (called from ModItem)
    
    To preserve existing behavior I would be in favor of keeping it like that to
    avoid regression, and deal with it separately if we want to improve/remove it.
    
    So basically here we are setting it to undef in Koha::Item->store to make it
    handle correctly by the parent Koha::Object->store. I agree that's kind of weird
    and must be improved.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 794e8f992eee39641ec83beb83c140c6f7df4814
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 27 17:20:26 2020 +0100

    Bug 23463: Move DelItem.t and Items_DelItemCheck.t tests to a Koha/Item.t subtest
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f70a738bca1782e7a90ef217473c2d50e335e3e4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 27 16:54:20 2020 +0100

    Bug 23463: Fix timestamp default value
    
    This sounds wrong as we should let the DBMS do that, but it was failing.
    Here we are doing the same as Koha::Patron->store for dateenrolled
    
    To recreate the failure, prove t/db_dependent/Koha/Item.t without this
    patch:
    DBD::mysql::st execute failed: Column 'timestamp' cannot be null [for
    Statement "UPDATE `items` SET `more_subfields_xml` = ?, `timestamp` = ?
    WHERE ( `itemnumber` = ? )" with ParamValues: 0='<?xml version="1.0"
    encoding="UTF-8"?>
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cc6f25fec44273ed1407c910544af04c4700817e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 10 12:58:09 2019 +0100

    Bug 23463: (follow-up) Remove DelItemCheck and ItemSafeToDelete
    
    Wrong replacement in additem.pl
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18555f244ad0bbb0526e58cb26993161d9fd07e0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 2 14:32:09 2019 +0100

    Bug 23463: cn_sort needs to be updated if cn_source changed
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f76a75a3d3b8e6c99d5dcd687580778364571c14
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 2 12:02:28 2019 +0100

    Bug 23463: Replace recently added occurrences
    
    Few occurrences have been added since this patchset has been originaly
    written
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 22f8584eadd2ace33f296f9cee1409ed6608e12b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 12 18:27:30 2019 -0500

    Bug 23463: build cn_sort only if needed
    
    No need to calculate cn_sort if not dirty when we store
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit befc3f19f7d28dd3e92f719274d7e277e1a15fff
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 12 17:51:24 2019 -0500

    Bug 23463: Fix items.cn_source vs cn_source
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fce29fb77d61ff7c006874b22ae7a00adb80cf34
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 7 21:13:18 2019 -0500

    Bug 23463: update permanent_location if location has been updated
    
    This change to Koha::Item->store seems correct here, but tests from /db_dependent/Items.t is failing now.
    
    Adjusting them to make them pass.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bef6c36156a3e732c294d096169eb58682912e6b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 7 20:47:20 2019 -0500

    Bug 23463: Fix AutomaticItemModificationByAge.t
    
    We do not want to log if nothing changed
    
    How could we do that better?
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eeaf0b19e08e96293be1bf663015e7138d80e69c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 7 20:28:06 2019 -0500

    Bug 23463: Getting less item-level_itypes warnings (?)
    
    So, we get less warnings. I do not really understand why...
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4bce8c68fec3d940a053b647cfd629cf56c134c1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 7 11:09:57 2019 -0500

    Bug 23463: Fix failing tests
    
    And adding a FIXME about discard_changes
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2088b6857e9dd0d41acb53582897703586b7116d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 7 11:00:49 2019 -0500

    Bug 23463: Fix CancelReceipt.t
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2677da8f17fdf5a7f505770a2dc9935e55a3e73c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 7 10:44:24 2019 -0500

    Bug 23463: Remove no longer needed subs related to default values
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a3687711b075f64e1e5f1fe31c6adad664679e42
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 6 11:58:01 2019 -0500

    Bug 23463: Remove DelItemCheck and ItemSafeToDelete
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b844b19dfc9dacea4e6b27357844f731c6a389e3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 6 11:29:27 2019 -0500

    Bug 23463: Remove DelItem
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc09b0d491b17447c9e3bdfe67c3f7b870405b9a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 6 11:14:25 2019 -0500

    Bug 23463: Remove ModItem
    
    There should not be any calls left
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6ae8919e9230b2327bbc690bfbce89c1c4c67ad5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 6 11:14:07 2019 -0500

    Bug 23463: Remove _mod_item_dates
    
    We did not do anything useful here.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 516e76d1b53001a1be2f765e71d02b63ac9d85fb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 6 11:12:31 2019 -0500

    Bug 23463: _do_column_fixes_for_mod dealt with integer location and timestamp moved
    
    That's done in Koha::Item->store, and Koha::Object->store for integers.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7ec06a1ae8466b5027535fb3d40ab9618bfd3a65
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 6 11:11:38 2019 -0500

    Bug 23463: _set_derived_columns_for_mod was only used for cn_sort
    
    Same as _set_defaults_for_add
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d35052a14df66e9c5fe5d70378d36a6b1edb94d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 6 10:17:28 2019 -0500

    Bug 23463: Move plugin hook
    
    From C4::Items to Koha::Item
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit df520d2d6288bfbc9acac59c90a28ebe343a5390
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 18 15:06:03 2019 -0300

    Bug 23463: remove trivial UpdateHoldingbranch sub
    
    We do not need this subroutine, moving it where it is used.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bbb504c86f5ca0a474365d4839177412f415c4ee
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 18 14:56:19 2019 -0300

    Bug 23463: Replace ModItem with Koha::Item->store
    
    Starting to replace the ModItem calls with Koha::Item->store
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0c8d8e867b18b61f39381d2061cd2124fe1c5ed3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 18 14:41:37 2019 -0300

    Bug 23463: AddItem removing
    
    We are done with AddItem, only need to log and index.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 488a6f98a6b7a1527ed801f4eef21013f8a2bbf9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 18 14:20:51 2019 -0300

    Bug 23463: Replace _set_derived_columns_for_add
    
    Remove the unique call to _set_derived_columns_for_add
    Even if design to deal with other values it only dealts with cn_sort
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 02134d7604a6fc08b88046fde87b6c909de04353
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 18 14:15:37 2019 -0300

    Bug 23463: Remove _set_defaults_for_add
    
    _set_defaults_for_add is no longer needed as it is handled by dbic and koha::object->store
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2075a22ed3c71196002dd8da28a061f791baf393
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Mar 17 23:12:46 2019 -0300

    Bug 23463: Replace AddItem calls with Koha::Item->store
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9b33b8babdfe288ef1f436bdfc4a1ea5cc5629da
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Mar 17 23:12:22 2019 -0300

    Bug 23463: fix for testbuilder - set default value items.damaged=0
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 150b835ab3b57c05b043c0b8d317f9dcb75b6d58
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Mar 17 21:10:00 2019 -0300

    Bug 23463: Remove uneeded SearchItemsByField subroutine
    
    It is no longer used.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 826eda128e98f39e989a7da3af92e7f8b500eb75
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Mar 17 21:09:29 2019 -0300

    Bug 23463: Replace SearchItemsByField by SearchItems
    
    The subroutine SearchItemsByField is only called once and can be
    replaced easily with SearchItems
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fcaed6ef24084da54d9d91c09072ff04d0070ef2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 17 11:25:28 2020 +0000

    Bug 24297: Record 'Manual' trigger transfers
    
    To test:
    1 - Apply patches, restart_all
    2 - Gi to Circulation->Transfer
    3 - Transfer an item
    4 - Check the branch transfers table
    5 - The reason is set to 'Manual'
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f04e77c7e5411ca7dcf761e7e1177d7362a10654
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 20 16:02:15 2020 +0000

    Bug 24436: DBRev 19.12.00.049
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9364ceba0c78aadf289887f93faf3d4260a47cd8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 17 10:47:49 2020 +0000

    Bug 24436: Add handling for reserve transfer triggers
    
    To test:
    1 - Place a hold for pickup at a different branch than you are signed in at on an item owned by current branch
    2 - Check in the item
    3 - Confirm the transfer
    4 - Check the branchtransfers table and note the reason is 'Reserve'
    5 - Set the preference CanMarkHoldsToPullAsLost to allow
    6 - Place a hold on an item at branch you are singed in at
    7 - Ensure you are not using strict sql modes (bug 22431)
    8 - Go to Circulation->Holds to pull
    9 - Mark hold as lost
    10 - Check branchtransfers and confirm reason is "LostReserve"
    11 - Check in item from step 1 at the correct branch
    12 - Go to Circulation->Holds awaiting pickup
    13 - Cancel the reserve
    14 - Check branchtransfers and confirm reason is "CancelReserve"
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 46da9fceccc35086bf2b7c53edba787ed418f33e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 17 11:20:37 2020 +0000

    Bug 24436: Add 'Reserve' options to branchtransfers trigger
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3ebe29bf2a79b51b72d274c55160c7a373d727ef
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 20 15:57:45 2020 +0000

    Bug 24299: DBRev 19.12.00.048
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3b6326a6ed8133b5596ffc6a7c20b2a639aaea80
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 20 11:15:54 2020 +0000

    Bug 24299: Add Unit test for 'reason' in transferbook
    
    Test plan
    1/ Run test and verify it passes
    2/ Signoff
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5013a1bf850d548f2f6492b8ee703308b772d308
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 16 16:40:10 2020 +0000

    Bug 24299: Record 'RotatingCollection' as a transfer trigger
    
    This patch adds support for passing a trigger to
    C4::Circulation::transferbook and passes 'RotatingCollection' to it when
    called inside the rotating collections routine.
    
    Test plan:
    1/ Perform a rotating collection transfer operations
    2/ Check the database for instances of 'RotatingCollection' in the
    branchtransfers.reason field.
    3/ Signoff
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12cae89523ce6237b2ade600bcd86345e5df803b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 16 16:43:09 2020 +0000

    Bug 24299: Add 'RotatingCollection' branchtransfer trigger
    
    This patch adds the RotatingCollection value to the database enum for
    branchtransfer.reason
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77c66abf7a3712573920a1aa17a602a4bb4e8712
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 20 01:36:32 2020 +0000

    Bug 24688: Check the priority of the fulfilled hold when fixing priorities
    
    Currently when fixing priorities of existing holds, priorities aren't
    fixed when checking out a middle priority hold because the hold has been
    fulfilled and deleted. This patch adds a check for, if the hold can't be
    found, an old hold with the required reserve_id.
    
    To test:
    1. Place at least four holds on a biblio for different borrowers
    2. Check out an item to the 3rd priority borrower
    3. Check the existing holds table for the biblio. The priorities might be
    out of order, or try clicking the dropdowns and there might be an empty
    dropdown option, or open the browser developer tools and notice the option
    values in the select are missing value=3.
    4. Apply patch and restart memcached
    5. Check out an item to the 2nd priority borrower
    6. Check the existing holds table for the biblio. Confirm the priorities
    have been fixed and are now consecutive with no gaps.
    
    Sponsored-by: Chartered Accountants Australia and New Zealand
    Signed-off-by: Emmi Takkinen <emmi.takkinen@outlook.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3944f20beb6850f576cb9f68cd5ee9ac4493efb5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Mar 18 13:54:52 2020 +0000

    Bug 24892: Resolve uninitialized warns from opac-memberentry
    
    Especially line 500 (current master).
    
    Use of uninitialized value $new_data{"sort2"} in string eq at /usr/share/koha/opac/opac-memberentry.pl line 500.
    Use of uninitialized value in string eq at /usr/share/koha/opac/opac-memberentry.pl line 500.
    
    Simple fix, not completely trivial due to adding xor ;)
    
    Test plan:
    Do not apply, update from opac memberentry. Check warns in log.
    Apply patch, update again. Less warns?
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c66b9c874f81f9c73648da5da6b7c8732a62221
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Mar 13 17:40:38 2020 +0000

    Bug 24848: Improve manual links for the label creator
    
    Some of the manual links in the label creator tool were
    not working correctly or pointing to the wrong pages.
    
    A problem is the label-manage.pl file. This can show
    different data depending on an added parameter. Example:
    /cgi-bin/koha/labels/label-manage.pl?label_element=template
    
    But it appears that parameters will be ignored when creating
    links to the manual. So this patch links to the beginning
    of the label creator section in the manual for now.
    
    To test:
    - Go to the lable creator
    - Try the various pages of the tool
      - Note: All 'New ...' links should point to the
        correct section in the manual (batches, templates, ...)
        Except: Barcode range. This feature is new and not
        yet documented in the manual. Link goes to label creator section.
      - Note: All 'Manage ...' links should point to the
        beginning of the 'label creator' section in the manual
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 64035301fcde844c899253c6e21174397c34acbf
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Feb 25 14:42:29 2020 +0000

    Bug 24553: Use 'barcode' not 'item_id' when removing hold from SIP patron
    
    The drop_hold routine was using the wrong parameter for item info in the patron's
    array of holds. We store it as 'barcode' not 'item_id'. This is true for both waiting and unavailable
    holds
    
    To test:
    1 - Apply unit tests patch
    2 - prove -v t/db_dependent/SIP/ILS.t
    3 - It fails
    4 - Apply second patch
    5 - prove -v t/db_dependent/SIP/ILS.t
    6 - It passes!
    
    You can also see bug 24175 - you cna hack sip_cli_emulator to allow cancelling a hold
    and check the messages, test coverage is improved by this patch and should be sufficient
    for testing
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5dcb02ec88d589512e18022ad36d7753381b88f6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Feb 25 14:42:17 2020 +0000

    Bug 24553: Unit tests
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 56195db216d3dd55549a166fdd9e61987b0e9f45
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 15:43:49 2020 +0100

    Bug 22025: Remove warnings when importing patrons
    
    The following warning is raised when importing patrons
    Argument "" isn't numeric in numeric eq (==) at /usr/share/perl5/DBIx/Class/Row.pm line 1018
    
    if one of the following headers is passed but does not have a value:
     * privacy
     * privacy_guarantor_fines
     * privacy_guarantor_checkouts
     * anonymized
    
    Test plan:
    - Do not apply the patch
    - Generated a csv file with at least one those headers
    - Import it using the import_patrons.pl script (or using the GUI)
    - Notice the warnings without the patch
    - Apply the patch
    - Confirm that the warnings do not longer appear
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 29243a3c829842d305a00ff8b1ce24086d308662
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 15:43:38 2020 +0100

    Bug 22025: Add a regression test
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 65f7a7190b20051ed29dedb5ab2cf2efe84698c3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 12 10:12:41 2019 +0100

    Bug 13775: Set main headings to mandatory in authority frameworks (UNIMARC)
    
    Same as previously, for UNNIMARC
    
    For unimarc_complet:
    CLASS => 245
    CO => 210
    CO_UNI_TI => 235
    EXP => 232
    FAM => 220
    GENRE/FORM => 280
    NAME_COL => 245
    NP => 200
    NTEXP => 242
    NTWORK => 241
    PA => 260
    PERS => 223
    PUB => 217
    SAUTTIT => 240
    SNC => 250
    SNG => 215
    TM => 216
    TU => 230
    WORK => 231
    
    For unimarc_lecture_pub:
    CO => 210
    NP => 200
    SAUT => 200
    SAUTTIT => 240
    SCO => 210
    SNC => 250
    SNG => 215
    STU => 230
    TU => 230
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d8198ad48844a8e99079073879bf0a38d7e296a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 12 10:10:23 2019 +0100

    Bug 13775: Set main headings to mandatory in authority frameworks
    
    For MARC21 we need to set the following tags as mandatory:
      CHRON_TERM => 148
      CORPO_NAME => 110
      GENRE/FORM => 155
      GEOGR_NAME => 151
      MEETI_NAME => 111
      PERSO_NAME => 100
      TOPIC_TERM => 150
      UNIF_TITLE => 130
    
    Note that it also fixes an error on the UI, which was initially reported
    on bug 13775.
    
    Test plan:
    - Create a fresh install in the language of your choice.
    - Confirm that when you create a new authority you cannot save without
    entering a value for the main heading
    
    - Edit marc record's field 648 -> chronological term
    - Try to add there one by clicking a link on the left side of the field.
    From there it opens me to a new window, click "Create a new authority"
    Click on the authority creating fields randomly, save.
    => Without this patch an error occurred "Can't call method "subfields"
    on an undefined value at authorities/blinddetail-biblio-search.pl line 88."
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4ffe70dfaff9c552cce1e40bec4a0d86a4dc819e
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 25 02:02:22 2020 +0000

    Bug 8595: (follow-up) Changing other occurrences of 'host item' to 'host record'
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d61b6e03363a098537e7e33e1c4c839e992e3cf
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 13 21:23:58 2020 +0000

    Bug 8595: Rename 'host item' to 'host record'
    
    To test:
    
    1) Enable the syspref EasyAnalyticalRecords
    2) Find a biblio record, go to the detail page
    3) Click the Edit dropdown and notice the option "Link to host item"
    4) Apply patch and refresh page
    5) Click the Edit dropdown and confirm the renamed "Link to host record"
    button
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 20b38829ce0d483335f5c258f5e563778f0ad2f1
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Mar 20 08:58:29 2020 -0400

    Bug 23808: (follow-up) Object methods can be used directly, no need for unblessed
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9abe037f290dc451d9ba1716401fa3cdc36fe896
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Tue Mar 17 23:59:03 2020 +0000

    Bug 23808: (follow-up) Pre-fill guarantee's contact details from guarantor patron in memberentry.pl
    
    Pre-fill guarantee contact details (email, phone) from guarantor record
    when adding a gurantee to a guarantor's record
    
    Test plan:
    
    1. Apply first two patches and follow test plans
    2. On an adult's patron record (which has an primary phone number, secondary
       phone, other phone, primary email, secondary email and fax set) select
       'Add a guarantee' and observe the guarantee's 'Contact' section is not
       pre-filled with that information from the guarantor
    3. Apply this patch
    4. On the same adult's record select 'Add a guarantee' and observe that the
       'Primary phone', 'Secondary phone', 'Other phone', 'Primary email',
       'Secondary email', 'Fax' have been pre-filled from the guarantor's record
    5. Fill out the rest of the memberentry.pl and 'Save' and observe that those
       contact details are successfully saved
    6. Repeat step 4 and alter the 'Primary phone' and 'Primary email'
       fields and save and observe that those altered values are saved
    7. Run tests and confirm they pass:
       sudo koha-shell <instancename>
       prove xt
       prove t
    
    Sponsored-by: South Taranaki District Council, NZ
    Signed-off-by: Andreas Roussos <a.roussos@dataly.gr>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 14637559b4c5f83ef10256c9fa50925ccb573b39
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Tue Mar 17 20:43:59 2020 +0000

    Bug 23808: (follow-up) Display card number in 'Guarantor information' in memberentry.pl
    
    Instead of displaying 'Patron #' and displaying the guarantor's borrowernumber
    in 'Guarantor information' we should display 'Patron card number:' with
    the cardnumber displayed as that value is more meaningful to librarians.
    The hyperlink containing the borrowernumber should stay the same so that
    librarians can easily visit the patron record of existing guarantor
    patrons.
    
    Test plan:
    
    1. Apply first patch and follow it's test plan
    2. On an Adult patrons record select 'Add guarantee'
    3. In 'Guarantor information' section of memberentry.pl observe in the
       pre-filled guarantor information there is a line 'Patron #:' with a
       link displaying a borrowernumber (not card number) and when you click
       on the link it takes you to the adult/guarantors patron account
    4. Select 'Search to add' and search and add another guarantor
    5. Observe in the added guarantor 'Patron #:' is displayed along with the
       borrowernumber (not card number). The borrowernumber displayed in not
       a link.
    6. Apply this patch
    7. On a adults patron select 'Add guarantee'
    8. Observe in 'Guarantor information' section the pre-filled guarantor now
       has 'Patron card number:' displayed (instead of 'Patron #:', and it's
       link now displays the guarantors cardnumber.
       Clicking on the link still takes you to the guarantors patron account
    9. Repeat step 4
    10. Observe in the added guarantor they also have 'Patron card number:'
        (instead of 'Patron #:'). A cardnumber rather than borrowernumber is
        displayed. The cardnumber is not a link.
    11. Confirm tests still pass:
        sudo koha-shell <instancename>
        prove xt
        prove t
    
    Sponsored-by: South Taranaki District Council, NZ
    Signed-off-by: Andreas Roussos <a.roussos@dataly.gr>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6fc82e008c6a1f2bc835b06a9c88558226de6048
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Tue Mar 17 04:50:32 2020 +0000

    Bug 23808: Pre-fill guarantor fields when adding guarantee to guarantor
    
    Bug 14570 removed the guarantor pre-fill functionality when selecting
    'Add guarantee' to an Adult patron. This is because guarantor
    information would now only display if (1) the patron record exists
    (which it won't when first adding guarantee to guarantor record) and (2)
    if there is already a guarantor added to a guarantee
    
    This patchfix will pre-fill guarantor fields and address fields (so the guarantee
    has the same address as the guarantor) if no relationship (existing
    guarantor data exists) and a guarantor_id is handed to memberenty.pl in
    URL when clicking 'Add guarantee' button on Adults patron record.
    
    Test plan:
    1. Add adult patron make sure to fill in their 'Main address' details
    2. Select 'Add guarantee'
    3. Observe no details of the adult patron are displaying in the
       'Guarantor information' section or 'Main address' sections of memberentry.pl
    4. Select 'Search to add', search for your adult patron and choose
      'Select' to add them as guarantor
    5. Fill out rest of memberentry.pl and 'Save'
    6. Observe adult is showing as the guarantor
    7. Apply patch
    8. Run tests:
       sudo koha-shell <instancename>
       prove xt
       prove t
    9. Confirm tests pass
    10. Return to your adult patron
    11. Select 'Add guarantee'
    12. Observe in 'Guarantor information' and 'Main address' sections of
        memberentry.pl are pre-filled with the 'patron #' (borrowernumber),
        surname, firstname and street number, address, address2 (if you
        filled that in on adults account), city
    13. Fill out the rest of memberenty.pl and save and confirm your adult
        patron is showing as the guarantor and the pre-filled address details
        have been saved and are showing
    14. Repeat steps 10,11 and 12 and in the 'Guarantor information' select
        'Search to add' and add another adult as guarantor
    15. Fill out the rest of memberentry.pl and 'Save' and notice with this
        patch applied you can still add multiple guarantors successfully
    
    Sponsored-by: South Taranaki District Council, NZ
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: George Veranis <gveranis@dataly.gr>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87acc552d598b94daa9066c5532c34562a712450
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Aug 1 14:57:29 2019 +0000

    Bug 23411: Do not fall back to 'email' for SMS messages
    
    To test:
     1 - Have a patron wiht an sms number, but no email
     2 - Enable sms by setting SMSDriver syspref to Email
     3 - Set Notice triggers to send an overdue via sms and email
     4 - Ensure the selected notice is defined only for 'email'
     5 - Checkout an overdue to the patron above
        You can set a specify a due date in the past
     6 - perl misc/cronjobs/overdue_notices.pl -t
     7 - Check the patron notices tab, they have a print notice and an SMS notice pending
     8 - The SMS notice used the 'email' template
     9 - Apply patch
    10 - sudo koha-mysql kohadev
    11 - DELETE * FROM message_queue WHERE borrowernumber={borrower as above};
    12 - Run the cron again
    13 - Patron should have a print notice queued, no sms
    14 - Define an SMS notice
    15 - delete the message queue
    16 - Run again
    17 - The patron should have a print and an SMS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 32424eac2af05a1313f15e2821c5a5840780f949
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon Mar 9 12:05:03 2020 -0300

    Bug 24830: Fix parse_prefetch recursion and +count cases
    
    When a child of a prefetched element wasn't found on element's
    prefetch_whitelist, no prefetch element was returned.. including element
    it self. Now we return element's name if no child was found.
    
    Also, embeded keys that ended with +count where taken literaly. Now we
    search the correct key by stripping _count of embedded element if it was
    declared as "is_count"
    
    To test:
    1. Apply test patch but not this one
    2. prove t/Koha/REST/Plugin/Query.t
    CHECK => tests shoul fail
    3. Apply this patch
    4. prove t/Koha/REST/Plugin/Query.t
    SUCCESS => tests pass
    5. Sign off
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 99dbf72b72ab9b47b78ea1531def40f269106ea2
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Mar 12 18:47:40 2020 -0300

    Bug 24830: Add tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 569f7266b976299702d17416bf83dabc9052ecca
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 17 11:31:40 2019 +0100

    Bug 24250: Do not duplicate debarred comment in patron screen message AF field
    
    Caused by
      commit bddfed75913a2302c19c00b00a6fe86538af6f9f
      Bug 19933: Remove patronflags - tricky ones
    
    Test plan:
    1 - Setup SIP in your testing environment
        https://wiki.koha-community.org/wiki/Koha_SIP2_server_setup
    2 - Set a patron to have a restriction
    3 - Send a patron status request or patron information command via
        the SIP cli emulator (see link above)
    4 - Note the comment on the restriction is sent only once
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 424b08cff9542606bce4b5fda08467d90e957399
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 12:51:06 2020 +0100

    Bug 23900: Add tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 743eead9fdce5516f85cb38ad00248907971756c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 11 17:54:56 2019 +0100

    Bug 23900: Teach label maker to concat database fields
    
    Test plan:
    - define a label layout with this field list: "100a 245s","enumchron copynumber"
    - find or create a record with values for all of those fields
    - generate a label for that record
    - the 100a and 245s successfully display on one line
    - the enumchron and copynumber are displayed and separated by a space
    
    Try other combinations
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 50f0ba0a3a7f7281f6d91a5b7371996e6e199fc3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 19 11:57:16 2020 +0100

    Bug 24904: Speed up installer process - 1 query per table
    
    Since bug 13897 we are using YAML file to store the installer data.
    We are generating/executing 1 query per row, which is much more slower than before.
    We should generate 1 query per table to get back to the previous execution time.
    
    With this patch we are going to generate a single one big SQL query per
    table.
    
    Test plan:
    1/ Checkout a commit before bug 13897:
    git checkout -b before_13897 0706922221dcdf9fa8ed7fcf86245c5622f33a3c
    2/ Execute the following commands (several times, to get a median!):
    mysql -h db -u koha_kohadev -ppassword -e"DROP DATABASE koha_kohadev";
    mysql -h db -u koha_kohadev -ppassword -e"CREATE DATABASE koha_kohadev";
    koha-shell -p -c "perl benchmark_installer.pl sql" kohadev;
    Note the different times displayed in the output, especially the first 2
    installer/data/mysql/en/marcflavour/marc21/mandatory/authorities_normal_marc21.yml
    installer/data/mysql/en/marcflavour/marc21/mandatory/marc21_framework_DEFAULT.yml
    They are the number of seconds took to insert them
    3/ checkout master
    git checkout -B master origin/master # Will reset your master branch!
    4/ Execute the previous commands but without the 'sql' parameter passed
    to the benchmark script
    mysql -h db -u koha_kohadev -ppassword -e"DROP DATABASE koha_kohadev";
    mysql -h db -u koha_kohadev -ppassword -e"CREATE DATABASE koha_kohadev";
    koha-shell -p -c "perl benchmark_installer.pl" kohadev;
    Note the different times.
    5/ Apply this patch and retry 4
    
    Please post the execution times when you signoff on this patch.
    
    Spoiler: total time goes from 21s to 4s.
    marc21_framework_DEFAULT.yml from 12s to .5s
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    My numbers, 99.99% confidence
    
    3.906 ±0.252    SQL files
    15.516 ±0.772   YAML wo/patch
    3.324 ±0.193    YAML w/patch
    
    Very good!
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7bbb19e3bc66aa011980dc2bf98ca22f6943bd42
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Mar 20 10:12:24 2020 +0000

    Bug 24809: (QA follow-up) Add prefix to prevent disambiguity
    
    This seems not to be needed. Just at the safe side.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 07ff532d01d0c550ecb0180be7487a6bf61fc4e6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Mar 5 10:59:22 2020 +0000

    Bug 24809: Get only timestamp of deleted items attached to existing bibs when check if bib deleted
    
    To test:
     1 - Edit/create a file in the koha home dir '/var/lib/koha/{instance}/OAI.yaml' with content like below:
    format:
      marcxml:
        metadataPrefix: marcxml
        metadataNamespace: http://www.loc.gov/MARC21/slim http://www.loc.gov/standards/marcxml/schema/MARC21slim
        schema: http://www.loc.gov/MARC21/slim http://www.loc.gov/standards/marcxml/schema/MARC21slim.xsd
        include_items: 1
     2 - Set the systempreferences below to indicated values:
      OAI-PMH => Enable
      OAI-PMH:ConfFile => /var/lib/koha/{instace}/OAI.yaml
     3 - View a record with items and confirm the items show:
      http://localhost:8080/cgi-bin/koha/oai.pl?verb=GetRecord&metadataPrefix=marcxml&identifier=KOHA-OAI-TEST:4
     4 - Delete the items, then delete the record
     5 - Reload the URL from step 3
     6 - Internal Server Error:
      Empty String at /kohadevbox/koha/Koha/OAI/Server/Record.pm line 58.
        at /usr/share/perl/5.24/Carp.pm line 167
     7 - Apply patch
     8 - restart_all
     9 - Repeat
    10 - Reload URL from step 3
    11 - Success
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e3d3ef705c963b7db79ebf0ca6c6966b2ee41c4a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 20 10:39:42 2020 +0000

    Bug 22987: (RM follow-up) Schema Update
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit de8911eae78b7c230dff4f831d20308c90a0cb83
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Sat Mar 14 21:00:24 2020 -0300

    Bug 24870: Translate installer data label
    
    This patch enable the translation of the
    labels 'Mandatory' or 'Optional' present at install time
    for groups of installer files.
    
    To test:
    1) Try install using de-DE language,
       at step3 verify 'Mandatory' and 'Optional'
       labels for marc21 or other data checklist
       Do not close this window!
    2) Apply this patch
    3) Update de-DE translation files, reinstall lang files
       cd misc/translator
       ./translate update de-DE
       ./translate install de-DE
    4) Reload page at step3, now 'Mandatory' label
    is translated to 'Pflichtfeld'
    5) Verify strings in translation file
    Search for
    ^msgid \"Mandatory\"
    ^msgid \"Optional\"
    in po/de-DE-staff-prog.po.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04f12cb2fcef4a9884135a8ab67e761ad8cefbbd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 12 10:01:10 2020 +0100

    Bug 24856: Remove itemtypes.imageurl in fr-FR sample data
    
    in installer/data/mysql/fr-FR/3-LecturePub/sample_itemtypes.sql and installer/data/mysql/fr-FR/4-Conservation/sample_itemtypes.sql the values of imageurl point to non-existent images.
    
    Test plan:
    Insert the 2 sql file and confirm that imageurl is not empty
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 962e6b720b972f9df0c64368f70446011e656f76
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 19 08:10:00 2020 +0000

    Bug 24901: Add tests for transferbook
    
    Test plan:
    0/ Read the commit and confirm the new tests make sence
    1/ Run the tests and verify they pass
    2/ Signoff
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eed5e858b95f5f95a8e7425b9d599055c36320fc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 18 19:25:57 2020 +0000

    Bug 24901: Minor refactor of tests
    
    Test plan:
    0/ Read the change and verify it makes sense
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d4254cf244d2cae4a1852bf34351401d64718584
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Feb 3 07:56:37 2020 -0500

    Bug 24566: UpdateItemLocationOnCheckin triggers SIP2 alert flag, even with checked_in_ok enabled
    
    If UpdateItemLocationOnCheckin, it triggers an alert flag but cannot be acted on in the same way as LocalUse and thus should be removed in the same fashion.
    
    Test Plan:
    1) Enable UpdateItemLocationOnCheckin and set it up to trigger at
    checkin for an item
    2) Return that item via SIP2
    3) Note the alert flag is set
    4) Apply this patch
    5) Repeat steps 1 and 2
    6) The alert flag should not be set
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Kevin Cook <ILS@cedarparktexas.gov>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d6ac30323b575c9108ca84f97965255e0a98bf4f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 19 13:07:06 2020 +0000

    Bug 24818: (RM follow-up) Update account_line date definition
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 06dafd8e74d9aa4a242b7ec8fc1b03369c71162d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 19 13:05:10 2020 +0000

    Bug 24818: (RM follow-up) Update tests for DATE -> TIMESTAMP change
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 29fe1f4fb4eb6fba2e701c39361564208bb8c0b7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 18 11:20:30 2020 +0100

    Bug 24726: Replace one occurrence in print statement
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a696d4ecc353eea87195f17bbe91ca988fbadd3d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 25 13:20:18 2020 +0000

    Bug 24726: Update overdue_notices to use inbound_email_address
    
    This patch updates the overdue_notices functionality to use the
    inbound_email_address method to obtain the correct email address
    for a branch.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e1ebe8ddefe7a770e1404694c4fa56fc4a9abb9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 25 11:14:12 2020 +0000

    Bug 24723: Update EmailPurchaseSuggestions to use inbound_email_address
    
    This patch updates the EmailPurchaseSuggestions functionality to
    use the inbound_email_address method to obtain the correct email address
    for a branch when it is set to BranchEmail
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04de40cdcf0f005c209a76414be853b5007e8a6a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 25 11:03:58 2020 +0000

    Bug 24721: Update emailLibrarianWhenHoldIsPlaced to use inbound_email_address
    
    This patch updates the emailLibrarianWhenHoldIsPlaced functionality to
    use the inbound_email_address method to obtain the correct email address
    for a branch.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2fcc16b62c00aceca350e6edce8a84443150abe8
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Fri Feb 21 14:09:17 2020 -0500

    Bug 17674: Handling of special cases
    
    This patch adds handling for those 2 particular cases:
    1. Deleting the expected issue
    2. Deleting a serial and it's item, but one item cannot be deleted
    
    To test:
    
    1.1 Create a subscription that creates items
    1.2 Receive two issues
    1.3 Use the new button to delete the 'Expected' issue
    1.4 The issue is correctly deleted, but the new expected issue created
    to replace the one which has been deleted don't have a published or
    received date and is show in it's own tab.
    1.5 Apply patch
    1.6 Repeat steps 1.1 through 1.4
        => The new expected issue is created correctly
    
    2.1 Use the same serial as in 1 or repeat step 1.1 and 1.2
    2.2 Check out one of the items
    2.3 Delete the corresponding serial and check box to delete items
    2.4 The serial is deleted, but not the item.
        => No feedback is show to the user
    2.5 Apply patch
    2.6 Repeat step 2.1 through 2.4
        => As before, the serial is deleted, but not the item
        => This time, an error is shown to inform the user
    
    Signed-off-by: sonia <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6cb8c9e4e97b0800d46ba2f5a32a3b898cf2d73a
Author: Pierre-Marc Thibault <pierre-marc.thibault@inLibro.com>
Date:   Wed Oct 10 11:25:59 2018 -0400

    Bug 17674: Allow UI to delete serials in batch
    
    This new feature allows for batch deletion of serials through the UI.  The current usage is a one-by-one long game.
    
    Test plan :
    - Apply patch.
    - Create at least four serials with items.
    - Notice that new items have a numbering pattern and a date in the enumchron field.
    - Use the button Delete selected issues for the following steps.
    - Delete a serial and its associated item.
    - Confirm the serial and item are gone.
    - Delete a serial and not its item.
    - Confirm the serial is gone.
    - Confirm the item is still there and the date part in the enumchron field is gone.
    - Delete the two lasts serials.
    - Confirm they are gone.
    
    Sponsored-by: CCSR
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Sonia <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f8d38ddcf11c45db0a1c01c167af2e687485597a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 19 09:29:06 2020 +0000

    Bug 22987: DBRev 19.12.00.047
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4f4d30975aa617e128a50af688b3b867c83528af
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 13 11:41:21 2020 -0300

    Bug 22987: Add biblioimages.timestamp
    
    This patch adds the timestamp column to the biblioimages table.
    To test:
    1. Apply this patch
    2. Run:
       $ updatedatabase
       $ koha-mysql kohadev
       > SHOW CREATE TABLE biblioimages;
    => SUCCESS: Notice the new column is there with the right settings
    3. Sign off :-D
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aff13ee0f7981347b975eaaca30077a2020fc763
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 12:16:27 2020 +0100

    Bug 24510: Add missing filter
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 73df5c7b3f40cd6249322704514c095a5d4060fe
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 17:38:53 2020 +0100

    Bug 24510: Code cleaning
    
    Additional test plan:
    Create 3 clubs: abc adf axy
    place a hold for on of those club, search for a club 'a'
    you will get the focus on the "Clubs" tab
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c841e8a8bfe5b25c7f2ec194507b894575df3441
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Feb 26 15:53:48 2020 +0000

    Bug 24510: When Placing a Hold, cursor doesn't focus on Patron Name
    
    This alternate patch tries to implement a fix in a more "correct" way by
    tying the cursor focus to the initialization of the jQueryUI tabs. By
    configuring both the "create" and "activate" events we can make sure the
    correct input field is focused.
    
    I think the only advantage of this patch over the other one is that
    tying the focus to the tabs activation makes it a little more obvious
    where in the DOM loading sequence the focus is being set.
    
    To test, follow the original patch's test plan:
    
    TEST PLAN:
    1. Go to Biblio Record
    2. Place Hold (request.pl) - either the Hold above the Bib or the Hold
       on the left, it does the same thing.
    3. Note that the cursor does not go to Patron Name (for whom to place
       the hold for), it goes to the Top Search bar under Checkout.
    4. Apply patch and reload the page.
    5. The focus should now be correctly set.
    6. Toggle between 'Patrons' and 'Club' tabs.
    7. Focus should stay set.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a8e2249ca180a3e7a8e94ec0687833ed6221be27
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Fri Jan 24 15:34:07 2020 +0000

    Bug 24510: Add focus to Patron/club input
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 41931c1b6329815bace9f0cf22f54501131f7d93
Author: Lari Taskula <lari.taskula@hypernova.fi>
Date:   Mon Mar 2 09:18:26 2020 +0000

    Bug 24774: Set JSON indentation of 2 spaces in .editorconfig
    
    To test:
    1. Start an editor that supports .editorconfig
    2. Open or create a JSON file
    3. Observe identation is set to 2 spaces by default
    
    Sponsored-by: Hypernova Oy
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b626f656a8b60a285b9aefb83beb134c24fa90ce
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 19 09:21:14 2020 +0000

    Bug 24298: (RM follow-up) Schema Class Update
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12bac04164beeba2230089a6207c4436c704df12
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 19 09:18:45 2020 +0000

    Bug 24818: DBRev 19.12.00.046
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ad6e72dddddd29ed3330f0c282b754d941c53d95
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 6 11:20:51 2020 +0000

    Bug 24818: Update database accountlines.date to timestamp
    
    This update increases the resolution for the 'date' field, used for
    'creation date' in accountlines from a 'date' to a 'timestamp'.
    
    This matches other tables where both a created and updated field are
    included.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 53ef5a4078d8d140c6f0d70bd183f56888767ad8
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 9 11:45:14 2020 -0300

    Bug 24384: Add Access-Control-Allow-Origin support to OPAC reports svc
    
    This patch makes the opac/svc/report script use output_with_http_headers
    so it sets the Access-Control-Allow-Origin header.
    
    To test:
    1. Create a new public report and remember the report id
    2. Use your favourite too to fetch the report in JSON by issuing:
       GET http://localhost:8080/cgi-bin/koha/svc/report?id=1
    => FAIL: There is no Access-Control-Allow-Origin header
    3. Apply this patch
    4. Restart Plack
       $ sudo koha-plack --restart kohadev
    5. Set the AccessControlAllowOrigin to anything (for example,
       https://koha-community.org)
    6. Repeat 2
    => SUCCESS: On the response headers you find
    Access-Control-Allow-Origin: https://koha-community.org
    7. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0abe936e37cefad5986f14290ca178d68495d323
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 19 09:13:42 2020 +0000

    Bug 3137: DBRev 19.12.00.045
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b920305daa3b8640f8e7b24f621d22176209542d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 19 09:11:30 2020 +0000

    Bug 3137: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit acda3765b1c7da6cd914771211ae9ee0ce157e68
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Mar 13 15:35:17 2020 +0000

    Bug 3137: (QA follow-up) Switch hidden for collapsed in text
    
    Changes the text and tooltip on top of the add/edit patron screen
    to use collapsed instead of hidden.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87c3436f7780f51ed3ed8a1392983d53fdf356fc
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Mar 11 04:02:53 2020 +0000

    Bug 3137: (follow-up) Rename using 'collapse', remove syspref lettering and fix guarantor section collapsing
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1a33d5124619781a600441ba534a576e38ab9110
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Fri Feb 7 02:57:40 2020 +0000

    Bug 3137: HideFieldsPatronAddForm syspref
    
    This patches adds a syspref - HideFieldsAddPatronFrom - that controls
    which fieldsets are hidden by default in the add patron form.
    
    To test:
    1) Apply patch and update database
    2) Go to System preferences and confirm HideFieldsPatronAddForm has no
    fields selected
    3) Go to add a patron / edit an existing patron (any patron category).
    confirm everything still works as expected.
    4) Tick some of the fields in the syspref to hide them in the form
    5) Go back to add patron form.
    6) Confirm these fields are hidden and listed at the top of the page
    7) Toggle the checkbox and confirm the hidden fields show or hide as
    expected.
    8) Go back to the HideFieldsPatronAddForm system preference and ensure
    the Main address option is checked to be hidden
    9) Go to the patron's details page
    10) Click to edit the Contact Information section
    11) Confirm the Main address option shows and the checkbox to show
    hidden fields is not present.
    12) Confirm you can click the legend of each section to show and hide
    sections
    
    Sponsored-by: Catalyst IT
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4687197d64df3392b0ba9923a18b8f8b8f0fd7ea
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Feb 29 23:36:46 2020 +0100

    Bug 15775: Change wording slightly
    
    maxoutstanding only blocks holds, for checkouts we got
    noissuechage.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b8f85fccc2f8940747a4537ebea065163fd7ea39
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 6 22:25:06 2020 +0000

    Bug 15775: Show message on OPAC summary if holds are blocked due to fines
    
    To test:
    1) Set maxoutstanding syspref to 5
    2) Create a manual invoice for a borrower for $6
    3) Log in to the OPAC as this borrower
    4) Go to opac-user.pl, your summary page
    5) Confirm there is a warning box explaining that the borrower is
    blocked from holds due to fines
    6) Back on the staff side, pay some or all of the borrower's fines so
    they are no longer over the max outstanding amount
    7) Refresh the summary page in the OPAC and confirm the warning is gone
    
    Sponsored-by: Catalyst IT
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2db51d681f780df93aaa9d3ff230d10333fbbb0d
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Fri Feb 21 20:54:41 2020 +0000

    Bug 24701: Add column config to course_items_table
    
    This patch adds course_items_table to the column config tool
    TEST PLAN:
    1. Have some course reserves
    2. Add some items to that course reserve and browse to opac-course-details
    2. See all the unconfigurable columns
    3. Apply patch
    4. Browse to column config > OPAC > opac-course-details
    5. Try hiding each column and make sure the correct column is hidden on opac-course-details.pl
    
    Signed-off-by: Devinim <kohadevinim@devinim.com.tr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e7f1bb335418a935c7e7985b5bfca5d74fb832c1
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Mar 11 03:38:44 2020 +0000

    Bug 24844: Focus syspref searchbar
    
    To test:
    1) Go to Administration
    2) Notice neither of the syspref search bars are focussed so you have to
    click inside one to begin searching
    3) Apply patch and refresh page
    4) Notice the header syspref search bar is now focussed so you can begin
    typing straight away
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit efb7c4c68799bb419063f869a3abbbd975d1ddf6
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Mar 11 14:00:21 2020 +0300

    Bug 24847: Select AND by default in items search
    
    In items search form, when clicking on "New field" a new conjunction and search field are added.
    It would save time to select AND conjunction by default, like it is in advanced search.
    
    Test plan:
    1) Go to items search
    2) Click on  "New field"
    3) Check that AND is selected
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 45423f4ecd281bcfcaaa14303b18a58a964b2cdf
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 19 08:55:55 2020 +0000

    Bug 24846: DBRev 19.12.00.044
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cb8895a5fd95efde5ecf0cfb934a8c0db82744e4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 17 16:59:44 2020 +0100

    Bug 24846: Update items.onloan with the new due date
    
    Signed-off-by: Donna Bachowski <donna@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7084c4c27313dc14b29e958469f6ef8d8b21b4a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 11:45:44 2020 +0100

    Bug 24846: Add new tool to batch extend due dates
    
    With events sometimes leading to unforeseen branch closures (think Coronavirus as
    an example), it would be helpful to have a tool that would allow librarians to
    update due dates in bulk based on branch and current due date of the material.
    
    It allows to select checkouts given the following parameters:
     * libraries
     * patron's categories
     * range of the due date
    
    You can set a hard due date, or define a number of days to extend the
    due date.
    
    Test plan:
    Check some items out
    Use the new tool to extend the due dates
    Test the different filters to make sure they all work
    
    Note: What about holidays?
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18a56d014641f5b5e30126c52612acbe2025268d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 11:51:10 2020 +0100

    Bug 24846: Link to the new tool
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 48bfabbe057fd364ce13be84126de4eeacf3a504
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 11:45:15 2020 +0100

    Bug 24846: Add new permission batch_extend_due_dates
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 44e6f6d9eba833d35e3ba89348ab5a47bc9c25c7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 19 08:54:38 2020 +0000

    Bug 24298: DBRev 19.12.00.043
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e2ae4e4201ee23aa54c9bfe7150a00d6dbf9536
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Mar 12 07:52:00 2020 -0400

    Bug 24298: Update test count and use build_sample_item
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a51fe76c57a387af3f785cba9e63fadc50340e6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Feb 28 15:47:12 2020 +0000

    Bug 24298: (follow-up) Add missing filter!
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f64280255a3881cb90ae843982ad3a6afd0254c6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Feb 3 13:21:18 2020 +0000

    Bug 24298: Add tests for ModItemTransfer
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3fbc212d634ceac3d7d79d7a1dca09528cda7c82
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 16 13:56:41 2020 +0000

    Bug 24298: Record transfer triggers for returns
    
    This patch adds handling to catch transfers that may have been triggered
    on item return.
    
    Test Plan:
    
    1) Enable AutomaticItemReturn and accompanying system preference
    2) Return an item to the wrong branch and note the transfer
    3) Check the database for the new trigger value
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 26b64bf8b45ea883f7c2c6c4e7bc7d4bdc1f68f6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 16 15:25:34 2020 +0000

    Bug 24298: Add return enums to branchstransfer triggers
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bbe77b10d8435ae7f6b59954964836b9ddc89de6
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Mon Jan 27 12:00:47 2020 +0000

    Bug 24518: Fix IE11 partner filtering
    
    This patch adopts the approach detailed in comment #1.
    
    It also fixes a couple of additional minor bugs relating to the ILL
    partner list:
    - Exclude partners with no email address, we cannot use them
    - Quote the "value" attribute to avoid warnings displayed by IE, they
    should be quoted anyway!
    
    Test plan: USE IE11
    - Apply the patch
    - Define 3 ILL partner patrons (patrons in the category that has a code
    that matches the <partner_code> value in the ILL config). One patron
    should have no email address, the other two should have an email address
    - Navigate to "Place request with partners" for an ILL request
    - TEST: Observe that the patron with no email address is not displayed
    - Try filtering the list
    - TEST: Observe that the list filters correctly
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 06f7cc332cad6ac425a1fe149c1be862e4324ce8
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Sep 8 17:20:38 2017 +0200

    Bug 19279: performance of linked items in search
    
    When catalog has fields 773 (461 in UNIMARC), those linked items are fetched for display in search results.
    Looks like the code could be more performant by replacing item search by $9 with direct call with GetMarcItem().
    
    Test plan :
    1) Enable system preference EasyAnalyticalRecords
    2) Get a record A with a lot of items, it will be the 'Host record'
    3) Click on 'Analytics' on this record
    4) On one of its items (say item A1) click on 'Create analytics' to
    create record B
    5) Enter the same title as record A and all mandatory fields
    6) Edit field 773 (461 in UNIMARC)
    6) Check that $0 contains the biblionumber of record A
    7) Check that $9 contains the itemnumber of item A1
    8) Perform a search on record A title, be sure you see record B with
    other results
    => Compare execution times with and without patch
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8ba48fb5f1cb397148623ef88cca680f65bda750
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 17:19:22 2020 +0100

    Bug 24881: Try to fix random failure from Circulation.t
    
    This is a follow-up of bug 22917.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 20952a7b2d45e1cc3fe3a5b543f6aa041a133d4e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 18 10:08:25 2020 +0100

    Bug 22821: Rename method with ->inbound_email_address
    
    The method has been renamed in the previous bug report.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 67bda71a454b53b72b57ba5a1951ffec95c6ef77
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 25 07:48:31 2020 +0000

    Bug 22821: Correct to_address for issue notes
    
    This patch updates the controller and service code to use the newly
    introduced 'get_effective_email' routine from bug 22823 to obtain the
    branches most appropriate email address.
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04dcca4321caa0ca23870fb3299312cd4ff0d7ab
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 25 09:05:18 2020 +0000

    Bug 22821: Use 'reply-to' address in issue notes
    
    This patch updates the issue notices to not pass from_address and so
    default to the branch email of the user for from_address. We now pass
    the patrons email (cascading through email, emailpro, B_email) into the
    reply_address field so mail servers are less likely to report emails as
    spam and mail clients still have access to the patron address via the
    reply-to header when staff want to hit 'reply' and have the email go to
    the user.
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cd2b79b8710f9bea2b20bf13691e77db26314199
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 18 10:35:52 2020 +0100

    Bug 22823: return undef if KohaAdminEmailAddress not exist
    
    I have the feeling that we should return undef here, but can be ignored
    if someone disagrees.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 027051c938924a33a64014794705526ab68351af
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 18 10:07:02 2020 +0100

    Bug 22823: Rename method with ->inbound_email_address
    
    Make the name obvious it's not an email address for "from"
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40c08434d4853c888a67d3c5a2cde75b64c13a75
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Feb 24 20:42:30 2020 +0000

    Bug 22823: Add get_effective_email method to Koha::Library
    
    Add a `get_effective_email` method to the Koha::Library object which
    returns the email address for the library which they are most likely to
    have access to.
    
    This method falls back through preferences `branchreplyto`, `branchemail`,
    `ReplytoDefault`, `KohaAdminEmailAddress`.
    
    This bug simply introduces a new utility function to return the most effective email address for a branch to be emailed on.
    
    Test plan
    1/ Read the new test and verify it makes sense
    2/ Run the tests and verify they all pass.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b16d43394376bdcfbcaaaf2f5543567c3aec9771
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 25 07:36:12 2020 +0000

    Bug 22823: Add unit tests for get_effective_email
    
    This patch adds unit tests for the newly introduced get_effective_email
    method in the Koha::Library class.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 21807202d447c3ad91afe8e053b17724912298a0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 18 15:43:38 2020 +0000

    Bug 10269: DBRev 19.12.00.042
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c1129d2286924cbc81d4d42085043760677b7c57
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 25 09:05:18 2020 +0000

    Bug 10269: Use 'reply-to' address if passed to EnqueueLetter
    
    This patch updates the EnqueueLetter method to allow passing a reply_to
    address. This allows for passing in arbitrary addresses for the reply
    address which will not override the from address. This improves the
    chances of your email getting past spam filters.
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8c0ffe6150c4b684194125436af643700d2cbde2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 25 09:47:10 2020 +0000

    Bug 10269: Schema Update
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ae5d4548f97b111a38098d1dc5158377d2b8c112
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 25 09:42:20 2020 +0000

    Bug 10269: Add reply_address field to message_queue table
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c265dc6b0cf3810dc18dde79614ec3eb5274997
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 18 13:43:52 2020 +0100

    Bug 24200: (follow-up) Try to fix random failures from Borrower_PrevCheckout.t
    
    2 other occurrences where missing.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b961f2d764c12a2fdfbabc688e1f05a3dc197e1d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 18 12:44:09 2020 +0000

    Bug 24722: (RM follow-up) Schema Changes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bf0e914e62715a65cb9ea07920cc1188fbfaa820
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 18 10:26:07 2020 +0000

    Bug 24722: (RM follow-up) updatedatabase correction
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 27a19916df416c2cbd92daaa7844f2d2f178a864
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 18 11:07:14 2020 +0100

    Bug 24722: reserves.priority must default to 1 at DB level
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b3d53930971a9c008112d3a851f96469a89c6bd
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Tue Jan 28 00:21:19 2020 +0000

    Bug 24495: Reword change collection feature
    
    This patch changes the text of the "Collect from patron" field to read "Amount tendered"
    
    To Test:
    
    1) In the Point of Sale screen, check that the text inside the "Collect payment" box reads "Collect from patron"
    2) Go into a patron record, and create a manual invoice.
    3) Go to Make a payment, and select to "Pay an amount". Check the text reads "Collect from patron".
    4) Repeat the process with the "Pay Selected", and "Pay" button (listed next to the individual invoice)
    5) Install the patch
    6) Repeat steps 1-4, but the text should now read "Amount tendered", instead of "Collect from patron" in all payment options in the patron record, and in the Point of Sale screen.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e5b7240523018c609a3375fddfe3affba65ce9f7
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Fri Jan 17 22:12:11 2020 +0000

    Bug 24456: change default sort orders/make wording clearer
    
    TEST PLAN:
    1. Apply patch
    2. Have some checkout from today and some from multiple previous days.
    3. Set todaysIssuesDefaultSortOrder & previousIssuesDefaultSortOrder to 'earliest to latest' and confirm it sorts correctly.
    4. Reverse the 2 system preferences and see that it is now sorting the opposite way.
    5. Also look at the wording of each system prefence and make sure it makes sense
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2dd5065faabe1266bf663adf429cb8f50f76f372
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 17 15:03:53 2020 +0100

    Bug 23531: Simplify tests using build_object
    
    And build_sample_item.
    Also remove a debug statement
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f980e7f4c2b7aef62f1a8533ff8d1e072b14a20d
Author: Arthur Suzuki <arthur.suzuki@biblibre.com>
Date:   Sun Dec 22 08:07:51 2019 +0100

    Bug 23531: Add some tests for HoldItem and HoldTitle with date params provided
    
    Signed-off-by: Arthur Suzuki <arthur.suzuki@biblibre.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c8bf308e1b453023910336308d59566359efc535
Author: Arthur Suzuki <arthur.suzuki@biblibre.com>
Date:   Tue Sep 3 11:08:49 2019 +0200

    Bug 23531: fix ILSDI non-implemented but documented parameters
    
    test plan :
    1/ Submit a hold through ILSDI with start_date and expiry_date parameters
    2/ Verify in Koha those parameters are not applied to the newly created
    reserve. Delete reserve.
    3/ Apply patch and repeat 1.
    4/ Verify the reserve created by same request as 1 now has both dates
    applied and visible in Koha.
    
    Signed-off-by: Christophe Croullebois <christophe.croullebois@biblibre.com>
    Signed-off-by: Arthur Suzuki <arthur.suzuki@biblibre.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a5fb30fbd0d0413185ed2e2e5fca6ac05227dfc6
Author: Caroline Cyr La Rose <caroline.cyr-la-rose@inlibro.com>
Date:   Wed Feb 12 14:32:01 2020 -0500

    Bug 23236: Remove 'its items may still be processed' in action if no match is found
    
    When importing records and looking for duplicate records using record matching rules,
    there is an option if NO match is found to "ignore incoming record (its items may
    still be processed)". This doesn't make any sense. Where would the items go if there
    is no match?
    
    To test:
    1) Go to Tools > Stage MARC for import
    2) Browse and choose a file with at least one record that is not already in your
    catalog and click on Upload file
    3) Fill out the first section with the appropriate information
    4) In the Look for existing records in catalog? section, choose a record matching
    rule
    5) In the Action if no match is found drop-down menu, choose Ignore incoming record
    (its items may still be processed)
    6) Click on Stage for import
    7) Click on Manage staged records
    8) Click Import this batch in the catalog
    9) In the table, the record status should say Ignore
    10) Apply patch
    11) Redo steps 1-9, notice the option Ignore incoming records does not mention items
    12) Make sure the tool still works and still ignores the record
    
    Signed-off-by: Devinim <kohadevinim@devinim.com.tr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 374c78a0b7039c5c18143c93fbd49e9376af5666
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 18 08:34:21 2020 +0000

    Bug 24722: DBRev 19.12.00.041
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a288f5a7397b48fc368b11fc6cf8d59886e761d2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 17 09:04:17 2020 +0100

    Bug 24722: Same change for old_reserves.priority
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 231696ac6e5804c3e69e382806c6dd1fcf84c2e2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 13:20:52 2020 +0100

    Bug 24722: Add atomicupdate file
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b09f5726af9c9d7a42bcc98cefcf9bf34feaa8c5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 25 12:26:31 2020 +0100

    Bug 24722: DBIC changes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 08576a23cc840a1a8cba5f8c2a8fa8bf1aa4a230
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 25 12:15:21 2020 +0100

    Bug 24722: Add test
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5037d7f355f71e276c62009ee22649f1036384d5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 25 12:07:18 2020 +0100

    Bug 24722: Enforce NOT NULL constraint on reserves.priority
    
    This field is never NULL and must always be equal to an integer.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd808d02a6269828914d4f6d91c942117b4f0d67
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 12:39:39 2020 +0100

    Bug 24851: Translate the .txt in French
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cb1f6c574b7bbd4526bc94222f49346ecd652eed
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 4 19:06:03 2020 +0100

    Bug 24851: Insert libraries sample data for "UNIMARC"
    
    I am trying to make koha-testing-docker UNIMARC compabible.
    In order to have koha-misc4dev insert all the data correctly (users, etc.) we need at least 1 library.
    I am suggesting to reuse the usual library list for UNIMARC.
    
    misc4dev will use fr-FR sample data for "UNIMARC"
    This is related to https://gitlab.com/koha-community/koha-misc4dev/issues/29
    
    Test plan:
    outside your box, in koha-testing-docker (up-to-date), edit .env and set
     KOHA_MARC_FLAVOUR=unimarc
     DEBUG_GIT_REPO_MISC4DEV_URL=https://gitlab.com/joubu/koha-misc4dev.git
     DEBUG_GIT_REPO_MISC4DEV_BRANCH=unimarc
    
    Then start the koha container
    When the misc4dev will start its job, the scripts will have the expected
    data to continue.
    
    Without this patch you will get
    koha_1       | Not enough data in the database, library and/or patron category does not exist at /kohadevbox/misc4dev/create_superlibrarian.pl line 31.
    
    And plenty of errors will follow.
    
    Also, the sample data used in misc4dev will use CPL
    (/kohadevbox/misc4dev/data/sql/unimarc/1812/after_22155/items.sql)
    
    Signed-off-by: Jon Knight <J.P.Knight@lboro.ac.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c8f39a832b5478c8579d52ff1043f2b64a22482e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Mar 16 14:55:31 2020 +0000

    Bug 24789: [follow-up] Fix saving of macros
    
    Saving was accidentally commented out in patches, this restores that
    
    To test:
    1 - Create a new macro
    2 - Add some content
    3 - Reload the macro, no content
    4 - Apply patch
    5 - Repeat
    6 - Macro saves/loads correctly
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c186a3e25efb174d54b5ca6e5d6599979bcd568
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Mar 2 17:35:53 2020 +0300

    Bug 24776: Remove file Koha/Template/Plugin/Borrowers.pm
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a0c872992f41977f3d3590eac08822cad51e42dc
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Mar 2 17:27:10 2020 +0300

    Bug 24776: Remove Borrowers.IsDebarred call
    
    Borrowers Template Toolkit plugin contains method IsDebarred that can be directly called from Koha::Patron object.
    
    Also in template circ/returns.tt, when patron is restricted and checkin was backdated, var "patron" is undefined, should be "issue.patron".
    
    Test plan :
    1) Enable system preference SpecifyReturnDate
    2) For a patron without restriction create a checkout
    3) Create a manual restriction to debarre patron
    4) Go to return page and click on "Checkin settings"
    5) Specify a date in the past, barcode and click "Check in"
    6) You see message "Jon Doe is restricted. Please verify this patron should still be restricted."
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e0483bd6e244fe81a858ad3e22cbd92fe2a83672
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Mar 2 17:18:34 2020 +0300

    Bug 24776: Remove Borrowers.HasOverdues call
    
    Borrowers Template Toolkit plugin contains method HasOverdues that can be directly called from Koha::Patron object.
    
    Test plan :
    1) Go to circulation page of a patron with overdues
    2) Click on print button
    3) You see "Print overdues"
    4) Go to circulation page of a patron without overdues
    5) Click on print button
    6) You don't see "Print overdues"
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f4f841fd8ce5e21c1c84dba21dace6081451fa8b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 16 13:01:04 2020 +0100

    Bug 24827: Add a test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8f9aedaf1d0d6a381293265b0c8a691a12fc1258
Author: Andreas Roussos <a.roussos@dataly.gr>
Date:   Sun Mar 15 08:43:25 2020 +0100

    Bug 24827: Specify UTF-8 as encoding in new_from_xml()
    
    The MARC preview of staged records fails when a staged record contains
    items with UTF-8 characters (see attached screenshots). That's because
    in EmbedItemsInImportBiblio() the call to MARC::Record->new_from_xml()
    does not explicitly specify 'UTF-8' as the optional encoding to use.
    
    This patch fixes that.
    
    Test plan (in a MARC21 instance):
    0) Stage for import the test record attached to this bug report (make
       sure that 'Check for embedded item record data?' is set to 'Yes'),
       then go to Home > Tools > Manage staged MARC records and click on
       the filename you've just staged.
    1) In the 'Citation' column, click on the hyperlink to launch the MARC
       preview -- notice how it fails to produce any output apart from the
       modal heading.
    2) Apply the patch, and restart Plack if necessary.
    3) Re-launch the MARC preview: this time the output should include the
       whole record, including the embedded item data in field 952.
    4) Run the unit tests to ensure nothing was broken inadvertently:
       $ prove t
       $ prove xt
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1d26fb3a9dcaa2c40abd95f3d454973865194cc8
Author: Andreas Roussos <a.roussos@dataly.gr>
Date:   Sun Mar 15 08:34:52 2020 +0100

    Bug 24827: Standardise on 'UTF-8' as the encoding name
    
    This patch standardises the encoding name used in direct calls
    to new_from_xml() to 'UTF-8' instead of 'utf8' or 'utf-8'.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit de07356028d5b98af3a7cd7cbae02a7ad6402a43
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Mar 13 12:03:03 2020 -0300

    Bug 24862: Handle annonymous sessions gracefuly
    
    This patch introduces code to detect (cookie) annonymous sessions and
    act as expected.
    
    Right now, as check_cookie_auth is not passed the required permissions
    (because there aren't always required permissions, and the code to check
    permissions is shared with other authentication mechanisms) it returns
    'ok' and the session id. This use case was overlooked when this was
    coded, and yeilds unexpected error codes (500) when the user logs out
    and the annonymous session cookie is used to hit the API. The end result
    doesn't pose any security issue (i.e. the resource access is rejected)
    but the returned error code is not correct and should be fixed.
    
    This patch verifies for an anonymous session (and avoids querying the
    corresponding patron) and then verifies if there is an authorization
    config on the route and if the patron object is defined.
    
    To test:
    1. Apply the tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/auth_authenticate_api_request.t
    => FAIL: Tests fail, 500 instead of the expected 401
    3. Apply this patch
    4. Repeat 2
    => SUCCESS: Tests pass!
    5. Repeat the original 'steps to reproduce' from the bug report using
       the browser
    => SUCCESS: Problem solved!
    6. Sign off :-D
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0547ad34dfe01ca7d7660df59e29bc30fdf3cf1d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Mar 13 11:44:03 2020 -0300

    Bug 24862: Regression tests
    
    This patch introduces tests for the expected behaviour on API routes
    that expect a logged in user, but the request is made with an anonymous
    session cookie.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/auth_authenticate_api_request.t
    => FAIL: Tests fail because the situation is not handled correctly in
    the code
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6c3a2b474806d1499780966bdb35c0ddabc609d0
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Mar 3 13:26:02 2020 +0000

    Bug 24789: Remove ITS macro format
    
    To test:
    1 - Apply patches
    2 - Confirm you can save, load, and run macros
    3 - Confirm you have no choice of format
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0666b644be37899217d64c75e1a610b0a0de1724
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Sun Mar 8 08:39:40 2020 +0000

    Bug 24402: About template corrections
    
    With the 20.05 team we introduced and expanded some roles.  This patch
    adds support for:
    
    * removal of the release maintainer for development releases
    * a list of documentation managers
    * a list of packaging manager
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ea7ec1a5d3d1c262345743bced3669c5cab39baf
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Mar 13 08:47:53 2020 +0000

    Bug 22943: Remove unused line from Auth.t
    
    Removes an unnecessary variable declaration from Auth.t
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da5024e5c26a75c106504809b48325532c402510
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 9 09:17:50 2020 +0000

    Bug 22943: (QA follow-up) Add new cases
    
    A few additional cases were introduced since the original bug was
    authored. This patch simply catches those cases and makes the same
    change.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 619d6362ce895ba4da543dcd809b162ed7a9b6b5
Author: Hayley Pelham <hayleymapley@catalyst.net.nz>
Date:   Mon May 27 13:57:05 2019 +1200

    Bug 22943: Renames the in_ipset function to in_iprange in C4::Auth
    
    Bug 14407 introduced a new system preference to allow limiting the
    online self checkout system to an IP or IP Range. The function that
    handles this is called in_ipset, which is the name of a linux tool. To
    stop confusion, this patch renames the function to 'in_iprange', and the
    variable 'ipset' within it to 'iprange'.
    
    To test, follow the test plans outlined in Bug 14407 and confirm that
    everything works as expected.
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3b47f87b0ff5c020300108ef4fd8e4145bfccd13
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Feb 11 15:10:48 2020 +0000

    Bug 24627: Correct style of clubs search results during hold process
    
    This patch updates some markup and CSS so that the process of selecting
    a club from search results during the hold process looks the same as
    when selecting a patron: Club names should be links (like patron
    names are) and the table row should have a hover color to help indicate
    that it is clickable.
    
    This patch also changes the markup of the Patrons/Clubs tabs a little
    bit to make the information clearer: Superfluous Bootstrap-related tab
    markup has been removed, and the patron and club search results have
    been moved into their respective tab containers. This means that if you
    search for a patron but then switch to the clubs tab the patron list
    doesn't still display.
    
    To test, apply the patch and rebuild the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client)
    
     - You should have more than one patron club defined.
     - Begin the process of placing a hold on a title.
     - Test the process of searching for both patrons and clubs.
       - In each case the name (patron or club) should be an active link.
       - Hovering your mouse over the table rows should change the row
         background to yellow.
       - Clicking the other tab at this stage should hide the search results
         from your last search.
       - Whether you click the linked name or elsewhere in the table row
         you should be correctly redirected to the next step in the holds
         process.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0fc78cae28db6bd79549a2d78674eb51b276600f
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Thu Mar 12 22:38:47 2020 +0000

    Bug 24858: Correct labels on wording in ExcludeHolidaysFromMaxPickUpDelay
    
    TO TEST:
    - Apply patch
    - mark your library closed today and tomorrow
    - set ReservesMaxPickUpDelay to 1 day
    - set ExcludeHolidaysFromMaxPickUpDelay to "Ignore the calendar"
    - place hold, capture hold
    - hold expiration date is set to tomorrow (doesn't skip closed days)
    
    - Set ExcludeHolidaysFromMaxPickUpDelay to "Use the calendar"
    - Place hold, capture hold
    - hold expiration date is set to the day after tomorrow (skips closed days)
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 22f2494914a4bbec0bb4612e813515ee7412008a
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Mar 12 07:07:48 2020 -0400

    Bug 24767: Hide the "Claim returned" tab if the feature is turned off
    
    The ability to claim an item "claim returned" is not there if the syspref is empty, however, the Claim Returned tab is stil present on the patrons detail page.
    
    Test Plan:
    1) Ensure ClaimReturnedLostValue is not set
    2) Note the claims tabs on the circulation and patron details pages
    3) Apply this patch
    4) Refresh those pages
    5) The claims tabs should be gone!
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c8468a92029af19ced6d1454ed4c5c3ae30aca34
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 12 15:09:02 2020 +0100

    Bug 5103: Refactor the code to avoid repetition
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4432429c1e164adecff78869627168cf276c5d50
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Mar 11 03:08:12 2020 +0000

    Bug 5103: (follow-up) Using mapped item fields instead of hardcoding subfields
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d505e371fa6c5848af47d48d43872fb922dc04c
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Feb 26 02:52:24 2020 +0000

    Bug 5103: Format dates in MARC detail using dateformat syspref
    
    This patch fixes the formatting of dates on the following pages:
    - catalogue/MARCdetail.pl (staff)
    - cataloguing/additem.pl (staff)
    - opac-MARCdetail.pl (opac)
    
    To test:
    1) Ensure that the following fields are visible in the opac, intranet
    and editor. You may need to edit the subfields in your default
    bibliographic framework
    952$d date accessioned
    952$q date due/on loan
    952$r date last seen
    952$s date last borrowed
    952$w replacement price date
    
    Also ensure you have dateformat system preference set
    
    2) Go to cataloguing/additem.pl for a biblio. Fill in the fields above
    if required. Save
    3) Remain on cataloguing/additem.pl. Notice the items table at the top
    of the page, the dates are in the generic yyyy-mm-dd format
    4) Go to catalogue/MARCdetail.pl for that biblio. Notice dates in wrong
    format
    5) View this biblio in the opac opac-MARCdetail.pl. Scroll to bottom to
    items table. Notice dates in wrong format.
    6) Apply patch, restart memcached and plack and refresh pages
    7) Dates should now be formatted according to dateformat preference
    8) Confirm that changing the preference changes the format of the dates
    
    Sponsored-by: Catalyst IT
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 81fd7a6936d258001aa3a0f2d0ec5d7758482f45
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Mar 9 09:41:26 2020 +0000

    Bug 19288: Don't show patron info for item level holds on details.pl unless hold is waiting
    
    This persists after bug 20948 - we can still display patron information even if this patron is not the one
    who will receive the item upon checkin. The holds tab can give an overview of holds and information - I think
    on the details page the only info we need is whether there might be a item level hold, not who it is for
    
    To test:
    1 - Place an item level hold for delivery at a branch not matching home branch of item
    2 - Place a record level hold for delivery at homebranch of item placed on hold above
    3 - Enable LocalHoldsPriority with 'pickup library' matches the item's 'home library'
    4 - View the details for the page, it says the item has a hold for the patron with an item level hold
    5 - Check in the item, the hold triggered is for the next available patron, ignore the hold
    6 - Apply patch
    7 - Check details page, 'There is an item-level hold (priority=1)' with no patron info
    8 - Check in, next available hold is still the one triggered
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 67ef0d870963dbc62b87071c51fd1974f0f03eef
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jul 26 15:43:02 2019 +0200

    Bug 23383: fix IdRef syspref test in XSLT
    
    IdRef link is displayed via XSLT.
    There is a test of syspref with just if value is defined.
    But in installer/data/mysql/sysprefs.sql you see this pref will be 0 by default, which is true in XPATH.
    We should test that pref is 1.
    
    Test plan :
    1) Create a fresh UNIMARC database
    2) You have pref IdRef disabled
    3) Simulate a SUDOC record:
      Fill a 7..$3 field with a ppn (032581270 for example).
      Fill the 009 field with an integer
    4) Go to the opac detail page of the record => You don't see IdRef link
    5) Enable IdRef syspref
    6) Go to the opac detail page of the record => You see IdRef link
    7) Disable IdRef syspref
    8) Go to the opac detail page of the record => You don't see IdRef link
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 90480693552e305b383bf005c1fe4f2cef705228
Author: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
Date:   Wed Mar 11 00:54:03 2020 +0000

    Bug 24838: Fix help link for patron categories
    
    To test:
    - go to admin/categories.pl
    - click Help, confirm it takes you to manual main page
    - apply patch
    - restart all
    - click Help, confirm it takes you to patron categories in manual
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 63641856dd07880bc20e285e04387c162e22050c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Oct 25 13:49:05 2019 +0000

    Bug 23521: (follow-up) Add quotes
    
    Not only should terms from facets/limits be grouped, but order should probably matter
    We build a different facet for "Dillinger Girl" or "Girl Dillinger"
    
    The parens are possibly overkill now, but I think it makes it very clear and does not hurt
    
    To test:
    1 - Follow original plan
    2 - Create a new record with 'Girl Dillinger' as author
    3 - Search for 'Dill*'
    4 - You get all three records (and maybe others that match)
    5 - Limit by 'Girl Dillinger' - you get two records
    6 - Same for 'Dillinger Girl'
    7 - Apply patch
    8 - Limits/facets for 'Dillinger Girl' and 'Girl Dillinger' now match a isngle record
    
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c5e367c54ebaf7ddd9cd2f1df8aa1e7f4299980a
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Aug 29 15:06:14 2019 +0000

    Bug 23521: Put parentheses arround limit terms
    
    Test plan:
      - Use Elasticsearch 6 (you'll need Bug 18969),
      - create a biblio (#1) with "Dillinger Girl" in author and what you
        want in title,
      - create another biblio (#2) with the word "girl" in the title and
        "Dillinger Escaplan" as author
      - reindex
      - search * and refine on "Dillinger Girl"
      - Ko => Biblio #1 and #2 appear
      - Apply this patch,
      - search * and refine on "Dillinger Girl"
      - Ok => anly biblio #1 appears
      - use Elasticsearch 5 again
      - check for no search regression
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0c9b39a66dff00d2d76effc42824c2051484f9c5
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Feb 14 10:44:39 2020 +0100

    Bug 24662: Remove global variables MSG_* from datatables.inc
    
    Now that bug 21156 is pushed, we don't need to have global variables in
    .inc or .tt files for translation in .js file. We can simply declare our
    translatable strings where they are used.
    
    This patch removes all global variables used in DataTables configuration
    
    Test plan:
    1. cd misc/translator && ./translate update fr-FR
    2. Translate strings in misc/tranlator/po/fr-FR-messages-js.po
    3. cd misc/translator && ./translate install fr-FR
    4. Go to the staff interface, in english, and check that DataTables
    tables are still working. You should check at least the following pages:
        - catalogue/detail.pl
        - circ/circulation.pl
        - tools/quotes.pl
        - tools/letter.pl
    5. Switch to french and check again DataTables tables, and verify that
       strings are translated
    
    This patch depends on bug 24661
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d28bf2de71edb2d895840619d0b70aadff43290a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 5 14:32:23 2020 +0000

    Bug 24812: (bug 24081 follow-up) Add permission description
    
    Bug 24081 added a discount permission to the accounts system but during
    subsequent rebases, the description of that new permission got lot.
    
    This patch restores the description.
    
    Test plan
    0/ Check that a checkbox without a description appears in the 'Manage
    patrons patrons fines and fees' section of the 'Set permissions' page.
    1/ Apply the patch
    2/ Reload the page and note that the checkbox now preceeds a suitable
    description.
    3/ Signoff.
    
    Bonus points: Check the permission works as described and hides the
    'Discount' action button for staff who do not have the permission
    enabled.
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87f3e2d5e09ce4f0aeb20bb805732e1c050b9629
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Mon Feb 3 11:14:50 2020 +0000

    Bug 24565: Add patron profile to ILL list pages
    
    We need the API call to get ILL requests on the patron profile page,
    this commit allows this.
    
    Test plan:
    - Do not apply the patch.
    - Go to the "Ill requests history" page for a patron who has made ILL
      requests
    - TEST: Observe that no requests are displayed
    - Apply the patch
    - Refresh the page
    - TEST: Observe that requests are displayed
    - Go to the main "ILL requests" page
    - TEST: Observe that requests are displayed
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 818ce7ac998b50b1e0d094082b75de1fd1c4f0de
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 11 11:27:38 2020 +0000

    Bug 24839: (QA follow-up) Remove unused variables
    
    Whilst QAing I spotted a couple of unused variables in the test.. no
    harm in removing them ;)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 218012812d2c95f7e5013a4bb0a2684a4eec7378
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Mar 10 09:37:56 2020 -0400

    Bug 24839: Return hold info to transfer script and set borrowernumber
    
    To test:
    1 - Place a hold on an item
    2 - Go to Circulation->Transfers
    3 - Attempt to transfer item to a branch it is not expected at
    4 - No warning
    5 - Apply patches
    6 - Repeate
    7 - You get a notice that there is a hold and must deal with the hold (or ignore)
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2c3b0f4d57c73b1775780d48703cbb5af82e58d3
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Mar 10 09:59:16 2020 -0400

    Bug 24839: Unit tests
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52db77b93ead47914e049f1e32e102e6b0dab40b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 10 18:48:49 2020 +0000

    Bug 17845: (RM follow-up) Remove Printer DBIC Class
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6653a24148d8d061f2dce868ca19db48c6bf5a34
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 10 18:41:48 2020 +0000

    Bug 17845: (RM follow-up) Restore a removed test
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 03013acc2ed908a41415c3def0c72e888d4e5d00
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Mar 2 18:03:54 2020 +0300

    Bug 24777: Use patron.is_debarred instead of patron.debarred in return.tt
    
    In return page return.tt, when there is an hold message, patron is said as restricted even if restriction end date is in the past.
    
    Test plan :
    1) For a patron Jon Doe create a manual restriction with end date in the past
    2) Create an hold for this patron on an item
    3) Check in this item => You don't see message "Patron is RESTRICTED"
    4) For a patron Kevin Doe create a manual restriction with end date in the future
    5) Create an hold for this patron on an item
    6) Check in this item => You see message "Patron is RESTRICTED"
    7) Repeate 1-6 with system preference HoldsAutoFill enabled
    8) Repeate 1-6 with a waiting hold
    
    Signed-off-by: Nazlı Çetin <nazli@devinim.com.tr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6fc8d02995b7c5c085c913bde6af3fcd24536107
Author: Emmi Takkinen <emmi.takkinen@outlook.com>
Date:   Fri Jul 5 11:46:15 2019 +0300

    Bug 23268: Make "Suspend all holds" calendar select a date from tomorrow
    
    This patch removes "circulation" and moremember" templates functions
    for Datepicker plugin. They now use options common for all inputs with
    "datepicker" class and get "minDate" option from class "futuredate" assigned
    function in "calender.inc".
    
    To test:
    - Apply patch
    - Add holds for patron
    - Use "Suspend all holds" calendar
    =>Calendar greys out dates past from today
    
    Signed-off-by: David Roberts <david.roberts@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 32421f8de6e09453d78ec4ae511b7ffb888bff2f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 10 12:19:54 2020 +0100

    Bug 18127: Add missing html filters
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f0c031670e864858f0e4627e1a9151f954628bcc
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Feb 5 04:33:50 2020 +0000

    Bug 18127: Add batch modified records to an existing list
    
    To test:
    1) Start by having no (zero) lists
    2) Go to Tools -> Batch record modification
    3) Go through the batch record modification process, confirm everything
    works as normal and there is a link to do a new batch record
    modification at the end
    4) In another tab, go to Lists and create a new list
    5) Go back to the first tab and start a new batch modification process
    6) At the end of the process, there should be a new option to add
    modified records to an existing list
    7) Select a list from the dropdown and confirm you are able to save your
    modified records to the list as expected
    8) Start a new batch modification process, this time for authorities
    records
    9) At the end confirm there is no option to add modified records to a
    list, because authorities cannot be added to lists
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Jessica Zairo <jzairo@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aad473ff26ffb3e5bef6f3330c828a29690d8a2b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 10 15:19:34 2020 +0000

    Bug 17374: DBRev 19.12.040
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ef2fee688536a0db979ada68fa19d6c26972458d
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Jan 30 08:31:28 2020 +0100

    Bug 17374: (QA follow-up) Make search labels match with patron record
    
    Makes some small changes to the patronfields.inc to make sure the
    search labels match with the labels in the patron record.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6f39131b85fa7039c1d6f43e71e73073aae459fd
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Oct 30 14:07:02 2019 +0000

    Bug 17374: (follow-up) Unit tests
    
    Signed-off-by: Maxime Dufresne <maxime.dufresne@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e0749d4f0e8d35ece1499c5775f5277a5ae9e83
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Apr 24 19:03:26 2018 +0000

    Bug 17374: (follow-up) Remove spaces from include file
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit faf1e7cd914d1a6c88f5c7bef54780d43b6c453d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 27 14:21:02 2016 +0000

    Bug 17374: Make use of fields from syspref 'DefaultPatronSearchFields' in patron search fields dropdown
    
    This patch preserves the current dropdown choices for patron search and adds fields from
    the DefaultPatronSearchFields system preference
    
    To test:
    1 - View the regular patron search and note fields in dropdown
    2 - Apply patch, ensure dropdown has not changed
    3 - Add fields to DefaultPatronSearchFields, note they are available in
    dropdown
    4 - Ensure existing and new fields search properly
    
    Signed-off-by: Kelly <kelly@bywatersolutions.com>
    Signed-off-by: Maxime Dufresne <maxime.dufresne@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b17e1ae2ccde6f03037a311f5c398c46c21022f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 10 15:09:07 2020 +0000

    Bug 17845: DBRev 19.12.00.039
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8a7afe0ead1ff04196663199568ce4d100e4008f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 10 11:12:12 2020 +0100

    Bug 17845: Schema changes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b0a783a8a8428ad657b8b58a341474718c021203
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 10 10:56:08 2020 +0100

    Bug 17845: Remove the column if it exists
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 07b0c5bc0e06001137419e99b14c3f75c5b3d26d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 10 10:39:49 2020 +0100

    Bug 17845: Adjust few other occurrences
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9f362876f4fceffda51a09678828e4078c6454d0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 9 16:51:28 2020 +0000

    Bug 17845: Remove some missed references to branchprinter
    
    Remove a few last references to branchprinter, mostly from tests.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 708f297918c5d6642131641cb1030f3040653e29
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 9 16:44:57 2020 +0000

    Bug 17845: (QA follow-up) Remove hidden print input
    
    As highlighted by Jonathan, the hidden 'print' form field is no longer
    read and thus no longer required in the template.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit db473f8777235244929ec80133515130c55a1559
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 9 16:42:34 2020 +0000

    Bug 17845: (QA follow-up) Remove commented line
    
    A commented line still refered to the removed page from the
    admin-menu.inc
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7b7f83ae31c23f1bf7e0e1761d06c733d2817f9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 9 16:41:27 2020 +0000

    Bug 17845: Update atomic update for new format
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9b86077aaea9b12ba750a04f7054fd4c1ab180aa
Author: Katrin Fischer <katrin.fischer@bsz-bw.de>
Date:   Sun Sep 16 23:25:37 2018 +0200

    Bug 17845: Remove unused code related to printers
    
    There is some quite old and unused code in Koha related
    to printer configuration and network printing. These code
    hasn't been functional in a long time and should be removed.
    
    This patch:
    
    - Removes printcirculationslips system preference
    - Removes table printers
    - Removes branchprinter column from branches
    
    Check that:
    - Go to administration
    - Open any age there, but change the last bit to: printers.pl
    - Apply patch, run the database update
    - Verify the hidden page no longer exists
    - Verify that logging in and out still works correctly
    - Verify that checkout and returns work correctly
    - Switch to another branch using the "Set library" option
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f9efa7a99c3ea1a803b00e53ccb0b8e3020b0edb
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Wed Oct 30 12:34:45 2019 +0000

    Bug 23926: Limit GIR segment to 5 pieces of info
    
    Strictly if a GIR segment contains more than 5 pieces
    of information the it should be encoded in repeated
    segments each of 5 elements or less each sharing the same
    copy sequence number
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b6fb99c459a51e9da99d26361307b8c6e9600cf
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 10 11:39:44 2020 +0000

    Bug 23112: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 65f48c02bc1e2daf9f85a91d08003cc96dcbf98f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 10 11:38:48 2020 +0000

    Bug 23112: DBRev 19.12.00.038
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a29f56a90ee4960359a1583d0a5b665b2670ca6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Mar 6 11:35:05 2020 +0000

    Bug 23112: (QA follow-up) Clean up tests, catch warnings
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit db0b620c5f7d69f1830321d7f2c5885aa8ffff8f
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Fri Mar 6 09:33:16 2020 +0000

    Bug 23112: (follow-up) Unit test fixes
    
    As requested by Nick, fixes unit tests and added a test for the new
    Koha::Illrequest::biblio method
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b49656fa3196deb0e22e1d3a9a02bd002c196863
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Thu Mar 5 09:27:32 2020 +0000

    Bug 23112: (follow-up) Conditionally prevent checkout
    
    As mentioned by Nick in comment #69, the checkout button displays even
    for requests without a biblio attached (such as chapters). This patch
    fixes that.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3cd9d847f7316302e545e38d2579eaeac4f88dc8
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Mar 4 11:52:11 2020 +0000

    Bug 23112: (QA follow-up) Fix database update, add filters, remove tabs
    
    Looks like the atomicupdate and sysprefs.sql changes were lost at some point.
    
    Don't forget to run QA tools on your patches before submitting
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 00d375b26543ab4a55acf695705f886fa1de6cce
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Tue Jan 7 10:16:58 2020 +0000

    Bug 23112: (follow-up) Fix test as per feedback
    
    As per comment #48
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 39924b6769aa18de54a02196f8bb79bbc964f96a
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Mon Jan 6 12:04:53 2020 +0000

    Bug 23112: (follow-up) Address QA feedback
    
    As per comment #46
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3896eaa2bb64a667b920100d7516225cee242ad1
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Thu Oct 10 15:41:58 2019 +0100

    Bug 23112: (follow-up) Call C4::Koha::GetAuthorisedValues
    
    In response to the problem Magnus was experiencing in comment #28 & #29
    we now call GetAuthorisedValues by it's full path
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 934790769fa195f41d2ce45023d2746e2e62a71e
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Tue Jul 30 14:54:53 2019 +0100

    Bug 23112: Add unit tests
    
    This patch adds unit test for the new Koha::Illrequest::check_out method
    
    Sponsored-by: Loughborough University
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ae885b99f0f3fd1ec7cd6a38e200582b4db3c6d8
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Mon Jul 29 09:10:04 2019 +0100

    Bug 23112: Update request status on return
    
    This patch updates a request's status to RET upon return
    
    Sponsored-by: Loughborough University
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ccbfb6338ef4ae944365190f48344c4b20b33832
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Mon Jul 29 09:08:41 2019 +0100

    Bug 23112: Add permission checks
    
    We only want the ILL circulation functionality to be available if the
    appropriate syspref and perm are available, this patch adds those
    checks.
    
    Sponsored-by: Loughborough University
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 47895a1a23ce888e6f4035a144a7ed76787b55c8
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Thu Jul 25 13:46:12 2019 +0100

    Bug 23112: Add circulation to ILL requests
    
    This patch adds the ability to circulate ILL requests. Once a request has a suitable status, a "Check out" button is displayed on the "Manage request" toolbar. Clicking this will enable the user to check out the item either to the user who made the request or an in-house statistical  user. A due date can be specified, but if not circ rules are used.
    
    Prior to the check out, an item is created which is attached to the biblio record that was created when the request was added
    
    This development has been carried out according to the originally stated requirements of the customer that sponsored it, detailed here: https://wiki.koha-community.org/wiki/ILL_Circulation_RFC
    
    Test plan:
    
    1. Ensure the FreeForm ILL backend is available
    2. Enable the "CirculateILL" syspref
    3. Ensure you have a statistical patron category defined (patron category type "Statistical")
    4. Ensure you have at least one patron in your statistical patron category
    5. Create a new FreeForm request (make a note of the library you select when creating it)
    6. Mark the new request as confirmed by clicking the "Confirm request" button on the "Manage ILL request" page
    7. TEST: Observe that a "Check out" button is now displayed in the request toolbar
    8. Click the "Check out" button in the "Manage ILL request" page
    9. In the "Issue requested item to..." screen:
      a. Do not select a statistical patron at this time
      b. You can at this point choose an item type, this will determine the type of the item that will be created for this request
      c. TEST: Observe that the default selected "Library" matches that that was defined when creating the request
      d. Do not select a due date at this time
    10. Click "Submit"
    11. TEST: Observe that the "Item checked out" screen displays, issued to the requesting patron with a due date corresponding to appropriate circ rules
    12. Click "Return to request"
    13. TEST: Observe that the request's status is now "Checked out"
    14. Click the "Bibliographic record ID" link
    15. TEST: Observe that the bibliographic record now has one item attached to it which is checked out
    16. TEST: Observe that the item barcode is "ILL-" + the ILL request ID
    17. Return to step 5., however, this time select a statistical patron and test that the item use is recorded and the item is not issued
    18. Return to step 5., however, this time manually select a due date and test that the item's due date is set correctly on check out
    19. Check in the item
    20. TEST: Observe that the request's status is updated to "Returned to library"
    21. Now implement a restriction on the patron (perhaps a fine) which would prevent them from checking out an item
    22. Return to step 5. follow the instructions to step 10.
    23. TEST: Observe that a banner is displayed at the top of the screen informing you that there was a problem checking the item out, containing a link to the patron's account page
    24. Resolve the problem with the patron's account
    25. Return to step 8.
    26. TEST: Observe that the item is now successfully checked out
    27. Disable the "CirculateILL" syspref
    28. Return to step 5. at step 7. Observe that the "Check out" button is NOT displayed
    
    Sponsored-by: Loughborough University
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04b473261ac1517062668b8268234beb191cd14a
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Fri Jul 26 10:42:32 2019 +0100

    Bug 23112: Add CirculateILL syspref
    
    Sponsored-by: Loughborough University
    Signed-off-by: Chris Walton <C.J.Walton@lboro.ac.uk>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7b25bb76444afb06d3459423ca65314e2145c8a9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 9 16:14:58 2020 +0100

    Bug 24583: adjust xt/sample_notices.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c7f72e4ed0f61053d3344d11ab844cd901697fc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 9 16:09:50 2020 +0100

    Bug 24594: Fix license statements
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 61a2c4db6adfa18ccd3b403cf7ccb12a0df9efd7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 9 15:59:41 2020 +0100

    Bug 24545: Cannot return outside of sub
    
    We must die instead
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 83da3af9dad6591516cf2bd297e7353952596435
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 11:53:04 2020 -0300

    Bug 24594: Rewrite marc21_framework_DEFAULT to YAML
    
    YAML version of marc21 mandatory marc21_framework_DEFAULT.
    
    To test:
    1) Do a clean install with mandatory data,
       dump table marc_tag_structure and
       marc_subfield_structure, reserve.
    
    2) Apply this patch and it's dependencies
    
    3) Do a clean install, dump again and compare
       No major differences expected
    
    4) Try translation
      a) Go to misc/translator
      b) create files for a new language
         ./translate create xx-YY
      c) Check new file po/xx-YY-instaler-MARC21.po
         Verify strings from this file.
      d) Install new language
         ./translate install xx-YY
      e) Try clean install with new files
    
    NOTE: This patch fails with qa tools!
    Reason is that qa tools use YAML.pm module to
    check files, but Installer.pm or LangInstaller.pm
    are using YAML::Syck, using that module gives
    no error, check for example:
    
    perl -e 'use YAML::Syck qw( LoadFile ); $y = LoadFile("marc21_framework_DEFAULT.yml");'
    No error!
    
    perl -e 'use YAML qw( LoadFile ); $y = LoadFile("marc21_framework_DEFAULT.yml");'
    Error!
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5ead9529da75ca5fdd26e7411c5b3ee3487d0e1c
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 11:55:45 2020 -0300

    Bug 24594: Rewrite authorities_normal_marc21 to YAML
    
    YAML version of marc21 mandatory authorities_normal_marc21.
    
    To test:
    1) Do a clean install with mandatory data,
       dump table auth_types, auth_tag_structure and
       auth_subfield_structure, reserve.
    
    2) Apply this patch and it's dependencies
    
    3) Do a clean install, dump again and compare
       No major differences expected
    
    4) Try translation
      a) Go to misc/translator
      b) create files for a new language
         ./translate create xx-YY
      c) Check new file po/xx-YY-instaler-MARC21.po
         Verify strings from this file.
      d) Install new language
         ./translate install xx-YY
      e) Try clean install with new files
    
    NOTE: This patch fails with qa tools!
    Reason is that qa tools use YAML.pm module to
    check files, but Installer.pm or LangInstaller.pm
    are using YAML::Syck, using that module gives
    no error, check for example:
    
    perl -e 'use YAML::Syck qw( LoadFile ); $y = LoadFile("authorities_normal_marc21.yml");'
    No error!
    
    perl -e 'use YAML qw( LoadFile ); $y = LoadFile("authorities_normal_marc21.yml");'
    Error!
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d9b83c12c601ae43bcf67125e351c098b4fe1efa
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Mar 4 11:31:29 2020 -0300

    Bug 24593: (follow-up) fix sql statements
    
    Original inserted values depends on the order of insertion.
    This patch rewrites the sql statements to make them order
    independent
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0f020eabbdb0d1cd358c396959049bc11631ebf2
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 11:12:27 2020 -0300

    Bug 24593: Rewrite marc21_simple_bib_frameworks to YAML
    
    YAML version of marc21_simple_bib_frameworks
    
    To test:
    1) Same test plan of first patch
    
    NOTE: Same problem as first patch with qa tools
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ff39a08302f48dd127cc835686f0eef01897dc47
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 11:08:37 2020 -0300

    Bug 24593: Rewrite marc21_sample_fastadd_framework to YAML
    
    YAML version of marc21_sample_fastadd_framework
    
    To test:
    1) Same test plan of first patch
    
    NOTE: Same problem as first patch with qa tools
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2c8f894b96dd2e340d3aa8562ba9914ccbfb1d4f
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 10:11:16 2020 -0300

    Bug 24593: Rewrite marc21_default_matching_rules to YAML
    
    YAML version of marc21 optional marc21_default_matching_rules.
    
    To test:
    1) Do a clean install with optional data,
       dump table marc_matchers, reserve.
    
    2) Apply this patch and it's dependencies
    
    3) Do a clean install, dump again and compare
       No major differences expected
    
    4) Try translation
      a) Go to misc/translator
      b) create files for a new language
         ./translate create xx-YY
      c) Check new file po/xx-YY-instaler-MARC21.po
         Verify strings from this file.
      d) Install new language
         ./translate install xx-YY
      e) Try clean install with new files
    
    NOTE: This patch fails with qa tools!
    Reason is that qa tools use YAML.pm module to
    check files, but Installer.pm or LangInstaller.pm
    are using YAML::Syck, using that module gives
    no error, check for example:
    
    perl -e 'use YAML::Syck qw( LoadFile ); $y = LoadFile("marc21_default_matching_rules.yml");'
    No error!
    
    perl -e 'use YAML qw( LoadFile ); $y = LoadFile("marc21_default_matching_rules.yml");'
    Error!
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95884c204c5bfd8f97bf0580dbf40a3e12d15f8b
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 09:53:12 2020 -0300

    Bug 24584: Rewrite optional/sample_z3950_servers to YAML
    
    YAML version of optional sample_z3950_servers
    
    To test:
    1) Same test plan of first patch, only check table
       z3950servers
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 29411e38ee4c9122d8d9dffab1e13bcecc62f66c
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 09:51:16 2020 -0300

    Bug 24584: Rewrite optional/sample_quotes to YAML
    
    YAML version of optional sample_quotes
    
    To test:
    1) Same test plan of first patch, only check table
       quotes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 08b65033d0617327645bd4ddc902eed851ff0f8e
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 09:49:14 2020 -0300

    Bug 24584: Rewrite optional/sample_patrons to YAML
    
    YAML version of optional sample_patrons
    
    To test:
    1) Same test plan of first patch, only check table
       borrowers
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e3ed060fb02528032787b56d5637f336be6bac0f
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 09:46:28 2020 -0300

    Bug 24584: Rewrite optional/sample_news to YAML
    
    YAML version of optional sample_news
    
    To test:
    1) Same test plan of first patch, only check table
       opac_news
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 89ced6c9a01a5751446af3ab7cb32b64a51a07f8
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 09:44:28 2020 -0300

    Bug 24584: Rewrite optional/sample_libraries_holidays to YAML
    
    YAML version of optional sample_libraries_holidays
    
    To test:
    1) Same test plan of first patch, only check table
       repeatable_holidays
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c5ac1d23f2720b975ab8bce0c798f5642d7747c3
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 09:42:17 2020 -0300

    Bug 24584: Rewrite optional/sample_libraries to YAML
    
    YAML version of optional sample_libraries
    
    To test:
    1) Same test plan of first patch, only check table
       branches
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e49f3ce3ab59b8e28697cdce3d7bc9eb204185d7
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 09:39:52 2020 -0300

    Bug 24584: Rewrite optional/sample_itemtypes to YAML
    
    YAML version of optional sample_itemtypes
    
    To test:
    1) Same test plan of first patch, only check table
       itemtypes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77964c9e123a7f7ffb9acc151010ec7ff12e7308
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 09:35:53 2020 -0300

    Bug 24584: Rewrite optional/sample_creator_data to YAML
    
    YAML version of optional sample_creator_data
    
    To test:
    1) Same test plan of first patch, only check tables
       creator_layouts, creator_templates and printers_profile
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6f90d1f3bd3b73f28c21a510c90a75e69c24b389
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Wed Feb 5 09:32:10 2020 -0300

    Bug 24584: Rewrite optional/patron_categories to YAML
    
    YAML version of optional patron_categories
    
    To test:
    1) Same test plan of first patch, only check table
       categories
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a57754825f4a2d3d1ade770ef2d40c7e7ef5ffd5
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Feb 4 21:27:01 2020 -0300

    Bug 24584: Rewrite optional/patron_atributes to YAML
    
    YAML version of optional patron_atributes
    
    To test:
    1) Same test plan of first patch, only check table
       borrower_attribute_types
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3af76ad5c473c15e6aa8f7da0fbd6a891112da29
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Feb 4 21:01:27 2020 -0300

    Bug 24584: Rewrite optional/parameters to YAML
    
    YAML version of optional parameters
    
    To test:
    1) Same test plan of first patch, only check table
       currency
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1c1693ddccf92573510782fff19ca0fd9c6ada09
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Feb 4 21:17:00 2020 -0300

    Bug 24584: Rewrite optional/marc21_relatorterms to YAML
    
    YAML version of optional marc21_relatorterms
    
    To test:
    1) Same test plan of first patch, only check table
       authorised_values
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e848d36412f60e2553301f6d6c9032140744f627
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Feb 4 21:07:44 2020 -0300

    Bug 24584: Rewrite optional/marc21_holdings_coded_values to YAML
    
    YAML version of optional marc21_holdings_coded_values
    
    To test:
    1) Same test plan of first patch, only check table
       authorised_values
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77b0151c9d2f532421ee7c906b94d1c4fa26bd17
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Feb 4 20:56:30 2020 -0300

    Bug 24584: Rewrite optional/csv_profiles to YAML
    
    YAML version of optional csv_profiles.
    
    To test:
    1) Do a clean install with optional data,
       dump table export_format, reserve.
    
    2) Apply this patch and it's dependencies
    
    3) Do a clean install, dump again and compare
       No major differences expected
    
    4) Try translation
      a) Go to misc/translator
      b) create files for a new language
         ./translate create xx-YY
      c) Check new file po/xx-YY-instaler.po
         Verify strings from this file.
      d) Install new language
         ./translate install xx-YY
      e) Try clean install with new files
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8ad61cb07abd8a192abe29580cf368ab3cee9e44
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Thu Mar 5 10:21:55 2020 -0300

    Bug 24583: (follow-up) restore null values to labels
    
    This patch adds null values to selected label2/3 in
    sample numberpatterns
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e2fceec873300a4df70e332bf25ae32c22dc5253
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Feb 4 20:34:54 2020 -0300

    Bug 24583: Rewrite mandatory/sample_numberpatterns to YAML
    
    YAML version of mandatory sample_numberpatterns
    
    To test:
    1) Same test plan of first patch, only check table
       subscription_numberpatterns
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 01efbbf8c6cf6b42c2fbcff5eb704b2d63468d76
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Feb 4 20:07:43 2020 -0300

    Bug 24583: Rewrite mandatory/sample_notices to YAML
    
    YAML version of mandatory sample_notices
    
    To test:
    1) Same test plan of first patch, only check table
       letter
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 23b9c058ce36f559f646121a568b2d5c165aff88
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Feb 4 20:05:31 2020 -0300

    Bug 24583: Rewrite mandatory/sample_frequencies to YAML
    
    YAML version of mandatory sample_frequencies
    
    To test:
    1) Same test plan of first patch, only check table
       subscription_frequencies
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd287a7b7f64b0ce952fcb9b14fbe8cec130ad11
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Feb 4 19:58:09 2020 -0300

    Bug 24583: Rewrite mandatory/class_sources to YAML
    
    YAML version of mandatory class_sources
    
    To test:
    1) Same test plan of first patch, only check tables
       class_sort_rules, class_split_rules and class_sources
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c56e8b58d972bb2e77394e1b9b9da885290a2288
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Feb 4 19:45:07 2020 -0300

    Bug 24583: Rewrite mandatory/auth_values to YAML
    
    YAML version of mandatory auth_values.
    
    To test:
    1) Do a clean install, dump auth_values, reserve.
    
    2) Apply this patch and it's dependencies
    
    3) Do a clean install, dump again and compare
       No differences expected
    
    4) Try translation
      a) Go to misc/translator
      b) create files for a new language
         ./translate create xx-YY
      c) Check new file po/xx-YY-instaler.po
         Verify strings from this file.
      d) Install new language
         ./translate install xx-YY
      e) Try clean install with new files
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 31774a2ee8583f49bc204ce75e8a25030fcab0ac
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Thu Mar 5 10:23:53 2020 -0300

    Bug 24262: (follow-up) admit null values on labels
    
    This patch adds handling of null values on translatable
    labels.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 33c1ddf86b198677cca49e56b8b566288e01ec1f
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Fri Dec 20 10:53:11 2019 -0300

    Bug 24262: Translate installer data in YAML format
    
    This patch adds the ability to:
    1) Create new translation files from yaml installer files
    2) Create installer directory for a given language
    
    It will not create a installer directory if it already exists.
    
    New (possible) translation files:
      xx-YY-installer.po
      xx-YY-installer-MARC21.po
      xx-YY-installer-UNIMARC.po
    
    Needs Bug 13897 (for yaml files)
    
    NOTE: updated version adding ability to process multiline
    fields, discard small ( < 2) strings, and discard strings
    with pure html, TT or punctuation.
    
    To test:
    1) Apply patches from Bug 13897
    2) Apply this patch
    3) Go to misc/translation
    4) Create translation files for a NEW language
       $ ./translate create xx-YY
    
       check new file 'xx-YY-installer.po'
    
    5) Copy ../../installer/data/mysql/en/optional/auth_val.yml
       into ../../installer/data/mysql/en/marcflavour/marc21/mandatory/
       and ../../installer/data/mysql/en/marcflavour/unimarc/mandatory/
    
       remove po/xx-YY*, then repeat creation
    
       check new files 'xx-YY-installer.po', 'xx-YY-installer-MARC21.po'
       and 'xx-YY-installer-UNIMARC.po'
    
       remove all new files
    
    6) Create for xx-YY again and try update
       $ ./translate create xx-YY
       edit ../../installer/data/mysql/en/optional/auth_val.yml
       and change one char in one of the translatable values,
       also edit 'xx-YY-installer.po', translate the same
       string (in msgstr).
    
       Do an update
       $ ./translate update xx-YY
    
       check in 'xx-YY-installer.po' a fuzzy value for the
       translated value and the preservation of the translation
       Fix the translation, or add a new one.
    
    7) Create an install dir for xx-YY
       ./translate install xx-YY
    
        Check new dir '../../installer/data/mysql/xx-YY/'
        Check files on it
        $ tree ../../installer/data/mysql/xx-YY/
        and compare with ../../installer/data/mysql/en/
    
        All installation files must be present
    
    8) Try a new Koha install using this language in the
       usual way.
       Check in authorised_values table for the translated string.
    
    9) Try create an install dir for an existing language
       (eg. es-ES, de-DE or fr-FR ), eg.
       ./translate install de-DE
    
       Install dir is detected and not changed, a note is printed.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e925eb7a145bd6e206d6770ce7c73dbc32d1decd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 12 11:27:39 2020 +0100

    Bug 13897: Surround columns with backticks
    
    We have some column's names that need to be surrounded by ` as they are
    protected keywords ('rows' for instance)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 131183b0bfcb909be44fc64a0e78b30f97135f9b
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Thu Jan 30 11:30:30 2020 -0300

    Bug 13897: Process description, multiline values and SQL statements in YAML files
    
    This patch adds 3 features:
    1) Display description of YAML files at install time
       for frameworks, and fixes it's encoding.
    2) Enable use of multiline values, field required
    3) Process SQL statements declared in YAML files
    
    With this features we can process files with the
    following generic YAML strucure:
    
      ---
      description:
        - "File description"
    
      tables:
        - table_name:
            translatable: [ title, content ]
            multiline: [ content ]
            rows:
              - title: "Example title"
                content:
                  - "Content:"
                  - ""
                  - "This is the content."
                id: 1
                value: ~
    
      sql_statements:
        - "UPDATE table_name SET value ='empty' WHERE value IS NULL"
      ...
    
    * file description is now inside the YAML, can have multiple
      lines.
      This attribute is expected in all YAML files.
    * translatable attribute in table declare fields that can be
      translated
    * multiline attribute in table declare fields that can have
      multiple lines of content, they are joined using '\r\n'
      before insert into database.
      This is useful to express fields like 'news' content, and
      to simplify it's translation.
      '\r\n' is used for correct display in Windows clients.
    * sql_statements allows to add multiple SQL sentences, not
      insertions normally, that are executed in order.
    
    This features are not needed for the example file of this patch,
    but will be used in new bugs.
    
    To test:
    1) Use the same test plan of first patch.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc861f1ed93b44b5d0068f247894a77da0931c75
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 09:27:59 2019 +0100

    Bug 13897: Catch the error and warn it
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3edee6db6fa7f5e3c673dfa890e032f90ff234ed
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Thu Nov 28 19:06:35 2019 -0300

    Bug 13897: Use YAML files for installer data
    
    This patch modifies C4/Installer.pm to add support
    for loading YAML files into database.
    
    As an example of the functionality, optional
    auth_val.sql file is replaced by auth_val.yml
    
    The rationale behind this feature is to enable the
    translation of the data that is loaded into the
    database. That will be addressed in another bug.
    
    But taking into account that goal, translatable
    values are declared in the YAML files, to ease
    identification by translate script.
    
    Also file description is moved into the yaml
    file.
    
    To test:
    0) Do a clean install with all optional data,
       then dump authorised_values table, reserve.
    1) Apply the patch
    2) Do a clean install in English (marc21/unimarc)
    3) On optional data check for description of auth_val
       "Some basic default authorised values for ..."
    4) Select all optional data
    5) Finish installation
    6) Dump again authorised_values table and compare with that
       of point '0'.
       No differences should be found.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0706922221dcdf9fa8ed7fcf86245c5622f33a3c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 6 14:47:00 2020 +0000

    Bug 24817: Replace sleep calls with date setting in test data
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 79f2230c5dbb867f56f278883c8d527c9944c236
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 6 08:25:39 2020 +0000

    Bug 24817: Add sleep between db create actions
    
    We need to allow some time to pass between calls that add cash register
    lines to accountlines or cash_register_actions. We use database level
    triggers to maintain the timestamp fields, so cannot use Time::Fake, and
    the methods we are testing assume that, as human interactions, there
    will be at least a second between the last 'sale' on a cash register and
    the 'cashup' of that same cash register.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b952563a3bdb8581a066bcff51b274d1ce614f5f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Nov 19 14:03:37 2019 +0000

    Bug 24066: Add missing POD for has_permission
    
    To test:
    1) do perldoc Koha/Patron.pm
       search has_permission
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Fixed (removed) space before 'my $permission' to make it similar to
    other entries.
    No errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f1c93e88d4d56bcef05929de70fc86115cbdc463
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 17 10:45:11 2019 +0100

    Bug 24219: Preserve sort order when returning to result list
    
    There is a mismatch between sort_cgi, sort and sort_by variables.
    
     * sort_cgi
    I did not find relevant occurrences of sort_cgi in the git log of both
    search.pl and results.tt. So it seems that it never worked correctly.
     * sort
    It is the JS variable use in browser.js
     * sort_by is the search.pl parameter to set the sort_by option
    
    Test plan:
    1. Perform a search in the staff client
    2. Change the sort order to something different (try Author A-Z)
    3. Click on a result to view the record
    4. Click on "Results" button on left side to return to result list
    => Without this patch the result list is sorted by relevancy
    => With this patch applied the Author A-Z is kept
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c2a74a63861543d95c83b2f63a9dc2aeaafd965
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 18 16:13:11 2020 +0100

    Bug 23384: Fix use statement order for ArticleRequest::Status
    
    Koha::ArticleRequest is used by Koha::ArticleRequests so
    Koha::ArticleRequest::Status should not be needed in
    Koha::ArticleRequest.
    Also Koha::ArticleRequest::Status must be loaded before
    Koha::ArticleRequest
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit deb77ffe3d3d76c0863f287f1a6f3697c9fa6949
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Mar 6 11:13:15 2020 +0000

    Bug 24760: (follow-up) Add a neighboring test messsage
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a7de3ebf8b9e834bb00c2fe07464657f2e1d1b9b
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Feb 28 14:22:34 2020 +0100

    Bug 24760: Use C4::BackgroundJob->fetch in tests
    
    Starting with YAML 1.30 and YAML::Syck 1.32, these modules don't bless
    loaded objects by default. This is not a problem as
    C4::BackgroundJob->fetch bless them anyway.
    
    So, instead of testing what's in the session, test the result of
    C4::BackgroundJob->fetch, which is what's used everywhere else
    
    Test plan:
    1. Install latest version of YAML::Syck (or YAML if YAML::Syck is not
    installed)
    2. prove t/db_dependent/BackgroundJob.t => should FAIL
    3. Apply patch
    4. prove t/db_dependent/BackgroundJob.t => should PASS
    5. Verify that background jobs are still working (for instance,
    tools/batchMod.pl)
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7da21c6a10f944a21c96d0ce9a9d4494a4ae1560
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Tue Mar 3 14:32:31 2020 +0100

    Bug 24788: Remove autoloaded column accessors in Koha::Object->store
    
    Columns are accessed as methods, relying on AUTOLOAD, in
    Koha::Object->store. This could be a source of strange bugs
    if a column name clashes with an existing method name.
    
    To test:
    
    1) Apply patches for Bug 14957
    2) Follow the testing instructions, when saving a new marc rule and
    error is thrown.
    3) Apply patch
    4) Try saving a new rule once again, this should now work
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 348a04e00f57e15dc3f1ef320c673961b47ca936
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 6 13:13:37 2020 +0000

    Bug 23051: (RM follow-up) Fix rebase error
    
    Looks like at some point during reworking/rebasing the signature for
    Koha::Account::Line->apply changed and was then reverted but one case of
    the reversion got lost.
    
    The error was highlighted in the patrons_accounts credit api tests.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a8964a2dc4dd28844ef5def509427a8b259b4980
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 6 10:08:55 2020 +0000

    Bug 23051: DBRev 19.12.00.037
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d2a5ef86528679bb5ad8c10cf526c203cddd9c9
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Thu Mar 5 10:26:38 2020 +0000

    Bug 23051: (follow-up) Remove call to GetFines
    
    As mentioned by Nick in comment #69 and subsequently discussed on Slack,
    the call to GetFines in renew_item was unnececcesary. It has now been
    removed.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cc8f2cb50d39bf66a0480b57597a4d081145c3a8
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Wed Mar 4 15:11:23 2020 +0000

    Bug 23051: (follow-up) Fix renew summary display
    
    As mentioned in comment #69:
    
    >staff client does unless I click 'pay' next to the individual fine
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2ba1493e2e8b48a4ca277ed2cea3f31d54c9e45d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Mar 4 13:25:48 2020 +0000

    Bug 23051: (QA follow-up) Missing curly and tabs and fix test
    
    Some rebase issues, accounttype no longer exists, circ rules make
    CanBookBeRenewed fail, so we mock that too
    
    interface must be passed as a hashref
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a2449a81be55aa5b3710ca2c6df7884513f89540
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Wed Oct 9 15:13:54 2019 +0100

    Bug 23051: (follow-up) Add renewal feedback and move code to subroutines and test
    
    Rebasing was a nightmare, so I'm squashing the sign off follow-ups to
    ease the pain with any future rebases
    
    Includes:
    
    Bug 23051: (follow-up) Refactor renewal code
    As per Nick's first point in comment #20, the code that tests for
    renewability and renews items has been refactored into it's own
    function.
    
    Bug 23051: (follow-up) Provide feedback
    For renewals that fail when a fine is being paid off, this patch causes
    any errors to be passed back to the template for display.
    Addresses the second point in Nick's comment #20
    
    Bug 23051: (follow-up) Fix unit tests
    As raised by Nick in comment #35
    
    Bug 23051: (follow-up) Fix/improve feedback
    This follow up patch addresses the following parts of Nick's feedback in
    comment #35:
    - it would be nice to get feedback on what was successfully renewed as well
    - In general I think I would prefer to see 'ok' and 'not_ok' returned as
    a single 'renewal_results' array
    - There is no listing of errors if I use the 'pay' button on an
    individual fine
    
    Bug 23051: (follow-up) Refactor methods
    This follow up patch addresses the following parts of Nick's feedback in
    comment #35:
    - I don't really like that the functions are internal functions and then
    exported
    - I think the pref description should highlight that if 'RenewalPeriodBase'
    is set to due date, there may be doubled charges
    
    Bug 23051: (follow-up) Add SIP summary
    This follow up patch addresses the following parts of Nick's feedback in
    comment #35:
    - Ideally SIP would get feedback in a screen message
    
    Bug 23051: (follow-up) Renewing in OPAC
    This follow up patch addresses the following parts of Nick's feedback in
    comment #35:
    - I am also not sure about the code path if a patron paid fines on the
    opac (via paypal etc.) but renewals are not allowed on the opac.
    
    We've introduced the syspref RenewAccruingItemInOpac (default is off)
    which, when enabled, will cause items attached to fines that are paid
    off in the OPAC (via payment plugins), to be automatically renewed.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d26a10c1fedf55a7e85387e6555601e41db0e043
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Tue Jun 11 14:17:17 2019 +0100

    Bug 23051: Renew items when fines paid off
    
    When the RenewAccruingItemWhenPaid syspref is enabled and all the fines
    on an item that is accruing fines are paid, we automatically renew that
    item to prevent it from starting to accrue fines again.
    
    This patch adds an additional argument to C4::Circulation::AddRenewal
    which allows us to skip the calculation of fines upon renewal, which we
    don't want to do if the fines on that item have just been paid. Existing
    calls to AddRenewal have not been amended because there seems to be a
    convention of only passing undef when adding arguments that require
    their positioning to be maintained. Since the new argument is the last
    one, this is not the case with any existing call.
    
    Sponsored-by: Loughborough University
    
    Signed-off-by: Lucy Harrison <L.M.Harrison@lboro.ac.uk>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5f853ca1179ab4c69262d65370e0a6f51764dc47
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Wed Jun 12 15:18:54 2019 +0100

    Bug 23051: Add unit tests
    
    This patch adds unit tests for all modules affected by this bug
    
    Sponsored-by: Loughborough University
    
    Signed-off-by: Lucy Harrison <L.M.Harrison@lboro.ac.uk>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d30f378b2e55072af680681930bb3cd1a79fb44
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Wed Jun 5 14:38:07 2019 +0100

    Bug 23051: Add RenewAccruingItemWhenPaid syspref
    
    This patch adds the new syspref "RenewAccruingItemWhenPaid"
    
    Sponsored-by: Loughborough University
    
    Signed-off-by: Lucy Harrison <L.M.Harrison@lboro.ac.uk>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit be31436e858347a3ea1e4d3047368233fea6e0b5
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Tue Feb 4 08:01:06 2020 +0100

    Bug 24573: Add missing dependencies to cpanfile
    
    When using Elasticsearch, Catmandu::Store::ElasticSearch is required for
    search, and Catmandu::MARC is required for indexation
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d23692511c4203736f63aa56d66492d9fdfaeef
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 5 16:27:15 2020 +0100

    Bug 24813: Prevent api/v1/holds.t to fail randomly
    
    Hold cannot be suspended if found=W:
    Koha::Hold->suspend_hold
     90     if ( $self->is_found ) {    # We can't suspend found holds
    
    So when TestBuilder generate a hold with found=W the test fail.
    
    A question however:
    Why did not we have the correct exception displayed somewhere? That
    would be much more helpful to find the problem!
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3aa52a4bf6e1fe7d94504f1eca384d4a4836d4ee
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Feb 25 18:08:59 2020 +0000

    Bug 24713: JavaScript error on staff client catalog search results page
    
    This patch modifies the output of template toolkit variables so that
    values in the in-page JavaScript are quoted. This avoids JavaScript
    errors when the template variable is empty.
    
    To test, apply the patch and perform a catalog search in the staff
    client. Use the browser's developer tool to check for JavaScript errors
    in the console. There should be none.
    
    Test with AmazonCoverImages both on and off.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c2f1106f2e026fe6860e7e4df470540ce3e37405
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Mar 4 12:08:29 2020 -0500

    Bug 24802: Updating holds can cause suspensions to apply to wrong hold
    
    On request.pl, the table of holds shows a suspend_until date picker for each hold, *unless* that hold is waiting or in transit. The script reserve/modrequest.pl assumes that there will be a suspend_until input for each hold, but that is incorrect. Assume there are 20 holds on a record, and 10 of them are waiting or in transit. If you were to then set the suspend until date on the 10 open holds, and use the "Update hold(s)" button, those 10 suspensions would apply to the 10 found holds and not the holds they should apply to!
    
    Test Plan:
    1) Place two holds on a record
    2) Check in an item and trap it for the first hold
    3) Now that one hold is waiting and the other is not, attempt to set
       a suspension date using the "Update hold(s)" button
    4) Note your hold does not get suspended!
    5) Apply this patch
    6) Restart all the things!
    7) Repeat steps 1-3
    8) Your hold should now be suspended!
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2eebecfb621d0124b0b8be868c6d2a4fe959a9f7
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu May 23 07:55:15 2019 +0200

    Bug 22969: fix biblionumber on 001 in UNIMARC XSLT
    
    In UNIMARC default configuration the 001 is linked to biblio.biblionumber.
    In some XSLT files, 090$a is used.
    This is by default biblioitems.biblionumber so it usually works but it may not be the same and var biblionumber is used to create hyperlinks to record detail page.
    
    Test plan :
    1) Use UNIMARC database
    2) Set default in all XSLT system preferences
    3) At OPAC, perform a search and click on a result
    4) Check displayed page shows the correct biblio record
    5) Same at intranet
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Tested on clean UNIMARC install.
    Before insert new records: "alter table biblioitems AUTO_INCREMENT = 5"
    Added two records, with result:
    +--------------+------------------+
    | biblionumber | biblioitemnumber |
    +--------------+------------------+
    |            1 |                5 |
    |            2 |                6 |
    +--------------+------------------+
    Without patch, OPAC results shows for first record
      http://opac/cgi-bin/koha/opac-detail.pl?biblionumber=5, Wrong!
    with patch result is correct
    
    Works, no errors
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c77e64de1ea64239e64e8479527f2b023adb5189
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Mar 4 18:29:24 2020 +0000

    Bug 24798: smart-rules.tt has erroneous comments
    
    This patch corrects a couple of invalid Template Toolkit comments in the
    Circulation and Fines rules template.
    
    To test, apply the patch and log into the staff client as an
    administrator.
    
    On the Circulation and Fines Rules page "View source" and look for
    instances of the text "[#% Default branch %#]" There should be none.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    [EDIT] There is a theoretical difference between [% # and [%#. The latter
    marks the whole directive as a comment and not just until EOL.
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2cc6c709c1d106800cee6bfe257a88a741d3f319
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Mar 4 19:47:26 2020 +0000

    Bug 24803: Remove JS error when clicking "Log in to your account"
    
    This patch removes the "data-toggle" attribute from the login link in
    order to avoid a JavaScript error. Since we have a custom click handler
    to trigger the modal we don't need Bootstrap's "automatic" modal
    handling.
    
    Test plan:
    1. Apply patch
    2. Open F12 dev tools
    3. Click "Log in to your account" on OPAC
    4. Observe no Javascript errors in console
    
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0fcbec7507a4117a7389d8bcebffed57db3a477c
Author: David Cook <dcook@prosentient.com.au>
Date:   Thu Feb 27 00:28:48 2020 +0000

    Bug 24719: Remove use of CGI object in C4::Context::set_remote_address()
    
    This patch replaces the CGI "http" object method with its equivalent
    class method, which doesn't require object instantiation and thus skips
    global initialization and premature handling of the incoming HTTP request.
    
    Test plan:
    0. Disable Plack if it is enabled
    1. Set koha_trusted_proxies in koha-conf.xml to 1.1.1.1
    2. Clear Memcached
    3. Try to upload MARCXML file to /cgi-bin/koha/tools/stage-marc-import.pl
    4. Note that form below "Upload progress" never appears and errors show
    in browser console
    5. Apply the patch
    6. Try to upload MARCXML file to /cgi-bin/koha/tools/stage-marc-import.pl
    7. Note that form appears below "Upload progress"
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b003f4b73a4e1ff8c21e2e6ac6f75b3abe3ba04
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 5 14:16:33 2020 +0000

    Bug 24492: (RM follow-up) Redirect to correct page after cashup
    
    Cashup of a single register was resulting in a redirect to the register
    details page. It should return to the branch details page instead.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8f7a3bf5eaec24a5de642ba2fe95c0bf7d663af9
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Mar 4 19:02:53 2020 +0000

    Bug 24492: Update GPL license
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2ff054962ed308107b406b454f1c40802ff340e3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 9 13:53:09 2020 +0000

    Bug 24492: Add branch details page
    
    This patch adds a new 'branch details' page to the POS system which
    displays a summary of the cash register transactions for a branch
    since each register was last cashed up. It also allows for cashing
    up individual registers or cashing up all registers at a given branch
    in one transaction.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 764053f2f40c3f2d0d54bc4a726764f296fd3a35
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Jan 22 14:24:15 2020 +0000

    Bug 22615: Fix perlcritic
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 81655e7dbf6d769219260828b6f4781435efca1c
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Jan 22 14:21:33 2020 +0000

    Bug 22615: Add endpoint for getting one ill backend
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit def667f7fc1b64171bec937861e34c5a94ead0d7
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Mon Apr 1 15:08:26 2019 +0000

    Bug 22615: Add /ill_backends endpoint
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 29bca18047f1d08e6408fbf21e5806cbedcae81c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 5 13:01:22 2020 +0000

    Bug 24369: DBRev 19.12.00.036
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1af4010ff7344b12c193c9beb8a33f05125e7bf7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 9 11:13:47 2020 -0300

    Bug 24369: Add CORS support to the API
    
    This patch adds CORS support for API requests. It uses the
    AccessControlAllowOrigin syspref. To test:
    
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/auth.t
    => SUCCESS: Tests pass!
    3. Set the AccessControlAllowOrigin to any string (for example, *)
    4. Use any API testing tool (Postman?) to place a request on the API
    => SUCCESS: The response headers include Access-Control-Allow-Origin,
        containing what you set on the syspref
    5. Sign off :-D
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c951f8e06a8db91308b85f2610ee9a8c4d89297a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 9 10:44:09 2020 -0300

    Bug 24369: Add CORS support to output_with_http_headers()
    
    This patch adds CORS support to output_with_headers(). It will use the
    AccessControlAllowOrigin syspref to pick the value and set the Access-Control-Allow-Origin header.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/Output.t
    SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2526bc3c9f886cd0b31878bd329097b2229faa8f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 9 10:42:43 2020 -0300

    Bug 24369: Add AccessControlAllowOrigin syspref
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 33f122621adcf94ecdbf28dad9a1017d6f9d5c79
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Jan 31 11:13:47 2020 +0100

    Bug 24552: Be compatible with Search::Elasticsearch 6.00
    
    There is no need to specify the `client` param here because
    '5_0::Direct' is the default value for Search::Elasticsearch 5.x and it
    breaks when Search::Elasticsearch 6.x is installed
    
    Test plan:
    1. Apply the patch
    2. Make sure you have Search::Elasticsearch 5.x
    3. Reload starman
    4. Verify that search works
    5. Install Search::Elasticsearch 6.x
    6. Reload starman
    7. Verify that search works
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 98c53cd06490ca0ae2cf1c96601ed35365e5b42a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 5 08:51:51 2020 +0000

    Bug 23354: (RM follow-up) Correction for cash register selection
    
    The form element for selectin cash register override at point of sale was
    misnamed and as such one could not actually override the cash register.
    
    This patch corrects the form element name and updates the logic very
    slighlty to ensure we still fall back to the defualt no the subsequent
    page load.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d8c5f7311820ff87e29be52d2290c5686454b94
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Mar 5 08:51:51 2020 +0000

    Bug 23354: (RM follow-up) Correction for cash register selection
    
    The form element for selectin cash register override at point of sale was
    misnamed and as such one could not actually override the cash register.
    
    This patch corrects the form element name and updates the logic very
    slighlty to ensure we still fall back to the defualt no the subsequent
    page load.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 69af9e18cd59afa273f0b36444ea759c11558a1d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Mar 3 11:39:38 2020 -0300

    Bug 24790: Add POS to the 'More' dropdown on the staff client
    
    This trivial patch adds 'Point of sale' to the dropdown.
    
    To test:
    1. Notice there is no 'Point of sale' entry in the staff dropdown
    => FAIL: No dropdown
    2. Apply this patch and reload
    => SUCCESS: Point of sale displays and works
    3. Play with enabling/disabling the feature and removing permissions
    => SUCCESS: The entry in the dropdown respects the configured
    permissions and settings.
    4. Sign off :-D
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95b1b6662deabfe6062e79b7d318f96da448d506
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 4 16:05:28 2020 +0000

    Bug 24082: DBRev 19.12.00.035
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 15655f0dbcea2fbada164745fe12037529f9f846
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Mar 3 16:10:17 2020 -0300

    Bug 24082: (QA follow-up): Template fixes
    
    This patch introduces missing TT filters and also replaces tabs for
    spaces to fix indentation problems.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 342f45b5dc802af4c4528bbf60b2a4e1611bb52a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 16:05:06 2020 +0000

    Bug 24082: Add access to historical transactions
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d16710382e21d06bb4a11f616b4f6655a17d2499
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 16:03:06 2020 +0000

    Bug 24082: Add refund action to relevant lines
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d4d1ffb91c6019fd7aec570ec9ac4193c21cab26
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 15:52:25 2020 +0000

    Bug 24082: Add `anonymous_refund` permission to `cash_management`
    
    This patch adds the new `anonymous_refund` permission to the
    `cash_management` flag and binds it to the visability of the register
    details page.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0359a04bf8086c2f17045c5c60d7b195ed77ec2b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 6 11:02:03 2019 -0500

    Bug 22529: Use new C4::Auth::haspermission from svc/members/search
    
    The svc/members/search script can be used to retrieve patrons with a
    specific permission. This feature is only used once, to link patrons to
    funds.
    The code in the script is duplicated from what we have in
    C4::Auth::haspermission, and it makes sense to clean it.
    
    Test plan:
    Create a fund and add users to this fund.
    When you search for users you must only have a list of patrons with the
    acquisition.order_manage permission.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Works as described. No errors
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c16476af444bc529dbc6500978c63969de4d2b9c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 4 15:53:12 2020 +0100

    Bug 24801: Display all the categories - Selenium fix
    
    To make sure we are going to be able to click on the "Delete" button of
    our newly created category PATRON_CAT, we are displaying them all.
    
    Test plan:
    Create several patron categories that will fill the first page:
    
    use t::lib::TestBuilder;
    my $builder = t::lib::TestBuilder->new;
    for my $i ( 1..20 ) {
        $builder->build_object({ class => 'Koha::Patron::Categories', value => { description => "cat_$i" } });
    }
    
    Execute the selenium tests.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c0f3c9f29ad3b5de3efea95da515ab64a4bbd268
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 2 11:59:27 2020 +0000

    Bug 24775: Add ID to POS submit payment button
    
    This patch simply adds an ID to the submit button to make it easier to
    overide styling and functionality.
    
    Test Plan:
    0/ Inspect the element on page and note there is no id
    1/ Apply patch
    2/ Refresh page
    3/ Inspect the element on page and note there is now an id
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c5c7f3efa22b755956be4d463a4c172f90ec723d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 2 11:32:42 2020 +0000

    Bug 24479: Use $Price filters for '0' amounts
    
    This patch adds the use of the $Price TT filter to properly format '0'
    amounts in the POS system.
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4237fa95121ce0dadf032efd9429c3946f4de56d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 4 14:49:27 2020 +0000

    Bug 24081: DBRev 19.12.00.034
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ce2744e0e3f6bf86ca8279f2de3770f343a3bae6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Mar 4 09:49:46 2020 -0300

    Bug 24081: (QA follow-up) Fix small typo
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87ff9883937527660541fdaabb3a382e89be3386
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 3 19:22:49 2020 +0000

    Bug 24081: Add discount action to boraccount
    
    This patch adds the ability to apply discounts to existing patron
    charges from the boraccount page.
    
    Test plan
    1/ Carry out some accounting actions that end up with debts on the
    patron record. (Add a manual invoice for example)
    2/ Note a new 'Apply discount' action button on the unpaid debt
    3/ Paid debts do not display the action button
    4/ Click the button
    5/ Enter an amount into the resulting modal and click confirm
    6/ Confirm that the outstanding debt has been reduced by the amount you
    specified.
    7/ Confirm that a new 'Discount' line appears on the patrons account
    8/ Confirm that in the 'details' view of the debt that the discount line
    was used against the debt to create the reduction.
    9/ Signoff
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a2fa0acb7daee624154c98be05ec85b613d64f42
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 9 14:14:34 2020 +0000

    Bug 24081: Add DISCOUNT to the allowed 'reduce' types
    
    This patch adds the DISCOUNT type to the handled types list in the
    reduce method introduced in bug 23442
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12381ead911a71bac9c38599b0b3670060a8b121
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 9 14:13:25 2020 +0000

    Bug 24081: Add credit_types, offset_types and permissions
    
    This patch adds the credit_type, offset_type and permissions required
    for the addition of a discounting workflow in the accounts system.
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7c6300c6570737415c55696408e34812bf417fdd
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 2 16:50:17 2020 +0000

    Bug 24540: Prevent add button being triggered on enter
    
    This patch prevents the add button being triggered by hitting return
    from inside the collected from patron form input.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b78de6cefd7daf16f8ec0e95cb3e5e155fd8ac7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 3 09:55:03 2020 +0100

    Bug 24741: (bug 21674 follow-up) Fix destructive update DB 19.12.00.017
    
    Previous version of the SQL query did not deal correctly with subgroup.
    
    Test plan:
    checkout the following commit to be just before 017
      commit 715da06db557edc4b1baa51cc278fdac362c01c4
      Bug 22868: DBRev 19.12.00.016
    reset_all # recreate the DB
    Create a complex tree of library groups, with several groups, subgroups,
    etc.
    When you add a new library, refresh the page to add it several time.
    When ready, git checkout master, restart all the things, execute the
    updatedatabase script, then go to the library groups page.
    You should see that the duplicated entries have been removed, but
    subgroups have not been deleted
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Tested with duplicated entries on groups and subgroups,
    going back to the right commit and doing clean install.
    Patch works, subgroups are preserved. No errors.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 027f72da7c7bea317e977ed7fba0a06d6840d14a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 4 09:04:15 2020 +0000

    Bug 23355: (RM follow-up) Tidy Template
    
    At Jonatans request, I have tidied the table markup
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2f98da053b5b7fd81ea0d7485f6dde6d55c6bd10
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 4 09:49:06 2020 +0100

    Bug 23355: Make "Print receipt" translatable
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f7630d746947b82b40098be4cbac266e4a494553
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 3 16:19:53 2020 +0000

    Bug 23355: (RM follow-up) Remove reintroduced relationship
    
    As part of an accidental push of a DO NOT PUSH schema update commit
    we re-introduced a formerly removed relationship accessor
    
    This patch removes that mistake.
    
    Tests added to the pre-push hook to prevent future mishaps.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bdefa101078c597ed7664937e2c8e1c8c3643836
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 3 16:09:28 2020 +0000

    Bug 23355: (RM follow-up) Add DROP statement for cash_register_actions
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ab0f1df0c1ec652f59a3978ec1414129b7251cf3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 3 15:01:48 2020 +0000

    Bug 23355: DBRev 19.12.00.033
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3252c8d2ddaf30c2bb7270dda5863a022abc3adb
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 3 14:09:40 2020 +0000

    Bug 23355: (QA follow-up) Add a modal confirm to the cashup action
    
    This patch adds a simple modal to confirm the cashup action adding a
    safely measure to it.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd44efbc847b7909cd2dbc9f57dc43e918ce0985
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Mar 3 10:50:44 2020 -0300

    Bug 23355: Rename staff_id for manager_id
    
    This patch makes the parameter naming more consistent and also fixes the
    tests (there was a missmatch on the parameter naming, and tests count
    was incorrect).
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d6684f13fc65f0e84c386d47196826de5c65fdda
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Mar 3 10:48:22 2020 -0300

    Bug 23355: (QA follow-up) Missing koha_object(s)_class definitions
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a1d89f8b889c0cc5f538c4edc2081a7739d848c7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Mar 3 10:03:33 2020 -0300

    Bug 23355: (QA follow-up) Add missing TT filters
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d3015f84e3ec15eb8b21f45e06b7c96183e0ed75
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Mar 3 10:03:01 2020 -0300

    Bug 23355: License fixes
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4d2037914c0481ef5fb5908a3cd3b59304b43ad2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 13 14:48:49 2019 +0100

    Bug 23355: Add cashup permissions
    
    Add new 'cashup' sub-permissions to the 'cash_management' permission to
    allow fine grained control over whome may 'cashup' a cash register.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fcb545b4aed7d46daec23cddde192bbeb2eb380f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 13:40:33 2020 +0000

    Bug 23355: Add register details page
    
    This patch adds a new page which can be accessed via the menu to the
    left of the point of sale page.  This new page displays a list of
    transactions since the last 'cashup' action, a summary of transaction
    amounts and a button to allow the recording of a new 'cashup action.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 16b3a163741227c21eaa842d7e2fdce0774f619d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 13:39:44 2020 +0000

    Bug 23355: Split tests for Line vs Lines
    
    This patch simply splits the existing tests for accountlines into two
    test files, one for the singular object and one for the set.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 39ebdb4ea226d9e78bf1a774495022e85ffb1fd6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 13 14:11:37 2019 +0100

    Bug 23355: Link cash_register_actions to cash_registers by foreign key
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8781527637451dbf02b58f5eb441e0fda6496774
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Aug 22 09:10:51 2019 +0100

    Bug 23355: Add accountline deletion test
    
    This patch adds a test to ensure database relations do not cascade
    deletions when a cash register is deleted.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 747531e8dec58acf37b739a0d8d8b04060a17111
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 13:37:46 2020 +0000

    Bug 23355: Add CASHUP actions
    
    This patch adds methods relating to cashup procedures to the cash
    register object to ease adding and querying for cashup actions related
    to the register.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5cf1e85191cda1ba5515011be18ba296d06df896
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 13:37:33 2020 +0000

    Bug 23355: [DO NOT PUSH] DBIC Classes
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 239ac3303c25ea25b41373ccba66b47968eefcd9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jul 23 14:05:18 2019 +0100

    Bug 23355: Add cash_register_actions table
    
    This patch adds the new cash_register_actions database table to allow
    for storing of cash register actions which are not already stored as
    accountlines.
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e2adf9f28cc59b578fc68549bca3f0f901265ab6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 3 15:58:40 2020 +0100

    Bug 23534: Fix selenium tests
    
    The title of the page now contains lot of info (is it what we really
    want?)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 292f56260592a124a28e98103b243696344bd5a0
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Mar 2 11:08:18 2020 +0000

    Bug 24756: Catch two failed to load-variations in Security.t
    
    Test 7 in Security.t failed when 'failed to load HTTP resource' was
    returned by libxml2 instead of 'failed to load external entity'.
    
    We now remove the debugging with Dumper again and adjust the regex to
    include both variations.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bd9960a2d209bbcf9a23d0a5b1ade4ccb77ec2ca
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 3 10:30:32 2020 +0000

    Bug 24757: (RM follow-up) Restore test count
    
    Somehow we lost a '0' on the test count for
    t/db_dependent/Koha/Patrons.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3c9cc044ce9c2e8b37b98be5584b0b120940a183
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Mar 3 09:22:18 2020 +0000

    Bug 23975: (QA follow-up) Add another plugin source
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 21170c635cbdcb2d0b0ba2c4bb81f35c7cf58dab
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Mar 3 00:08:09 2020 -0300

    Bug 23975: (QA follow-up) Add missing TT filters
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c46dc0fadca08721b7e3e2909c1bbb13a8061ffe
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Mar 3 00:04:36 2020 -0300

    Bug 23975: (QA follow-up) Search button style and functionality
    
    This patch makes the search form button match the other buttons style,
    and also adds the submit() action on click.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 10cdbb9fde7529445d00fbe4f225d9aab2b25227
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 2 18:58:13 2020 +0000

    Bug 23975: (QA follow-up) Fix styling of install buttons
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 553627f12c388576af34af12b3867ea61ea5f03a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 13 08:48:17 2020 +0000

    Bug 23975: (follow-up) Don't rely on save_to being present
    
    The `save_to` shortcut method was introduced to Mojolicious in version
    8.02 but we still support 7.21 as our minimum dependancy and as such we
    cannot yet use it.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f1dc82d70bb60de7dcccbb224cac8142054910b8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 12 14:43:01 2020 +0000

    Bug 23975: Add 'Install' support for github results
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7809a9fdd8c908e216844e906d58671c69a9e20e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 5 12:31:04 2019 -0500

    Bug 23975: Add ability to search and install plugins from GitHub
    
    It would be nice to be able to search and install plugins directly from GitHub ( and GitLab if possible ). This would make it easier to verify the authenticity of plugins and make discovering new plugins easier as well as making installation of plugins simpler.
    
    Test Plan:
    1) Apply this patch
    2) Add the new block for plugin_repos to your koha-conf.xml
    3) Restart all the things!
    4) Browse to the plugins home page
    5) Try searching for 'patrons' in the new search box
    6) Verify you get results!
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ef1d49efb5d40ad3d620bc3b8472fb33edf5a475
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri Feb 7 23:54:14 2020 -0300

    Bug 24615: Make object.search helper also order by embedded columns
    
    With this patch REST API request can order results by embedded columns.
    
    Full path to the column must be given for it to work.
    For example: If you are on biblio endpoint and you want to order by holding patron's card number you could
    
    > GET /biblio/1?_order_by=item.holds.cardnumber HTTP/1.1
    > x-koha-embed: item.holds
    
    To test:
    1. apply this patch
    2. prove t/db_dependent/Koha/REST/Plugin/Objects.t
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 863f129a58f2ed850b0195fe956b9951f12ae94b
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Jan 30 19:20:42 2020 +0000

    Bug 24502: (follow-up) Add all 3 query parameters in api definition
    
    This patch adds api definition for body, query or header parameters.
    
    To use them include:
    
    * "$ref": "../parameters.json#/q_body" for body parameter.
    * "$ref": "../parameters.json#/q_param" for query parameter.
    * "$ref": "../parameters.json#/q_header" for header parameter.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 755d82015d78d4d0c8d33770e93db9bdd63cd587
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri Jan 24 23:59:32 2020 -0300

    Bug 24502: object.search also filter by prefetched columns
    
    This patch adds the possibility to object.search helper, to also filter by prefetched columns.
    
    In order to dynamically add filter parameters, they must be coded as json and placed in the body of the request, coded as string in 'q' query parameter or as string in 'x-koha-query' header.
    
    The coded json, is in fact dbix syntax.
    
    To test:
    1. apply this patch
    2. prove t/Koha/REST/Plugin/Query.t t/db_dependent/Koha/REST/Plugin/Objects.t
    3. Sign off
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ab94a12ee46c511b5c09326d37925081996f89aa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 13 12:03:36 2020 +0100

    Bug 17532: Make koha-shell propagate the error code
    
    Context: I am trying to make koha-misc4dev stop when something wrong happens.
    Basically we do not want the process to continue of the DB has not been populated correctly.
    It will make the errors easier to catch.
    
    The issue: Say a script that will return an error (die in perl for an easy example),
    koha-shell will not return the 255 error code, but 0 instead.
    The caller cannot know something wrong happened
    
    The solution is to propagate the error and make koha-shell return the same error code
    as the command it executed
    
    An example:
    === t.pl ===
    die('something wrong');
    
    % perl t.pl;echo $?
    something wrong at t.pl line 1.
    255
    
    % sudo koha-shell kohadev -p -c 'perl xxx.pl' ; echo $?
    something wrong at xxx.pl line 1.
    0
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Tested it with
      $ sudo debian/scripts/koha-shell kohadev -c 'exit 8'
      $ echo $?
      8
    The unpatched version returns 0 (forgets about the error code).
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a9e9fb95e52390451d774835e60903a89647a4d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 2 11:15:04 2020 +0000

    Bug 24735: DBRev 19.12.00.032
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6321c7220ee485783cf31124d21ddcbfcc2a9d0c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 15:59:02 2020 +0100

    Bug 24735: Remove more code from tests
    
    That was use by QP tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52e95fff34e1c6da967a4d86fbb99bec748ccb31
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 13:28:27 2020 +0100

    Bug 24735: Remove QueryParser-related code
    
    At the last development meeting we have voted to remove the
    QueryParser-related code
    https://wiki.koha-community.org/wiki/Development_IRC_meeting_19_February_2020
    
    Hea tells us that it has not been adopted, and the code/bug tracker that
    it is not really usable as it. As nobody is willing to work on it, we
    decided to remove it instead.
    
    Test plan:
     % prove t/db_dependent/Search.t
    must return green
    
    See commits from bug 9239 and confirm that the code is removed in this
    patch.
    
    Also play with the search on the UI and confirm that you do not see
    obvious regressions
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 35b47f0119ba124d63542e10e564c2dc61fa1ecc
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Mar 1 00:33:19 2020 +0100

    Bug 15377: (QA follow-up) Fix capitalization and column heading
    
    Checked Out -> Checked out
    Circulation -> Status (matching other pages with this information)
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 584cf35502364f91f31013ac201ac45d8c4bdaa8
Author: Rogan Hamby <rhamby@equinoxinitiative.org>
Date:   Tue Jan 14 14:38:36 2020 -0500

    Bug 15377: Allow removal of 'checked out' items from course reserves
    
    1) removes the restriction of not allowing a reserve to be removed if it is onloan
    2) adds a column to the display that says with the item is checked out or available based on the onloan flag
    
    testplan: add an item to course reserves, check the item out, check that the Ciruclation column changes to Checked Out and that you can remove it
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Hannah Olsen <holsen@duncanville.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95e4e0a153f22a98e2b676f5efb51eb3056419d6
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Fri Feb 14 11:33:44 2020 -0300

    Bug 24664: Add missing *-messages-js.po
    
    If you try to update some language translation files
    translate script will complain of missing *-messajes-js.po
    file.
    
    This patch adds those missing files
    
    To test:
    1) Go to misc translation
    2) Update some language, eg- fr-FR
    Check error
    /usr/bin/msgmerge: error while opening "/.../misc/translator/po/es-ES-messages-js.po" for reading: No such file or directory
    3) Apply this patch
    4) Repeat 2), no error message
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 08900d5653ee0a63ae4867d1a7c7337dac7529d3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Dec 9 18:17:34 2019 +0000

    Bug 24193: Add CodeMirror linting of JavaScript, CSS, HTML, and YAML
    system preferences
    
    This patch adds CodeMirror plugins for linting JS, CSS, HTML, and YAML.
    When invalid data is entered in a linted CodeMirror editor an icon is
    displayed in the editor's "gutter." Hovering over the icon displays the
    error message.
    
    This patch renames the minified CodeMirror JS file to match convention
    but the version is unchanged.
    
    To test, apply the patch and go to Administration -> System preferences.
    
    Test preferences of each type and confirm that each type of CodeMirror
    editor shows an error indicator if you entry invalid data. Valid data
    should trigger no error indicator.
    
     - HTML: e.g.  OpacMainUserBlock,  opacheader. Enter invalid HTML, for
       example "<h1>Hello <h2>World</h2>."
       Example valid HTML: "<h1>Hello world</h1>"
     - JavaScript: e.g. OpacUserJS, IntranetUserJS. Example bad JS,
       "alert("Success!');"
       Example valid JS: "alert("Success!");"
     - CSS: e.g.  IntranetUserCSS, SCOUserCSS. Example bad CSS,
       "p { color blue }"
       Example valid CSS, "p { color: blue; }"
     - YAML: e.g. OpacHiddenItems. Example bad YAML:
       "one: two, three: four"
       Example valid YAML:
       "one: two
        three: four"
    
    Also test that other CodeMirror instances still work correctly without
    linting: The advanced MARC editor, SQL reports editing.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0c6500f46776ee0682cc43d3ae3813e5e781cef9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Mar 2 11:32:34 2020 +0100

    Bug 17016: (follow-up) Clear with 0.00 instead of blank (Use Price)
    
    Using Price, to formatted it correctly if needed
    So far it will not do anything as 'on_editing => 1' we keep 0.00, but it
    must be improved later (when we will handle that)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a495f29aaf3e181a400e7516280fd78404af327b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 25 11:54:45 2020 +0100

    Bug 17016: Clear with 0.00 instead of blank
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0bd3b45ba63da574acb74ff709c4677b1a41dbbd
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Feb 25 04:19:05 2020 +0000

    Bug 17016: (follow-up) Removing unnecessary code
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ae3e69a7dc2743b449561f35325aba77c4a182ed
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Tue Aug 2 05:47:28 2016 +0000

    Bug 17016: Button to clear all fields in budget planning
    
    Currently there is no way to undo the 'auto-fill'. This
    patch adds a 'clear' option that resets the row.
    
    To test:
    1) Go to Admin --> Budgets
    2) Click a budget
    3) Click Planning -> any option
    4) Test the Auto-fill button to see what it does
    5) Apply patch and refresh page
    6) Should now be a Clear button
    7) Auto-fill the row then click Clear button. Confirm it clears all
    fields and sets the fund remaining back to the original amount and
    styles.
    8) Add another fund and confirm that this still works with multiple
    funds.
    
    Sponsored-by: Catalyst IT
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a28e1928d3b7efe1503fee2f9cc077954353e5b7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 14 12:36:54 2020 +0100

    Bug 21746: Remove NO_LIBRARY_SET
    
    NO_LIBRARY_SET was used when the DB user was logged in. Since bug 20489
    it's not longer possible. We could remove the code.
    
    One occurrence left in C4::InstallAuth as there is no (real) logged in user yet.
    
    Test plan:
    * Install Koha to make sure NO_LIBRARY_SET is not needed during the
    install process
    * Login into Koha
    * Make sure the your library's name is displayed correctly in the header
    * Set another library
    * Confirm that the library's name is updated
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    No problem during install, nor changing library.
    Fixed (pre-existing) tab in circ/branchtransfers.pl
    No errors
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f870d027e4dddeab7d1237be0387d762bc7fa840
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Feb 29 21:57:09 2020 +0100

    Bug 24390: (QA follow-up) Fix capitalization and simplyfy code a bit
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 71279181b2bf864bdee8166181a91adc03d14ad4
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Thu Jan 9 17:07:59 2020 +0000

    Bug 24390: Add item total to rotating collections
    
    Displays the number of items in a rotating collection.
    
    TEST PLAN:
    1. Set up some rotating collections and add some items to them.
    2. No good way to see how many total items are in a given collection.
    3. Apply patch
    4. Look at collections again and you should see 'Total Items: X'
    5. Make sure it is counting the total number of items correctly.
    
    Signed-off-by: Jessica Zairo <jzairo@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6179fcce8cffa33a19e997e9ee6a88ae22ce43d5
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Wed Feb 19 18:25:48 2020 +0000

    Bug 23547: Add column configuration to course reserves table in the OPAC
    
    This patch adds opac-course-reserves to the column config tool
    TEST PLAN:
    1. Have some course reserves and go look at opac-course-reserves.pl
    2. See all the unconfigurable columns
    3. Apply patch
    4. Browse to column config > OPAC > course_reserves_table
    5. Try hiding each column and make sure the correct column is hidden on opac-course-reserves.pl
    
    Signed-off-by: Devinim <kohadevinim@devinim.com.tr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f64efb1a5c6e83a8d0870ec763746460241b16e2
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 24 14:05:23 2020 +0000

    Bug 24617: Add number to Descriptions in catalogue detail view
    
    Same change as in bug 24530 for OPAC.
    Only much easier. No trouble from Syndetics.
    
    Test plan:
    Add or remove a few notes from the MARC record (tag 500 etc).
    Verify the number is correct on the detail page.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested the else part for 'notes' with a [% SET notes = 'test' %] in tt file.
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 274dcf9a9001d6a7f0296102577660fdff3b50c1
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Feb 25 18:51:41 2020 +0000

    Bug 24732: Set DumpTemplateVars Dumper options for Indent and Sort
    
    To test:
    1 - Enable sysprefs
        DumpTemplateVarsOpac
        DumpTemplateVarsIntranet
    2 - View some pages on staff client and opac
    3 - View the page source
    4 - See a large mass of comments including the page vars at the top of the source
    5 - Refresh page and note order of vars changes
    6 - Apply patch
    7 - View page source on some pages and note things are much easier to read
    8 - Refresh page and note variable order does not change
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2d49d54ff4660b3ee2ccbfdb8cbbf10e277ebc68
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 28 17:14:25 2020 +0100

    Bug 24757: Add more tests
    
    Now we want to make sure we are not missing another situation.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3631678c9566bcbb5776f2e6206cbd052a706c45
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 28 16:57:56 2020 +0100

    Bug 24757: Leap day failing tests - Fix the tests!
    
    The same day was returned, for a different subtraction.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2682efccdb84d783be9d2acf41e8435227980bb6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 28 16:47:57 2020 +0100

    Bug 24757: Leap day failing tests - refactoring
    
    Refactore the tests to add more of them after we fixed the failing ones.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3f8412cc9175bc00e2cb24171042a80178dedde0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 28 15:59:36 2020 +0100

    Bug 24757: Leap day failing tests - It's like we are on 2020-02-28
    
    Those tests were failing on 2020-02-28, next day was a leap day.
    Let's fake time and recreate the failure
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 104b87c9a093e5a2aa859f9d2d63ed2b8556bcaa
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 2 09:45:47 2020 +0000

    Bug 22273: DBRev 19.12.00.031
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b4d56d3fd823974e39c064b4f59a17a85a0194bc
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Dec 18 13:49:59 2019 +0000

    Bug 22273: Modify Koha::ArticleRequest->store to fill created_on
    
    For a new record, store should fill created_on.
    The database will always update the timestamp updated_on.
    Since open also calls SUPER::store, we do not need to call it twice.
    
    Test plan:
    [1] Run t/db_dependent/ArticleRequests.t
    [2] In the interface, add two article requests. Change the status of one
        to PROCESSING. Check created_on and updated_on in the article_requests
        table. The changed request should have updated_on > created_on.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    [1] Tests pass
    ok 12 - New article request has created_on date set
    ok 13 - New article request has updated_on date set
    
    [2] Work as described.
    No errors
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 266bcd554bd298ee4a1f09696af6e20c8fa3f548
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Dec 18 14:35:50 2019 +0000

    Bug 22273: Database revision for table article_requests
    
    Column created_on should not be updated. It is filled once by the
    store method of Koha::ArticleRequest.
    Column updated_on should be a timestamp, updated by the database.
    
    Note: Although higher versions of MySQL and MariaDB support two timestamps
    (NOT NULL) in one table, I kept on the safe side by allowing NULL on the
    created_on column.
    
    @RM: Don't forget to run DBIx update.
    
    Test plan:
    Run new install or upgrade.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8dc15ceffd7c9b3a720210537dff098a7b0c83d8
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Dec 18 13:39:57 2019 +0000

    Bug 22273: Replace typo opan by opac in POD
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 00d70a9bd839f6153b9b86c50c5e51dbe7d82b40
Author: David Cook <dcook@prosentient.com.au>
Date:   Mon Jan 13 17:05:17 2020 +1100

    Bug 17464: Order deny,allow / Deny from all was deprecated in Apache 2.4 and is now a hard error
    
    Patch change Apache access control from 2.2 to 2.4 directives.
    
    Test plan:
    0. Apply patch
    1. Build Koha from source
    2. Copy or symlink koha-dev/etc/koha-httpd.conf into your relevant
    Apache directory.
    3. Reload Apache
    4. Note a lack of syntax errors regarding the "Order" directive
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b5b8a7daeb54a4793f5725aa15927781f52fe106
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Wed Aug 21 17:20:16 2019 -0400

    Bug 23488: Line wrapping doesn't always respect word order in Patron card creator
    
    When wrapping long lines of text, the line is divided by removing each
    word from the end of the line and putting it in a new one until the line
    is the right width. When the word to be removed appears multiple time
    in the line, it is not the last occurrence that is removed.
    
    This patch changes the regular expression used to remove the part of
    the text that is wrapped to a new line, making sure it removes it at
    the end of the text.
    
    Test plan:
    
    1. Go to Tools > Patron card creator
    
    2. Have a card template and a card batch
        -> If needs be, you can create them by using
           New > Card template or New > Card batch
    
    3. Create a layout and use one text field containing a long text with
        at least one word which is repeated a minimum of 2 times
        (preferably towrdds the end of the text, since it has to be picked
        as one of the words to appear in the new line). You can use this:
    
            one two three one two three one two three one two three
            one two three one two three one two three one two three ...
    
    4. Go to Manage > Card batches and export a batch
    
    5. Choose the layout set up in 3.
    
    6. Click the Export button and open the resulting pdf file
    
    7. Notice all the repeated word have been grouped
        -> For this example : all of the ones appear first, followed by
           all the twos and only then the threes.
    
    8. Apply patch
    
    9. Repeat step 4 through 7
        => this time the order of the words has not changed!
    
    Signed-off-by: Gabriel DeCarufel <gabriel@inlibro.com>
    Signed-off-by: William Frazilien <william.frazilien@inlibro.com>
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9060ca36c08f6f5ff2b5790ae163cd43758a7fd8
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Feb 28 16:48:37 2020 +0000

    Bug 23753: Add missing humanMsg library to pages using background job JavaScript
    
    The JavaScript used to process background uploads calls the humanMsg
    library under some circumstances. There are several templates which use
    background-job-progressbar.js which don't include the humanMsg assets.
    This patch corrects those templates.
    
    Note: upload-images.tt has been modified to remove the inclusion of
    background-job-progressbar.js because it was unused.
    
    To test, apply the patch and test the following processes which include
    background job processing:
    
     - Batch item modification -- the background job is triggered when you
       submit your changes
     - Batch record modification -- the background job is triggered when you
       submit your changes
     - Stage MARC for import -- the background job is triggered when you
       click the "Sage for import" button after uploading a file
     - Staged MARC management -- the background job is triggered when you
       click "Import this batch into the catalog"
    
    In each case the process should complete correctly. If you would like to
    test the error message handling provided by the humanMsg library you can
    deliberately introduce an error into the JavaScript. After applying the
    patch you can modify js/background-job-progressbar.js to alter line 63
    from:
    
       url: f.action,
    
    ...to:
    
       url: f.action + "foo",
    
    Perform the same tests and confirm that you see an error message. Don't
    forget to undo your changes to background-job-progressbar.js before
    signing off.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ee12fb2247f913195a31d790c164f28952178bf7
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Feb 28 15:00:40 2020 +0000

    Bug 23536: Remove obsolete category markup from patron entry
    
    This patch removes some obsolete markup from the patron entry template
    (memberentrygen.tt). The old markup was necessary in a long-gone version
    of Koha where it was possible to add patrons using built-in categories
    instead of defining your own.
    
    To test, apply the patch and test the process of adding or editing
    patrons. You should see the patron category displayed correctly in the
    page title, breadcrumbs, and main heading.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit afd5ee31baeabdee9b01e2b9f5ae379de1ffb8db
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Feb 28 14:53:53 2020 +0000

    Bug 23534: Use patron-title.inc on patron entry page
    
    There are a few instances where we can simplify the patron entry
    template by using the patron-title include file instead of outputting
    patron name variables one by one. This patch does so in the page title,
    page breadcrumbs, and page heading.
    
    To test, apply the patch and edit a patron record. The page title,
    breadcrumbs, and main heading should all look correct.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d5a1a82a9bb3aa8c693192d469ee0186aef7c7c4
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Feb 24 17:01:19 2020 +0000

    Bug 24725: (QA follow-up) Add missing spaces between elements on claims tab
    
    There was a missing space between the title and the barcode.
    Also added a space between title and author.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2fe29c657468f240ec5c781edfaf811261c774cd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 25 14:40:06 2020 +0100

    Bug 24725: Remove ES template literals in checkouts.js
    
    From Julian on bug 24661 comment 6:
    """
    It looks like xgettext does not like ES6 template literals.
    
    https://savannah.gnu.org/bugs/?50920
    
    From what I understand, support for template literals was added in gettext 0.20 (still not packaged in debian) but is still buggy in latest released version 0.20.1 and a fix is present in master.
    """
    
    We should not use backticks ` in .js file, it breaks xgettext.
    
    To replicate:
    kohadev-koha@e1f3025cca60:/kohadevbox/koha/misc/translator$ perl translate update es-ES
    koha-tmpl/intranet-tmpl/prog/js/checkouts.js:569: warning: unterminated string
    koha-tmpl/intranet-tmpl/prog/js/checkouts.js:858: warning: unterminated string
    koha-tmpl/intranet-tmpl/prog/js/checkouts.js:904: warning: unterminated string
    koha-tmpl/intranet-tmpl/prog/js/checkouts.js:911: warning: unterminated string
    koha-tmpl/intranet-tmpl/prog/js/checkouts.js:1095: warning: RegExp literal terminated too early
    /usr/bin/msgmerge: error while opening "/kohadevbox/koha/misc/translator/po/es-ES-messages-js.po" for reading: No such file or directory
    
    (last error 'No such file or directory' is not related to this).
    
    Test plan:
    Make sure nothing is broken on the claims table
    Confirm that the errors do not longer appear on `perl translate update LANG`
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 813da7f2433d182a7616407da42beef7f2c1f881
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 25 14:17:27 2020 +0100

    Bug 24727: (bug 14697 follow-up) Replace link on title to bib detail page
    
    903                               let title = `<a
    class="return-claim-title strong"
    href="/cgi-bin/koha/circ/request-rcticle.pl?biblionumber=[%
    rc.checkout.item.biblionumber | html %]">
    
    At first it seems like a typo:
    request-rcticle.pl vs request-acticle.pl
    
    But actually it does not make sense to link to request-article, we want
    (I think) to link to the bibliographic record detail page.
    
    Test plan:
    - Have something in the claim table (cf bug 14697)
    - Click on the title of the bibliographic record
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cab8dd8cf116fcc23b487c493d7bac147c82b9fe
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Feb 26 20:09:52 2020 +0100

    Bug 24734: Fix paths in LangInstaller.pm for JS files
    
    Use intrahtdocs and opachtdocs in order to get the correct paths for all
    kind of installations
    
    Test plan:
    1. With a dev install, run ./translator create/update/install xx-XX and
       verify that there is no error message
    2. With a standard install, run ./translator create/update/install xx-XX
       and verify that there is no error message
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Tested for dev/single/standard installs, no errors,
    just a (normal) warn from po2json.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d352145c65d7c8609d8694031902dafdb23a14f2
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Feb 29 10:49:46 2020 +0100

    Bug 24736: (QA follow-up) Change tooltip wording
    
    Suggesting a change of the tooltip wording to read:
    
    There are no enrollments for this club yet
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 886dd6b3be3ce94eb28742b2b10cffe7eaf64c8b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 26 17:46:49 2020 +0100

    Bug 24736: Disable "Enrollments" link if nobody enrolled to the club yet
    
    The link is disabled but it's possible to click and access the page
    anyway.
    
    Test plan:
    - Create a new club template
    - Create a new club
    - Click the Actions > Enrollments link
    => Without this patch you can access the page
    => With this patch applied you cannot, and a tooltip explains why (feel
    free to suggest another wording)
    - Add a new patron to this club (from /cgi-bin/koha/opac-user.pl#opac-user-clubs)
    - Notice that the action link is not enabled and click takes you to the
    list of enrollments
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 729200ae57b81966b3ae5e312eef8e75123f85b9
Author: Andrew Fuerste-Henry <andrew@Andrews-MacBook-Pro.local>
Date:   Thu Feb 27 14:09:02 2020 -0600

    Bug 24747: Corrects on-screen instructions in branch transfer limits
    
    To test:
    1- go to cgi-bin/koha/admin/branch_transfer_limits.pl
    2- see wording "Check the boxes for the libraries you accept to checkin items from"
    3- apply patch
    4- see wording "Check the boxes for the libraries you allow your items to be transferred to"
    
    To verify new wording accuractely describes behavior:
    1- Set UseBranchTransferLimits set to Enforce using itemtype
    2- Confirm circ rules allow holds
    3- Confirm hold policy by item type allows holds
    4- Confirm all branches are valid pickup locations in branch setup
    5- In Branch Transfer Limits, set dropdown to Branch A, select itemtype Book, disable all transfers so Branch A does not accept books from any other branch
    6- Find a patron from Branch A
    7- Find a book from Branch B
    8- On the intranet, successfully place hold on item for patron for pickup at branch A
    9- Cancel hold
    10- Log into opac as patron
    11- Successfully place hold on item for pickup at Branch A
    12- Cancel hold
    13- In Branch Transfer Limits, set dropdown to Branch A, select itemtype Book, ENABLE all transfers so Branch A DOES accept books from any other branch
    14- In Branch Transfer Limits, set dropdown to Branch B, select itemtype Book, disable all transfers so Branch B does not accept books from any other branch
    15- On the intranet, try to place a hold on item for patron, confirm Branch B is your only pickup option
    16- On the OPAC, log in as patron, try to place a hold on item, confirm Branch B is your only pickup option
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c44bfe12087cda33b351b157014e818db2e4613a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Feb 27 02:06:34 2020 +0000

    Bug 24746: Duplicate id in opacheader markup
    
    This patch removes '<div id="opacheader">' from masthead.inc
    because the same markup is generated by koha_news_block.
    
    To reproduce the bug, make sure there is an opacheader news block
    defined. Add this to the OPACUserCSS system preference:
    
    View the main page of the OPAC. You should see two blue borders around
    the opacheader content.
    
    Apply the patch and reload the OPAC page. There should now be only one
    blue border.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    
    Tested whith OPACUserCSS -> #opacheader { border: 1px solid blue; padding: 1px; }
    don't know the intended value but works :)
    
    Work as described following test plan, no errors.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bd88b10c6fbf5b6ee19ff71dc8c9777de26d5eb6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Mar 2 09:27:54 2020 +0000

    Bug 13327: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7b63d55ddc0d821b7311fcad714ff46ff750f08a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Feb 19 13:47:11 2020 +0000

    Bug 13327: (follow-up) Correct CSS and XSL errors
    
    This patch adds back the CSS changes which seem to have been lost in a
    rebase somewhere. The patch also corrects a bad copy/paste in the XSL
    file which led to a 404 error.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5bbf80989a5b8d6a1222b0e95c242b9457dfb024
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Aug 12 11:38:57 2019 +0000

    Bug 13327: OPACPopupAuthorsSearch doesn't work with XSLT views
    
    This patch reimplements the OPACPopupAuthorsSearch feature so that it
    will work in the XSLT view.
    
    To test, apply the patch and rebuild the OPAC CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
     - View the detail page for a bibliographic record in the OPAC.
       Test under the following conditions:
    
     - OPACPopupAuthorsSearch ENABLED, OPACXSLTDetailsDisplay "default"
     - OPACPopupAuthorsSearch ENABLED, OPACXSLTDetailsDisplay empty
     - OPACPopupAuthorsSearch DISABLED, OPACXSLTDetailsDisplay "default"
     - OPACPopupAuthorsSearch DISABLED, OPACXSLTDetailsDisplay empty
    
    In each of these cases, test the detail page's listing of additional
    authors/contributors and subjects. Test records which have both multiple
    contributors or subjects and which have only one author or subject.
    
    When OPACPopupAuthorsSearch is turned on, verify that the author/subject
    selection modal appears and that your selections are correctly combined
    to build a search string.
    
    Note that OPACPopupAuthorsSearch feature has a problem with terms
    containing parentheses. The issue predates this patch.
    
    Also note that the QA tools will give a false positive about Bootstrap
    button styles. This rule only applies to the staff client.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e7819f742cdea8b14342db4da188b48cc0cc4b9
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Mar 2 09:00:57 2020 +0000

    Bug 24756: Show the warnings on Jenkins
    
    Temporary measure to see which warnings Jenkins got while we cannot
    reproduce them ourselves on D8, D9 and D10.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c497d4f5a6af3648127ab14ef6e2e970c8258a64
Author: David Cook <dcook@prosentient.com.au>
Date:   Fri Feb 28 00:17:58 2020 +0000

    Bug 24739: Perform IPv6 tests only if Net::Netmask is correct version
    
    Test plan:
    0. Apply patch
    1. Set up Koha on stretch (e.g. koha/koha-testing:master)
    2. perl t/Koha/Middlware/RealIP.t
    3. Observe the following:
    Subtest: IPv6 support
        ok 1 - Warn on IPv6 koha_trusted_proxies
        ok 2 - Unable to parse IPv6 address for trusted proxy, so ignore the X-Forwarded-For header
        1..2
    ok 13 - IPv6 support
    
    4. Set up Koha on buster (e.g. koha/koha-testing:master-buster)
    5. perl t/Koha/Middlware/RealIP.t
    6. Observe the following:
    Subtest: IPv6 support
        ok 1 - Trust proxy (2001:db8:1234:5678:abcd:1234:abcd:1234) using IPv6 CIDR notation, so use the X-Forwarded-For header for the remote address
        1..1
    ok 13 - IPv6 support
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d33c2506d5173f8243adf39566a67b6b8ab096b7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 27 09:16:12 2020 +0000

    Bug 24739: Skip tests when IPv6 support is found
    
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cad8540cbf7d4b3469568e82b4b8d9384a09df8d
Author: David Cook <dcook@prosentient.com.au>
Date:   Fri Feb 28 00:28:02 2020 +0000

    Bug 24753: Change Koha/Middlware to Koha/Middleware in test name
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e1ea21415ea3457bcf855485907b59e0b5b4db42
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Feb 28 11:13:16 2020 +0000

    Bug 24756: Fix failing tests by removing temporary filenames
    
    In order to resolve the random failure, that might be caused by reusing
    filenames in File::Temp and caching xslt code, this patch replaces the
    temporary file by using the code parameter.
    
    Note: Since XSLT uses a digest based on the passed code fragment, we will
    exclude collisions here.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2c8a1176041f5ab13c68f42ff585332b11a07339
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Feb 28 08:20:43 2020 +0000

    Bug 24756: Fix D8 and U18 failures for Koha/XSLT/Security.t
    
    Instead of warning_like, we eventually catch multiple warnings and look
    if we catch one specific warn and not catch another specific one.
    
    Test plan:
    Run t/db_dependent/Koha/XSLT/Security.t on D8, D9, D10 or U18.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Passes on D8 and D9 for me.
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d296876626d30f89fc92e66804ad9fe8270001ad
Author: Nazlı Çetin <nazli@devinim.com.tr>
Date:   Fri Feb 21 14:33:42 2020 +0000

    Bug 21879: Code cleaning in printinvoice.pl
    
    Coming from
      commit 51aa6db46c604aa202a3d8f8e5028557480efbd5
      Bug 12001: Move GetMemberAccountRecords to the Koha namespace
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d4509897e1613e8239b5d27ffb9bc121ad842c5d
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Wed Feb 19 11:45:04 2020 +0200

    Bug 24680: Fix end_date returned from api/v1/holds/{hold_id}/suspension endpoint
    
    Before this patch the response would return current date as the suspension end date for a hold that is suspended with no end date.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1f16881f28146a9a01ed0d599087f1c612ba9b7d
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Wed Feb 19 11:43:08 2020 +0200

    Bug 24680: Fix PUT api/v1/holds/{hold_id} to work also when priority is not provided
    
    Before this fix the endpoint would accept the request but fail to actually update the hold if the request does not contain a priority parameter.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4f3b4dae2740113a022ca4b44ff5e4881f706a1c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Feb 26 03:16:26 2020 +0000

    Bug 24733: created_by param should be an arrayref
    
    We allow for the user to add multiple users to this field, and the
    search function expects and array. We have been treating it as a scalar
    
    TO test:
    1 - Have an open basket in acquisitions
    2 - Add to basket - from an existing order (copy)
    3 - Enter a name in the 'Basket created by' field and select a user
    4 - Hit search
    5 - ISE (Can't use string ("1") as an ARRAY ref while "strict refs" in use at /usr/share/koha/lib/C4/Acquisition.pm line 2482.)
    6 - Apply patch
    7 - Repeat 1-4
    8 - Success!
    9 - Test with mutiple 'created by' entries as well
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0dc6f329992697bd5bfa6906df2d891b1615c8cc
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Feb 25 13:40:52 2020 +0000

    Bug 24294: (QA follow-up) Add rollback and 008 default test
    
    Default for 008 was not tested yet.
    Only wondering if we should insert default values only when we meet an
    undefined value. Or should we also add if we meet an empty string? Is the
    latter not more realistic in MARC?
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 64855886b8e4eb71d03fa902762c3f3f1f79b5ed
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 2 12:09:27 2020 +0100

    Bug 24294: Add default value support for control fields in ACQ framework
    
    When trying to add an order using the ACQ framework with a 008@ tag,
    Koha explodes:
    
    Control fields (generally, just tags below 010) do not have subfields,
    use data() at /home/vagrant/kohaclone/C4/Acquisition.pm line 3272.
    
    Test plan:
    Set a default value for a control field in the ACQ framework
    Turn on UseACQFrameworkForBiblioRecords
    Create a new order from a new record
    The default value should be displayed
    Save
    => No crash
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd9a965ed58208075efa1bc51a2364096f04cda3
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Feb 23 21:25:00 2020 +0000

    Bug 24605: (QA follow-up) Fix unencoded series link in staff interface
    
    Same change as the first patch, but for the staff detail page.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f4077149075d89dd1db284e8984c71b6a1bbeac5
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Feb 6 17:45:07 2020 +0000

    Bug 24605: Fix unencoded series link
    
    To test:
    1 - Add an 830 to a record with a volume subfield separated by a semicolon
        830$aThe series ;$vvol 8.
    2 - View the record in the opac
    3 - Click the series link, no results
    4 - View the link url - the semicolon is not encoded
    5 - Apply patch
    6 - link works
    7 - URL is corrrectly encoded
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ba4fb0fdeec33dea91316b220ba24bd6b7b6d9a8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 25 14:35:04 2020 +0000

    Bug 23290: (RM follow-up) Correction to copyright statement
    
    We have updated our copyright statements now ;)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b2651484ed73fbfb178c82ef31f5bd89740e1589
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 25 14:26:57 2020 +0000

    Bug 24661: (RM follow-up) Check lang is defined
    
    This adds a check that the lang variable is defined before testing
    against it. In normal operation this is likely a no-op, but it is
    required for compiling templates during QA.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d7407055a891e723c7840739ff277b699668a56d
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Fri Feb 7 13:49:46 2020 +0200

    Bug 22522: Fix several REST API tests
    
    Fixes among others the invalid use of json_has() which caused broken tests to pass with older Mojolicious versions.
    
    Signed-off-by: Mason James <mason@kohaaloha.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2061132e457b85f780a5b77f5272db6b707ad7ea
Author: Mason James <mtj@kohaaloha.com>
Date:   Tue Feb 4 17:20:27 2020 +1300

    Bug 22522: Fix route typo
    
    Signed-off-by: Mason James <mason@kohaaloha.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a4dc6c8ed1d21343fc101366e1d299bcd92fb45
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Wed Jan 29 13:24:15 2020 +0200

    Bug 22522: Add support for current Mojolicious and related packages
    
    This patch allows tests to succeed with the following versions:
    JSON::Validator 3.18
    Mojolicious 8.32
    Mojolicious::Plugin::OpenAPI 2.21
    
    Also Mojolicious::Plugin::OpenAPI version 1.17 and later 1.x versions now work.
    
    Calling valid_input in under() would cause ' Use of uninitialized value $_[2] ' in more recent OpenAPI plugins, so that was changed too. As far as I can see this does not affect authorization.
    
    Signed-off-by: Mason James <mason@kohaaloha.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a01e5132c15d4a7241a9926b326566248367881f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jan 27 14:06:36 2020 +0000

    Bug 23290: (QA follow-up) Rename option to expand_entities_unsafe
    
    When you enable options marked as unsafe, we hope that you know what
    you are doing. You should, while having access to koha-conf.xml.
    
    Test plan:
    Verify that Security.t still passes.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 306ed2fb6f49b79139a346c70f253509af29c7af
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 17 10:30:16 2020 +0000

    Bug 23290: (follow-up) Replace warning_like by warnings_like
    
    Security.t does not pass anymore ;)
    Due to bug 23290 the tests now trigger an additional runtime error that
    we should also catch to let the tests pass again.
    
    Test plan:
    Run t/db_dependent/Koha/XSLT/Security.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 404fbeee729f624c1b3b7d2bfb02f9d538e4319f
Author: David Cook <dcook@prosentient.com.au>
Date:   Tue Nov 19 13:56:30 2019 +0000

    Bug 23290: Add test for write_net
    
    Test plan:
    Run t/db_dependent/Koha/XSLT/Security.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 801693096c6024099c5fb251d56fcf36509127e5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 15 13:19:50 2019 +0000

    Bug 23290: Add test Koha/XSLT/Security.t
    
    Test plan:
    Run it!
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a69df1fe611ebc3d77692bc3d1c1c52ec6d79a90
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 17 11:01:14 2020 +0000

    Bug 23290: (follow-up) Disable expand_entities unless explicitly enabled
    
    This follow-up refines the change made in the former patch.
    
    See also
    https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=838097
    https://rt.cpan.org/Public/Bug/Display.html?id=118032
    
    We do not want to depend now on the exact LibXML version, so we will
    disable expand_entities unless it is explicitly enabled via the config
    variable koha_xslt_security. (Allowing us to test if bad things will be
    caught.)
    
    The options key is now always added to the Security object.
    The return from set_parser_options has been removed to allow disabling when
    there is no koha-conf entry (which probably is the normal situation).
    
    Test plan:
    [1] Test the first example patch with and without the other patches (excl.
        the second example). Toggle expand_entities in koha-conf. Restart
        Plack and flush the cache each time. Evaluate results with the
        commit message of first example.
    [2] Test both example patches with/without other patches.
        Toggle expand_entities. Restart etc. Evaluate results with commit
        message of second example (check tmp/breached.txt).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f6bb3eb4787ce2208347b3b066392ee1bf2432cf
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 15 12:41:32 2019 +0000

    Bug 23290: Allow enabling expand_entities
    
    Since libxml2 disables it now by default, we need to enable it for testing.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7baa8d349c40d444f917396e5762165b358a26b9
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 15 11:04:53 2019 +0000

    Bug 23290: Apply the changes in Security to Base now
    
    Until now Base did not yet use Security. The security lines are removed
    from Base here by calls to Security.
    A new test must be added still.
    
    Test plan:
    Ensure that t/db_dependent/XSLT_Handler.t still passes.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 269c0bf2174afbee272aaf9b74571a4c04641bbf
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 15 10:59:40 2019 +0000

    Bug 23290: Introduce Koha::XSLT::Security
    
    Also adds a temporary stub for Koha::XSLT_Handler referring to Base.
    This will be removed later.
    
    Test plan:
    Run t/db_dependent/XSLT_Handler.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9ae9e5aade44c508e2fa0ed0fdc22f4db636ae50
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 15 10:55:50 2019 +0000

    Bug 23290: Rename XSLT_Handler
    
    This is just a git move. Cannot be tested. (Easier for QA.)
    The next patch adjusts paths etc. in the module.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 322fbf151b0e5bd0f2e68a6d7e8157d1aa12910d
Author: David Cook <dcook@prosentient.com.au>
Date:   Thu May 23 16:53:57 2019 +1000

    Bug 23290: XSLT system preferences allow administrators to exploit XML and XSLT vulnerabilities
    
    The problem is that administrators can provide XSLTs that
    can read from the server and network and write to the server. The
    
    This patch prevents the Koha::XSLT_Handler from running
    XSLT stylesheets that call actions such as read_file, write_file,
    read_net, and write_net as documented at
    https://metacpan.org/pod/XML::LibXSLT#XML::LibXSLT::Security
    
    (Previous tests suggested issues with XML external entities
    causing read file like vulnerabilities but these were not
    reproducible)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 884ab0d98e54d3a9f5229e2d21fd234dddf298b0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 25 12:00:28 2020 +0100

    Bug 23777: (follow-up) Use To.json in results.tt
    
     Wrong copy/paste here!
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9d80c1d5222b3a68c07ffaf340dc645f8b461d9c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 24 15:30:12 2020 +0100

    Bug 24545: (follow-up) Fix license statements
    
    Oops, missing # here!
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a1849d5fa00b3935e1f841f649bdad3604a2054c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 24 14:05:09 2020 +0100

    Bug 24545: Fix newly added files
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cfe98ddc3b51df019b31f29bb740172fefc37d4f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 3 10:46:26 2020 +0100

    Bug 24545: (follow-up) Fix license statements
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 48b8ad7515416243130b17ae4e25b312d47a219a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 31 14:43:39 2020 +0100

    Bug 24545: Fix find-license-problems.t to catch future wrong license statements
    
    File adjust to run tests and be executed on all our codebase.
    
    Test plan:
    - Apply this patch without the other one
    - run the tests
    => Several failures
    - apply the other patch
    - run the tests
    => Should pass now
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d8b96803f664d86762a6afb966051f7d565c40e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 31 14:07:20 2020 +0100

    Bug 24545: Fix license statements
    
    Bug 9978 should have fixed them all, but some were missing.
    We want all the license statements part of Koha to be identical, and
    using the GPLv3 statement.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8acdb067812bd93a06068c4ab00e251e42a2f353
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Feb 24 13:30:13 2020 +0000

    Bug 22880: DBRev 19.12.00.030
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cce9a1a85cff32a4dad4f45528661393b6ec67d4
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 24 12:12:58 2020 +0000

    Bug 22880: (QA follow-up) Replace use by require
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d8a5c48273b73c4a383288c9d9b4e9ff5f88bf2c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 24 12:00:33 2020 +0000

    Bug 22880: (QA follow-up) Pass lang instead of news_lang in masthead
    
    Might be a rebase problem. Not sure if I look at the third patch.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18f3b83b6e0b6ca0cddd280ea861e7faa428d5d9
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 24 11:55:34 2020 +0000

    Bug 22880: (QA follow-up) Remove opacheader from C4::Auth
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c48070115acdca72a96aac2fbdf57591fe43ab74
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Feb 21 10:05:22 2020 +0000

    Bug 22880: (QA follow-up) Fix "koha_news_block: not found"
    
    To make qa tools happy again.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f3b87f37ddff27301ccb84b4208854cbffaababf
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Dec 12 13:30:43 2019 +0000

    Bug 22880: (follow-up) Process all installed languages, not just enabled
    
    This patch changes the database update so that the system preference is
    copied to news items in all installed languages, not just those enabled
    in the OPAC.
    
    Signed-off-by: Lisette Scheer <lisettes@latahlibrary.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 29bfa688003996c8723b63864b441e9d4a0107f6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 11 09:31:07 2019 -0500

    Bug 22880: Use placeholders
    
    Always.
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Lisette Scheer <lisettes@latahlibrary.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ba0eccdf8d691dbe6afd7b3735ffac8f81df1e55
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Sep 4 17:42:02 2019 +0000

    Bug 22880: (follow-up) Define OpacHeader variable for conditional
    
    This follow-up uses the updates introduced by Bug 23253 as a model for
    improving the display of opacheader. Adding the OpacHeader variable
    allows the template to check for its existence and display some
    container markup around opacheader if it exists. This will help ease the
    transition for libraries who depend on the #opacheader id for styling.
    
    To test, apply the patch and test the OPAC with an 'opacheader' item
    defined. The content should be displayed on the page inside '<div
    id="opacheader"></div>.'
    
    Delete the 'opacheader' news item and reload the OPAC page. There should
    no longer be an #opacheader div.
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Lisette Scheer <lisettes@latahlibrary.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12074faff9686f6c25126e39fcf1954e5faba009
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Dec 11 13:42:09 2019 +0000

    Bug 22880: (follow-up) Loose ends: Better DB update, global inclusion, etc.
    
    This patch makes a number of improvements and ties up some loose ends
    where the old system preference usage wasn't getting replaced.
    
     - Removes news-specific code for defining the language of news
       items queried for the OPAC home page. An identical language variable
       is already defined globally.
    
       Previous to this patch an 'opacheader' news item would only appear on
       the OPAC home page. Now it should appear on all OPAC pages.
    
     - Changes the database update so that 'opacheader' news
       items will be inserted with a default title, matching the interface's
       requirement that the title field be populated.
    
     - The database update will also now insert the old opacheader system
       preference contents into the news item for all active languages as
       defined in the 'opaclanguages' system preference. This helps match
       the previous behavior in which the opacheader contents were the same
       for all languages.
    
     - Adds support for the new opacheader news item to the self checkout,
       self check-in, and OPAC maintenance pages.
    
     - Updates sysprefs.t which was using the opacheader preference to test
       on. I've changed it to use URLLinkText instead.
    
     - Removes the addition of the opacheader system preference from the
       installation SQL file.
    
    Signed-off-by: Lisette Scheer <lisettes@latahlibrary.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 65a5d1298c2594ed948cdb9be95367e5c7f1b61f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu May 9 13:52:30 2019 +0000

    Bug 22880: Convert opacheader system preference to news block
    
    This patch builds on Bug 22318 to move the opacheader system preference
    into the Koha news system, making it possible to have language- and
    library-specific content.
    
    It extends the original patch by adding an option to the template plugin
    specifying whether the content title should be shown (probably should be
    a flag in opac_news). It also adds a wrapper div with the content
    location as the ID (e.g. 'opacheader'). This will make it slightly more
    backwards-compatible with CSS customizations.
    
    To test you should have some content in the opacheader system
    preference. Apply the patch and run the database update process.
    
     - Go to the OPAC and confirm that the content which was previously in
       the opacheader system preference now displays correctly where it was
       before.
     - In the staff client, go to Tools -> News and verify that the content
       from opacheader is now stored in a news item with the location
       'opacheader_en.'
     - Go to Administration -> System preferences and confirm that the
       opacheader preference has been removed.
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Lisette Scheer <lisettes@latahlibrary.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e5adbed369074d1314df6d1b73392f7d823a3287
Author: David Nind <david@davidnind.com>
Date:   Sat Jan 25 11:01:52 2020 +0000

    Bug 24291: Update the item type form text for library limitation field
    
    Bug 15497 introduced the ability to limit item types by library.
    However, the text next to the 'Library limitation' selection field on
    the item type form mentions authorized values and is confusing.
    
    The current text reads: "Select 'All libraries' if this authorized value
    must be displayed all the time. Otherwise select libraries you want to
    associate with this value."
    
    This patch updates the text on the item type add or edit form for the
    'Library limitation' field to something more understandable.
    
    To test:
    1) Apply the patch
    2) Go to Administration > Basic parameters > Item types
    3) Click 'Edit' for any item type
    4) The text next to the 'Library limitation' field should now show
    "Select 'All libraries' if all libraries use this item type. Otherwise,
    select the specific libraries that use this item type."
    5) Sign off
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b2ad63582520f49ad3c03ca29975d99fa2ef2ecf
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Tue Jan 21 12:39:49 2020 -0300

    Bug 24356: Make objects.search prefetch embedded relations
    
    This patch makes the Koha::Object(s) derived classes expose information
    about prefetch-able relations. This is then used by a new helper to
    generate the prefetch information for the DBIC query.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Object* \
               t/db_dependent/Koha/REST/Plugin/Objects.t \
               t/Koha/REST/Plugin/Query.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a7bf8a488f4357e016ef1f43d89a241ff2fbb3bf
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 21 15:46:53 2020 -0300

    Bug 24356: prefetch_whitelist tests
    
    This patch adds tests for the introduced methods.
    
    To test:
    1. Run the tests :-D
    => SUCCESS: They pass!
    2. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e875e3980605f406bb62fbc5f2eacb9ff5c7c0de
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Tue Dec 10 21:02:41 2019 -0300

    Bug 24211: Compress/uncompress translation files
    
    This patch adds the ability to compress/uncompress
    translations files.
    
    On update/install the files are uncompressed first
    
    The only gain is to use less space.
    
    To test:
    1) Apply the patch
    2) Go to misc/translator
    3) Try it
       $ ./translate compress fr-FR (check po/*.gz)
       $ ./translate uncompress fr-FR ( check normal files)
    4) Try again with verbose mode
       $ ./translate compress fr-FR -v (list compressed files)
       $ ./translate uncompress fr-FR -v (list uncompressed files)
    5) Try update compressed files
       $ ./translate compress fr-FR
       $ ./translate update fr-FR (result is uncompressed)
    6) Try install compressed files
       $ ./translate compress fr-FR
       $ ./translate install fr-FR
    7) Try compress all
       $ ./translate compress  (add '-v' for verbose output)
    8) Try uncompress all
       $ ./translate uncompress  (add '-v' for verbose output)
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 612887d46fbed7811aed055367ac61f1bfde68f6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 21 12:28:30 2020 +0000

    Bug 24629: SIP patron items contains an array of hashes
    
    $patron->{items} contains the borrowers checkouts as an array of hashes
    { barcode => $item->barcode }
    
    When printing to log we assumed these were only barcodes
    
    This patch pushes the current checkout as a hash and maps the values retrieved to a string
    
    To test:
    1 - Enable SIP debug mode
    2 - Perform multiple checkouts for a patron
    3 - Note the messages like:
        koha koha_sip_koha[13575]: ILS::Checkout: patron 123 has checked out HASH(0x55a5b187f858), HASH(0x55a5b1896ad0), HASH(0x55a5b18a6cf0), 7826832
    4 - Apply patch
    5 - Restart all the things
    6 - Do some checkouts via SIP
    6 - Messages should now have barcodes
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 721c8bcd18cec819ed35c60949b81cfa5c243f90
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 12 10:22:29 2020 +0100

    Bug 24629: SIP log - Display barcode instead of hash
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 825741aa430db9b3d15b0d8ecd65b62f3166fb2a
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Feb 20 08:29:37 2020 +0100

    Bug 24693: Move GD from recommends to requires in cpanfile
    
    Without it, catalogue/detail.pl dies (and probably other scripts too)
    
    Test plan:
    1. Uninstall GD, reload starman
    2. Go to catalogue/detail.pl. Confirm that it dies
    3. Reinstall GD, reload starman
    4. Go to catalogue/detail.pl. Confirm that it work normally
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cd2a99e456efd4ea7e92be2fd33e4683ad6205c7
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 29 09:45:48 2019 +0000

    Bug 24114: (QA follow-up) Fix counts for lock, anonymize and delete
    
    Since these operations impact on the resultset, the counts should be
    saved before.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 88d1ad0c35af9415d24037f408dd312e885250be
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 29 09:17:19 2019 +0000

    Bug 24114: (follow-up) Resolve warning on non-numeric subtraction
    
    Argument "" isn't numeric in subtraction (-) at /usr/share/koha/Koha/Patrons.pm line 290.
    
    Coming from an empty or undefined FailedLoginAttempts.
    
    Test plan:
    Verify that Koha/Patrons.t still passes.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e1db56dd8a0f70792fc9c1f8eb66423a9611944
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 26 11:11:35 2019 +0100

    Bug 24114: Remove warn statements from Koha::Patrons
    
    The warn must be done in the cronjob.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Followed this test plan (with two follow-ups applied):
    [1] Prefs: UnsubscribeReflectionDelay=1, PatronAnonymizeDelay=2, PatronRemovalDelay=3, FailedLoginAttempts was undef
    [2] Pick borrower and set expiry to NOW-2, and lock him (login_attempts=-1) Could be achieved too by settings FailedLoginAttempts and trying wrong passwords. Run cleanup job:
        Locked 0 patrons
        Anonymized 1 patrons
        Deleted 0 patrons
    [3] Pick borrower, set expiry to NOW-3. Run cleanup job:
        Locked 0 patrons
        Anonymized 0 patrons
        Deleted 1 patrons
    
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit db2cf80a7a85e3d9db0965509c11411c53b997c4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 21 10:31:54 2020 +0100

    Bug 24682: Make UsageStatsGeolocation readonly (and redirect to the config page)
    
    To prevent invalid values in this pref (and so on the server), we should
    make this input readonly on the syspref page.
    The sysprefs related to Hea should be edited from the dedicated page, so
    also adding a note about that.
    
    Test plan:
    Search syspref with "UsageStats"
    Notice the note about the admin page
    Notice the UsageStatsGeolocation input is now readonly (and resized, to
    display the whole value when filled)
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18afaf438b2f1d8ae602dae1531d08bc41e4e241
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Jan 28 16:09:20 2020 +0100

    Bug 24527: misc/cronjobs/update_totalissues.pl problem with multiple items
    
    misc/cronjobs/update_totalissues.pl when issuing statistics table, no-incremental,  has a problem for biblio with multiple items.
    The first SQL query gets the biblios linked to items with issues in statistics :
    
    SELECT
      biblio.biblionumber, COUNT(statistics.itemnumber)
    FROM
      biblio
    LEFT JOIN
      items
    ON
      (biblio.biblionumber=items.biblionumber)
    LEFT JOIN
      statistics
    ON
      (items.itemnumber=statistics.itemnumber)
    WHERE
      statistics.type = 'issue'
    $limit
    GROUP BY
      biblio.biblionumber
    
    The second SQL query is :
    SELECT
      biblio.biblionumber, 0
    FROM
      biblio
    LEFT JOIN
      items
    ON
      (biblio.biblionumber=items.biblionumber)
    LEFT JOIN
      statistics
    ON
      (items.itemnumber=statistics.itemnumber)
    WHERE
      statistics.itemnumber IS NULL
    GROUP BY
      biblio.biblionumber
    
    The problem is that this second query will set to 0 where ANY item has no entry in statistics table.
    So when running it sets 0 to the biblio that had a value from first
    query.
    
    I think the best fix is to use "WHERE statistics.type = 'issue'" inside que JOIN :
    LEFT JOIN statistics ON (items.itemnumber=statistics.itemnumber AND statistics.type = 'issue')
    
    Test plan :
    1) Begin with an empty database
    2) Create a biblio 1 with no items
    3) Create a biblio 2 with 3 items
    4) Create a biblio 3 with 2 items
    5) Checkout and checkin all items of biblio 2
    6) Checkout and checkin the firt item of biblio 3
    7) run misc/cronjobs/update_totalissues.pl --use-stats -v
    8) Check biblio 1 has biblioitems.totalissues = 0
    9) Check biblio 2 has biblioitems.totalissues = 3
    10) Without patch the biblio 3 has biblioitems.totalissues = 0
    11) With patch the biblio 3 has biblioitems.totalissues = 1
    12) Check misc/cronjobs/update_totalissues.pl --incremental is OK
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2164a4d427e7693effd44d310e1bf3e37904dc95
Author: Caroline Cyr La Rose <caroline.cyr-la-rose@inlibro.com>
Date:   Fri Feb 21 12:46:00 2020 -0500

    Bug 24707: Remove AMICUS from default fr-CA z39.50 servers
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8749c0b6113e3f7b327fce75ab44ab650fa1dd20
Author: Caroline Cyr La Rose <caroline.cyr-la-rose@inlibro.com>
Date:   Fri Feb 21 13:11:14 2020 -0500

    Bug 24708: Update Z39.50 server attribute in fr-CA installation file
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8a6dd41d3a31e318f14df91ede8f90a10c89df5f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Feb 21 09:41:27 2020 -0500

    Bug 24705: Holds placed via SIP will be given first priority
    
    The SIP server does not calculate and pass a priority to AddReserve, which causes the hold to be given priority 1.
    
    Test Plan:
    1) Place a hold via SIP for a record with existing holds
    2) Note the new hold is top priority
    3) Apply this patch
    4) Restart SIP
    5) Repeat step 1
    6) New hold should be last priority
    
    Signed-off-by: Christofer Zorn <Christofer.Zorn@ajaxlibrary.ca>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f9bd5286b2aa7d528090a45a8a807adf4129652d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 24 10:40:54 2020 +0100

    Bug 24705: Add tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77b29c2f95c2dae6d3d74d8d718a966c581f2e6e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 21 21:11:37 2020 +0000

    Bug 24711: Don't add logout input to login form
    
    To test:
    1 - Set OpacPublic syspref to 'Disable'
    2 - Log in to OPAC
    3 - Log out
    4 - Try to log in again
    5 - No error, but you get the login form again
    6 - Apply patch
    7 - Repeat
    8 - This time you can log in again
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 27b9030d14a0ee09540652fe8533ab3ed9b69e41
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 21 15:43:06 2020 +0100

    Bug 24706: Fix ergonomic issue on the list view if empty
    
    If the list is empty, the toolbar does not render correctly.
    Buttons are displayed instead of links, also the "Sort" is displayed
    when it should not
    
    Test plan:
    - Create a new list, do not add items
    - Notice that the toolbar now renders correctly
    - Use the different link to create/edit/delete
    - Confirm that the sort link is not displayed
    - Add a new item
    - Confirm that the toolbar is looking the same as before
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a5777dafcfdee37f13ae3cc9e211692a952a68b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Feb 12 18:44:05 2020 +0000

    Bug 24646: Move RoundFinesAtPayment to 'Fines policy' section
    
    To test:
     - Search Admin->System preferences for 'RoundFinesAtPayment'
     - Note it is listed under self-check
     - Apply patch
     - Restart/refresh
     - Note it is now under Accounting -> Policy
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cfebd96d1fd6e45dea69bde20be044ad17899a19
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Feb 21 17:12:56 2020 +0000

    Bug 24588: (RM follow-up) Update debian/control
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a24a82d757feab0ae17eada4ceb72f16ead54c06
Author: Ulrich Kleiber <ulrich.kleiber@bsz-bw.de>
Date:   Wed Feb 5 11:04:20 2020 +0100

    Bug 24588: Prevent e-mails from Koha to be flagged as spam
    
    Set the e-mail headers Mailer-X and MessageID by Koha,
    to gain a better positive score from the spam filter.
    
    To test:
    1) Let Koha send an e-mail message.
    2) Check the header of this e-mail message with your e-mail client.
       There should be no X-Mailer header with value 'Koha'. If there
       is an MessageID header, it is probably set by the MSA, e.g. Exim.
       Example:
          Message-Id: <E1iyZRY-0006XT-0t@FQDN>
    3) Apply patch.
    4) Repeat step 1.
    5) Check the header of the new e-mail message with your e-mail client.
       There should be a X-Mailer header with value 'Koha' and a MessageID
       header with a value set by Koha.
       Example:
          X-Mailer: Koha
          Message-Id: <15807387030.B731e.18490@FQDN>
    6) Sign off.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d030aca6a94a8b69a5e26094696273d5cb85552b
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 13 02:47:20 2020 +0000

    Bug 22655: Adding holds rules to Onboarding tool
    
    This patch adds the following fields to the circ rule step in the
    onboarding tool:
    - holds allowed (total)
    - holds allowed (daily)
    - holds per record (count)
    
    To test:
    1) Apply patch, drop and recreate database, restart memcached and refresh page
    2) Go through the installer and get to the final step of the onboarding
    tool
    3) Confirm the above fields are now available to set in your circulation
    rule
    4) Save and log in to Koha
    5) Go to Admin -> Circ and fines rules
    6) Confirm the fields saved correctly
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f065c95e74f4a79c79a1b4ba41cfc4bc8cd2f62a
Author: Andreas Roussos <arouss1980@gmail.com>
Date:   Fri Feb 14 19:50:39 2020 +0000

    Bug 17510: enable use of subfield 0 in MMT actions
    
    When adding MARC modification template (MMT) actions, if a subfield
    value of 0 (zero) is entered it will not show up in the action's
    description upon saving. Also, if you try to modify an authority or
    biblio record using actions that refer to subfield 0 the procedure
    will fail.
    
    This patch fixes that.
    
    Test plan:
    0) Create a MARC modification template and add some actions to it,
       ideally testing all action types (Delete/Add new/Update existing
       or add new/Move/Copy/Copy and replace); make sure you input a 0
       (integer zero) in the text box for the subfield value(s).
    1) As you save each action, observe that subfield 0 ($0) is missing
       from the action description.
    2) Home > Tools > Batch record modification: try to modify a biblio-
       graphic record using the modification template you just created.
       Observe that you get an error in the system logs if you click on
       'Show MARC' or 'Modify selected records'.
    3) Apply the patch.
    4) Repeat steps 0-2. The subfield value ($0) should be displayed in
       the action description and the Batch record modification should
       work without problems.
    
    Signed-off-by: Lisette Scheer <lisettes@latahlibrary.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 08284f8dc29baf7f19d9cce0c02ee9c34d15859c
Author: Andreas Roussos <arouss1980@gmail.com>
Date:   Fri Feb 14 20:07:50 2020 +0000

    Bug 17510: update MMT-related unit tests
    
    The unit tests related to MARC modification templates need to be
    updated with extra tests specific to actions involving subfield 0.
    
    Test plan:
    0) Apply the patch.
    1) Run the updated unit tests, they should pass without any errors:
       $ prove t/SimpleMARC.t
       $ prove t/db_dependent/MarcModificationTemplates.t
    
    Signed-off-by: Lisette Scheer <lisettes@latahlibrary.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 82952294a37298f8b0070bf6cb599b96bf9550f7
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Jan 12 12:40:51 2020 +0100

    Bug 11161: Relabel 'child fund' to 'sub fund' in staff interface
    
    It was noted, that 'sub fund' might be a better term to use than
    'child fund'. So this patch changes it.
    
    To test, check with and without patch:
    
    - Add a budget in acquisitions
    - Add a fund in acquisitions
    - Add a sub/child fund to your fund (label of menu item #1)
    - Edit your first fund, check option to update owners of
      sub/child funds (#2)
    - Try to delete your 'parent' fund (tooltip #3)
    - Click on the greyed out entry (alert ÃÃ#4)
    
    If you like the change, please sign-off. If you think otherwise,
    please comment on the bug report.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 564736a76af16eb16c54d09c33636b00e4054c13
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Aug 21 02:24:11 2019 +0000

    Bug 23482: Fix BakerTaylor cover images on lists
    
    While this needs a username/pass to fully test, it should be possible to
    verify the code changes by comparing to opac-results code
    
    To test:
    1 - Enable BakerTaylor images
    2 - Enter your usernme and password
    3 - Do not fill the BookStore URL
    4 - Verify OPAC covers are working
    5 - Save some times with covers to a public list
    6 - Verify they do not display in list
    7 - Apply patch
    8 - Verify images now work
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0a07597f20f3e1f01ab23027bf7ae8ce720f8fce
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 21 14:35:30 2020 +0100

    Bug 17896: Remove duplicated use statements
    
    and remove uneeded '&'
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2dc33d4df2b5e62b6167dec230b36e472d86b4f0
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 21 12:56:53 2020 +0000

    Bug 17896: load BakerTaylor module with use
    
    We are incinsistent here, Amazon and Syndetics module are always loaeded in some places
    BakerTaylor is conditional everywhere, and causes issues under plack
    
    For simplicity sake I think we should just load this (small) module where it might be needed
    
    To test:
    1 - Disable Baker and Taylor images
    2 - Restart plack
    3 - Visit opac-readingrecord, opac-detail, opac-search, opac-shelves, opac-user
        Log in to opac
        Virew your reading history
        Make/view a list
        Search the catalog
        Look at an individual title
    4 - Enable BakerTaylorEnabled
        If you don't have Baker and Taylor credentials, simply fudge them with bad data and enable
    5 - Repeat steps above, in the word of Joubu "Kaboom"
    6 - Apply patch
    7 - Repeat 1-4
    8 - You shoudl be able to load all the pages after enabling the pref
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 325f82c8a9623dda56223e45753461097be025b3
Author: David Cook <dcook@prosentient.com.au>
Date:   Tue Feb 18 00:59:05 2020 +0000

    Bug 24676: Remove <p/> typo in opac-auth.tt
    
    This patch removes some trivial invalid HTML from opac-auth.tt
    
    Test plan:
    1. Apply patch
    2. As an unauthenticated user, try to place a hold on a search result
    e.g. http://localhost:8080/cgi-bin/koha/opac-reserve.pl?biblionumber=29
    3. View source or use an inspector to see there is no <p></p> block
    between <input type="submit" value="Log in" class="btn"> and
    <div id="nologininstructions">
    
    Signed-off-by: Sally <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4f8a85839a55f5e9b32464664fd460d4bad7878f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Feb 21 07:03:15 2020 +0000

    Bug 23777: (QA follow-up) Fix TT closing braces
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 63d831a14459c76493b5758790e1e0a794a036a5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 09:30:40 2019 +0100

    Bug 23777: Use To.json in request.tt
    
    Test plan:
    Use quotes in a library's name, then place an item on hold for a patron
    that cannot do it.
    If you are allowed to overwrite this restriction you will get a warning:
    "This item normally cannot be put on hold except for patrons from
    BRANCHNAME"
    The library's name should be correcty displayed
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d4cc6054e05c281da3808c0fd722559ce05a9d48
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 09:30:27 2019 +0100

    Bug 23777: Use TO.json in value_builder/unimarc_field_4XX.tt
    
    No idea how to test this but, as other fixes work, this one should,
    right?
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2ff14bae1565ca95b81f3aea9a689068f717e18d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 09:24:42 2019 +0100

    Bug 23777: Use To.json in results.tt
    
    Test plan:
    Search for a string with quote and confirm that it is correctly
    highlighted in the result list.
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 73d2f954445c032a8f69b0c5885f33e44ca157e5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 09:11:30 2019 +0100

    Bug 23777: Use To.json in authorities.tt
    
    No fix here.
    
    Test plan:
    Edit GENRE/FORM 040$a
    With text: Original catalo'"ging age"'ncy
    Save, you get the alert
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 348d84ea7f2255ec8ceee3976ea5370ca25230f4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 08:55:30 2019 +0100

    Bug 23777: Use To.json in preferences.tt
    
    Test plan:
    Search for "foo bar" (with double quotes) in the sysprefs
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a55d9ff0baddf77d5456c0f219daa91f5b141ac2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 09:19:31 2019 +0100

    Bug 23777: Fix for the advanced editor
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8051b885d20e98c0dc57c7d893157a06581adfb0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 11 19:03:41 2019 +0100

    Bug 23777: Fix auth finder escaping
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d91f9e72b4f1b2f22bf6b605224611d61b86890
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 24 12:23:39 2020 +0000

    Bug 22359: Prevent undercollection at the server
    
    This patch adds some additional handling to prevent undercollection of
    fees at the server side.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e8338ec17b629e059af5ff58646ec7fd51ba0650
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 20 16:01:56 2019 +0000

    Bug 22359: Improvements to payment collection inputs
    
    This patch attempts to clarify the uses of the various input fields on
    the paycollect screens.
    
    It does this by adding validation to the form such that entering a
    'collected' value that is lower than the 'paid' value is now forbidden.
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit adc59c434d68e9de1629efaf40320ee9b38850f5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 20 16:39:52 2020 +0000

    Bug 17702: (RM follow-up) Remove use of I18N tt
    
    This patch removes the use of the I18N TT plugin in introduced for all
    strings in the new template. We're not yet ready to use this plugin for
    all strings as we need to further investigate performance for such a
    move and perhaps add template compilation.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4afbd08968e1dc804483e337c0b558ded7306c1f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 20 14:51:02 2020 +0000

    Bug 17702: DBRev 19.12.00.029
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 654fbfd169c70bf7873a0501528782eb3aecd15b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Feb 10 14:30:19 2020 +0000

    Bug 17702: (QA follow-up) Add new field to kohastructure
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 50a733f09ca9a279c785b963f52891d4ff136c1f
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Feb 7 13:17:54 2020 +0100

    Bug 17702: Add UI to manage account credit types
    
    It is the same as for debit types.
    
    It adds a new column `archived` in table `account_credit_types` that has
    the same purpose than `account_debit_types.archived`
    
    Test plan:
    0. Apply patch && run updatedatabase && update_dbix_class_files
    1. Go to Admin » Credit types
    2. Add a new credit type, give it a code and a description and check
       'Can be manually added'
    3. Go to a patron's accounting section, 'Create manual credit' tab
    4. Verify that the new credit type appears
    5. Return to Admin » Credit types and archive the credit type
    6. Verify that the new credit type is not available anymore in 'Create
       manual credit'
    7. Restore the credit type and verify that it is available again
    8. Create a manual credit with the new credit type
    9. Go to Reports » Cash register and make sure you can find the
       transaction by filtering on transaction type
    10. Edit the new credit type and set some library limitations, make sure
        that the credit type doesn't appear if you're connected to a library
        you didn't selected, and that it appears if you're connected to a
        library you selected.
    
    Note to QA team:
    The change in Koha/Account.pm, I added it because otherwise Koha died
    when adding a manual credit with a custom type.
    In that case, offset type will default to 'Manual Credit'. I'm not sure
    if that is the best thing to do. I'm open to suggestions :)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fbd0687718a607aa3881298ff70c2101e8cf9cb8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 14 10:23:39 2020 +0100

    Bug 24657: Do not explicitely pass a branchcode
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit acc38cbc043858a1af6dffc66709eaa73946e6fb
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Feb 13 14:16:20 2020 -0300

    Bug 24657: Fix t/db_dependent/Koha/Item.t and t/db_dependent/Holds.t
    
    on t/db_dependent/Koha/Item.t on line 172 I created 2 Koha::Library::Groups like this
    
    my $root1 = $builder->build_object( { class => 'Koha::Library::Groups', value => { ft_local_hold_group => 1 } } );
    my $root2 = $builder->build_object( { class => 'Koha::Library::Groups', value => { ft_local_hold_group => 1 } } );
    
    I didn't realize this was creating 2 new libraries that sometimes messed up with tests, so I changed it to this
    
    my $root1 = $builder->build_object( { class => 'Koha::Library::Groups', value => { ft_local_hold_group => 1, branchcode => undef } } );
    my $root2 = $builder->build_object( { class => 'Koha::Library::Groups', value => { ft_local_hold_group => 1, branchcode => undef } } );
    
    on t/db_dependent/Holds.t on line 1058 I created 3 libraries like this
    
    my $library1  = $builder->build_object( { class => 'Koha::Libraries' } );
    my $library2  = $builder->build_object( { class => 'Koha::Libraries' } );
    my $library3  = $builder->build_object( { class => 'Koha::Libraries' } );
    
    but they needed to be pickup_locations, and sometimes they wheren't set as such, so I changed it to this
    
    my $library1  = $builder->build_object( { class => 'Koha::Libraries', value => {pickup_location => 1} } );
    my $library2  = $builder->build_object( { class => 'Koha::Libraries', value => {pickup_location => 1} } );
    my $library3  = $builder->build_object( { class => 'Koha::Libraries', value => {pickup_location => 1} } );
    
    To test:
    1. do not apply this patch
    2. in bash:
       for i in {1..300}; do echo "loop $i"; prove t/db_dependent/Koha/Item.t t/db_dependent/Holds.t; if [ "$?" = "1" ]; then break; fi; done
    3. Grab a cup of coffee (or tea if you are healthy) and wait for a while
    4. Whithin 300 iterations there should be an error in any of both scripts and for loop should exit
    5. Apply this patch
    6. repeat step 2 and 3 (decaff this time!)
    7. All 300 loops should pass
    8. Sign off
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 06b5535de6564385fb920786d1fb8e42094d2b4d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 20 09:12:35 2020 +0000

    Bug 14567: DBRev 19.12.00.028
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2b4c70dd864b14131c7294f2563d52ec8a8f4deb
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 20 09:09:45 2020 +0000

    Bug 14567: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0e7f7ab051c8a23705ea802005f15877ca40d16f
Author: Robin Sheat <robin@catalyst.net.nz>
Date:   Tue Jul 21 17:14:09 2015 +1200

    Bug 14567: Add a browse interface to the OPAC
    
    This is an interface for quick and efficient browsing through records.
    
    It presents a page at /cgi-bin/koha/opac-browse.pl that allows you to
    enter the prefix of an author, title, or subject and it'll give you a
    list of the options that match that. You can then scroll through these
    and select the one you're after. Selecting it provides a list of records
    that match that particular search.
    
    To Test:
     1 - Apply patches
     2 - Update database (updatedatabase on kohadevbox)
     3 - Compile the CSS
       https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client
       yarn build --view=opac on kohadevbox
     4 - Enable the new syspref OpacBrowseSearch
     5 - Have ES running and some records in it
         SearchEngine syspref set to Elasticsearch
     6 - Browse to opac home, click 'Browse search' link
    for your site)
     7 - Test searching for author, title, and subject
     8 - Verify that results are returned in expected order
     9 - Experiment with fuzziness
         https://www.elastic.co/guide/en/elasticsearch/reference/5.6/common-options.html#fuzziness
         Options are: exact (0 edits), fuzzy (1 edit), very fuzzy (2 edits)
    10 - Click any result and verify specific titles are correct
    11 - Click through title to record and verify it is the correct record
    12 - Test that disabling pref removes the link on the opac home
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 24154f2ec91eed4d9f28f5008d74013de2b48196
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Feb 5 15:07:23 2020 +0100

    Bug 14898: Add button at manual invoice to redirect to pay tab
    
    Test plan:
    1. Create manual invoice for any patron and click on "Save", you should
       be redirected to Account tab
    2. Create manual invoice for any patron and click on "Save and pay", you
       should be redirected to Account tab
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b459df2bcf0a9d69bc591f1b64db5b25a98251b6
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Feb 16 05:41:46 2020 +0000

    Bug 14647: Make spelling in file format pull downs match
    
    While bibliographic had XML and MARC, authorities had xml and marc
    in the pull down. This just makes both the same.
    
    To test:
    - Look at the pull downs on both tabs and verify they are
      now using the same spelling
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a7b7d63db1db41b5ffc7a7cfd5d395b868a4cf4a
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Sun Feb 9 21:32:12 2020 +0000

    Bug 14647: (follow-up) Fix script not detecting XML output format
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c42097685da4d6bb361a5e51bacc1777422a89da
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Jul 10 02:07:38 2017 +0000

    Bug 14647: (follow-up) Changes to script
    
    This patch adds the necessary changes to the script so that the filename
    extensions works for exporting authorities.
    
    To test:
    1) Attempt to export with all filetypes for biblios and authorities
    2) Confirm the extension for the exported file (after clicking the
        Export button) is correct for each one
    
    Sponsored-by: Catalyst IT
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ebb57cd6c5114241b93b7f474057fbff5b60c48c
Author: Gus Ellerm <gel1163@stacmail.net>
Date:   Tue Jan 19 23:33:14 2016 +0000

    Bug 14647: Make the file name extension dynamic on exporting records
    
    Test -
    1. go to cgi-bin/koha/tools/export.pl
    2. Check that both tabs ("Export bibliographic records & Rxport authority records") do the following
    3. In Output format
    4. When changing "File format" from dropdown it update "file name"
    5. Still works with user inputted names
    
    Works as expected.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bf0f6a2b8f9e78a7548f27a6430d187b0e9f08b7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 20 08:45:29 2020 +0000

    Bug 24532: DBRev 19.12.00.027
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c6bdb0fda8ea5cffaa653a47dbf8d20224c7214a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 30 14:39:22 2020 +0000

    Bug 24532: Fix misidentified credit_types from bug 23049
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1a5efe389d17c49f24d94815c5695eaf07fec9f6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 30 13:19:37 2020 +0000

    Bug 24532: Fix original DB update for bug 23049
    
    Pathalogical cases of Payments and Writeoffs being converted to debits
    are identified during the DB update for bug 23049, but we are not
    correctly limiting to those types accountlines when subsequently
    populating the debit_type field.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cd9d18f24d79d51be5db77a934288b0cef5bf175
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 19 21:30:22 2020 +0000

    Bug 24670: (QA follow-up) Add missing $rules definition
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Lisette Scheer <lisettes@latahlibrary.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2e860805666e248fe555fa83967872159121cfcc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 17 12:54:56 2020 +0100

    Bug 24670: Fetch all circulation rules at once to fix perf regression
    
    Signed-off-by: Lisette Scheer <lisettes@latahlibrary.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87c14e07d65e988a07529a3fd45eae354b1285ba
Author: David Cook <dcook@prosentient.com.au>
Date:   Wed Feb 19 02:07:30 2020 +0000

    Bug 24538: Handle Net::Netmask parser errors
    
    This patch switches from the new() to new2() constructor,
    which will return an undef value when it fails to parse a value.
    
    This patch warns on parser failures, but otherwise silently drops
    the invalid value, and returns objects for any valid input it can parse.
    This way one mistake won't disable the whole feature.
    
    To test:
    1. Run the unit test t/Koha/Middlware/RealIP.t
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b0d777b8366239523639ffe60735944503434daa
Author: David Cook <dcook@prosentient.com.au>
Date:   Wed Feb 19 02:05:07 2020 +0000

    Bug 24538: Add unit tests for Koha::Middleware::RealIP
    
    This patch adds some unit tests for Koha::Middleware::RealIP
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ff2641ca86018bf369673ac5f7c8b55a2c77ded0
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Jan 12 10:11:12 2020 +0100

    Bug 17611: Change 'Pending order' to 'Quantity ordered'
    
    Picking Quantity ordered as it seems more in line with
    other pages in Koha where we show information. We always
    show the quantity, so it makes sense to also have this
    label on the 'order search' and 'copy existing order'.
    
    Order search
    1) Make sure you have some orders in your acq module
    2) Go to the top and do an empty orders search
    3) Review the column headings of the search results
    4) Find "Pending order"
    
    Order from existing order (copy)
    1) Create or choose an existing open basket
    2) 'Add to basket' - 'From existing orders'
    3) Search to find some of your orders
    4) Look at the column headings, find 'Pending order'
    5) Pick some orders and fill out order information, save
    6) Summary: Find 'Pending order' in the table again
    
    x) Apply the patch and make sure all 'Pending' orders
    above have been changed to 'Quantity ordered'.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f49661a96f1c24adfe81c6e2650aeebd6a7daa91
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 19 17:12:06 2020 +0000

    Bug 24103: (RM follow-up) Correction to updatedatabase text
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc4d99d2d799f4c9ac785dbea9c60570b509e185
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 19 16:11:13 2020 +0000

    Bug 11297: DBRev 19.12.00.026
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d610ac87434a8bcac838db969d0812432964d9d1
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Feb 16 03:09:07 2020 +0000

    Bug 11297: (QA follow-up) Make table headings match other pages
    
    The patch set adds a table hading for the Actions column on the
    summary page. If you compare with other pages, this should
    be labelled 'Actions' instead of 'Options'.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4174d44218259564eefb0d7769de61d596027a3d
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Aug 29 10:20:02 2018 +0000

    Bug 11297: (follow-up) Add html filter to new input field
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 749a508c1165484f57da93998195d713414b15c9
Author: Charles Farmer <charles.farmer@inLibro.com>
Date:   Wed Feb 21 15:14:00 2018 -0500

    Bug 11297: Modify Z3950server schema file
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 99699a3114e7d9c13b191814f48eb16e1ec44e2e
Author: Charles Farmer <charles.farmer@inLibro.com>
Date:   Wed Feb 21 15:12:42 2018 -0500

    Bug 11297: Add atomicupdate patch and modify kohastructure.sql
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bd141a442e5244f4ea08819b833ab88350464d33
Author: Charles Farmer <charles.farmer@inLibro.com>
Date:   Fri Aug 10 17:28:38 2018 -0400

    Bug 11297: Add support for custom PQF attributes for Z39.50 server searches.
    
    Adds the "Attributes" field to z3950 servers.
    
    The feature here is not quite de same.
    
    In the old patches, the attributes were applied to individual query parts if the part already contains "@attr" and the additionnal attribute is not already in the query part.
    
    Here, the content of the new field is prepended to all PQF queries sent to the server.
    
    This new way of doing is simpler and works for the sponsor.
    
    Test plan:
     I) Apply the patch
    II) Run updatedatabase.pl
    
    1) Add a new z3950 server with the following parameters:
    Hostname : catalogue.banq.qc.ca
    Port     : 210
    Database : IRIS
    Syntax   : Marc21
    
    2) Perform a z3950 search on that server.
        Keyword (Any) : egypt
    2.1) Nothing Found.
    
    3) Add attributes on the server administration page
        @attr 4=1
    
    4) Perform the same z3950 search
    4.1) A lot of results
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9f9c1d5098ecee3926d394e409b6961e7c5e82bf
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Feb 14 16:25:21 2020 +0000

    Bug 6508: (follow-up) Remove dependency on jquery for check in templates
    
    Should work as before with the test plan from the second patch. But
    removes the added jQuery display control code in favor of checking
    if fines is set on template level.
    
    For several patrons with and without fines and with credits:
    - Check the Fines & Charges only display when there is something to see
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b36b76d201845ee70d455b351360d13a8f19ce8a
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 13 04:24:08 2020 +0000

    Bug 6508: (follow-up) Change layout of price and hide tab if no fines
    
    With this patch, the tab will not show if there are no fines.
    I've also changed how the fines look in the tab header to look more like
    the OPAC fines tab.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 242ced55e2c5e3e61b3914465e50dd522800e049
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 23 11:37:56 2019 +0100

    Bug 6508: Add balance to `Fines & Charges` tab
    
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a8109710531c8819da9457d7069e2d8785dd6d87
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 18 09:57:45 2020 +0100

    Bug 18433: Display the number of selected items
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7b0ad20f690aa57d86badc3318bc7bbcaa8cd8a4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 18 09:54:20 2020 +0100

    Bug 18433: Add missing filter
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 261dc1e247b215079973a400e0587c922a74bddc
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Jan 17 10:17:42 2020 +0100

    Bug 18433: Remember item search results selected rows in session storage
    
    Session storage is not shared between browser tabs, and is cleared when
    a tab is closed, so it seems like a good fit for storing selected rows
    
    Test plan:
    1. Go to item search (intranet) and submit the form
    2. Select some rows on the first page by clicking on checkboxes
    3. Go to another page of results
    4. Select more rows
    5. Go back to the first page
    6. Selected rows should still be checked
    7. Play with sorting and filtering, and see that selected rows are
       always checked
    8. Export as CSV and as a barcodes file, verify that the export contains
       all selected rows
    9. Click on 'Clear selection', it should deselect all rows from all
       pages
    10. Select some rows again
    11. Click on 'Edit search' and submit the same search
    12. No row should be selected
    13. Select some rows again
    14. Refresh the page and submit again the same search
    15. No row should be selected
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40219cf2a683ca05afbfd4807ac8fdd055cb6eb2
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Apr 14 15:45:04 2017 +0200

    Bug 18433: Allow to select results to export in item search
    
    This adds a column of checkboxes in the results table to be able to select the
    items to be exported
    
    Test plan:
    1. Go to item search and click 'Search'
    2. Without checking any checkbox, verify that the export still works (it should
       export all results)
    3. Tick some checkboxes and re-export, verify that only selected items are
       exported
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2dbcc0303a4f51701d58c5f2bd54e621842e964b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 19 16:00:11 2020 +0000

    Bug 24363: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cff40d493c695299ee3fed85e2b26cb01d1bf336
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 13 16:14:24 2020 +0100

    Bug 24363: Move the datepicker icon out of the input
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 88dc96e68a7b35270b6cf24b3dfd33fa484f2172
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 19 16:07:04 2020 +0000

    Bug 24103: DBRev 19.12.00.025
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7c78331f68aa6de2d99f0638b6dd15e500aa1724
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 14 11:34:46 2020 +0000

    Bug 24103: (follow-up) Dump query on opac authorities search
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d33dbcf2efd08ac8962a66fe566bd47596dcdef
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Nov 25 14:58:00 2019 +0000

    Bug 24103: Add option to dump search query to templates
    
    To test:
    1 - Apply patch, update database
    2 - Note new syspref 'DumpSearchQueryTemplate'
    3 - Leave it off
    4 - Enable DumpTemplateVariablesOpac and Staff
    5 - Search on staff and opac
    6 - View the source
    7 - Search for 'search_query' - you shouldn't find it
    8 - Enable the new pref
    9 - Repeat, but you should find the query
    10 - Test staff/opac search and advanced search, cataloguing search, authority search, authfinder search, adding to a basket form a new biblio
    11 - All should work and show the query
    12 - This will work under both ES and Zebra
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ad433ddfe0b61a4dac0d56f394a8d7074af23e9a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 21:43:50 2019 +0100

    Bug 23593: Link to the bibliographic record from the suggestion (OPAC)
    
    If there is a link between a suggestion and a bibliographic record (ie.
    if suggestion.biblionumber is set), it makes sense to have an hyperlink
    on the suggestion list at the OPAC.
    
    Test plan:
    - Create 2 suggestions
    - Create an order from one of them
    - Go to the suggestion list at the OPAC
    => The one with the order has a to the bibliographic record
    => The other one is not linked with a bibliographic record, and so the
    title is displayed, without hyperlink
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b73dfef3e1751ab71562d5a352970bfcb7d814f4
Author: Caroline Cyr La Rose <caroline.cyr-la-rose@inlibro.com>
Date:   Wed Feb 12 17:29:41 2020 -0500

    Bug 24648: Contextualization of past tense 'Created'
    
    In French, everything has one of the binary genders (male or female),
    and it affects the past tense verb agreements.
    
    This patch adds contextualization for the "Created" verb
    
    The following files have been modified:
    booksellers.tt - refers to a basket
    basket.tt - refers to a basket
    transferorder.tt - refers to a basket
    memberentrygen.tt - refers to a patron restriction
    suggestion.tt - refers to a suggestion
    
    To test, apply the patch and visit all those pages in English to make
    sure there is no change.
    1) Go to Acquisitions
    2) Search for vendors
    3) On the vendors result pages, check the 'Created by' column heading
    of the baskets
    4) Click on one of the baskets, check the basket info at the top,
    it should say 'Created by:'
    5) Click Transfer on one of the orders
    6) Search for and choose a vendor
    7) In the list of that vendor's basket, it should say 'Created by'
    8) Go to a patron's account
    9) Add a manual restriction in the Restrictions tab at the bottom
    10) In the restriction info, it should say 'Created'
    11) Click on the Purchase suggestions tab on the left
    12) Add a new suggestion
    13) In the Suggestion management section, it should say 'Created by:'
    14) Submit the suggestion
    15) From the list of suggestions, click on the title
    16) In Suggestion management, it should say 'Created by:'
    
    Next, install a new language (fr-CA used as example)
    1) translate create fr-CA
    2) open fr-CA-messages.po and add a translation for 'basket created by',
    'patron restriction created on' and 'suggestion created by' (it doesn't
    have to be real, just write something different for each)
    3) translate install fr-CA
    4) in the system preferences, enable the french language in
    'language'
    5) change interface language to french
    
    Redo the tests above to make sure the word you put in the translation
    for the basket is in the places where 'Created by' refers to a basket, that
    the translation for the patron restriction is where it should be and that
    the translation you put in for the purchase suggestion is in the places where
    'Created by' refers to a purchase suggestion
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 26f968344845c5ef6b078407d746a262691ceaaf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 19 15:02:11 2020 +0100

    Bug 24669: Fix selenium test
    
    There is one more "Unlimited" on the circ rules now.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d4783f244b9b8bfe786849c8bc5f46489999a7af
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jan 14 13:00:03 2020 +0000

    Bug 24269: Adjust C4::Heading to generate headings from auth tags
    
    To test:
    1 - Be using Elasticsearch
    2 - Check that field 150 is mapped to 'Match-heading' or add it (the subfields don't matter)
    3 - Add a topic term authority record like "150 $aCats$vFiction"
    4 - Add a 650 with $aCats and $vFiction and  $e depicted to a bibliographic record
    5 - Run the linker for the bib
        perl misc/link_bibs_to_authorities.pl --bib-limit "biblionumber=89" -v
    6 - Confirm the record is not correctly linked to the record
    7 - Apply patch
    8 - Reindex authorities for ES
        perl misc/search_tools/rebuild_elasticsearch.pl -v -d -a
    9 - Run the linker and confirm record is correctly linked
        perl misc/link_bibs_to_authorities.pl --bib-limit "biblionumber=89" -v
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 907914624248890a3b50f407618d80e57c16b698
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 19 12:03:17 2020 +0000

    Bug 24367: (RM follow-up) Syntax error correction
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6e49d50d83d0c32107b23b9b3a79cb87ba4bda73
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 19 11:36:50 2020 +0000

    Bug 21633: DBRev 19.12.00.024
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 33e33345b0a13b98759759b0ad9500d82f52afd2
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jan 23 12:06:21 2020 +0000

    Bug 21633: (follow-up) Cleanup other values for finesMode
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aa83cb59ced347ac909444a99ac43058d6ad7b1e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jan 3 14:56:53 2020 +0000

    Bug 21633: Remove finesMode 'test'
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2cf4496dd6e98f69baafe1e23ff418b2855f8f49
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jan 31 14:18:24 2020 +0000

    Bug 24094: Strip trailing spaces and punctuation from authority headings
    
    Both when searching for and creating new authorities we need to remove
    punctuation that exists in the bibliographic record but does not belong in
    the authority record.
    
    For example, a series with a volume contains a semicolon in the bib record,
    however, this should not be passed to the authority as the volume is not
    included in the authority record.
    
    To test:
     1 - Set AutoCreateAuthorities to 'generate'
     2 - Set BiblioAddsAuthorities to 'true'
     3 - Set CatalogModuleRelink to 'Do'
     4 - Find or create a record with:
        a 100 field with a subfield e preceded by a comma: 100 $aBoring, M. Eugene M ,$e author
        an 830 field with a volume preceded by a semicolon: 650$aLord of the rings ;$v 3.
     5 - Save the records and check the links
     6 - Note punctuation is passed through
     7 - Save again, auth records are created again
     8 - Apply patch
     9 - Save again, new auth records are created again
    10 - Check the records, punctuation has been removed
    11 - Save again, no more records created.
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f2cbcdbb99f871b64ee79c3679c453262302d17e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jan 31 14:18:14 2020 +0000

    Bug 24094: Unit tests
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 43dd880d4fc4cd4e1214113c31f9a865b183b75b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 13 17:01:06 2020 +0100

    Bug 24494: Make the regex more exact
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3c382e1f35bdc6e07c2303e1002bb20e06127751
Author: Victor Grousset <victor@tuxayo.net>
Date:   Thu Jan 23 15:55:18 2020 +0100

    Bug 24494: tests: 00-valid-xml.t shouldn't check node_modules
    
    == Test plan ==
    - work with SCSS (just recompile it if you never did)
      - https://wiki.koha-community.org/wiki/Working_with_staff_client_SCSS
    - now you have a node_modules directory
    - prove -r t/00-valid-xml.t
    - it should fail on files in node_modules
    - apply this patch
    - prove -r t/00-valid-xml.t
    - it should work
    - sabotage a legitimate XML file, like etc/SIPconfig.xml
    - prove -r t/00-valid-xml.t
    - it should fail, good the test is still useful
    - undo the sabotage
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fa8225feb344eb224cd59eace0cb18370d9e547e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 14 11:44:44 2020 +0100

    Bug 19791: Keep user in circ when viewing patron's logs
    
    When a librarian is viewing the log for a given patron (tab "modification log"
    from the circulation module), the "object" and "modules" parameter can
    be modified. It does not make sense, we should stay in the circulation
    module and avoid those fields to be modified.
    
    Test plan:
    - Modify several patrons (in order to have several modification logs)
    - Go to the modification log tab of one of them
    - Notice that the "Object" input is not a "Borrowernumber" labelled
    input and that you cannot modify it.
    Also notice that the "modules" is hidden.
    - Go to the log viewer tool and notice that the view is still the same
    as before this patch.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d55462f1b2cb4840333f9e3830de3084a39a30e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 18 11:29:46 2019 +0100

    Bug 24051: Remove "search( %condition ) is deprecated" warning from batchMod.pl
    
    Test plan:
    Go to Home › Tools › Batch item modification
    Insert barcodes and continue
    => Without this patch you will get warning in the log
    => With this patch applied you warning does no longer appear
    Confirm that the number of holds is correct
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 946d1dff1a428217cb825787c341563ef1e97289
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Feb 16 11:46:08 2019 -0300

    Bug 22245: Allow copy/move from and to control fields
    
    The JS conditions were wrong, we want to allow copy and move between
    control fields.
    
    Test plan:
    Create a new MARC modification template action using control fields.
    Confirm that you are allowed to copy/move a control field to another one
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 38b95b5122a8448bbf84c96450fd1906d4fffaec
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Mon Feb 17 10:32:26 2020 +0000

    Bug 24669: Show "Unlimited" values correctly in smart-rules.pl
    
    The rules "Holds allowed (total)", "Holds allowed (daily)", "Holds per
    record (count)" were not set empty when in rule editing. Also, the
    text "Unlimited" was not shown for rule "Holds per record (count)"
    even though it should have been since empty value means unlimited
    holds per record.
    
    To test:
    1. Apply patch
    2. Edit the rules "Holds allowed (total)", "Holds allowed (daily)", "Holds per
    record (count)" to be empty and save
    3. Make sure all of the above rules now say Unlimited
    4. Edit the rules again and make sure the above rules are now in the
    rule editing empty.
    
    Sponsored-by: The National Library of Finland
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4a9330df408bd7bfd6bfafbedeeb1cb9ce858d9a
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Mon Feb 17 09:48:22 2020 +0000

    Bug 24669: Improve numeric input handling in smart-rules.pl
    
    This removes code duplication by introducing a new subroutine
    strip_non_numeric() that removes whitespace and makes the rule value
    '' if it is a string value instead of a digit. The call to
    strip_non_numeric() is now added also to all the rules it is needed
    in.
    
    To test:
    1. Write some string like "test" to rules:
      - Current checkouts allowed
      - Current on-site checkouts allowed
      - Holds allowed (total)
      - Holds allowed (daily)
      - Holds per record (count)
      - Holds per record (count) – can be found in default policy
    2. Save rules
    3. Apply patch
    4. Edit the rule line where you just typed all those strings and save
    5. Notice how the values are now empty strings (some say "unlimited" but
       if you go check from DB it should show empty value there)
    
    Sponsored-by: The National Library of Finland
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f3d8a3b91aef7debb66d064d8150843ed448b1fe
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 18 18:32:02 2020 +0000

    Bug 24666: (QA follow-up) Add missing filters
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18eeaed95feb8ccd5ff2598c4e6511a814d8a370
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 17 14:39:50 2020 +0100

    Bug 24666: Display not registered guarantors on the patron detail page
    
    There was no way to see the not registered guarantors apart of editing
    the patron.
    
    Test plan:
    - Create a patron with category type "Child"
    - Define a "guarantor surname" and/or "guarantor firstname" in the
    "Contact" block (the patron is not registered)
    - See the patron's detail page and notice that the info appear
    - Edit and add a registered guarantor
    - See the patron's detail page and notice that the 2 guarantors info appear
    
    Note that the relationship has been added.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 74729776551c68a3bab9693f082ef22822864e4d
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Nov 24 13:01:20 2019 +0100

    Bug 5016: Fix some translation issues with English PDF order templates
    
    Changes made:
    - Instead of n° print no.
    - Market Identification => Market identification
    - GST => Tax
    
    To test:
    - Create at least 2 baskets with one or more orders
    - Create a basket group with those baskets
    - Print the PDF using
      - the 2 page layout
      - the 3 page layout
    - Verify that the changes made appear and everything looks correct
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit afb3d36c3e5ccda5cc1bb562d2fd07a218fdcb32
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Jan 12 03:55:41 2020 +0000

    Bug 17221: (follow-up) Orphan comma in shelf browser
    
    This further improves the display if no location or no
    collection has been set. Example output:
    
    Browsing Centerville shelves, Collection: Non-fiction
    
    Also changes 'Collection code' to 'collection' and takes
    care of additional spaces before the comma.
    
    To test:
    - Make sure your OpacShelfBrowser pref is set to "Show"
    - Search for a record with items and callnumbers in your OPAC
    - "Browse shelf"
    - Navigate back and forth, verify the information showing on
      top of the list is correctly formatted
    - Try different combinations for the following prefs:
      - ShelfBrowserUsesCcode
      - ShelfBrowserUsesHomeBranch
      - ShelfBrowserUsesLocation
    - Verify the display is always nicely formatted
    
    Note: fixing capitalization here is tricky, as it also
    depends on what was displayed before. If you have no
    homebranch, you would want "Shelving...", if you have one
    we'd like "shelving...". Left as I found it for now.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d78c57d97b6e5e8e06a753edb8da2e68aab3c4e
Author: Eric Phetteplace <phette23@gmail.com>
Date:   Sun Jan 12 11:32:53 2020 +0100

    Bug 17221: Remove orphan commas in shelf browser
    
    This patch adds more conditions to the shelf browser template
    such that the displayed text reads as a proper list no matter
    what combination of system preferences are utilized
    
    Sponsored-by: California College of the Arts
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 515df43af8dddd493616dfe9efc83373c8d2f50b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Dec 3 11:03:18 2019 -0500

    Bug 21944: Improve efficiency of code
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 07ad62380ececb2dda591fcf495d67ee71d890d1
Author: Christopher Brannon <cbrannon@cdalibrary.org>
Date:   Tue Dec 4 16:38:34 2018 +0000

    Bug 21944: Reroute waiting hold from wrong branch
    
    To Test:
    1) Place a hold on an item.
    2) Check in the item to trigger the hold.  Item is now listed as
    waiting.
    3) Set branch to a different library.
    4) Check in the item to trigger the hold.  Notice that nothing but a
    local use is recorded.
    5) Apply the patch.
    6) Repeat steps 1-4.  Notice that the hold is triggered around routed to
    its original pickup location.  A transfer is set and the hold status
    is changed from waiting to correctly showing the item as in transit.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ccf4dfc3e9f4819c2317a533a68ddce7395d7035
Author: Christopher Brannon <cbrannon@cdalibrary.org>
Date:   Thu Dec 13 00:08:54 2018 +0000

    Bug 21944: Test for Circulation.pm
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fe43d98bd1492a1aeb94d2a3df987ca6c5ed7150
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 26 09:27:21 2019 +0100

    Bug 24110: Do not html filter TT vars when dumped
    
    DumpTemplateVarsIntranet and DumpTemplateVarsOpac are devs tools to
    display the variables sent to the template. They should not be filtered
    otherwise it's getting complicate to read.
    
    For instance: $VAR1 = { var =&gt; val }
    
    Test plan:
    Turn DumpTemplateVarsIntranet on
    Go to the main page
    Show the source of the page
    Confirm that the variable are displayed as it and not filtered
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5ecabb315add6fd27772178bb8aed745c59e4cf3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 17 16:59:15 2020 +0100

    Bug 24367: May fix another warning
    
    May fix the following warning:
    Use of uninitialized value in concatenation (.) or string at
    /kohadevbox/koha/C4/Search.pm line 1818.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0fdc9377d73d2cf1759d88029114e29f8faa8097
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 10 08:51:51 2020 +0000

    Bug 24367: Resolve other uninitialized warns in Search.pm
    
    Use of uninitialized value in hash element at /usr/share/koha/C4/Search.pm line 2074.
    Use of uninitialized value in hash element at /usr/share/koha/C4/Search.pm line 2137.
    Use of uninitialized value in concatenation (.) or string at /usr/share/koha/C4/Search.pm line 2189.
    Use of uninitialized value in hash element at /usr/share/koha/C4/Search.pm line 2213.
    Use of uninitialized value in hash element at /usr/share/koha/C4/Search.pm line 2215.
    Use of uninitialized value in hash element at /usr/share/koha/C4/Search.pm line 2225.
    Use of uninitialized value in hash element at /usr/share/koha/C4/Search.pm line 2226.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e3c8ba65cff48d598c810f9def4f654c79dd0669
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 10 08:27:39 2020 +0000

    Bug 24367: Resolve warn Use of uninitialized value within [arrays]
    
    Use of uninitialized value within @operators in string eq at /usr/share/koha/C4/Search.pm line 1362.
    Use of uninitialized value within @indexes in pattern match (m//) at /usr/share/koha/C4/Search.pm line 1367.
    
    Trivial tests added.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit db019fa6628c147c716a1dc1cad903f025775ee4
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 10 08:07:05 2020 +0000

    Bug 24367: Resolve warn Negative repeat count does nothing
    
    Negative repeat count does nothing at /usr/share/koha/Koha/QueryParser/Driver/PQF/query_plan.pm line 53.
    Negative repeat count does nothing at /usr/share/koha/Koha/QueryParser/Driver/PQF/query_plan/node.pm line 102.
    
    I am not sure if this statement actually does what the author intended,
    but adding the test on node_count/atom_count removes the warn.
    Repeating this change on query_plan.pm line 62.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c801ea3c69e6d6db524f568372a8685622ee90cf
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 10 07:54:33 2020 +0000

    Bug 24367: Resolve warn Argument available is not numeric in delete
    
    Argument "available" isn't numeric in delete at /usr/share/koha/C4/Search.pm line 1480.
    The construction delete array[string] simply does not work.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 76a4753dfe9bf2f541eb7cb40bfaab8a9605c9db
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 7 16:53:50 2020 +0100

    Bug 24367: Remove warnings from Search.t
    
    * Set defaults for index to 'kw'
    * Check that priority is defined before using it.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9363ff96b59155ea4e3bde5a3498ac4b189b287b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jan 24 17:33:48 2020 +0000

    Bug 24514: Add option to exclude title from patron-title.inc
    
    Without this patch sorting by patron name on the 'holds awaiting
    pickup' report sorted by title, surname, firstname. With this
    patch the list will sort by surname, firstname, ignoring the title.
    
    To test:
    - generate and capture a hold for a patron named "Mr. A A"
    - generate and capture a hold for a patron named "A A"
    - generste and capture a hold for patron named "Mr. B B"
    - generste and capture a hold for patron named "B B"
    - go to holds awaiting pickup
    - sort by patron name ascending
    - holds sort Mr. A, Mr. B, A, B
    - sort by patron name descending
    - holds sort B, A, Mr. B, Mr. A
    - APPLY PATCH
    - Reload holds awaiting pickup
    - Confirm holds sort on Surname
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d3f50b246db813caeb2d030488231c30a79650fe
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Sun Feb 9 21:55:01 2020 +0000

    Bug 18933: Allow OPAC messaging SMS number to be set to empty
    
    To test:
    1) Ensure EnhancedMessagingPreferences is enabled and
    EnhancedMessagingPreferencesOPAC is set to Show. Set SMSSendDriver to
    Email
    2) Log in to OPAC, go to your messaging tab
    3) Set an SMS number if you havent already
    4) Try to remove it (set to empty)
    5) Notice that it says the number has been updated, but it has not
    been set to empty
    6) Apply patch and refresh page
    7) Attempt to set the number to empty
    8) Confirm this is successful
    
    Sponsored-by: Catalyst IT
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ee8a9a6af57300c4cf7b629492cc3c31bf901933
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Dec 16 17:41:42 2019 +0000

    Bug 24249: OPAC lists page should require login for login-dependent operations
    
    This patch modifies opac-shelves.pl so that login is required if the
    requested operation is anything but "view" and "list."
    
    The patch also modifies a couple of "Log in to create a new list" links
    so that they point to the list creation form instead of opac-user.pl.
    
    To test, apply the patch and go to the main lists page (the list of
    lists) in the OPAC while not logged in.
    
     - Click the "Log in to create a new list" link.
     - Log in.
     - You should be taken to the "Create a new list" form.
     - Also test the "New list" link shown in the toolbar when you're
       viewing the contents of a list.
     - When not logged in click the "Lists" menu in the page's header menu.
       Clicking "Log in to create a new list" should take you to the login
       form and then to the list creation form.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 93a5e162d6e1049dca7216eecdbc6ec39d9fba06
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 16 18:50:16 2019 +0100

    Bug 24388: Remove uneeded test in lateorders.tt
    
    The budget_lock is never set (and has never been).
    
    Test plan:
    For QAer only, make sure this never worked
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ea09ef36e84e0f217b1c071f110089fddb1a311c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 12 15:49:17 2020 +0100

    Bug 24549: Do not set "last patron" cookie if showLastPatron is disabled
    
    If the showLastPatron syspref is disabled, we should not store the 3
    cookies we use for this feature.
    
    Test plan:
    0/ Do not apply this patch
    1/ Turn off showLastPatron
    2/ Search for a patron, click on a result
    3/ Open the cookie list of your browser
    => You see 3 cookies named lastborrowercard, lastborrowername,
    lastborrowernumber
    4/ Remove them
    5/ Apply the patch
    6/ Reload the patron detail page
    => The 3 cookies are not created
    7/ Turn the pref on
    8/ Reload the patron detail page
    => The 3 cookies are created
    9/ Eat one of them.
    
    QA note: it's a bit dirty, we should do that JS side, but
    staff-global.js is too widely used to make the change easy. Any other
    suggestions welcomed.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 29c09991e7d7e4a00ba18163d28e9545bd4325ce
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Feb 12 21:24:58 2020 +0100

    Bug 24647: Remove PDF::API2::Simple from cpanfile
    
    It is not used anywhere.
    
    Also, remove PDF::API2::Page and PDF::API2::Util from cpanfile.
    These modules are included in PDF::API2 which is already in cpanfile.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7cd00c77d4305758e438f09aaeb1aaad65464aec
Author: David Kuhn <techservspec@gmail.com>
Date:   Sat Aug 31 16:23:16 2019 -0700

    Bug 23527: BakerTaylorBookstoreURL is converted to escaped characters by template, rendering it invalid
    
    Changing the template toolkit filter for rendering the value of
    BakerTaylorBookstoreURL in opac-detail.tt and opac-results.tt from uri
    to url fixes the problem.
    
    To test (requires a Baker & Taylor username and password):
    
    1. Enter the B&T url into BakerTaylorBookstoreURL.
    2. Set BakerTaylorEnabled to "add" and enter your username and password.
    3. Look up a title in the OPAC.
    4. Locate a title with a cover image.
    5. Click on the cover image. You are not redirected to the url stored
       in BakerTaylorBookstoreURL.
    6. Display the full record for the title
    7. Click on the cover image. You are not redirected to the url stored
       in BakerTaylorBookstoreURL.
    8. Apply the patch.
    9. Refresh the OPAC display.
    10. Click on the cover image. You are now redirected to the specified url.
    11. Return to the results list.
    12. Click on a cover image. You are now redirected to the specified url.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    
    Although I don't have valid Baker & Taylor credentials I was able to use
    dummy data to verify that the links in the template are correctly
    encoded with this patch.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d0a8df6214e68d9fbdbac43e5b73e6c5bb155cb3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 19 11:09:41 2020 +0000

    Bug 24640: DBRev 19.12.00.023
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9446b894b863fd3db0dbc22536895a4ef754ca7e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 12 12:26:25 2020 +0100

    Bug 24640: Allow quotes.timestamp to be NULL
    
    It is broken with strict mode enable, timestamp is created without
    default value.
    
    Note that the .sql installer file init the value with NOW(), which is
    wrong.
    
    DBD::mysql::st execute failed: Field 'timestamp' doesn't have a default
    value [for Statement "INSERT INTO quotes (source, text) VALUES (?, ?);"
    with ParamValues: 0="poeut", 1="pouet"] at
    /kohadevbox/koha/tools/quotes/quotes_ajax.pl line 49.
    
    Test plan:
    Create a new quote of the day
    => Without this patch you will get an error
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 79dbd633695527d3a6d6e5bd8327fd3c26f2f639
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Feb 13 15:43:30 2020 +0000

    Bug 24654: Remove trailing quote in rda264 XSLT
    
    To test:
    1 - Find or add a recod with a 264 field
    2 - Make sure there is a subfield b
    3 - View the record in opac
    4 - Right click on publisher link and copy and paste into a text editor
    5 - Note the trailing " in the search
    6 - Apply patch
    7 - Refresh
    8 - Link is correctly formed now
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc1db6b9948ba06cd6497ff64248451078fffedc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 18 10:37:58 2020 +0100

    Bug 7611: (follow-up) Adjust tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 799ec12063259a81a78e6c68f647e1379907a03b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 17 18:18:48 2020 +0100

    Bug 24002: (follow-up) Incorrect DATE value: '00-00-0000' in C4/Serials.pm
    
    Oops, wrong copy/paste here! The column order changes was not expected.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bd6e75217f6a3058e34304f008f6a72b07309896
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 17 14:05:20 2020 +0000

    Bug 24530: (QA follow-up) Add missing filter
    
    Jenkins is complaining about a missing filter:
    xt/find-missing-filters.t, koha-tmpl/opac-tmpl/bootstrap/en/modules/opac-detail.tt line 573
    
    The variable is just filled in the template but lets make Jenkins happy.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a2f70b7e382bc43fc39eda790dcbaf7e1788fbb
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Feb 10 19:04:57 2020 +0000

    Bug 24621: Phase out jquery.cookie.js: Basic MARC editor
    
    This patch removes the use of the jquery.cookie plugin by the basic MARC
    editor for setting two interface preferences: Showing MARC tag numbers
    and showing MARC documentation links.
    
    To test, apply the patch and open the basic MARC editor.
    
     - From the "Settings" menu, select the "Show MARC tag documentation
       links" link. This should toggle the display of the "?" link next to
       MARC tag descriptions.
     - Reload the page to confirm that your selection has been saved.
     - Perform the same test with the "Show tags" menu item.
    
    You can also follow the changes to the cookie using the browser's
    developer console. Look for cookies named 'marcdocs_***' and
    'marctags_***' (where *** is the borrowernumber of the logged-in
    user) and confirm that the value of each flips from "show" to "hide" and
    back.
    
    https://developer.mozilla.org/en-US/docs/Tools/Storage_Inspector
    https://developers.google.com/web/tools/chrome-devtools/storage/cookies
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b11678b9053c258898e8320c028dfd95dd3c4a02
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Feb 10 17:58:04 2020 +0000

    Bug 24619: Phase out jquery.cookie.js: MARC Frameworks
    
    This patch removes the use of the jquery.cookie plugin on the MARC
    Frameworks page and replaces it with a call to the new js-cookie
    library.
    
    To test, apply the patch and go to Administration -> MARC
    bibliographic frameworks.
    
     - Choose the 'MARC structure' menu item for one of the frameworks
       listed.
     - On the page which lists the tags in the framework, check the box
       labeled "Display only used tags/subfields." The page should reload.
     - The checkbox should remain checked and the list of tags should now
       show only used tags.
     - Uncheck the checkbox and the page should reload again.
    
    You can also follow the changes to the cookie using the browser's
    developer console. Look for a cookie named
    'marctagstructure_selectdisplay' and confirm that the value flips from 0
    to 1 and back.
    
    https://developer.mozilla.org/en-US/docs/Tools/Storage_Inspector
    https://developers.google.com/web/tools/chrome-devtools/storage/cookies
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e62983653501759c2f1819ac97d20a7912d701d
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Feb 11 19:03:18 2020 +0000

    Bug 21921: Add date publication year to biblio Z39.50 search form in acquisition
    
    Test plan:
    
    1) Apply the patch
    2) Have a Z39.50 endpoint with attr 31 defined - Library of Congress
    supports this
    3) Try to find some biblio records through Z39.50 using the new field
    "Publication year" in acquisition module
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 68a92c02dfbafa9eea73516cb29ba5e6a311a730
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Nov 30 09:06:22 2018 +0000

    Bug 21921: Add date publication year to biblio Z39.50 search form
    
    Test plan:
    
    1) Apply the patch
    2) Have a Z39.50 endpoint with attr 31 defined - Library of Congress
    supports this
    3) Try to find some biblio records through Z39.50 using the new field
    "Publication year"
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dcfedab563fd7bf202a5e70203619dda288c8406
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 16 17:15:19 2019 +0100

    Bug 24389: Better error handle when claiming late orders
    
    A successful message says that the email has been sent and the order has
    been claimed, but nothing happened.
    
    Test plan:
    0. Do not apply this patch
    1. Create a new vendor, does not create a contact
    2. Create some orders, close the basket
    3. Go to the late orders page and claims some orders
    => You get a successful message, but the claim has not been done!
    4. Apply this patch
    5. Claim the orders
    => You get an error
    6. Set a contact for the vendor
    7. Claim the orders
    => Success
    
    In the docker container, you may need to:
    % apt install postfix
    % postfix start
    Edit /etc/hosts
    127.0.0.1       localhost localhost.localdomain
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f96075d6ec6d9a1e1881d177f0c721e41ecaef86
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 14 14:02:09 2020 +0000

    Bug 19718: (follow-up) Make messages translatable
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8f33efbc2941afe90d42d2e71d3b1bc93b339864
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Aug 28 11:51:18 2019 +0000

    Bug 19718: Show message if patron has existing holds on a title
    
    To test:
     1 - Set a rule to allow multiple holds on a title
     2 - Place a single hold in the opac for a patron
     3 - Return to record and attempt place a second hold
     4 - Note there is no message but that you must match the type placed before (item or record level)
     5 - Don't place the hold
     6 - Apply patch
     7 - Attempt to place second hold again
     8 - Note there is a message informing you of which level hold you may place
     9 - Test with both item/record level holds and placing a single request or multiple requests
    
    Signed-off-by: Donna Bachowski <donna@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ce14ab2bf8bdf47f9c2cc13a6b43d0bfb7a07c4b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 21:24:24 2019 +0100

    Bug 23592: Link to the bibliographic record from the suggestion
    
    If there is a link between a suggestion and a bibliographic record (ie.
    if suggestion.biblionumber is set), it makes sense to have an hyperlink
    on the suggestion detail page.
    
    Test plan:
    - Create 2 suggestions
    - Create an order from one of them
    - Go to the detail page of the suggestion
    => The one with the order has a to the bibliographic record
    => The other one is not linked with a bibliographic record, and so the
    title is displayed, without hyperlink
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 71d0775cc701e741ef940f120921627a7f7b451c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 13 10:46:22 2020 +0000

    Bug 24651: Add maxdays option to fines cronjob
    
    This patch adds an optional maxdays parameter to the fines.pl cronjob.
    The new parameter allows system administrators to set a maximum number
    of days for the job to process overdues.  This can improve performance.
    
    Signed-off-by: Sally Healey <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0df78d29953d74ba6e3ce24a2c86e0c394082012
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Fri Feb 14 17:36:49 2020 +0000

    Bug 24576: `StoreLastBorrower` preference is in the wrong tab and is confusing
    
    This patch moves the preference from OPAC/Privacy to Circulation/Check
    In
    
    To Test:
    
    1) Apply the patch
    2) Check that the system preference no longer displays under the OPAC
    Privacy tab
    3) Check that it now displays in the Circulation tab, under the Check In
    policy
    4) Ensure that the system preference can be changed and saved correctly.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0752c983ff985ad9e60e12c0dc6999489e6f905f
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Feb 15 01:15:35 2020 +0000

    Bug 18499: (QA follow-up) Add missing colon after label description
    
    To match the line above, a colon (:) was added after the description:
    
    Callnumber classification scheme: [pull down]
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2bc6d6d575240636cec549d300a6483f164bd8fa
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 14 17:59:38 2020 +0000

    Bug 18499: (follow-up) Add missing filters
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6b6a68525ca3a22b51d3887acc59581a44122b61
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Feb 6 13:14:30 2020 +0000

    Bug 18499: Use items cn_source in cn_browser.pl
    
    This does a few things:
     * We fetch the cn_sort from the DB and use this rather than calculating based on DefaultClassificationSource
       We were already pulling based on the items source, so this should not change things
     * Rather than using JS to submit the form, it submits via html
     * Fix subtitle display and add barcode (it was retrieved in one query but not used)
     * Add option to apply different classification scheme to the search
    
    To test:
     1 - Add cn_browser.pl to the 'plugin' field in a framework for 952$o
     2 - Edit an item on a record in that framework
     3 - Enter an itemcallnumber
     4 - Click the two dots to launch the callnumber browser
     5 - Note the results
     6 - Apply patch
     7 - Repeat
     8 - Note subtitles and barcodes are displayed in results
     9 - Note callnumbers are appropriate
    10 - Try changing the class source used
    11 - Try this with differing dewey,lcc, and other callnumbers
    12 - Ensure results are as expected
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 31946d68e4833bf817c2ce2c6e1e12a52ac0be31
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 10 08:05:50 2020 +0000

    Bug 24530: (QA follow-up) Include Syndetics in notes count
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 232716b9e9608f987eb0f4c94e7673baf914adec
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed Jan 29 14:15:02 2020 +0000

    Bug 24530: Show a number for title notes on opac-detail
    
    A number (just as on most other tabs) tells more than a boolean (i.e. the
    tab does not appear for zero marc notes). Intuitively, you might be misled
    by "Holdings (1), Descriptions" and think there are none.
    
    Test plan:
    Verify that the number of title notes on opac detail page matches your
    expectations.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6191bfe92bfc004144da52451fe05693326b3859
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Feb 17 11:22:21 2020 +0000

    Bug 8643: Add sporsorship
    
    Sponsored-by: CCSR ( http://www.ccsr.qc.ca )
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1f1ff392fb1977107a583044e2eca51e573d14f0
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Nov 8 15:49:08 2019 +0000

    Bug 7611: (follow-up) separate positive and negative statuses as in the past
    
    This patch preserves someting closer to previous functionality.
    
    Negative not for loan are in the 'unavailable' section in red, positive ones are in the 'reference' section in green. Itemtype level will also be in green in reference
    
    Item specific status will override an itemtype level.
    
    The line break between 'reference' and 'unavailable' existed before and is preserved - negative not for loan and checked out items appear here
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2513b4f596f9cd9185204cf8abb3ba865f373e7a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 5 16:32:45 2019 +0000

    Bug 7611: (follow-up) Fix display of undefined statuses and add a class
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 128fcb8dd472a14408c00f195e0c63f3f2122069
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Oct 15 13:30:02 2019 +0000

    Bug 7611: (follow-up) Add missing space
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 86f203ebe51e9036aee3927b702c0a325c01b8dd
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Aug 29 12:06:24 2019 +0000

    Bug 7611: Change negative notforloan as well
    
    This makes the changes apply to both positive and negative notforloan values
    
    The extra line generated before is removed
    
    Some spans are added and cleaned up and labels moved to CSS to allow for easier altering where needed
    
    Itemtypes marked notforloan remain as reference, the label can be changed via css
    
    To test:
     1 - Have a record with items in various statuses, ideally
       - 3 available, with 2 in one branch, 1 in another
       - 3 with itemtype not for loan, 2 in one branch, 1 in another
       - 3 in a positive not for loan status, 2 and 1 as above
       - 3 in a negative not for loan status, 2 and 1 as above
       - 1 in a different positive loan status, but with the same opac description as the negative above
     2 - Search the opac to include this record, take a screenshot
     3 - Apply patch
     4 - Restart all and refresh
     5 - Compare to screen shot
     6 - Differences include:
       - Positive statuses are now on separate line with opac description showing
       - Unavailable (not for loan items) now include callnumber and branch in display
       - Positive and negative notforloan with same description are combined where branches match
       - Inspect the elements, note new spans around 'Items available for
    loan/reference'
     7 - Add to OPACUserCSS:
      .ItemSummary .ItemBranch{
        display:none;
      }
      .unavailable .ItemSummary .CallNumber,.unavailable .ItemSummary .LabelCallNumber{
        display:none;
      }
     8 - Note the branches are hidden, and callnumbe rhidden for unavailable
    items
    
    Signed-off-by: Jessica Zairo <jzairo@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d8159b61f592774696c25338878c49c77718318f
Author: Mehdi Hamidi <mehdi.hamidi@inlibro.com>
Date:   Fri Mar 3 14:33:29 2017 -0500

    Bug 7611: Show the NOT_LOAN authorised values for item status in XSLT OPAC search results
    
    Added : Call number for all not for loan status
    
    XSLT Results template improvement : Use the NOT_LOAN authorised values
    
    Improvement : Use the NOT_LOAN authorised values when showing items status in the OPAC search results.
    Before this patch, these items were only considered as "unavailable".
    
    Note : This patch only affects the OPAC XSLT search results template for MARC21 records. This patch was not tested on UNIMARC or NORMARC records. I won't be able to support these formats, so I'm hoping someone could do the same for these other record formats.
    
    Sponsored-by: CCSR ( http://www.ccsr.qc.ca )
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 94393690ef6a17d70890bde445b3ef1c700cb06d
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jan 6 16:26:33 2020 +0000

    Bug 15850: Correct eslint errors in cataloging.js
    
    This patch makes corrections to cataloging.js so that there are no
    issues flagged by eslint. The fewer eslint warnings we have to see makes
    it more likely that real problems will be noticed.
    
    Some functions were unused have been removed.
    
    To test, apply the patch and clear your browser cache if necessary.
    
     - Open a MARC record for editing in the basic cataloging editor.
     - Test the JavaScript-driven functionality affected by the changed
       file:
        - Open the authority browser from a field (e.g. 100a) which is
          linked to an authority type.
        - Clone a repeatable tag.
        - Clone a repeatable subfield
        - "Unclone" a tag or subfield: This should remove the tag or
          subfield (if possible) or clear the contents of the tag or
          subfield if not.
        - Clone a subfield on the item edit page (In my MARC21 installation
          I had to modify the default framework in order to have a
          repeatable item subfield to test with).
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 82716a01727f143ba2c167cd86233a531f330390
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 19 20:54:40 2019 -0500

    Bug 23084: Replace grep {^$var$} with grep {$_ eq $var}
    
    We certainly faced 3 similar bugs due to this syntax: bug 23006, bug
    22941 and bug 17526.
    
    To prevent other issues related to this syntax this patch suggests to
    replace them all in one go.
    
    Test plan:
    Confirm that the 2 syntaxes are similar
    Eyeball the patch and confirm that there is no typo!
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8aec7aa5fa7e5c2e7921cf9e0e8ec06961fa80af
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Feb 17 10:43:37 2020 +0000

    Bug 20882: DBRev 19.12.00.022
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5a685aa78fda1c8b3693da5fbb846b2e50f21475
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 10 14:28:51 2020 +0000

    Bug 20882: Move items.uri to mediumtext
    
    Applies to items and deleteditems.
    
    Test plan:
    Run new install or upgrade. Check field size.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 932596cc479f637ed276d10b5a012b915da91e9e
Author: Andreas Jonsson <andreas.jonsson@kreablo.se>
Date:   Fri Jan 24 10:13:05 2020 +0000

    Bug 24506: Multibranch limit does not work with ElasticSearch
    
    Test plan
    1. Set up a system with ElasticSearch
    2. Set up or make sure ther are at least two branches
    3. create a group of branches
    4. make sure there are items associated with any library in the group
    5. make a search in opac limited by the library group
    6. make an advanced search in intra limited by the library group
    7. change SearchEngine system preference to Zebra and repeat 5. and 6.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6fcbf109d6e0139d9379e52c6b6abf3c11f3f7f8
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Feb 10 15:17:38 2020 +0000

    Bug 13574: Fix display of repeatable item subfields
    
    Applies to OPAC and staff: opac-MARCdetail and catalogue/MARCdetail.
    
    Test plan:
    [1] Pick an item. Pick two fields say URI and copy number, and fill these
    with a value like A | B. (The pipe char is important.)
    [2] Verify that the display of the item block on opac-MARCdetail shows
    both A and B in those columns. (Previously only B was shown.)
    [3] Verify the same on catalogue MARC detail, items tab.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Holly Cooper <hc@interleaf.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7383bf3959cfd0381fa455736993ef80dde9c55c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 13 09:27:26 2020 +0000

    Bug 24649: Fix two other missing <li> tags for cloned subfields
    
    Same problem as previous patch in Batch item modification as well as
    serial-edit.pl.
    
    Test plan:
    [1] Go to Tools/Batch item modification.
        Test cloning subfield on batchMod-edit.
    [2] Go to a serial with "Create item when receiving".
        Receive an issue. Click add item.
        Test cloning subfield.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 46b5849f30c102177033e349c5cda791b5d66f0e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Feb 13 08:56:35 2020 +0000

    Bug 24649: Fix missing <li> tag on item editor for cloned subfield
    
    Instead of the parentNode (which is a div), we need the parent of the div
    (which is a li).
    So a simple fix.
    
    Test plan:
    To see the difference, test first without patch applied:
    Mark item subfield, say URI, as repeatable.
    Clone that subfield in item editor.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Aleisha Amohia <aleishaamohia@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7c9680749fa3a56ee65e823b318b22876a95edce
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 21 12:57:01 2020 +0100

    Bug 22898: Fix failure since bug 19618
    
    See comment in the code, this is not the correct fix, but cannot find
    something better for now.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 25aad587d2b8789f171e3f3093362d1856f388ea
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 21 12:56:22 2020 +0100

    Bug 22898: Since bug 23957, submit element is now a button (no longer input)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f1378a537e73c05783082725f203b4cb1eeec596
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 13 11:31:14 2019 -0500

    Bug 22898: Add selenium tests placing holds (staff)
    
    Quick selenium tests to prevent regressions like bug 22895.
    
    Test plan:
    Make sure the selenium tests return green
    
    You can also test the buggy branch:
    % git checkout v18.11.05
    % prove t/db_dependent/selenium/basic_workflow.t
    => Failure
    % git bz apply 22895.
    % prove t/db_dependent/selenium/basic_workflow.t
    => Success
    
    Signed-off-by: Victor Grousset <victor.grousset@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d1a0921fd106bc910fff2fed74344bbad4d33f55
Author: Magnus Enger <magnus@libriotech.no>
Date:   Wed Jan 29 23:59:44 2020 +0100

    Bug 24531: Fix OAI-PMH sets for records with repeated fields
    
    Currently, an OAI-PMH set mapping will only match if the value it
    is looking for occurs in the first instance of a repeated field.
    
    To test:
    - Apply the first patch with two new tests
    - Run something like this:
      sudo koha-shell -c "prove -v t/db_dependent/OAI/Sets.t" kohadev
    - Verify that the last test fails
    - Apply this secind patch
    - Rerun the test file above
    - Verify that all tests now pass
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3a49e02a5d184a7be800df3e6d0037584fdf3251
Author: Magnus Enger <magnus@libriotech.no>
Date:   Wed Jan 29 23:56:32 2020 +0100

    Bug 24531: Test for OAI-PMH sets and repeated fields
    
    This patch adds two tests related to OAI-PMH sets. It creates a
    dummy record with a repeated field, with different values. It then
    tests if the record is caught by mappings that match the value in
    the first field, and then if it is caught by mappings that match
    the second field.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2e60c553ba42e61c8ad321c3625e6d291e9c13d
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri Feb 14 09:46:01 2020 +0100

    Bug 24661: Fix inclusion of locale-related javascript files
    
    2 js files (Gettext.js, i18n.js) + 1 generated js file (locale_data.js)
    were added by bug 21156. Their URL are broken and the files are not loaded.
    
    Use Template::Toolkit plugin Asset to include these files, and exclude
    locale_data.js when language is english, because obviously translations
    are not needed in this case.
    
    Test plan:
    1. Just make sure the files mentioned above are loaded correctly when in
       English and in other languages as well
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 97b84b631f13b6b4a024b39cf928c11ae3dc6b88
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Feb 14 11:42:54 2020 +0000

    Bug 21156: (RM follow-up) Correction to added filters
    
    These lines required url filters rather than uri filters, my mistake :(
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d417d4a6fccf5d871a389ce13cd1d283ce1deee
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Feb 14 10:59:20 2020 +0000

    Bug 15352: (RM follow-up) Add missing filters
    
    Damn, I missed a case in the first followup!
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0c2d158497b379058db62cccca9d7131377a1d4a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Feb 14 09:48:48 2020 +0100

    Bug 15352: Do not display the link if item.uri does not exist
    
    Otherwise there is a "Link to ressource" that points to the current url
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e6550fd751dc7e73c8e6bfd83043bfde23f4d634
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Feb 14 08:38:56 2020 +0000

    Bug 15352: (RM follow-up) Add missing filters
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c0808108b42127a5c84026ea51f945ec9de81f22
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Thu Feb 13 00:37:43 2020 +0000

    Bug 15352: Use URLLinkText instead of URL for item links
    
    Use the value in URLLinkText in 952$u, or if not set, use 'Link to
    resource'.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f9abd7d2ef583ee6658c55aa1e342816ce303ce9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 13 16:00:35 2020 +0000

    Bug 24592: DBRev 19.12.00.021
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b9ecf361a82511a09b5487af0efd7f0d50a2b43e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 5 11:54:20 2020 +0000

    Bug 24592: Reword LOST_RETURN to LOST_FOUND
    
    This patch updates the wording in the 'lost and found' process to more
    closely reflect what the process is achieving by replacing 'RETURNED'
    with 'FOUND'
    
    Test plan:
    1) Grep codebase for _FixAccountForLostAndReturned and note there are no
       longer any instanced of it.
    2) Run t/db_dependent/Circulation.t and note it passes
    3) Test returning/renewing an item that has been marked as lost and note
       the updated values in the accountlines now use LOST_FOUND as
       credit_type_code and 'FOUND' as the status for the 'LOST' fee
       (debit_type_code 'LOST')
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a5a75ddd0419fabc1108b5334210692b99c49934
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 5 12:19:34 2020 +0000

    Bug 24592: Database Update
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 913871e9b15a3aa6ef00b7a7da085f8b74b160c5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 13 14:24:52 2020 +0100

    Bug 24643: Add test to cover the timezone
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8aafd70ecab475f4f5d1f61a78b74221b8d7796c
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Wed Feb 12 16:28:58 2020 +0000

    Bug 24643: Add unit tests
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a8a9512ff671488c703be45fc3d9e92bbdc88b5c
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Wed Feb 12 16:04:07 2020 +0000

    Bug 24643: Support fractional seconds
    
    This patch allows dt_from_string to handle RFC3339 strings containing
    fractional seconds up to one thousandth of a second.
    
    Test plan:
    
    - Apply patch
    - prove t/DateUtils.t
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ac8d6074111103dec0028f68f2da4e8adbe7c663
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Feb 7 09:51:10 2020 -0300

    Bug 24611: Fix wrong budget_id query param in /acquisitions/orders
    
    This patch fixes the wrong query parameter that slipped on rewriting the
    patches for the voted RFC.
    
    To test:
    1. Apply the tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/acquisitions_orders.t
    => FAIL: Tests fail because fund_id is not a valid query parameter
    3. Apply this patch
    4. Repeat (2)
    => SUCCESS: Tests pass!
    5. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0433960ed8cb72be475f979cdd1f4401c70f2b20
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Feb 7 09:53:32 2020 -0300

    Bug 24611: Regression test
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f2b108638732f9ff42456a461af0e9f30ed2b679
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 13 10:29:56 2020 +0100

    Bug 24361: Silent Items/GetItemsForInventory.t
    
    It was displaying hundreds of:
    Use of uninitialized value in concatenation (.) or string at
    /kohadevbox/koha/C4/Items.pm line 862.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 531c5baaee90aabb5a90b2b2f99612586a4d6f72
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 13 08:30:00 2020 +0000

    Bug 19735: (RM follow-up) Update debian/control
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 794c18b8e6918ca93c5cf6c5ca12a957f80d3093
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 12 16:29:11 2020 +0000

    Bug 19735: Remove C4::Installer::PerlDependancies
    
    This patch does the actual removal of the PerlDependancies module.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d817b8e66c59b109b73c17266ce223cbbed94aa
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 12 16:28:15 2020 +0000

    Bug 19735: (RM follow-up) Final update of cpanfile at push
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 357078b0aba74ad2bb1a99d6a2241f5fa9b20cd5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 12 12:46:34 2020 +0100

    Bug 19735: Update cpanfile
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cc595325d6dc7f5bbf398357cacaf490e40794f8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Feb 7 16:51:33 2020 +0000

    Bug 19735: Add support for max_ver
    
    This patchset adds support for extracting 'max_ver' from the cpanfile so
    we can use version ranges properly and report errors if we have modules
    installed that do not fit within that version range.
    
    Test plan:
    1) Manually modify the module version of a required module in the cpanfile
       to have a max version greater than the version you have installed.
    2) Run through the install proceedure and note the new warning that a
       module needs upgrade for the module in question.
    3) The module should also be reported in the about page
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit faa89f406d524b65accf0e101746f87ca53ad63e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Feb 7 16:59:44 2020 +0000

    Bug 19735: (QA follow-up) Drop references to 'usage'
    
    The 'usage' key was dropped as part of this migration to cpanfile but
    it was still refered to by the installed. This patch simply removes
    references to it. After considering how we might add it back in I
    decided that as it stands it wasn't a well maintained list and should be
    re-implimented in the future in a more consistent form if we miss it.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a34d086a24b1e4519f8b31331d4c42b87b8e4a83
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Oct 26 16:28:02 2017 +0000

    Bug 19735: Move Perl deps definitions into a cpanfile
    
    cpanfile is a format for describing CPAN dependencies for Perl
    applications.
    It is more concise - thus easier to read and maintain - than
    C4::Installer::PerlDependencies, and allows to describe requirements
    more accurately (using version ranges or features for instance)
    Additionally it can be read by tools such as cpanm or carton for an
    easy way to install dependencies on non-Debian-based systems.
    
    For more information on cpanfile, see
    http://search.cpan.org/~miyagawa/Module-CPANfile-1.1002/lib/cpanfile.pod
    
    This patch replace C4::Installer::PerlDependencies by an equivalent
    cpanfile and update all scripts/modules that were using PerlDependencies
    It also removes dead code from C4::Installer::PerlModules (some
    subroutines were not used at all, except in unit tests)
    
    Added dependencies:
     - Module::CPANfile
     - CPAN::Meta (dependency of Module::CPANfile, but we need a more recent
       version than the one Module::CPANfile requires)
    
    Test plan:
      1. Go to About page, tab Perl modules and keep this browser tab open
      2. Apply patch
      3. Install Module::CPANfile and CPAN::Meta
        a. On Debian-based systems:
           # will install libcpan-meta-perl as a dependency
           sudo apt install libmodule-cpanfile-perl
        b. Others:
           # will install CPAN::Meta as a dependency
           sudo cpanm Module::CPANfile
      4. In a new browser tab, go to About page, tab Perl modules and compare
         the table with the one in the previous browser tab
         They should be identical, except for newly added dependencies
         (Module::CPANfile and CPAN::Meta)
      5. Do a 'standard' install
        a. perl Makefile.PL (select 'standard')
        b. make
        c. sudo make install
        d. Configure your database, web server, ... and go through the web
           install process
      6. Verify that the cpanfile got copied into PERL_MODULE_DIR (which
         should be /usr/share/koha/lib)
      7. Go to the about page of this fresh install and compare it with your
         dev install
      8. Verify that debian/list-deps still works
         This takes a lot of time and it may not be necessary to wait until
         the end. If you see some Debian package names that correspond to
         modules in cpanfile, it means it still works
         (you need apt-file for this script to work)
      9. Verify that koha_perl_deps.pl still works
     10. prove t/Installer_pm.t t/Installer_PerlModules.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f9dd77cfab2c02ce7644a454612b40ec3b5627aa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 12 15:24:35 2020 +0100

    Bug 24642: Make Cache::Memcached::Fast::Safe required
    
    There is something wrong between the logic in Koha::Cache->new and our
    dependencies.
    
    We are having Cache::Memcached required, but
    Cache::Memcached::Fast::Safe is optional.
    However, in Koha::Cache->new we are initializing the Memcached cache
    only if Cache::Memcached::Fast::Safe is installed.
    
    We could fix the logic in Koha::Cache, but it seems better to make
    Cache::Memcached::Fast::Safe mandatory (especially after bug 13193).
    
    Note that after bug 13193, you are loosing the Memcached cache, as
    Cache::Memcached::Fast::Safe will not get installed by default.
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87e4ecacc525308aed137f5ec3458df32ab8b0dd
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Fri Jan 3 17:35:20 2020 +0000

    Bug 24340: allow koha-sip --disable inst
    
    To test:
    
    - Enable sip for your testing instance
     sudo koha-sip --enable inst
    - Start sip for your testing instance
     sudo koha-sip --start inst
    - Verify it is running
     ps ax |grep sip -> you should see processes
    - Disable sip for your testing intance
     sudo koha-sip --disable inst
    - Verify that the following has happened:
     * SIP is no longer running for your instance - no SIP processes
     * SIP Cannot be started for the instance because it is not enabled.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c8fbb4900015604d15ae8c13d74730e5bc984868
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 11 16:40:04 2020 +0000

    Bug 19014: (QA follow-up) Update test for AddReserve change
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c2d3a60566c672a65a3f8e4ad75d2530cb0d2d3d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Feb 11 13:18:10 2020 +0000

    Bug 19014: on_reserve blocks auto_renew
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 51f5f6ca49560a9ef035a35163ca8d8e82a9d4f5
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Feb 11 12:46:42 2020 +0000

    Bug 19014: Return auto_too_soon before on_reserve
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 96e779d952ae492a1c82fa3addf8553f111fc6b5
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Dec 30 19:27:26 2019 +0000

    Bug 19014: Unit tests
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a6b359ccbb9485aa89814c95a3c873be558ae96c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 11 16:44:07 2020 +0100

    Bug 8643: Fix IsMarcStructureInternal tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fb6926886217de42b1b30bd16d5508924b1b866b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 11 14:36:55 2020 +0000

    Bug 8643: DBRev 19.12.00.020
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1547e7c9921b78204a79e124c32453089bb5f963
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Mon Jan 13 11:21:09 2020 -0500

    Bug 8643: Code cleanup
    
    Merges "AreMandatoriesNotOk" and new "AreImportantsNotOk" into one
    function "AreFieldsNotOk". It can search for mandatory or important
    fields depending on the value of it's boolean "mandatory"
    parameter.
    
    To test:
    This patch should not change current behavior.
    Follow the test plan from previous patch and check that saving is
    still prevented for unfilled mandatory fields.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 339c27ca807de2966101ec9d2cafc30dccdea332
Author: Simith D'Oliveira <simith@inlibro.com>
Date:   Fri Dec 18 11:40:02 2015 -0300

    Bug 8643: Add important constraint to marc subfields
    
    This fix permits to add an "Important" option to the marc structure pages.
    
    Testing:
    
    1) Apply the patch
    2) Run updatedatabase.pl
    3) Regenerate CSS
    4) Define 100 as an "important" field ( Administration » MARC bibliographic framework » MARC structure ( Default Frameword) » Edit )
    5) Define 100$a as an "important" subfield (Administration » MARC bibliographic framework » MARC structure (Default Frameword) » Subfield » Onglet a)
    6) Edit a record to clear the field 100 (subfields are all blank)
    7) Save the record.
    8) Validate the following message:
    
    A few important fields are not filled:
    
        * tag 100 subfield a Nom de personne in tab
        * Field 100 is important, at least one of its subfields should be filled.
    
    Are you sure you want to save?
    
    Sponsored by the CCSR ( http://www.ccsr.qc.ca )
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 11b44869d95c47a7e6daec8dcb124762a9ee0026
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Aug 16 14:41:37 2018 -0300

    Bug 14711: Change prototype for AddReserve - pass a hashref
    
    The number of parameters of AddReserve makes it hard to read and
    maintain.
    This patch replace it with a hashref, which will make the calls more
    readable.
    
    Moreover the bibitems has been removed as it was not used by the
    subroutine.
    
    Test plan:
    - Make sure the tests pass
    - Read the diff and search for typos
    - Place a hold on few items
    
    Note for QA: reservation_date and expiration_date do not match the DB column's names,
    should we?
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 987cbc606a1b46c418e7e19eba2f23f63abefbf3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Feb 10 14:13:04 2020 +0000

    Bug 21156: (RM follow-up) Add missing filters
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b4f7dd50de9b2dfe659a0b7e90d3870fc6e75d98
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Wed Feb 5 01:04:52 2020 +0000

    Bug 24585: Add 'Managed on' and 'Suggested on' columns to pat_purchase_suggestions.tt
    
    This patch adds 2 new columns on the suggestions table on purchase-suggestions.tt. These use the data-order attribute to allow for sorting.
    TEST PLAN:
    1. Have a patron with some suggestions that have been managed by staff. (accept or reject the request).
    2. View that patrons suggestions from purchase-suggestions.pl.
    3. No suggested on or managaed on columns.
    4. Apply patch and reload the page.
    5. The new columns are there, have multiple suggestions and make sure sorting by the date works.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9d6ec5c64bd2d11cd143dfb357377e48237cb229
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Jan 4 21:08:29 2016 +0100

    Bug 21156: Add plural translation capabilities to JS files
    
    It adds Javascript equivalent of Koha::I18N's exported subroutines, and
    they are used the same way.
    
    String extraction is done only on *.js files and require gettext 0.19
    (available in Debian jessie, and also in wheezy-backports)
    
    It adds Javascript library Gettext.js for handling translation and a
    Perl script po2json to transform PO file into JSON.
    
    Gettext.js and po2json both come from Locale::Simple.
    There are several tools named po2json. It's simpler to integrate this
    one into Koha than to check if the good one is installed on the system.
    Locale::Simple is not needed.
    
    To avoid polluting the global namespace too much, this patch also
    introduce a global JS object named Koha and add some stuff in Koha.i18n
    
    Test plan:
    1. Add a translatable string in a JS file. For example, add this:
         alert(__nx("There is one item", "There are {count} items", 3,
         {count: 3}));
       to staff-global.js
    2. cd misc/translator && ./translate update fr-FR
    3. Open misc/translator/po/fr-FR-messages-js.po, verify that your
       string is present, and translate it
    4. cd misc/translator && ./translate install fr-FR
    5. (Optional) Verify that
       koha-tmpl/intranet-tmpl/prog/fr-FR/js/locale_data.js exists and
       contains your translation
    6. Open your browser on the staff main page, change language and verify
       that the message is translated
    7. Repeat 1-6 on OPAC side
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Works well, translation is OK and test message is displayed correctly.
    Current qa-tool error is a false positive.
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 17400198f02f30ec5ad2710efe6f10a950a96879
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 6 11:33:12 2020 +0100

    Bug 24526: Add the confirm flag to the cronjob files
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 27cc2d6a33619e34cf316a95c1633b3ded31fa75
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 5 16:05:19 2020 +0100

    Bug 24526: Set verbose if confirm not set
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 02275b8205f2c78d6754582b0278fe22524b8c1e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 5 16:03:42 2020 +0100

    Bug 24526: Replace commit with confirm
    
    Usually commit takes a value
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2dc6ef96312c9c2649719289c8e71466441a8da4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 5 16:02:25 2020 +0100

    Bug 24526: Use sprintf for readability
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aa9ad782ced801981242504d417348b31fa9f8d8
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jan 29 13:48:09 2020 +0000

    Bug 24526: (follow-up) clean up verbose conditional
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6e0a4d18d4f5c996c18b719f020adcfb800368b8
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jan 28 14:27:06 2020 +0000

    Bug 24526: Add verbose and commit options to automatic_renewals cronjob
    
    To test:
     1 - Apply patch
     2 - Have some items marked for auto-renewal
     3 - Run the job with no parameters
     4 - It should print 'Test mode'
     5 - Provide -v
     6 - It should print 'Test mode' then a line for each item
     7 - Provide -v -c
     8 - It should not say test mode, but should provide a line for each item
     9 - Provide -c
    10 - Shoudl run as expected with no output
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1bcc2159a5c137c216f6afa759cb7da5f2f4a15d
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Aug 8 15:40:09 2018 +0200

    Bug 21177: Use koha-conf.xml in misc/devel/update_dbix_class_files.pl
    
    It is annoying to have to specify database connection parameters each
    time DBIx::Class files need to be updated.
    
    This patch adds a new option --koha-conf that takes an optional <path>
    which defaults to the value of KOHA_CONF environment variable, and use
    the database connection parameters found in that file.
    --db_* options override values from $KOHA_CONF
    
    Test plan:
    1. Run the script with the same parameters as before the patch and see
       that it still works.
       Example:
         misc/devel/update_dbix_class_files.pl --db_name koha_dev \
         --db_user koha --db_pass koha
    
    2. Verify that KOHA_CONF is set and execute:
         misc/devel/update_dbix_class_files.pl --koha-conf
       Verify that Koha/Schema files were updated accordingly
    
    3. Execute:
        misc/devel/update_dbix_class_files.pl --koha-conf \
        /path/to/another/koha-conf.xml
       Verify that Koha/Schema files were updated accordingly
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 013edd90e31a871c4125cee3d6f48fd25af40138
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Nov 22 19:29:53 2019 +0000

    Bug 11281: Printing holds awaiting pickup prints both tabs
    
    This patch adds columns configuration to the holds awaiting pickup
    tables. Doing so helps solve the printing issue by adding a "Print"
    option to both tables. Using this print function will provide a
    printable version of only that table.
    
    To test you should have multiple holds in your system which are marked
    "waiting" and some which have been waiting longer than the value
    specified in the ReservesMaxPickUpDelay system preference.
    
    Apply the patch and go to Circulation -> Holds awaiting pickup.
    
     - On both the "Holds waiting" and "Holds waiting over..." tabs the
       DataTable should display correctly and all the controls should work,
       including the columns settings and the choices in the export menu.
     - Confirm that the "Print" action creates a printable version of only
       the table you are viewing.
    
     - Go to Administration -> Columns settings -> Circulation.
     - Change some visibility controls for the tables under the
       "holds_awaiting_pickup" heading (id=holdso and id=holdst). Confirm
       that these changes are reflected in the "Holds waiting" interface.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit caf1578be6ff8b0a85be468ef17a41cbe1876418
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 20 11:29:11 2020 -0300

    Bug 24462: Adapt mapping to voted RFC (Invoices)
    
    This trivial patch changes the attribute names for API reprensentation
    of Koha::Acquisition::Invoice objects.
    
    To test:
    1. Open https://wiki.koha-community.org/wiki/Acquisitions_invoices_endpoint_RFC
    2. Check the mappings are correct
    => SUCCESS: The patch makes the right changes to the mappings
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 51e341b56d4f066bb8b21b8d50ba663e6d8a82f9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 6 15:37:38 2019 -0500

    Bug 22860: Remove 1 remaining patron after authentication.t is ran
    
    Test plan:
    0/ Do not apply the patch
    1/ select count(*) from borrowers;
    2/ Run the tests
    => Notice that you have 1 more patron
    3/ Apply the patch and repeat 1/ and 2/
    => Notice that you have the same number of patrons before and after the
    tests
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5ee37a812732ee3868d48ce75c5635fa53780e00
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 3 17:31:42 2020 +0100

    Bug 24516: Add account_type to the columns settings on boraccount
    
    The column was missing from the yml file.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 30005cd2eae316515dde179202e647bbd1b0ec83
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Jan 20 12:41:51 2020 +0000

    Bug 13305: Remove tabindex from PrepareItemsRecordDisplay
    
    Test plan:
    Check the tab order of the item block on additem.pl (item editor),
    Acquisition (neworderempty or addiso2709), serials-edit.pl.
    You could also check services/itemrecorddisplay.pl and pass a
    biblionumber; this script is used in additem.js for cataloguing and
    acquisition.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 125d8c2d8bf1e18e1b410d38b33970b9f407d46a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Feb 7 16:52:52 2020 +0000

    Bug 16719: (QA follow-up) Remove tabs
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit be7ca413fd3cc3f9fadf1f879440859ce5175c02
Author: Oliver Behnke <oliver.behnke@aei.mpg.de>
Date:   Fri Feb 7 12:35:21 2020 +0000

    Bug 16719: (follow-up) Update check on password mapping
    
    Change to allow for unmapped default passwords
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f514a37d8815310f1608948db05bc129794946cc
Author: Oliver Behnke <oliver.behnke@aei.mpg.de>
Date:   Fri Feb 7 12:31:31 2020 +0000

    Bug 16719: Pass through undef rather than empty string in LDAP mapping
    
    Nullable DB fields should be passed null in cases where ldap fields are
    empty and not replaced with empty strings.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9de9976cb279039a24749dc90853fee8330a0248
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Feb 10 09:15:51 2020 +0000

    Bug 24525: (QA follow-up) Make payment type required with cash registers
    
    The use of cash registers adds the requirement to enter a payment type,
    this patch adds the required status when cash registers are configured.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ed7c1b34533149b081d8b0e5bd320b40623bb136
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jan 28 14:05:35 2020 +0000

    Bug 24525: (follow-up) Factor out to an include
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a40912a507b69e3a11ff051d1e90e6dee52f7e5e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jan 28 14:05:35 2020 +0000

    Bug 24525: Remove SIP payment types from point of sale
    
    This patch removes the SIP payments types from displaying in the select
    options on the point of sale payment page.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2cdd913faa56a2a20283d89c371eba33b574424
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 14 10:50:24 2019 +0100

    Bug 23640: Flushing L1 on every SIP connection
    
    This patch flushes the L1 cache on each SIP connection
    (ie every invocation of process_request).
    
    This means each SIP connection will fetch values from the
    L2 cache (ie memcached) and persist the L1 cache (in Perl
    memory cache) only until a new SIP connection comes in.
    
    Without this patch, the L1 cache persists for the length
    of the server process, which means the L1 cache will become
    stale very quickly, which can lead to unexpected behaviour.
    
    Test plan:
    1. Enable IssueLog
    2. Start SIP server
        2a. change to Koha git directory
        2b. koha-shell kohadev
        2c. perl C4/SIP/SIPServer.pm /etc/koha/sites/kohadev/SIPconfig.xml
    3. Issue book via SIP
    
        perl misc/sip_cli_emulator.pl -a 127.0.0.1 -p 6001 -su term1 -sp term1 -l CPL --patron 1 --item 3999900000001 -m checkout
    
    4. Check action_logs for "CIRCULATION ISSUE <borrowernumber> <biblionumber>" line
    
        http://localhost:8081/cgi-bin/koha/tools/viewlog.pl
    
    5. Disable IssueLog
    
    6. Check in the book and then check it out again
    
        perl misc/sip_cli_emulator.pl -a 127.0.0.1 -p 6001 -su term1 -sp term1 -l CPL --patron 1 --item 3999900000001 -m checkin
        perl misc/sip_cli_emulator.pl -a 127.0.0.1 -p 6001 -su term1 -sp term1 -l CPL --patron 1 --item 3999900000001 -m checkout
    
    7. Check action_logs for "CIRCULATION ISSUE <borrowernumber> <biblionumber>" line
    
        http://localhost:8081/cgi-bin/koha/tools/viewlog.pl
    
    8. Note results
    
    Without the patch, you'll see a 2nd checkout.
    
    With the patch, you won't see the 2nd checkout.
    
    (Note: After applying the patch, you have to restart the SIP server.)
    
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dfe3d784454310f4a7bef7da6bec50a074abf482
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jan 27 14:56:35 2020 +0000

    Bug 24482: Fix for formatted price issue with value over 1000
    
    This patch for the point of sale feature fixes an issue where items for
    purchase with a value of $1,000 or more break the payment calculations.
    
    Test plan:
    1) Enable the point of sale feature
       (EnablePointOfSale + UseCashRegisters system preferences)
    2) Add a cash register for a library
       (Home > Point of sale > Cash registers > New cash register)
    3) Create a purchase item with a cost of $1000
       (Home > Point of sale >  Purchase items > New debit type)
    4) Go to to the point of sale page and attempt to sell one of your items
       (Home > Point of sale > click 'Add' next to the item to purchase)
    5) Note that Koha inserts a comma into the price in the list of items for
       purchase
    6) Note that the 'Amount being paid' changes to 0.00 instead of $1,000,
       which affects the other calculations
    7) Apply the patch
    8) Repeat step 4
    9) Amount being paid and other calculations should now be correct
    10) Enter an amount for 'Collected from patron' and click 'Confirm'
        check that the change calculation is correct.
    11) Sign-off the patch!
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d31ee5980b2a52db6d1c60d9dd744f4584df3e40
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Feb 6 11:10:39 2020 -0300

    Bug 24602: Make get_onshelfholds_policy fallback to 0
    
    The onshelfholds circulation rules values are more of an ENUM type (as
    opposed to other rules with integers like max*qty). In the
    quantities cases, it makes sense to have undef mean unlimited. In the
    enum type it is clearer to just set a default value (0) as the code
    already expects (Note: undef and 0 both eval to false so there's no
    behaviour problem, but warnings or we get forced to check for
    defined when the rule is used. It seems trivial to just make the
    rule fallback to a chosen default value).
    
    This patch makes it fallback to 0.
    
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/CirculationRules.t \
               t/db_dependent/Reserves.t
    => FAIL: CirculationRules.t fails and Reserves.t prints a warning
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests pass! No warning!
    4. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 661e598d7035fe74b25e2d7ceef338fba38aa18d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Feb 6 11:09:12 2020 -0300

    Bug 24602: Tests for get_onshlefholds_policy
    
    Ths patch introduces tests for get_onshelf_policy.
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/CirculationRules.t
    => FAIL: Tests fail because the current code returns undef instead of 0
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 99e2fbd0832bee58e84724cd19b74e683d10520f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Feb 7 14:32:13 2020 +0000

    Bug 13193: (RM follow-up) Remove Cache::Memcached::Fast from PerlDependencies
    
    We replaced this module with Cache::Memcached::Fast::Safe and so do not
    need to depend upon it any longer.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bd4e4dcd85321637d1f14ed6e8b8a5a59e8a172a
Author: Mason James <mtj@kohaaloha.com>
Date:   Fri Feb 7 15:11:05 2020 +1300

    Bug 13193: (follow-up) Update debian/control file
    
    The dependancy has now been packaged, this patch adds it to the debian
    control file for package installs.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 31f1a766256b145cd657d826ec3bc6333a938e50
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Mon Sep 16 10:26:01 2019 +0000

    Bug 13193: Make Memcached usage fork safe
    
    When a high enough number of forks try to access for example system
    preferences with Koha::Cache using memcached as backend the results of
    different cache requests get mixed up.
    
    The problem is fixed by using Cache::Memcached::Fast::Safe that is a
    fork safe version of Cache::Memcached::Fast.
    
    Sponsored-by: The National Library of Finland
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    
    Works as described, and solves an insidious difficult to debug
    problem in Koha.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d5e993ed47400206519bfe74df79e9254f1175fe
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jan 31 09:06:51 2020 -0300

    Bug 24554: Only embed relations from Koha::Biblio in to_api
    
    This patch simplifies the behaviour of Koha::Biblio->to_api. It was
    designed with the idea of handling possible methods that would be added
    to Koha::Biblioitem. But it had a weird fallback behaviour was
    highlighted by using it with bug 24528.
    
    On fixing it it become obvious that it was unnessessarily complex and
    that it was not worth. That's the reason there wasn't any test for it,
    as Koha::Biblioitem doesn't implement any extra methods.
    
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Biblio.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests pass!
    4. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bc94d7e659b1f2cba90633cdb9f725e02db049f3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 13 14:30:35 2020 +0100

    Bug 24410: Fix multi holds
    
    Bug 19618 replaces the call to placerequest.pl with a REST API /holds
    That is wrong as it does not support multi holds.
    
    Test plan:
    Confirm that prior to this patch you are not able to place a hold on
    several records at once, and that this patch fixes it
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cd99a034401ad2207569efbbeb77aadd635d6c7e
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Feb 5 21:13:22 2020 +0000

    Bug 13420: (QA follow-up): Fix typo itemdate -> itemdata
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0ecf7694eac802f29ea4786502b7bffaaad3a6bf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 6 08:56:44 2019 -0500

    Bug 13420: Fallback to the previous behavior if published date is not used
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 82f7f7f7d3f7c46d9f0c2c703683f5fddd4672ca
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Apr 28 22:53:55 2019 -0400

    Bug 13420: Sort "Serial enumeration" by published date
    
    So far the sorting on volume information is incorrect. It sorts by the
    string displayed in the cell, which may not have any logics.
    
    A better solution would be to use Kyle's suggestion, see comments 7, 8,
    but it will need much more work.
    
    This patch suggests to use the publication date to sort this column.
    Note: In the code there is a switch depending on the existence of
    items.publisheddate, but I do not think it is valid, this valid should
    always exist if the item is received (did I miss something?)
    
    Test plan:
    You need to have different existing subscription, using different
    numbering.
    On the detail page of the bibliographic record you should be able to
    sort the serials (tab "Holdings") by "Serial enumeration".
    The sort will now use the publication dates.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ea8363559b10def137f1f365888d99551d2605de
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Nov 2 06:39:28 2019 +0000

    Bug 23784: Show subtitle, number and part in course reserve list of records
    
    At the moment only the title will display in the course reserves
    details, but not the information from other title fields. For
    series with multiple volumes that can lead to confusing display.
    The patch makes use of the new include to display 245$abnp.
    
    To test:
    - Add mulitple records to a course reserce course
      Make sure you have some with different combinations of 245$b$n$p
    - Look at the course details in the OPAC
    - Verify only $a displays
    - Apply patch
    - Reload
    - Verify now the full information displays
    
    Depending on your installation, you might want ot check that the 245
    are correctly mapped and save the record once so the database
    fields are correctly filled.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 21594689e54abdf9b07669a0b1b35f204eb2bd1e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Feb 5 14:26:47 2020 +0000

    Bug 23673: DBRev 19.12.00.019
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 043a36e46a9dbf0c94bd01da1c02241c67d6360d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 5 09:47:47 2020 +0100

    Bug 23673: Set updated_on=time_queued on DB update
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5958836a570f396c16b4bd43072bcd16a2101cb4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 5 09:44:58 2020 +0100

    Bug 23673: Avoid sleep in tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5ac7f3690d274e93cd38ee441c480d4d9c597a52
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon Oct 21 19:18:55 2019 -0300

    Bug 23673: Add "Updated on" column to patron's notices
    
    This patch adds "Updated on" column to patron's notices tab. It also adds logic to C4::Letters to retrieve updated_on column.
    
    To test:
    
    1. Apply patches.
    2. Restart plack.
    3. Choose a patron and add a purchase suggestion.
    4. Change suggestion status.
    5. Open patron's notifications.
       CHECK => Messages table has now "Updated on" and "Time created" columns, and "Time" column is gone.
       SUCCESS => There is a message with status pending, with a "time created" that equals "updated on"
    6. Execute in the shell in Koha directory
       $ ./misc/cronjobs/process_message_queue.pl
    7. Open patron's notifications one more time.
       SUCCESS => The message changed status. Time created remained the same, and now "updated on" has the current timestamp.
    8. Resend the message and repeat sep 6.
       SUCCESS => Every time you change the status, time created remains the same and updated on updates.
    9. Run `prove t/db_dependant/Letters.t`
    10. Sign off
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 76c0a06728ec73504983f4e1e52b6add0a37a0e1
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon Oct 21 17:29:44 2019 -0300

    Bug 23673: Change DB Structure
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eedb6ce233443c5c2af4d4352c5374f293b88ac3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 5 14:29:44 2020 +0100

    Bug 24595: Silent warnings from Circulation.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4668a31dc5a43dc32e8535dac03fd8d8f4bb9010
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jan 17 14:29:42 2020 +0000

    Bug 24449: Add too_many_overdue to patron status for SIP
    
    To test:
    1 - Have sip running and use the cli to get info for a patron
        example: perl misc/sip_cli_emulator.pl  -a localhost -p 6001 -su koha -sp koha -l CPL -m patron_status_request --patron koha
    2 - Checkout an item to the patron, backdated so it is overdue
    3 - Set syspref 'OverduesBlockCirc' to anything but "Don't Block"
    4 - Get the patron status via SIP, note circ blocked flag is set, but too_many_overdue is not
    5 - Apply patch
    6 - Restart all the things
    7 - Get the patron status via SIP
    8 - Note the too_many_overdue flag is now triggered and there is a message
        example: READ: 24Y     Y       00120200117    142716AEEdna Acosta|AA23529001000463|BLY|CQN|BV0.25|AFGreetings from Koha.  -- Patron has overdues -- Patron owes 0.25|AOCPL|
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 585001c6d3f18b4420f785778aab0889df43357b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 29 13:24:34 2020 +0000

    Bug 24529: Silence another uninitialised value warning
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1069bc240525f72d1e06bb9b78ef55fbec6dad2e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 29 13:18:20 2020 +0000

    Bug 24529: Silence warnings for title level holds
    
    This patch simply adds a test for itemnumber being defined in the
    reserve before comparing it to silence the warning.
    
    Test plan:
    1) Prior to patch, run prove t/db_dependant/Circulation.t and note lots
       of `Use of uninitialized value in numeric eq (==) at
       /kohadevbox/koha/C4/Reserves.pm line 790` warnings.
    2) Apply the patch, re-run the test and note the tests still pass but
       the warnings are now gone.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d88dfbf34e68849e0deed5543817decf6dfb19cb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Feb 5 10:36:14 2020 +0100

    Bug 24590: Fix Koha/Object.t on MySQL 8
    
    % prove t/db_dependent/Koha/Object.t
    is failing on MySQL 8 with:
    
     kohadev-koha@9bbf9ac68519:/kohadevbox/koha$ prove t/db_dependent/Koha/Object.t
     t/db_dependent/Koha/Object.t .. 15/18
         #   Failed test 'Exception field is correct'
         #   at t/db_dependent/Koha/Object.t line 650.
         #          got: 'api_keys.secret'
         #     expected: 'secret'
         # Looks like you failed 1 test of 16.
     t/db_dependent/Koha/Object.t .. 16/18
     #   Failed test 'store() tests'
     #   at t/db_dependent/Koha/Object.t line 723.
    
    MySQL 8 displays the tablename in the error.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9eaa4d9775fa64549ec9657f333914d671129acf
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Tue Jan 14 15:40:38 2020 +0000

    Bug 24420: Display waiting on hold items in the Cataloging search results Location column
    
    To Test:
    1. Place a hold on an item and trigger it.
    2  Do a cataloging search that would include this record.
    3. Notice that the 'Location' column does not account for this onhold
    item.
    4. Apply patch and look at catalog results again.
    5. You should see information display about the item being on hold.
    
    Signed-off-by: Barbara Johnson <barbara.johnson@bedfordtx.gov>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 445a97d8d27cb381ba6594bbe3848d35f741958d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Oct 18 18:26:38 2019 +0000

    Bug 23844: Check if field defined in framework and specify 'Default' for framework
    
    To test:
    1 - Go to Cataloguing
    2 - New from Z3950
    3 - Find an import a record
    4 - Check the plack logs:
    Use of uninitialized value in string ne at /kohadevbox/koha/cataloguing/addbiblio.pl line 565.
    Use of uninitialized value in string ne at /kohadevbox/koha/cataloguing/addbiblio.pl line 580.
    Use of uninitialized value $frameworkcode in string eq at /kohadevbox/koha/cataloguing/addbiblio.pl line 711.
    Use of uninitialized value $frameworkcode in string eq at /kohadevbox/koha/cataloguing/addbiblio.pl line 715.
    Use of uninitialized value $frameworkcode in string eq at /kohadevbox/koha/cataloguing/addbiblio.pl line 734.
    5 - Apply patch
    6 - Repeat
    7 - No new errors
    8 - Confirm selecting 'Default' from 'New from Z3950' dropdown also generates no errors
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8854a14fe7299bc9230a856d19f213dcb2308956
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Feb 4 14:16:26 2020 +0000

    Bug 22302: Make ITEMTYPECAT descriptions fallback to lib description if no opac description
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 724bd2e0550d8a61f7b5e0505b544cab52d655d9
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Feb 4 14:15:36 2020 +0000

    Bug 22302: Unit tests
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e2617342a156e58c3b59d6534842984c2f01df4
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jan 28 13:57:32 2020 +0000

    Bug 24485: Allow hold when some can be overridden
    
    The check to see if we can place a hold counts the number that we can override vs the number of items on the record.
    
    We cannot override if we already have a hold on an item, however, we don't count these to see if they plus
    the number of overrides equal the items on the record.
    
    To test:
    1 - Set max reserves to 2, allow 2 holds per recrod
    2 - Place 2 holds for a patron on some records
    3 - Find another record with 2 items
    4 - Place a hold on the first item, you will be notified about the limit but you can override
    5 - Attempt to place hold on second item, cannot be done, button disabled
    6 - Apply patch
    7 - Repeat
    8 - You can place the second hold
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c54163940d9fa1fb173ae236a1e093cc50cadba8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 4 16:05:49 2020 +0100

    Bug 23533: Remove spaces after/before the open/close parenthesis
    
    t/db_dependent/selenium/patrons_search.t is failing because of this change:
    
        #          got: 'Koha › Patrons › Modify patron <strong>fir's"tname</strong> \123 ❤ test_patron_1 ( iOVAoJj )'
        #     expected: 'Koha › Patrons › Modify patron <strong>fir's"tname</strong> \123 ❤ test_patron_1 (iOVAoJj)'
    
    We are adding space after and before the open/close parenthesis of the category code.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 86a0a7d80b71908582dfc40c981734c5828112fc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 4 16:00:21 2020 +0100

    Bug 18936: Fix selenium/administration_tasks.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a03815138b861a5894816e3c100e3a6daaaffb0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 4 15:59:01 2020 +0100

    Bug 18936: Display 'Unlimited' for Holds allowed (total)
    
    holds_per_day and reservesallowed are set to unlimited in the rules
    inserted by misc4dev
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c0f3170c44897a200cbf00d3e6026df6f152949c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 4 12:09:00 2020 +0100

    Bug 19008: Replace issues with checkouts in print statement
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 88315db11aeb9e567353e755616e169031eaef90
Author: Magnus Enger <magnus@libriotech.no>
Date:   Fri Aug 2 13:57:13 2019 +0200

    Bug 19008: More database cleanups - QA followup
    
    This patch tries to change the POD as suggested in the QA process.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 07968fc5f68d7bf7c3ae1674489cebab6bea3817
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jul 28 16:09:14 2017 +0200

    Bug 19008: More database cleanups - item transfers
    
    misc/cronjobs/cleanup_database.pl provides some database cleanup.
    Yet some tables that could need cleanup are not in this script.
    
    This patch adds cleanup for branchtransfers table.
    
    Test plan :
    - Count : select count(*),datearrived from branchtransfers group by datearrived;
    - Run cleanup : misc/cronjobs/cleanup_database.pl -v --transfers 30
    - Recount
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc7d7eece8c64a20305c6efc935128ce55b31f3a
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jul 28 16:01:51 2017 +0200

    Bug 19008: More database cleanups - old reserves
    
    misc/cronjobs/cleanup_database.pl provides some database cleanup.
    Yet some tables that could need cleanup are not in this script.
    
    This patch adds cleanup for old_reserves table.
    
    Test plan :
    - Count : select count(*),date(timestamp) from old_reserves group by date(timestamp);
    - Run cleanup : misc/cronjobs/cleanup_database.pl -v --old-reserves 30
    - Recount
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9b5ff17d79a61156426433bdd2e3c248e63d7431
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jul 28 14:57:33 2017 +0200

    Bug 19008: More database cleanups - old issues
    
    misc/cronjobs/cleanup_database.pl provides some database cleanup.
    Yet some tables that could need cleanup are not in this script.
    
    This patch adds cleanup for old_issues table.
    
    Test plan :
    - Count : select count(*),date(timestamp) from old_issues group by date(timestamp);
    - Run cleanup : misc/cronjobs/cleanup_database.pl -v --old-issues 30
    - Recount
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ca511ad957e090832dec4c4370180fd92bd331ae
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jul 28 14:43:45 2017 +0200

    Bug 19008: More database cleanups - deleted patrons
    
    misc/cronjobs/cleanup_database.pl provides some database cleanup.
    Yet some tables that could need cleanup are not in this script.
    
    This patch adds cleanup for deletedborrowers table.
    
    Test plan :
    - Count : select count(*),date(updated_on) from deletedborrowers group by date(updated_on);
    - Run cleanup : misc/cronjobs/cleanup_database.pl -v --deleted-patrons 30
    - Recount
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9ddb78f0d36910139a6dea4b0375a760f77d65c4
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jul 28 14:05:03 2017 +0200

    Bug 19008: More database cleanups - deleted catalog
    
    misc/cronjobs/cleanup_database.pl provides some database cleanup.
    Yet some tables that could need cleanup are not in this script.
    
    This patch adds cleanup for deleted catalog tables.
    Note that deletedbiblio_metadata is managed by foreign key on biblionumber.
    
    Test plan :
    - Count :
    select count(*),year(timestamp) from deleteditems group by year(timestamp);
    select count(*),year(timestamp) from deletedbiblio group by year(timestamp);
    select count(*),year(timestamp) from deletedbiblioitems group by year(timestamp);
    - Run cleanup : misc/cronjobs/cleanup_database.pl -v --deleted-catalog 30
    - Recount
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eae2dfce063e0b39046f3fffaa460441d2d79060
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jul 28 14:12:22 2017 +0200

    Bug 19008: More database cleanups - statistics
    
    misc/cronjobs/cleanup_database.pl provides some database cleanup.
    Yet some tables that could need cleanup are not in this script.
    
    This patch adds cleanup for statistics table.
    
    Test plan :
    - Count statistics : select count(*),date(datetime) from statistics group by date(datetime);
    - Run cleanup : misc/cronjobs/cleanup_database.pl -v --statistics 30
    - Recount statistics
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6ac19e02ed1349f93303a3f24b655f38bf70fa5d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 4 11:17:11 2020 +0100

    Bug 20708: Add Withdrawn status when placing a request in staff
    
    Same as bug 22021 for the withdrawn status.
    
    1. Withdraw an item
    2. Place an hold on this item
    Notice the new "withdrawn" status in the information column
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 127a92d8ab7dfe21fb216ba4dd6fa6be4ff77acf
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Feb 4 12:36:18 2020 +0000

    Bug 24569: (QA follow-up) Fix closing <a> tag
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5638a2f731e7d23df696fbb657d8ffdd46de8f49
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Feb 4 10:44:39 2020 +0100

    Bug 24569: Fix "add to basket" link (bug 23031 regression)
    
    The modal needs to be defined in both cases.
    
    Test plan:
    Repeat test plan from bug 23031 and click on the buttons!
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 14d1804652daf9c0b83139c3373f4cdaf46b5863
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 29 12:44:57 2020 +0100

    Bug 21466: Keep all AVs for a given framework
    
    There was a major (and silly) issue in the previous version, only one AV
    was kept as we erased the hash value at the end of each iteration:
    $invalid_locations_per_framework->{$framework->frameworkcode } =
      { items => $items, av_category => $mss->authorised_value, kohafield => $kohafield };
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87f20fd5fe7f4c67963498f42252bf09bf7a317d
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Nov 20 17:00:52 2019 +0000

    Bug 9993: On editing basket group delivery place resets to logged in branch
    
    This patch modifies basketgroups.pl so that existing data about a basket
    group's billing and delivery place are correctly preselected in the edit
    form. These fields shouldn't reset to the logged-in user's home branch
    just because they have an empty value.
    
    To test, apply the patch and go to Acquisitions -> Vendor -> Basket
    groups.
    
    When adding or editing a basket group the pre-selected value for
    "Billing place" and "Delivery place" should be correct:
    
       - When creating a new basket group: The logged-in user's library
         should be pre-selected.
    
       - When editing a basket group which has a library defined for either
         the billing or delivery places, the correct library should be
         pre-selected.
    
       - When editing a basket group which has no library defined for either
         the billing or delivery place there should be no library
         pre-selected (the "--" option should be pre-selected).
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1bddf5f3bab01ce2151ccefa8982134509e3fac3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Nov 19 17:02:02 2019 +0000

    Bug 10879: OverDrive should check for OverDriveLibraryID before performing search
    
    This patch modifies the OPAC search results template to check for three
    populated system preferences before performing an OverDrive search:
    OverDriveLibraryID, OverDriveClientKey, and OverDriveClientSecret.
    Previously OverDriveLibraryID was not checked, but without it the
    interface reports an error performing the search.
    
    To test you must have credentials for the OverDrive API as defined
    in OverDriveClientKey, OverDriveClientSecret, and OverDriveLibraryID
    system preferences.
    
     - With OverDriveLibraryID defined, the catalog search results page in
       the OPAC should show a link to results in the library's OverDrive
       collection.
    
     - With no value in the OverDriveLibraryID preference the catalog
       search page should not show any message about an OverDrive
       collection.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit db148eeff5b6e6fcfa5f7d0f47a3e43d0df5ea4e
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Sat Feb 1 16:42:10 2020 +0000

    Bug 24560: Remove No public list text from OPAC
    
    On the OPAC, the dropdown for Lists always includes
    the heading Public Lists, even if no public lists exist.
    This is sub-optimal for libraries that want VirtualShelves
    enabled for private lists but don't want to use public lists.
    
    TEST PLAN:
    1. have no public list and look at the List dropdown on the OPAC. It says No Public Lists.
    2. Apply patch
    3. It should now not say anything about public lists but still be formatted nice.
    4. Add some public lists and confirm that everything looks normal.
    5. Sign off
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0f6d55a0a13aa598f9da5543b72aecd40335eb89
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Dec 10 17:30:41 2019 +0000

    Bug 23533: (follow-up) Add markup comments
    
    This patch adds comments to the template to highlight the markup
    structure.
    
    This patch should have no effect on the interface or functionality.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 35635b98db9a25a8a63af6204bf490ab7b86dca3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Dec 10 16:34:56 2019 +0000

    Bug 23533: Reindent patron entry form (memberentrygen.tt)
    
    This patch re-indents the template for patron entry/editing. It
    makes only whitespace changes. It should have no effect on the behavior
    of the page.
    
    To test, create or edit a patron.
    
    Test every aspect of the process. At each step the page should work
    correctly. Including:
    
     - Adult patron
     - Child patron
     - Organizational patron
     - Quick patron add
     - Duplicate patron
     - With mandatory fields
     - With 'BorrowerUnwantedField's defined
     - With ExtendedPatronAttributes enabled
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d32f34d515f176738a6784576643580cbac36d2
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Mon Jan 27 15:41:32 2020 +0000

    Bug 24490: Clarify wording and function of Purchase Items link on POS
    
    This patch changes the wording of the links on the POS side menu
    
    To test:
    
    1) Apply the patch
    2) Check that the links on the left hand side of the screen read "Configure cash registers" and "Configure items for purchase"
    3) Click both links to ensure you are taken to the relevant config pages.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7c813d044119b055dd20b8ee9f0a68f163ce1c73
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 3 13:36:54 2020 +0100

    Bug 24440: Rename current_holds with current_item_level_holds
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4f4405174d9bd1a89433b2598b878ecf9057b2bb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 31 15:08:00 2020 +0100

    Bug 24440: Adding 2 more tests for ->biblio
    
    Not directly related to the other changes but seems good to have them
    here.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ffb5fb60ed3e8c5aeb534d60bf81bde80f309484
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jan 31 00:54:27 2020 -0300

    Bug 24440: (follow-up) Make related objects prefetchable
    
    This patch creates aliases for the relations used to retrieve the linked
    objects from other tables. It makes the accessor names match the used
    relation name, for consistency.
    
    This is important for code trying to be smart and guessing what needs to
    be prefetched, like the API code.
    
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Acquisition/Order.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests pass! No behaviour change
    4. Verify the POD changes make sense
    5. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a905fd8a3847ff4f035759aef575d8c6ad77fea2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jan 31 00:27:05 2020 -0300

    Bug 24440: ->biblio tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8829e8d21473486e29b7f4969165d201aa0a3c81
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 16 15:58:25 2020 -0300

    Bug 24440: Add ->current_holds to Koha::Acquisition::Order
    
    This patch introduces a method to fetch the current holds associated with the
    items linked to an order line. It basically implements what's done in
    parcel.pl, but fully tested and suitable for using on the API.
    
    To test:
    1. Apply this patches
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Acquisition/Order.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a567c990876d8d33a29e0b43c4f45940ddafd8b6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 16 15:58:15 2020 -0300

    Bug 24440: Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c5576eef0c252e8f9813ebc0df1f25e0e92b43b0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 23 14:06:06 2019 +0100

    Bug 24171: Check auto_renew if confirmation is needed
    
    Test plan:
    Add some fines
    Check auto_renew and check an item out, using a title keyword
    Pick one item
    You get the confirmation box
    => Notice that the auto_renew checkbox is checked
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 17cd229335ec9148a9d5f316e846f4bee01ccb1c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 17 12:10:28 2019 +0100

    Bug 24171: Preserve auto_renew when triggering itemBarcodeFallbackSearch
    
    The auto_renew parameter is not sent to the template when the popup
    triggered by itemBarcodeFallbackSearch is displayed.
    
    Test plan:
    - Turn on itemBarcodeFallbackSearch
    - Open a patron account
    - Check the checkboxes for automatic-renewal
    - Search for a title keyword in the checkout input box
    - Verify that auto-renewal flag is set
    
    Note for QA: The auto_renew flag will be set in any cases. Should we
    expect regression?
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 14fa7c112c9bfd685de7f062c732f8069aebb0ff
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Feb 4 10:08:50 2020 +0000

    Bug 18936: DBRev 19.12.00.018
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 845c1bae63d595506994dfe0f485d764d12bd48e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 3 16:45:27 2020 +0100

    Bug 18936: (QA follow-up) Fix failing test in api/v1/holds.t
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3e580599f0bc624ce5ed3531feb015144fac7fc2
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Mon Feb 3 15:25:09 2020 +0000

    Bug 18936: (QA follow-up) Fix failing test
    
    Using categorycode as a scope is not possible for any of these rules
    so lets remove it.
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dde8ea09fc187eed1dd23ed4b8bf922d3e8521b0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Feb 3 12:27:40 2020 +0100

    Bug 18936: (QA follow-up) Remove 2 new occurrences of Koha::IssuingRules
    
    Fix conflict with bug 13121
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 58e3c8e815956a017325fac2f44fe2eac4b649ce
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Mon Feb 3 10:20:17 2020 +0000

    Bug 18936: (QA follow-up) Convert remaining tests to use Koha::CirculationRules
    
    These two uses of Koha::IssuingRule were forgotten so this converts
    them to use the new Koha::CirculationRules object.
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2e9fde1bcd34a23817890178bf31969633fa837a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 31 16:45:55 2020 +0100

    Bug 18936: (follow-up) More fixes
    
    Previous "More fixes" patch added a debugging statement, not needed.
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 86bc36508f9b4582259f965eff908264db3023ca
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Fri Jan 31 10:51:36 2020 +0000

    Bug 18936: (QA follow-up) Add missing POD
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8fd9ff1730b321dc80ae92a127aced3187b2f43e
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Wed Jan 29 14:06:00 2020 +0000

    Bug 18936: (follow-up) Fix checkouts endpoint and its tests
    
    - Fixes a bug caused by the refactoring in
    Koha/REST/V1/Checkouts.pm (run the tests without this patch and you
    will see the tests fails because 'rule_name' parameter was
    forgotten).
    
    - Changes the tests to use the new Koha::CirculationRule objects
      instead of directly using issuingrules DB table
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d3d6df99b89b0e888d83391b3e687db59ddbb822
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Wed Jan 29 11:09:17 2020 +0000

    Bug 18936: (follow-up) Adjust circ rule related tests so that they pass
    
    Bunch of tests broke after moving from issuingrules to
    circulation_rules. This accomodates the tests for this refactoring and
    DB change.
    
    The itemtype did not exist in the DB. We create it at the beginning of
    the tests. Ideally we would like to create it filling the form.
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b0ccaaf8ef1f59b6c2f9634146bf7170aad39dc9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 28 16:47:39 2020 +0100

    Bug 18936: Fix IssuingRules/guess_article_requestable_itemtypes.t
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0401d13d2c2ae8335a95ea3dade63fd719ce8b47
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Tue Jan 28 15:05:15 2020 +0000

    Bug 18936: (follow-up) Make possible to have unlimited value for holds_per_day
    
    Without this it is not possible to make for a specific patron category
    or itemtype a more specific unlimited holds_per_day rule if you have a
    catch all rule (categorycode = *, itemtype = *) with limited
    holds_per_day value.
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 61628c97c245e72c750b61d9df6fa9b9100f3093
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Tue Jan 28 13:46:55 2020 +0000

    Bug 18936: (follow-up) Add cloning of circulation rules back to Koha
    
    The "Clone these rules" feature in admin/smart-rules.pl was
    dropped. This re-implements the cloning using Koha objects.
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d37a9366127644a06dd909dc91dfed046571937
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 27 10:13:44 2020 +0100

    Bug 18936: (QA follow-up) Fix inconsistencies in IssuingRules.t
    
    * get_effective_rule should not pass rule_value
    * indentation fix
    * add comment to list the rules we have when the test _is_row_match
    is executed
    * compare ->rule_name and ->rule_value returns
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 05cabe7b18a0aef9e7cfd7de432956bad758cae5
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Fri Jan 24 16:13:09 2020 +0200

    Bug 18936: (follow-up) Add missing import of Koha::CirculationRules
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1c187a1635f7f24f1f081e054698959edef75257
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Fri Jan 24 12:46:19 2020 +0200

    Bug 18936: (follow-up) Fix typo in documentation
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 533fd217dfa941795c146ca8127ab7a7cc2d226e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 24 14:54:45 2020 +0100

    Bug 18936: (follow-up) Add foreign key and scope enhancement to circ rules
    
    The previous patch modifies:
    -                categorycode => undef,
    -                itemtype     => undef,
    -                branchcode   => $branch,
    +                branchcode   => undef,
    
    But in that condition $branchcode is not '*' and so we should not set it
    to undef
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2879fb27f00d8a80e03d2b0c55f4a1fe24de9b0b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 24 12:19:07 2020 +0100

    Bug 18936: (follow-up) Fix the delete rule buttons
    
    The itemtype and categorycode were always set to '*'
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 790ee09c576bc1ee5ca218d327220861620386c1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 23 16:16:12 2020 +0100

    Bug 18936: Replace '*' with undef
    
    No test was provided initially so considering out of the scope for this
    one as well, but that's lacking terribly!
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e316de81b6903155fbc5d3f7488f44900d2a78e0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 23 16:01:13 2020 +0100

    Bug 18936: Insert default rules during the onboarding tool
    
    Those default values have been picked from bug 15522
    (Koha::CirculationRules)
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4072c2e3135f5f19722cbd0f6e4d6fb5a8373961
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 23 14:45:36 2020 +0100

    Bug 18936: (follow-up) Make sure we default to '*' if no rule exist
    
    Making sure the code is doing what we expect.
    Also this patch fix CirculationRules.t
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 47781d91df6434757a4b39adbd2181cc1b4b28fc
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Wed Jan 22 19:03:03 2020 +0200

    Bug 18936: (follow-up) Add missing circulation rule to fix tests
    
    The tests passed before by a chance because the default kohadevbox
    installation script added a issuing rule that had lengthunit =
    days. If you use a Koha version before the commits introduced by Bug
    18936 you can reproduce the Fees.t tests failing by deleting all the
    issuing rules from database with
    
    > delete issuingrules;
    
    and then running
    
    $ prove t/db_dependent/Koha/Charges/Fees.t
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 25848e5af3ecd77a1a16580aee671c5fb6da7fcb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 22 12:27:22 2020 +0100

    Bug 18936: Fix some more tests
    
    * CanItemBeReserved
    Prior to "Bug 18936: Convert issuingrules fields to circulation_rules",
    GetHoldRule returned holds_per_record even if no reservesallowed was
    defined. This change restores this behavior.
    FIXME Note: In GetHoldRule we return itemtype only if reservesallowed is set,
    not sure it is correct.
    
    * t/db_dependent/Holds/DisallowHoldIfItemsAvailable.t
    When setting returnbranch, holdallowed and hold_fulfillment_policy, we
    should not provide categorycode.
    
    * t/db_dependent/Holds.t
    Prefer to keep the existing rules instead of removing them. It got quite
    hard to understand what was going on here because of the mixup with
    the rule reservesallowed that was in issuingrules, and the other rules
    we used for the tests. Also, categorycode should not be passed to set
    those 3 rules (holdallowed, hold_fulfillment_policy and returnbranch)
    
    * t/db_dependent/Circulation.t
    Setting lengthunit to 'hours', no need to make sure the rule has been
    correctly be saved
    
    * t/db_dependent/Circulation/CalcDateDue.t
    It uses hardcoded data that is not in the sample data (categorycode=C).
    Let use K that exists and postpone a refactore of the whole script (to
    make it create the data it needs).
    
    * t/db_dependent/Circulation/ReturnClaims.t
    * t/db_dependent/Circulation/IssuingRules/maxsuspensiondays.t
    Simple replace Koha::IssuingRule with Koha::CirculationRules
    
    * t/db_dependent/Koha/Charges/Fees.t
    => FIXME Still failing, stuck here, need help
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e4dfe623d9b4db17beeb4b14ca329e503c99b225
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Wed Jan 22 10:58:37 2020 +0000

    Bug 18936: (follow-up) Don't retrieve unused issuing rule
    
    The chargename rule is not used anywhere in the code
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4ec3fe042dd272a7ef251417f1d9a45bd1a9ead8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 22 14:14:41 2020 +0100

    Bug 18936: Fix warning about page about wrong lengthunit
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e19c25fbad538716cc8e24e03d0aa0d554826cf4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 26 12:00:52 2019 +0100

    Bug 18936: fixes from comment #88
    
    - holds per day are not transferred in database update (actually not
    displayed)
    - in note column, I can see link "view notes" even if there is no note
    - No automatic renewal after (hard limit) does not respect dateformat
    and is shown in iso format
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7536a95692b014bda46409bffb0b20c091cfc6f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Aug 4 15:06:00 2019 -0500

    Bug 18936: Fix Update DB entry
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e5daedc4c77b2016520713d52b087d66518c35c7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Aug 4 14:31:04 2019 -0500

    Bug 18936: Add missing filters
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 72442dc8d29120d709710f6c6cba69cd48236766
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Aug 4 14:09:21 2019 -0500

    Bug 18936: More fixes
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da3f2eff5f7d8b4c725487a3e4d2d906be15d6ef
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 6 14:45:03 2019 -0300

    Bug 18936: Fix Circulation.t
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2894ac09c7bc93e61830815ee57ab2d7376b2e8e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 21 19:06:39 2019 -0300

    Bug 18936: Replace an other insert into issuingrules
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 51e000d6a4ce3ab0691b0e5e3d322d1555548cbe
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 21 17:50:29 2019 -0300

    Bug 18936: new holds_per_day
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7077bffdd9e8fd340189c9fcb0bae15a57318c95
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 21 17:49:21 2019 -0300

    Bug 18936: new suspension_chargeperiod
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2c293afea084fca7a95497be0eb48d1c191d5b8d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 21 17:46:37 2019 -0300

    Bug 18936: chargename removed by bug 21753
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c004887e33f760bdb08f72e90aaf8fbe1d8a252a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 7 15:18:20 2018 -0300

    Bug 18936: Fix several issues
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f7644cf30725c0a73d0d6f16f22f1aae2ad9cb85
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 6 16:54:39 2018 -0300

    Bug 18936: Fix syntax issue
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a10c961c67961e2d85fcd56c27e8087255e5263c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 6 16:32:04 2018 -0300

    Bug 18936: Remove last bit of Koha::IssuingRule
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f4a9900e4f5a08e1665fdb3cebb7b3e6a592da2f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 6 16:27:50 2018 -0300

    Bug 18936: Move guess_article_requestable_itemtypes method
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6804451334b32f1ed6797815e59f7f77f1714ee1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 6 16:21:06 2018 -0300

    Bug 18936: move get_opacitemholds_policy method
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1c43a26525730df93a2f0855147e123f5f4476bd
Author: Jesse Weaver <pianohacker@gmail.com>
Date:   Mon Feb 26 12:17:16 2018 -0700

    Bug 18936: (follow-up) Fix tests, replace old get_onshelfholds_policy method
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5712ec566f46b007d610c0d7cbdc40d43c444d24
Author: Jesse Weaver <pianohacker@gmail.com>
Date:   Mon Jan 29 15:54:40 2018 -0700

    Bug 18936: (follow-up) fix tests, null vs. empty behavior for limiting rules
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 14c7a00d4ac56ba9c1a15275963048c2113b5a48
Author: Jesse Weaver <pianohacker@gmail.com>
Date:   Mon Jan 29 13:44:43 2018 -0700

    Bug 18936: (follow-up) Remove issuingrules from kohastructure.sql
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f541228579940272ad31974c9122a8bbd982c6d9
Author: Jesse Weaver <pianohacker@gmail.com>
Date:   Tue Oct 17 17:26:31 2017 -0600

    Bug 18936: (follow-up) fix rental discount lookup
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18570614c404b662078a81cc0928e4807806bfc6
Author: Jesse Weaver <pianohacker@gmail.com>
Date:   Fri Oct 6 13:20:01 2017 -0600

    Bug 18936: (follow-up) Update REST definition for /.../kinds
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f2dfa17f0e7b3e6e1a035af18a16b0378a1b16f2
Author: Jesse Weaver <pianohacker@gmail.com>
Date:   Thu Sep 14 13:32:26 2017 -0600

    Bug 18936: (follow-up) Add foreign key and scope enhancement to circ rules
    
    This necessitates moving the circ rules from using '*' to using
    undef/NULL.
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a957114bd13e3876af2f3f9b5f1ca85aca0d0dfd
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 17 16:21:56 2017 -0300

    Bug 18936: Fix api/v1/holds.t
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40d8a72a9d80b1c536acdaf347155a07a2b6f299
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 17 16:04:51 2017 -0300

    Bug 18936: (follow-up) Fix upgrade step
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 58fda20e8541c59d1886c6798063376b1c150c05
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jul 13 10:03:54 2017 -0400

    Bug 18936: Convert issuingrules fields to circulation_rules
    
    Signed-off-by: Minna Kivinen <minna.kivinen@hamk.fi>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 65024825c5b1effbbc780a47b8e96f90c8d04250
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 31 11:37:55 2020 +0000

    Bug 21674: (RM follow-up) Fix updatedatabase error
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 268f03d34b370633a801142a62525bf8ca53c520
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 30 15:38:26 2020 +0100

    Bug 24546: Fix intentions of build_sample_item in Club/Hold.t
    
    In t/db_dependent/Koha/Club/Hold.t:
    my $item1 = $builder->build_sample_item({ branchcode => $library->branchcode });
    my $item2 = $builder->build_sample_item({ branchcode => $library->branchcode });
    
    build_sample_item takes either "library" or the item's attributes.
    branchcode is not part of the item's table, so what those 2 lines are trying to acchieve is wrong.
    
    Test plan:
     % prove t/db_dependent/Koha/Club/Hold.t
    must return green before and after this patch
    
    Note that this patch also remove an uneeded debugging statement.
    
    This has been caught by bug 24363.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 82c8542cb6493c9d2ddc9a1f26c54d6aac675317
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 11 09:39:30 2019 +0100

    Bug 24213: Fix Koha::Object->get_from_storage if the object has been deleted
    
    Without this patch it fails with something like:
      DBIC result _type  isn't of the _type Subscription at t/db_dependent/Biblio.t line 627.
    
    Test plan:
    - Apply the first patch (Add tests)
    - Confirm that they fail
    - Apply this patch
    - Confirm that the tests pass
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0bf254e4071ceb7c78e0387c184ae55b288695ef
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 11 09:39:15 2019 +0100

    Bug 24213: Add tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0ead9c01633f00dac9cd249095904b7aa69d45b3
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Jan 31 09:47:54 2020 +0000

    Bug 24467: (QA follow-up) Clarify tests wording for ->count methods
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 46bc93b4da637add09ef00d4cd6984e0a1d8e767
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Jan 31 09:46:56 2020 +0000

    Bug 24467: (QA follow-up) Fix POD in Koha::Biblio
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77979a03b44ff55b5aba889ca031b5251f0c3e63
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jan 22 16:21:22 2020 +0100

    Bug 24467: Remove _count methods introduced for API use
    
    This patch removes some methods that were introduced for API usage in
    the first iteration of the object embedding development effort.
    
    Those methods were obsoleted by bug 24528, which introduces a smarter
    way for Koha::Object->to_api to embed *_count attributes on the output
    structure based on the relationships and a call to ->count.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Biblio.t
    => SUCCESS: Tests pass
    3. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2dde059059fa30d808350bbb03727bd032d94ff0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jan 29 09:24:35 2020 -0300

    Bug 24528: Add a syntax to x-koha-embed to specify counts
    
    This patch adds a + syntax to specify on the x-koha-embed header that we
    want the count of a relation in the response. For example:
    
    GET /patrons/1
    x-koha-embed: checkouts+count
    
    Would return a JSON representation of a Koha::Patron, with a new
    attribute added: checkouts_count, which will be the result of calling
    $patron->checkouts->count.
    
    This is all done automatically in to_api. This patch makes parsing the
    x-koha-embed header build the right structure for passing to the to_api
    method.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/Koha/REST/Plugin/Query.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 58356c12bbaf4dc7eb3f7c918b62f91606062761
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 28 16:24:51 2020 -0300

    Bug 24528: Add *_count support to to_api
    
    This patch adds a way to tell to_api an attribute needs to be calculated
    as the count on an existing method/relationship result. For example, if
    we wanted to include the holds_count attribute for a Koha::Patron
    object, we would call it:
    
        $ patron_json = $patron->to_api({ embed => { holds_count => { is_count => 1 } } });
    
    This way to_api will internally call
    
        $json->{holds_count} = $self->holds->count;
    
    To test:
    1. Apply the tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Object.t
    => FAIL: Tests fail!
    3. Apply this patch
    4. Repeat (2)
    => SUCCESS: Tests pass!
    5. Sign off :-D
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 578b1aa8f754b49eacb47d0f652e174ab049d47b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 28 16:14:01 2020 -0300

    Bug 24528: Unit tests for Koha::Object->to_api
    
    This patch introduces unit tests for the new to_api bejaviour for
    *_count methods.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Object.t
    => FAIL: Tests fail because the feature is not implemented
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 528cc36f0c855b69e2257f7fbc754f3bbc4879c8
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Mon Jan 27 22:06:06 2020 +0000

    Bug 24523: Add missing </p>
    
    Signed-off-by: David Roberts <david.roberts@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d456df81a03096342dd72df99284e23603a7bbc
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jan 2 10:30:54 2020 -0500

    Bug 24330: When importing patrons from CSV, automatically strip BOM from file if it exists
    
    We have a partner that exports UTF-8 CSV files, and is experiencing the same thing as the author of this article: https://www.freecodecamp.org/news/a-quick-tale-about-feff-the-invisible-character-cd25cd4630e7/
    
    In short, Excel is inserting an invisible UTF-8 character at the start of the file, so that the column name "cardnumber" is actually named "\x{feff}cardnumber", causing "cardnumber" to be blank.
    
    A simple solution is provided here: https://stackoverflow.com/questions/24390034/remove-bom-from-string-with-perl
    
    Test Plan:
    1) Download the example.csv file
    2) Attempt to import it using the patron import tool
    3) Note the invalid column name error
    4) Apply this patch, restart all the things!
    5) Attempt the import again
    6) Assuming you have a branchcode MPL and a cataegory code S, the patron should import!
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Maggie Wong <maggie.wong@yccece.edu.hk>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cca2a0827043770877e6db3c7b13a2d6f263d4e6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 30 15:44:17 2020 +0000

    Bug 21674: DBRev 19.12.00.017
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3134736a841175755b9b30cbda16ee552798a82d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 21 15:01:51 2020 +0100

    Bug 21674: Remove duplicates from library_groups before adding the uniq constraint
    
    To avoid to make it fails if duplicates existed prior to this change
    
    Credit for the SQL query goes to Nick, thanks!
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 812a863d86686350243725f5bbfd2718022eee2d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 11 12:51:23 2019 +0100

    Bug 21674: Prevent to insert twice the same library in a group
    
    When you create hierarchical groups of libraries you are not allowed to add
    several times the same library to a given group/subgroup. The libraries
    that are part of the group is not displayed on the interface, to prevent
    the user to select it.
    
    However this restriction is only done template-side, the controller and
    module does not handle it.
    
    To prevent that this patchset enforces the constraint at DB level, and
    display a message to the end user.
    
    Test plan:
    - Go to Home › Administration › Library groups
    - Add a group
    - Add a library
    - reload the page several times
    => Without this patch the same library appears several times in the group
    => With this patch applied you will see a friendly error message
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 09ac74baca826670e7d1229d1b596c2c11e5059a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 11 12:51:14 2019 +0100

    Bug 21674: DB changes
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9384ed4aa8fa833c8a2ab5f1e237e5858feea6c1
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jan 16 13:09:58 2020 +0000

    Bug 24377: Record passed branch if renewing via cron
    
    To test:
    1 - Checkout an item with auto renewal set and eligible for auto renew
    2 - Set no renewal before in the circ rules to 99 (something greater than the checkout period)
    3 - perl misc/cronjobs/automatic_renewals.pl
    4 - Check the statistics table, note the branch for renewal is null
        SELECT * FROM statistics WHERE itemnumber={itemnumber} AND type='RENEWAL'
    5 - Apply patch
    6 - Repeat 1-4
    7 - Note the branch is set to the issuing branch
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Ed Veal <eveal@mckinneytexas.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit de6d12edfa02dde87d90b1f0f3d1225f80c73162
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jan 16 13:09:50 2020 +0000

    Bug 24377: Unit test
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bc05a90aa78ca014d22d9c5c67058220e541fdc4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 30 11:51:25 2020 +0100

    Bug 24543: Fix wrong test in api/v1/checkouts.t
    
    In t/db_dependent/api/v1/checkouts.t we define a circulation rule with renewalperiod=7.
    But then the expected due date is today+14 days.
    However, at the beginning of the script, the due_date of the issue is today+14 days.
    
    That highlight that the renewal period is not taken into account.
    
    The circulation rule is created with renewalperiod and renewalsallowed,
    however GetLoanLength check the existence of issuelength to return the rule.
    GetLoanLength finally return the default rule, with renewalperiod=0
    
    Note that this has been found working on bug 18936, code will be cleaned on that patchset.
    
    Test plan:
     % prove t/db_dependent/api/v1/checkouts.t
    must return green before and after this patch
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd1ade2a6768cd845ebefce471883a2d7555f6fd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 23 10:47:17 2020 +0100

    Bug 24487: Add 2 more tests
    
    And make sure tests pass if there is no patron with borrowernumber=10 in
    DB.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Ammended test description
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e5fca80e6f7967d0fe65e2010fcce9836e34c75
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Jan 23 01:50:29 2020 -0300

    Bug 24487: Don't apply matching criteria to path parameters
    
    This patch separates query parameters from path parameters, and uses exact matching for the later.
    
    To test:
    1. Apply this patch
    2. prove t/Koha/REST/Plugin/Query.t t/db_dependent/Koha/REST/Plugin/Objects.t
    SUCCESS => tests ok
    3. Sign off
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4584d36df43219a070bc542dba56ec065ad5b769
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed Jan 22 20:44:04 2020 -0300

    Bug 24487: Regresion test
    
    This patch introduces a regresion test where a path parameter is combined with 'contains' match criteria
    
    To test:
    1. apply this patch
    2. prove t/db_dependent/Koha/REST/Plugin/Objects.t
    
    Test should fail at this point.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1132889dc9fc5dccabbca51460e3bfb32a9f5fbd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 13 12:04:46 2020 +0100

    Bug 23031: Make 'add to basket' accessible in one click (fix regression)
    
    Since bug 21364 we have 'view' then 'add to basket' that is accessible
    in 2 clicks. We should have it directly accessible.
    
    Test plan:
    Create a new basket
    Add a new order to the basket (note that the link is directly
    accessible)
    When a new order is added you can close the basket from the basket list
    view
    Note that the dropdown button displays correctly
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c172c8ff6ef55e8c736a52b72931967cf54943e9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jan 6 15:09:08 2020 +0000

    Bug 24347: (follow-up) Remove custom catalog search from acquisitions
    
    This patch removes the "neworderbiblio" script and template which are
    made obsolete by the "search to order" feature.
    
    deleted:    acqui/neworderbiblio.pl
    deleted:    koha-tmpl/intranet-tmpl/prog/en/modules/acqui/neworderbiblio.tt
    
    Some documentation in addorder.pl has been corrected to remove reference
    to neworderbiblio.pl.
    
    To test, apply the patch and verify that the correct files have been
    removed.
    
    Search the Koha codebase to verify that no links to
    acqui/neworderbiblio.pl remain.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b9a7e354696ed905989f7f1ff581d59955406f3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jan 6 01:45:21 2020 +0000

    Bug 24347: Add a 'search to order' option similar to 'search to hold'
    
    This patch modifes the process of searching for an existing record
    to add to a basket. Now the search is performed as a keyword search in
    the regular catalog rather than via a custom search script. Options are
    added to the search results and detail pages to add results to an order.
    
    This process follows the same pattern as the "Search to hold" feature:
    When the search is initiated, a cookie is set with the requisite
    information--in this case vendor id and basket number.
    
    If the search results or bibliographic detail pages detect that a
    "searchToOrder" cookie is present, the correct "Add order" link will be
    shown. Like with the "search to hold" feature, the cookie expires in 10
    minutes.
    
    To test, apply the patch and log into the staff client as a user who has
    permission to add to a basket in acquisitions.
    
     - Go to Acquisitions -> Vendor -> Basket -> Add to basket.
     - Using the "From an existing record" option, perform a search.
     - On the search results page, test the "Add order" link which appears
       with each result. Clicking the link should take you to the "New
       order" page for the correct vendor and basket. The catalog
       details section of the form should include the correct information.
     - From the search results page view the bibliographic details page for
       any record. There should be a new toolbar button, "Add order." Verify
       that it works correctly.
       - Test the same thing from all bibliographic detail pages: Normal,
         MARC, Labeled MARC, ISBD, as well as the items page
         (moredetail.pl).
     - Test this process for both the locations in acquisitions where one
       can add to an existing basket: Vendor search results and the basket
       detail page
     - Test the cookie timeout: Wait 10 minutes and perform another catalog
       search. The "Add order" link should no longer be present.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0cbcef6ee955c138db5b88ca878234c7b70dce2a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 23 09:59:55 2020 +0100

    Bug 23594: Fix bad resolution conflict with bug 16784
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0c3a55fe0abcb02fb830ff3c58627da0f80aec04
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 22 10:04:21 2020 +0100

    Bug 23594: Add missing html filters
    
    Also fixes the following QA failure:
    forbidden pattern: Attribute type should not be used for script tags (bug 20053) (line 840)
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d07055190544fdb8cb98d452cfd8456fe1fd7d9c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 22 12:00:18 2019 +0200

    Bug 23594: Restore previous view after delete or update itemtype
    
    We want to restore the previous view when suggestions are deleted or
    their itemtypes are updated.
    To avoid c/p the code is moved to a new subroutine.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4b5570c6aa4f22b8f6734178f72e0a5212324296
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 22 11:51:54 2019 +0200

    Bug 23594: Fix [un]checkall links
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4494e8ba6ca7d28972fcc1161c680ecf0b091f62
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 21 18:06:07 2019 +0200

    Bug 23594: Batch modification for itemtypes on suggestions page
    
    This new enhancement adds the ability to update the item types for
    selected suggestions on the suggestions management page
    (suggestion/suggestion.pl)
    
    To achieve this goal we needed to refresh a bit the template, in order
    to get rid of weird code. To not recreate the previous coding awkwardness
    some code has been rewritten (mainly the removal of suggestiontype)
    
    Test plan:
    - Create some suggestions
    - On the suggestions management page, select some of them and a new item
    types.
    - Submit the form and confirm that the itemtype of the suggestions has
    been updated
    
    - Also you should confirm that the "delete" and "change status" still
    work as before
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 251bbb2eb9069841d065b0ba915fb757672a2179
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Oct 28 17:57:20 2019 +0000

    Bug 23915: Replace OPAC list sort menu with Bootstrap menu button
    
    This patch adds JavaScript to the list contents page which converts the
    resort form's <select> menu into a Bootstrap dropdown menu. This allows
    for a more compact and consistent display.
    
    To test, apply the patch and regenerate the OPAC CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    View a list in the OPAC. The toolbar of list controls ("New list,"
    "Download list," etc.) should have a similary-styled "Sort" button. Each
    sorting option should work correctly.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eb970752b402fab61ab94ef8fa029eca3570de15
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 25 08:49:15 2019 +0000

    Bug 23896: logaction should pass the correct interface to Koha::Logger
    
    Trivial fix.
    
    Test plan:
    Run t/db../Log.t to ensure that we did not break stuff.
    If you set opac to debug in log4perl config, inspect opac-error.log to see
    if you have extra loglines from running the test script.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2aaadd9a4d9ea390f0519774abbd1293ac747569
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Jan 12 11:16:05 2020 +0100

    Bug 17697: Improve NotesBlacklist system preference description
    
    - Switched 'separator' for more common 'tab' and rephrased sentence
    - Added examples
    - Added note to use hidden settings for hiding in other spots.
    
    To test:
    - Search for NotesBlacklist system preference and read the description
    - Apply patch
    - Refresh and read again
    - If improved, sign off.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 10a3c6deaae095914539c24afe0e630033e9c126
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 30 10:51:51 2020 +0100

    Bug 24542: (bug 23049 follow-up) Add missing use statement in Koha::Account
    
    Fix the following error when an item is checked out and that
    ManInvInNoissuesCharge is turned off:
    Can't locate object method "search" via package "Koha::Account::DebitTypes"
    
    Test plan:
    0/ Turn off ManInvInNoissuesCharge
    1/ Check an item out
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2931e68501901cb89cd1ece9cc23bb8cde39b60
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 30 10:20:25 2020 +0100

    Bug 23493: Fix selenium/regressions.t
    
    One test wants to make sure thead, tfoot and tbody will have th/td's
    with the same size/number.
    Existing test for tbody was retrieving the grouped td, which has a
    colspan of 100%. Note that this 100% value seems to be wrong as it is
    interpreted like "100" by the browser. We do not want to test this row
    anyway, but the real row, the one with all the td's.
    
    This patch makes it retrieve the second tr and count the number of td it
    has.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b3215b4482ba771ae6fc650220ae226617ad2a3f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 30 09:37:55 2020 +0000

    Bug 23493: (RM follow-up) Let datatables calculate colspan for us
    
    Prior to this we arbitrarily set a colspan of 100 for the rowgroup
    header row.  If we remove the td wrapper from the render function then
    datatables will automatically wrap the output in an appropraite td with
    cell with fullwidth colspan correctly set.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 715da06db557edc4b1baa51cc278fdac362c01c4
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 30 08:34:06 2020 +0000

    Bug 22868: DBRev 19.12.00.016
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ae53caa6818939274352fde85454c24112e6f984
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 14 10:02:11 2020 +0100

    Bug 22868: Move suggestions_manage subperm out of acquisition perm
    
    Bug 11911 replaced the permission of suggestions.pl (create a purchase
    suggestion) from catalogue => 1 to acquisition => 'suggestions_manage'.
    However we have a lot of acquisition scripts that have lax permissions
    (acquisition => '*' which means any sub permissions of acquisition is
    enough).
    
    That causes problem when a circulation staff can create purchase
    suggestions but not access acquisition information.
    
    One solution is to move the suggestions_manage subpermission out of the
    acquisition permission and create a new suggestion permission.
    
    Test plan:
    0. Setup
    * Create a patron with several permission (and full acquisition
    permission)
    * Create another patron with several permission, and suggestions_manage
    permission
    * Create another patron without the suggestions_manage permission
    1. Apply the patch and execute the update database entry
    2. Note that the third patron you create still does not have
    suggestions_manage
    3. Confirm that you can create a purchase suggestion if you have
    suggestions_manage, but cannot access acquisition pages if you do not
    have any subpermissions of the acquisition permission
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a5c82cf0da49b81801d215ee2968754ad655c9cf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 29 10:31:33 2020 +0100

    Bug 23493: Remove commented lines
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9aaf1e31dfb486e47653af8967fbe6d6bdb573a7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 29 16:12:13 2020 +0000

    Revert "Bug 23493: (follow-up) Switch to aDataSort for multi-column sorting"
    
    This reverts commit 930fedd46282bc46027332f4986f3baaee72b4ad.

commit 09b37fb63fc6214a74adc36109fb6212df6e11a0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 29 16:11:46 2020 +0000

    Revert "Bug 23493: (follow-up) Disable rowGroup on due date sort"
    
    This reverts commit 644ed8860aea4b1297d978700c2966a93e10628a.

commit 644ed8860aea4b1297d978700c2966a93e10628a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 29 11:27:51 2020 +0000

    Bug 23493: (follow-up) Disable rowGroup on due date sort
    
    When sorting by due date you are much more likely to want the true date
    sorting without forcing a primary sort on the grouping column. This
    patch achieves that by removing the primary sort on checkout date and
    disable rowGrouping in such a case.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 930fedd46282bc46027332f4986f3baaee72b4ad
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jan 28 17:18:44 2020 +0000

    Bug 23493: (follow-up) Switch to aDataSort for multi-column sorting
    
    This patch adds aDataSort configurations for each sortable column such
    that we always maintain the group sorting primarily and apply a
    secondary sort using the column in question.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c35b997c939f2953ee4803de90701493fdbc71b6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Aug 23 10:52:11 2019 +0100

    Bug 23493: Replace rowGrouping with rowGroup
    
    This patch replaces the unmaintained third party rowGrouping datatables
    plugin with the supported core rowGroup replacement.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c2650f577cf78e5c9ae685925876fcff752a5737
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 29 11:13:45 2020 +0100

    Bug 24305: (follow-up) Remove previous declaration of batch_biblionumbers
    
    Revert change for cardnumbers, they are not always numbers.
    We may need to add a regex to remove special chars however, will be done
    on its own bug report if needed.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d12f50a2e57e8ce84b7761c154b82d42051b9c4a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Nov 1 18:15:53 2019 +0000

    Bug 23947: Phase out jquery.cookie.js: Authority merge
    
    This patch updates the JavaScript which sets cookies during the
    authority merge process so that it uses the new js-cookie library.
    
    To test, apply the patch and perform a search in the authority module
    which will return multiple results.
    
     - Select "Merge" from the Actions menu next to any result.
       - A message should appear at the top of the page: "Merging with
         authority: <title>".
       - Click "Cancel merge." The message should disappear.
     - Select a record to merge again.
       - Select another record.
       - The page should redirect to the authority merge page.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 54c821a9e8df8a0cbc0a74a83fe605cd27cd40ac
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Nov 1 13:18:28 2019 +0000

    Bug 23944: (follow-up) Update circulation to use new library
    
    This patch updates the circulation page to use the new JavaScript Cookie
    library for cookie management.
    
    To test, apply the patch and open a patron record for checkout in the
    staff client.
    
     - Click "Search to hold" in the toolbar and perform a catalog search
       which will return results.
     - On the search results page, the toolbar at the top of the results
       should include a split "Place hold" button. The button's menu should
       include "Place hold for <patron>" and "Forget <patron>" options. Test
       that these work correctly.
     - In the table of search results each title should include a "Place
       hold for <patron>" link.
     - Go to the checkouts page for a patron with one or more checked-out
       items.
       - Check the "Always show checkouts immediately" checkbox.
       - The patron's checkouts should load.
       - Open another patron for checkout who has checked-out items.
       - The table of checkouts should load automatically.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 68c9273fa76cedf8de48d4284693b5058ca5fdbd
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Nov 1 13:00:03 2019 +0000

    Bug 23944: Phase out use of jquery.cookie.js in favor of js.cookie.js
    
    This patch adds a new JavaScript file to the staff client's global
    JavaScript include file: js.cookie-2.2.1.min.js. This "plugin" will
    replace jquery.cookie.js which is no longer maintained.
    
    The "About" page in the staff client is updated to include this new
    resource as well as adding previously-missing information about the old
    plugin which will remain until all instances of its usage have been
    removed.
    
    To test, apply the patch and check the About page to confirm the correct
    information is included.
    
    No functionality change is introduced by this bug. The only other
    observable change is the existence of the new files and the inclusion of
    the minified version of the file in any staff client page.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0cdd62600b85721f6f1704138fdf56b94ba15d52
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Fri Jan 24 02:15:46 2020 +0000

    Bug 20847: Add more fields to the Batch Patron Modification tool
    
    This patch adds streetnumber, address, address2, phone and mobile to the
    Batch Patron Modify form, also moves Primary email to a more logical
    place on the page
    
    To test:
    
    1) Install patch
    2) Open Batch Patron Modification tool, and input a borrowernumber to
    edit
    3) Add some data into the streetnumber, address, address2, phone and
    mobile fields and click Save
    4) These fields in the user record should now contain your data
    5) Test that running the tool again with the option to delete the data
    clears the fields correctly
    6) Repeat steps 1-5 with a file of user borrowernumbers
    
    Signed-off-by: Daniel J <daniel.jones@cheshiresharedservices.gov.uk>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12b8c3ac1e01f5a9fbc9221dba9ad44d00c53083
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Oct 21 17:01:06 2019 +0000

    Bug 23856: Split author and ISBN/ISSN out of citation in staged MARC record management
    
    This patch modifies the way data is passed to the staged MARC record
    management template, splitting author, ISBN, and ISSN out of the
    "citation" variable and passing them separately.
    
    The DataTables configuration for the staged MARC record management page
    is modified so that those now-separate variables are conditionally
    displayed.
    
    Unrelated minor change: Added a class to the MARC preview modal so that
    it displays wider.
    
    To test, apply the patch and view the "Staged MARC management" page for
    both batches of bibliographic records and batches of authority records.
    
    In each case the title or authority heading should be displayed as a
    link while author, ISBN, and ISSN (if any) should not.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ef4306cc02e2f15aa2466ae65d0b4f9a1fd70ad9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Oct 22 11:47:04 2019 +0000

    Bug 23885: Move staff client search results JavaScript into separate file
    
    This patch moves most of the JavaScript embedded in results.tt into a
    separate file. The JavaScript that remains on the page is everything
    which requires processing by Template Toolkit. This is limited to
    variable definition.
    
    To test, apply the patch and perform a catalog search in the staff
    client. On the results page, test that JavaScript functionality has not
    been affected:
    
     - The search results toolbar should "float" as you scroll
     - Select all and Clear all
     - Default search term highlighting; Unhighlight and highlight controls
     - Adding and removing one or more items from the cart
     - Adding one or more items to a list
     - Placing one or more holds my making selections and clicking "Place
       hold"
     - Browse selected records
     - Z39.50 search (search form should be populated with your search
       terms)
     - "Show more" and "Show less" links in the facets sidebar
     - Book cover image services: Amazon, Coce, local covers, etc.
     - Open a patron record and click "Search to hold"
      - Perform a search and select one or more results
        - Test "Place hold" from the hold menu in the toolbar
        - Test "Place hold for..." from the hold menu in the toolbar
        - Test "Forget..." from the hold menu in the toolbar
     - In Tools -> Patron clubs, locate a club with enrolled members
       - From the "Actions" menu, select "Search to hold"
         - Perform a search and select one or more results
           - Test "Place hold" from the hold menu in the toolbar
           - Test "Place hold for..." from the hold menu in the toolbar
           - Test "Forget..." from the hold menu in the toolbar
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 07d2a419f36711b5dc9b26a081eafa6a96cfdce9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jan 7 13:03:18 2020 +0000

    Bug 13121: Move search results "action" links ("Place hold," "Add tag," etc) into include file
    
    This patch moves markup for controls repeated across several OPAC
    templates into a single include: Place hold, Request article, Add tag,
    Save to lists, and Add to cart.
    
    To test, apply the patch and view the following OPAC pages:
    
     - Search results
     - Shelf contents view
     - User tags list
    
    On each of these pages all the controls should work correctly:
    
     - Place hold
     - Request art
     - Add tag
     - Save to lists
     - Add to cart
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f1f1c2e9b12d8d7bbcf5d88ad739e098a6031aef
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jan 28 15:05:44 2020 +0000

    Bug 24296: DBRev 19.12.00.015
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d06fbc124e3e13bc1487544fcd45c84e97b17a65
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 16 09:52:20 2020 +0000

    Bug 24296: Update stockrotation process to use branchtransfers.reason
    
    This patch updates all occurences of stockrotation related lookups of
    branchtransfers status from using the 'comments' field to using the new
    'reason' field.
    
    Test plan:
    1) Work through the process of creating a stock rotation plan and adding
       items to the plan.. no errors should be encoutered during this process.
    2) Run the stockrotation cronjob to move some items on.. no errors
       should be encountered.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b43a4b2756745d7bf96ef2c138708fba05ac5c82
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 16 09:01:34 2020 +0000

    Bug 24296: Update existing data in the database
    
    This DB udpate adds the stockration states to the trigger enum in the
    branchtransfers table and then populates it with any such data currently
    contained within the comments field.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c3188f024978f7070883dcbd9aa721f977b27c25
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jan 28 15:01:30 2020 +0000

    Bug 24287: DBRev 19.12.00.014
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 64f87158fd2d9ba0b2c20a43b3ecc8d7b2da7b5b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Dec 20 16:02:01 2019 +0000

    Bug 24287: Add `reason` to `branchtransfers`
    
    This patch adds the `reason` field to the `branchtransfers` table to
    record what triggered a transfer.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c85cdd192207dd5d97a664cc8ceb52954d0141e9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 28 15:04:10 2020 +0100

    Bug 24448: Adding a notice to tell the _count methods are temporary
    
    See bug 24467. You are allowed to flog tcohen with an RJ45 cable if this
    is not fixed in the next months.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 575d5418edbdd03fd2f648b760e59a704ba76e9d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jan 17 11:18:41 2020 -0300

    Bug 24448: Add Koha::Biblio->subscriptions_count
    
    This patch adds the handy subscriptions_count method to the Koha::Biblio
    class. It is intended to be used as a shortcut for
    
        $biblio->subscriptions->count
    
    in places like the API where we can embed the output of a method.
    
    To test:
    1. Apply this patches
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Biblio.t \
               t/db_dependent/Koha/Biblios.t
    => SUCCESS: Tests pass! i.e. Biblios.t still passes, and the tests for
    the new method in Biblio.t pass as well.
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 81c93cac461d8bdb751bf61ba865950aa51514a4
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jan 17 11:17:33 2020 -0300

    Bug 24448: Unit tests
    
    This patch adds tests for the new method to be introduced. It also moves
    the tests for Koha::Biblio->subscriptions to the Biblio.t where it
    really belongs.
    
    To test, run this tests along with the patch implementing the new
    method.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4111f4f1866434438ae8d3a7dd70b9279150bb08
Author: Andreas Jonsson <andreas.jonsson@kreablo.se>
Date:   Sun Jan 5 13:02:13 2020 +0000

    Bug 24348: Pass marc record to _passes_required_checks
    
    Test plan:
    
    * Add record matching rule:
    
     Matching rule code: test
     Description: 001 and 003
     Match threshold: 1000
     Record type: Bibliografic record
    
     Match points:
        Search index: Control-number
        Score: 1000
        Tag: 001
        Subfields:
        Offset:
        Length:
        Normalization rule: none
    
     Required match checks:
    
        Source (incoming) record check field
    
        Tag: 003
        Subfields:
        Offset:
        Length:
        Normalization rule: none
    
        Target (database) record check field
    
        Tag: 003
        Subfields:
        Offset:
        Length:
        Normalization rule: none
    
    * Note the match rule identity number.
    * Stage a marc-file for import, for instance this one ftp://ftp.libris.kb.se/pub/export2/X/marc/X.20200104.marc
    
    sudo /usr/sbin/koha-shell -c "perl /home/vagrant/kohaclone/misc/stage_file.pl --match 4 --file 'X.20200104.marc' --format ISO2709 --comment 'test'" kohadev
    
    * Note the batch number and commit the file using the batch number:
    
    sudo /usr/sbin/koha-shell -c "perl /home/vagrant/kohaclone/misc/commit_file.pl --batch-number 1" kohadev
    
    * Again, stage the same marc-file  for import:
    
    sudo /usr/sbin/koha-shell -c "perl /home/vagrant/kohaclone/misc/stage_file.pl --match 4 --file 'X.20200104.marc' --format ISO2709 --comment 'test'" kohadev
    
    * Note the number of records matched.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f2bedea793606e9095f839e5f7bd2dfac9bfb695
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jan 28 13:13:10 2020 +0000

    Bug 23442: (RM followup) Boraccount refund form correction
    
    This patch adds a minor correction to the refund form on the borrower
    accounts page. It removes the hidden 'registerid' form field and
    corrects the select field to submit registerid as intended.
    
    This corrects the behaviour such that the staff user can select which
    cash register the payout action should be attributed to.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 960a50925c66b127d37626431999dbee55cef939
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jan 28 13:12:40 2020 +0000

    Bug 24080: (RM followup) Boraccount payout form correction
    
    This patch adds a minor correction to the payout form on the borrower
    acocunts page. It removes the hidden 'registerid' form field and
    corrects the select field to submit registerid as intended.
    
    This corrects the behaviour such that the staff user can select which
    cash register the payout action should be attributed to.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f5a07d03ec2008297955d1510e27090468bcaabf
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jan 7 12:33:02 2020 +0000

    Bug 23113: members/pay.tt account_grp is not longer used
    
    This patch removes obsolete markup from pay.tt.
    
    To test, apply the patch and search the Koha codebase for instances of
    "account_grp" There should be none.
    
    Log in to the staff client and go to the account of a patron who has
    fines. Confirm that the "Accounting" page ("Make a payment" tab) works
    correctly.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a29d1db971450322f99f68af26295d097f44a0b9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 27 17:43:17 2020 +0100

    Bug 24361: Silent t/db_dependent/Items.t
    
    its output is displaying tons of
    Use of uninitialized value $field in regexp compilation at /kohadevbox/koha/C4/Items.pm line 2106.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 624bc03ea85f5027f2fcdb29ff80a5f5e94372c8
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jan 27 11:48:31 2020 +0000

    Bug 24486: Remove duplicated account information at the OPAC
    
    Test plan:
    Create a manual invoice
    Pay it
    Void it
    
    Go to the opac, account
    => You should see only one "(Voided)"
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c129a47ae5512b7a8026915894500b6390c64726
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jan 14 16:13:25 2020 +0000

    Bug 24421: Check if subfields are valid using the biblio tag
    
    To test:
     1 - Enable the sysprefs
         AutoCreateAuthorities
         BiblioAddsAuthorities
         CatalogModuleRelink
     2 - Open a record with a subject heading with a subdivision and add a new subfield, or add a new unauthroized heading to a record and save it
        e.g. 650$aChess$xOpenings$vFiction.
     3 - Save the record, note the created authority and that field is linked
     4 - Save the record again and note the authority number changes
     5 - Find and view the authority linked to the record
     6 - The record is for 'Chess', not Chess openings'
     7 - Search authorities for 'Chess' - note duplicated records
     8 - Apply patch, restart all
     9 - Save the record, auth number increases again, we shoudl create the correct record this time
    10 - Save again, auth number should not change
    11 - Search authorities and confirm the generated authority has the correct subfields
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit daaf0ca35ccefe73222c47b4b19e17e4360b8206
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jan 24 13:24:45 2020 +0000

    Bug 24421: Unit tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4f6dc86d2402ed552ae139e3cd6390422356d9ad
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 27 11:03:46 2020 +0100

    Bug 24339: Do not assume there are exactly 3 SIP* AVs
    
    Update DB entry 19.06.00.017:
    We created SIP* AV from accountlines if '^Pay[[:digit:]]{2}$', so I
    think we should assume that more than SIP00, SIP01, SIP02 can exist.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a6f538cbcd67303a8d7e8ff6f9ef79f68182649f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 8 12:48:55 2020 +0000

    Bug 24339: Remove SIP payment types from staff pay screens
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a10b520b9b8cc01ac443bb2e67a16cd9d0473c83
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 3 21:50:51 2020 +0000

    Bug 24339: Add SIP2 payment types for installation
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aad0802f825d7767ce2b103ecbf34419cfa77fc7
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Fri Jan 24 18:18:33 2020 +0000

    Bug 24497: Turn off smartIndent for SQL
    
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bebb0eaf2f5e98645ab04688491a6c9f0ad3ae45
Author: David Roberts <david@koha-ptfs.co.uk>
Date:   Thu Jan 23 12:18:17 2020 +0000

    Bug 24484: Add explanatory text to batch patron deletion
    
    This patch adds a more detailed explanation about what the tool can do.
    
    To test:
    
    1) Open up the Batch patron deletion and anonymisation tool
    2) Check the help text near the top of the screen
    3) Install the patch and repeat steps 1 and 2
    4) Check the help text has changed to the new version
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 194cdef333e85c49f998cb38b72c4278b4128d88
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jan 24 14:58:25 2020 +0000

    Bug 24511: Update variable names to avoid confusion
    
    To test:
    1 - Create a report
        SELECT borrowernumber, firstname, surname, email, emailpro FROM borrowers WHERE surname='acosta'
    2 - Create or edit patron with surname acosta to have a separate email and emailpro
    3 - perl misc/cronjobs/patron_emailer --notice HOLDS --module reserves --verbose --email emailpro --report ## --from 'me@you.us'
    4 - Note email is used, not email pro
    5 - Apply patch
    6 - Repeat, correct eamil is used
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95231815ccf47253967b02663b34d278117279f5
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jan 24 23:25:20 2020 +0000

    Bug 24515: Column Configuration for pay-fines-table does not hide Account Type properly
    
    This patch corrects the order of the columns in the columns
    configuration YML file. The incorrect order was causing the wrong column
    to be hidden when changing the columns settings for the table in
    Administration.
    
    To test, apply the patch and go to Administration -> Columns settings.
    
     - Under Patrons -> pay-fines-table, test hiding the account_type and
       description columns, together and separately.
     - Verify that the correct columns are hidden on the pay fines screen
       (Patron -> Accounting -> Make a payment)
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8a468824fd32d96af9e43c26635491d6579c19e2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jan 24 09:16:09 2020 -0300

    Bug 24509: Fix API relared tests failing on MySQL8
    
    This patch makes a trivial change to the tests so they catch the way
    MySQL 8 reports the duplicate key message. The difference on the API
    error message is irrelevant and so it is ok to just make the tests try
    both MySQL 8 output and the rest of the supported engines.
    
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/acquisitions_orders.t \
               t/db_dependent/api/v1/libraries.t \
               t/db_dependent/api/v1/patrons.t
    => FAIL: Tests fail due to warning and conflict message differences
    2. Apply this patch
    3. Repeat 1
    => SUCCESS: Tests pass!
    4. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0c404e0529ace3ac2eee218c1d0451ace8cea857
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 24 11:13:53 2020 +0100

    Bug 24507: Make Checkouts/ReturnClaim.t pass on MySQL 8
    
     $ prove t/db_dependent/Koha/Checkouts/ReturnClaim.t
     t/db_dependent/Koha/Checkouts/ReturnClaim.t ..
         #   Failed test 'Exception field is correct'
         #   at t/db_dependent/Koha/Checkouts/ReturnClaim.t line 97.
         #          got: 'return_claims.issue_id'
         #     expected: 'issue_id'
         # Looks like you failed 1 test of 8.
     t/db_dependent/Koha/Checkouts/ReturnClaim.t .. 1/1
     #   Failed test 'store() tests'
     #   at t/db_dependent/Koha/Checkouts/ReturnClaim.t line 133.
    
    This is similar to bug 23825.
    
    Test plan:
    Confirm that the tests pass on MySQL8 and MariaDB
    
    Signed-off-by: Tomás Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dc419ab2a9e7f3c49934272161597d903c24ea95
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 24 11:17:15 2020 +0000

    Bug 24305: (QA follow-up) Strip table name in [[table.field|alias]]
    
    When you would use the construct, you wont have batch features unless
    we strip the table name. This is consistent with the $sth->{NAME} used
    to fill the headers by default.
    
    Test plan:
    Use [[items.biblionumber|bibno]] instead of items.biblionumber in a
    reporting query.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c3e96a900b5ab0ed12e6e58d29ed2b13ce31716d
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 24 11:04:05 2020 +0000

    Bug 24305: (follow-up) Add small comment for square brackets in get_prepped_report
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3d388167698dbd43d42e1b0f83b435620d341cd8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 13 12:15:33 2020 +0100

    Bug 24305: Remove previous declaration of batch_biblionumbers
    
    We should not init batch_biblionumbers before.
    Also this patch deals with batch_cardnumbers.
    
    Signed-off-by: Holly Cooper <hc@interleaf.ie>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 00020bdfa9614b5627303fbd095e32b5cb5384b8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 26 11:11:55 2019 +0100

    Bug 24305: Fix links to batch tools when report's columns do not contain integers
    
    If report's columns do not only contain integers, we should not point to
    batch tools.
    For instance, if the value is a link, the batch tools will not work as
    they will not retrieve the id (itemnnumber or biblionumber) properly
    
    Test plan:
    Create a report like:
        SELECT CONCAT('<a href=\"/cgi-bin/koha/cataloguing/additem.pl?op=edititem&biblionumber=', biblionumber, '&itemnumber=', itemnumber, '#edititem', '\">', itemnumber, '</a>' ) AS itemnumber
        FROM items
        LIMIT 10;
    Execute it
    => There is not link to the batch tools
    
    Edit the report like:
        SELECT itemnumber
        FROM items
        LIMIT 10;
    Execute it
    => There is a link to the batch tools
    
    Edit the report like
    
        SELECT itemnumber, CONCAT('<a href=\"/cgi-bin/koha/cataloguing/additem.pl?op=edititem&biblionumber=', biblionumber, '&itemnumber=', itemnumber, '#edititem', '\">', itemnumber, '</a>' ) AS itemnumber
        FROM items
        LIMIT 10;
    Execute it
    => There is link to the batch tools
    
    Try other combinations with biblionumber.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a2223356bd332d666863cb9a75aad4c43c28b71
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jan 24 09:20:06 2020 +0100

    Bug 24503: fix missing use in value builder barcode_manual.pl
    
    Bug 22721 added use C4::Biblio in cataloguing/value_builder/barcode.pl.
    This is missing in value builder barcode_manual.pl.
    You get the error :
    Undefined subroutine &Koha::FrameworkPlugin::GetMarcFromKohaField called at cataloguing/value_builder/barcode_manual.pl line 41.
    
    Test plan :
    1) Configure a subfield of item to use value builder barcode_manual.pl
    2) Go to a record
    3) Try to add a new item
    4) Check the value builder is OK
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Tested with autobarcode==year-0001,0002
    No internal server error, but generates a barcode now.
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 518bb04d8a56edceeada645755de69530844f435
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 14 12:39:38 2020 +0100

    Bug 23443: Do not checkin an item if checked out to another patron when lost fee is paid
    
    Test plan:
    0 - Do not apply this patch
    1 - Check out an item to a patron
    2 - Make sure a fee will be charged when lost
    3 - Mark the item lost
    4 - Make sure the fee will not be refunded on return of the item
    5 - Return the item
    6 - Check it out to a new patron
    7 - Write off the fine for the original patron
    => The item is now checked in
    8 - Apply this patch and repeat 1 to 7
    => The item is still checked out
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 78ac663aa7947dd873ebdc748ff3e0abb0ed6823
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 14 12:39:36 2020 +0100

    Bug 23443: Add tests
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f8894fcba9e512d9e03d5bcbb6facd934885112c
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 24 07:22:52 2020 +0000

    Bug 23407: (QA follow-up) Same change for UNIMARC XSLT
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9654dd74ff4317f1113c6589b2bed9eb6dc446e5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 24 07:12:31 2020 +0000

    Bug 23407: (QA follow-up) Remove some XSLT item leftovers
    
    Test plan:
    Check intranet results and detail page.
    Check opac detail.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7c2319f8070ee00c2cd1b2042754d9ad3b06bdc7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jul 31 20:14:34 2019 +0000

    Bug 23407: Don't process items for XSLT on details pages
    
    To test:
    1 - Add 1000 items to a record
        Go to biblio
        Edit items
        Add multiple copies of this item
        Add 1000 and confirm
        Wait..
    2 - Load the record in staff client and OPAC, note how long it takes
        Press F12 in browser to open the console
        use the Network tab of the console
        note the load time
        refresh a few times to see average time
    3 - Apply patch
    4 - Restart all the things
    5 - Reload the record in staff and opac
    6 - Note decresed time
    7 - Verify nothing on the page has changed
    
    QA can grep the standard XSLT files for details pages for 'item' to note occurences do not use items information
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 703fc7ad6363f09297c37152c49752630d8cb73d
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jan 17 10:48:50 2020 +0100

    Bug 24443: Unit test
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 80f1374f262544a750b5d81a7d9605c8708c53b1
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jan 17 10:25:19 2020 +0100

    Bug 24443: Consider NULL as 0 for issues in items search
    
    In items search, we can filter by items issues count, data coming from items.issues.
    Most of the time, for an item with no issues this column contains NULL.
    This enhancement proposes to consider NULL as 0 to allow searching items with no issues.
    
    Test plan:
    1) Use SQL to count items with items.issues = NULL :
       select count(*) from items where issues is null;
    2) Go to items search
    3) Perform search with filter "Checkout count" = 0
    4) Check you get the same number of results as SQL query
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2ee96d2abd9037723a8e844d1d6ed1c1c3a0c556
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 24 09:16:01 2020 +0000

    Bug 22831: (RM follow-up) Add libarray-utils-perl to control
    
    This patch adds the new Array::Utils perl dependancy to the debian
    control files.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e326231cf6a5e853bf4b3b4bf71898d858d651c4
Author: Nightly Build Bot <nightly@abunchofthings.net>
Date:   Sat Jan 11 00:32:51 2020 +0100

    Bug 17084: Automatic debian/control updates (unstable/master)
    
    Remove Text::Unaccent dependancy
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 88d699fece53a1ae588554166f761d66edc95e69
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 24 09:44:04 2020 +0100

    Bug 24149: Skip Koha::Statistics for TestBuilder tests
    
    As statistics does not have a PK we need to adjust the TestBuilder
    tests.
    Bug 18441 already exists for adding the PK.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9597a384f3d714c866ca6fc58d480495384e65d7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 15:48:21 2020 +0000

    Bug 24080: (RM follow-up) Add payout to 'accounts.inc'
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 697ba67bc520bb1485025b9229bf0adc40540b61
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 15:47:39 2020 +0000

    Bug 23442: (RM follow-up) Add 'Refund' to accounts.inc
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 83a9c309c8a1d0b9db27d5cc77def9dd5ebe5e37
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 15:45:12 2020 +0000

    Bug 23442: (RM follow-up) Fix for missing 'uc' in offset_type call
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ddb51a7f26a83eeb27259836048b18acfe20c1f9
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Jan 23 05:50:34 2020 +0000

    Bug 24149: (QA follow-up) Add pod for Koha::Statistics->object_class
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b9520baf0a0a4f9bd4803d745bb33a200febe974
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 3 17:40:06 2019 +0100

    Bug 24149: Add tests
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e737f46c394f20091b2e7da20cc84e441561af06
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 26 19:44:47 2019 +0100

    Bug 24149: Add Koha::Statistic->item
    
    Sponsored-by: Association KohaLa - https://koha-fr.org/
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 346d6031db3cc6e33abf7d913a982d5711a463fa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 26 17:52:55 2019 +0100

    Bug 24149: Add Koha::Statistic[s] classes
    
    Sponsored-by: Association KohaLa - https://koha-fr.org/
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 435e80fb8d3e011491d439d617014ed15bf8ff44
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 10:39:38 2020 +0000

    Bug 24478: DBRev 19.12.00.013
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 83d98dfad595421a6e03364fd36c42de5c14daf5
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Jan 16 14:11:11 2020 +0000

    Bug 24478: Fix sequence in sysprefs.sql and add missing comma
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b2d557d424b6060e0856040fdbe2121a1f37ab2c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 22 10:51:55 2020 +0000

    Bug 24478: Use `EnablePointOfSale` preference
    
    This patch adds the `EnablePointOfSale` preference to the accounting tab
    on the preferences editor and ties the display of the Point of Sale
    module to it.
    
    Test plan:
    1) Enable both `UseCashRegisters` and `EnablePointOfSale` preferences.
    2) Ensure you are a superuser or your user has the
       takepayment permission.
    3) The Point of Sale module should be present on your staff home page
       with the above configuration, otherwhise it should not.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 11112b22cbc1a6b336fab9c076bfd6a23ed63e81
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 22 10:49:55 2020 +0000

    Bug 24478: Add `EnablePointOfSale` system preference
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 15f73bcf5ebf5bb8996dbc4b98e74ddc238bbe3c
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Wed Jan 22 16:31:10 2020 +0000

    Bug 24025: Make CodeMirror content searchable
    
    Signed-off-by: Barbara Johnson <barbara.johnson@bedfordtx.gov>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 164c228e97ba9f313351c0a5c50ce1370ef0fae3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Oct 23 13:16:45 2019 +0000

    Bug 23884: Merge strings.inc and browser-strings.inc
    
    This patch take the contents of the JavaScript in browser-strings.inc
    and puts it in strings.inc. browser-strings.inc is deleted.
    
    To test, apply the patch and perform a catalog search in the staff
    client.
    
     - View any result. In the left-hand sidebar there should be a search
       results browser box with "previous" and "next" arrows and a link back
       to search results.
     - Click on each different "view" tab and confirm that the search
       results navigation box persists: Normal, MARC, Labeled MARC, ISBD,
       Items.
     - From any of these views select Edit -> Edit items. The same
       navigation box should appear.
    
    Note: addbiblio.tt and stockrotation.tt are modified but feature doesn't
    currently work on those pages.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 127dfc0b8fddfc0c409bd5fc6d76b131369a1324
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jan 22 11:50:19 2020 +0100

    Bug 19809: Remove some new occurrences
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0e73e723efa4db15d2c4ab1404fb8b50b0f61380
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Dec 14 09:19:22 2017 +0100

    Bug 19809: Re-allow to call Koha::Objects::find in list context
    
    and remove 'scalar' keyword in calls where it's not needed.
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6fa4fbbbd7a80c0d74f5548f4fa746c4cf85ed1d
Author: Liz Rea <liz@bywatersolutions.com>
Date:   Mon Nov 25 11:20:51 2019 -0600

    Bug 24105: Fix error when running longoverdue.pl with --itemtypes
    
    To test:
    
    Run Longoverdue.pl as koha-shell with both 1 and several --itemtypes specified
    notice that it has an error
    apply this patch
    run longoverdue.pl as koha-shell with both 1 and several --itemtypes specified
    notice there isn't an error anymore!
    
    Signed-off-by: David Roberts <david.roberts@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 44ab1fd5c70e7ba825ee9c37ed616d332f2d8bde
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jan 17 15:00:31 2020 +0000

    Bug 24452: Advanced editor - show multiple spaces visually
    
    This patch updates the JavaScript and CSS for the advanced MARC editor
    so that multiple consecutive spaces within a line will be detected and
    highlighted.
    
    To test the EnableAdvancedCatalogingEditor system preference should be
    enabled. Apply the patch and clear your browser cache if necessary.
    
     - Go to Cataloging -> Advanced editor.
     - On any text entry line (e.g. 245), enter some words with one, two,
       and more spaces in between them. When there are two or more spaces
       between words the spaces between the words should have a dotted red
       underline.
     - Remove the extra spaces and confirm that the dotted line disappears.
    
    Signed-off-by: Cori Lynn Arnold <carnold@dgiinc.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 56fcf5a34d580026e0799baf07b537ac5bc43bb5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 10:20:31 2020 +0000

    Bug 22831: (RM follow-up) Code golf
    
    Rather than performing a symmetric diff and then splitting the results
    in a further loop this patch changes to logic to use two asymetric diffs
    to get the results more directly.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e9f7a0dd1cef9e32ec6b93fa3cfed5711f84a64c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Nov 7 18:49:12 2019 +0000

    Bug 22831: (follow-up) Sort results, group by db
    
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d5c79c201d5602245d173f6142ab5bb5b29e9c43
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Nov 6 14:37:01 2019 +0000

    Bug 22831: (follow-up) Determine where the record is missing and provide link, show counter
    
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2b32aee8258002269ab4d789496ea188465d016a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 2 12:24:08 2019 +0000

    Bug 22831: Elasticsearch - add a maintenance script for checking DB vs index counts
    
    This script uses Array::Utils and adds a dependency
    
    To test:
     1 - Have Koha with ES running
     2 - Delete some records from ES
         curl -X DELETE "es:9200/koha_kohadev_biblios/data/5"
         curl -X DELETE "es:9200/koha_kohadev_authorities/data/5"
     3 - perl misc/maintenance/compare_es_to_db.pl
     4 - Note you are notified of problems in both indexes
     5 - perl misc/search_tools/rebuild_elastic_search.pl  -a
     6 - perl misc/maintenance/compare_es_to_db.pl
     7 - Note you are only notified about problems in biblios (assuming you don't have other issues)
     8 - perl misc/search_tools/rebuild_elasticsearch.pl  -b
     9 - perl misc/maintenance/compare_es_to_db.pl
    10 - Both counts match, no problems
    
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1c07cacff2b41a9b58f8999b3565a888b018fbf9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 20 12:22:58 2019 +0100

    Bug 23064: Use Koha::Subscription in ModSubscription
    
    We must use Koha::Subscription instead of raw SQL.
    It will fix issue with default and integer values.
    
    Test plan:
    Edit a subscription and set number of issues = "f"
    Save
    => Without this patch there is a SQL error in the log:
      Incorrect integer value: 'f' for column 'numberlength'
    => With this patch the other changes are effective.
    
    Note: We also could change the type attribute of the input to "number",
    to have a client-side check
    
    Also, the return value of ModSuggestion is never used, so we are safe
    with that.
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c61876322213d9a70edc12b033894217d2116391
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 21 10:26:04 2020 +0100

    Bug 24345: Fix OPACViewOthersSuggestions
    
    Default value for $op needs to be set before the get_template_and_user lines as
    it's tested for OPACViewOthersSuggestions.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ed5ec62cac48a96413a9e468d8bacc2a4ef80ea5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Jan 5 22:02:18 2020 +0100

    Bug 24345: Fix process of suggesting purchase of existing title for non-logged-in users
    
    The 'op' parameter is removed from the CGI object ($input) before
    get_template_and_user is called. When the user is redirected to the
    login form (from checkauth, called from get_template_and_user), the
    op is lost.
    
    Moving down the deletion fixes the problem.
    
    Test plan:
    Logout at the OPAC
    Go the detail page of a bibliographic record
    Click the "Suggest for purchase" link
    Fill the login form
    => Without this patch you will see your suggestion list
    => With this patch applied the new suggestion form will be displayed,
    prefilled with the biblio's info
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 991f51b27240bd5d5e2ce302db7260f17d7e680c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 10 14:16:56 2020 +0100

    Bug 24397: Remove out of sync script populate_db.pl
    
    populate_db.pl from koha-misc4dev must be used instead.
    This script existed before the creation of koha-misc4dev, it does no
    longer make sense to have it in Koha.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e52cb442b57248b837a73a5e2d7a59fb10ee42e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 20 09:48:03 2020 -0300

    Bug 24459: Make ->to_api pass $params through
    
    This patch makes the to_api method in Koha::Acquisition::Inovice and
    Koha::Patron pass the passed parameters to the base class to_api method.
    This is required for things like embedding related objects.
    
    To test:
    1. Apply the regression tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Patron.t \
               t/db_dependent/Koha/Acquisition/Invoice.t
    => FAIL: Tests fail!
    3. Apply this patch
    4. Repeat 2
    => SUCCESS: Tests pass!
    5. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e003a3c16495c8f488a2970b57e00e1070f64e7d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 20 09:47:18 2020 -0300

    Bug 24459: Regression tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cf038dd938636303c3936ce186f1a64ae9cf10db
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Sun Jan 19 02:06:00 2020 -0300

    Bug 24457: Make overloaded ->to_api pass the params to parent method
    
    This patch makes the overloaded to_api method for baskets care about the
    remaining parameters, and pass them to SUPER::to_api.
    
    To test:
    1. Apply the regression tests
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Acquisition/Basket.t
    => FAIL: Tests fail! No embedded bookseller!
    3. Apply this patch
    4. Repeat 2
    => SUCCESS: Tests pass!
    5. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f8e399b62e78d56d7437597ea589af64954005ca
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Sun Jan 19 02:05:40 2020 -0300

    Bug 24457: Regression tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 78190371d00cb91ae668eb3d28a48ef33c112676
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Dec 20 13:33:28 2019 +0000

    Bug 24286: Escape forward slash in GENRE/FORM (and any authtype)
    
    Note that bug 24267 will fix the issue during Z39 searching for new auth, but the duplicate check at saving will still fail
    
    To test:
     0 - Set SearchEngine to Elasticsearch,  QueryRegexEscapeOptions  to 'Don't Escape'
     1 - Browse to Authorities
     2 - Select New->New from Z3950
     3 - Search for subject 'Short stories'
     4 - Auth search explodes
     5 - Apply patch
     6 - Repeat and confirm the search results return
     7 - Import and save the GENRE/FORM record for Short stories
     8 - Repeat the search and import the same record
     9 - Confirm that upon save you are notified of duplicate, don't save
    10 - set  QueryRegexEscapeOptions to 'Escape' and confirm Z39 searching works and importing/save notifies of duplicate
    11 - set SearchEngine to Zebra and confirm Z39 searching works and importing/save notifies of duplicate
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0dbf76c290f031e58dcb04e16047f1bd984560ef
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jan 16 14:10:18 2020 -0500

    Bug 24441: Error when checking in an item with BranchTansferLimitsType set to itemtype
    
    It appears that the transition to using Koha::Item in AddReturn has introduced a bug. Previously $item was a hashref with the key 'itemtype', now that it's an object, it has no itemtype method and so triggers an error with the message "The method Koha::Item->itemtype is not covered by tests!".
    
    Test Plan:
    1) Enable Branch Transfer Limits via itemtype
    2) Check in an item
    3) Note the error
    4) Apply this patch
    5) Restart all the things!
    6) Check in an item
    7) No error!
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Maribeth (Turner) Shafer <mshafer@ckls.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3760af11f7b098b8de68ce4429d348737caf4be1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 21 16:08:12 2020 +0100

    Bug 24441: Add tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 367df45840cf4b829c0757144a83db42c9ada92f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Dec 13 16:08:16 2019 +0000

    Bug 24236: Fix pagination to use query_cgi
    
    This is still wrong, we should use page-numbers.inc, but that is a larger refactoring
    This patch fixes non-QueryParser searches by simple getting an using the escaped query (query_cgi)
    
    For QueryParser, we do what the QP code does, just uri escape the query - the way that SimpleSearch does the query parsing instead of the usual buildQuery suggest to me that we should probably switch all of this to use the general Zebra search.
    
    The issues with reservoir should be their own bug
    
    To test:
    1 - Search for cat in cataloging search
    2 - Get results and see you can paginate
    3 - Search for "cat"
    4 - Get results but subsequent pages empty
    5 - Apply patch
    6 - Repeat search for "cat"
    7 - You can paginate
    8 - Enable UseQueryParser syspref (don't worry about installing)
    9 - Confirm can still search with quotes and paginate
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 451bc0fca595f426257b4a790fc6f83cc10f32f9
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed Jan 15 20:12:19 2020 -0300

    Bug 24432: Use from_api_mapping to translate column name in _build_order_atom
    
    Use the mapping instead of building a fake hash only to get the key name.
    
    To test:
    1. apply this patch
    2. prove t/Koha/REST/Plugin/Query.t
    3. sign off
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 62da76b84b4714851a1be3d33a565382d5d1037a
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed Jan 15 20:10:01 2020 -0300

    Bug 24432: add Koha::Objects->from_api_mapping
    
    This patch adds from_api_mapping to Koha::Objects, in order to be able to get the mapping from a result set.
    
    To test:
    1. apply this patch
    2. prove t/db_dependent/Koha/Objects.t
    3. sign off
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d8bd366b5c5ce36e52b3c8466d08feeeed5098d9
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed Jan 15 19:52:53 2020 -0300

    Bug 24432: Regresion test
    
    To test:
    1. apply this patch
    2. prove t/Koha/REST/Plugin/Query.t
    
    Test should fail at this point.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7015ba70599b96c6cdfc733b704a328afd000ba2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 22 10:26:00 2020 +0000

    Bug 24477: Require `takepayment` permission in pos/pay.pl
    
    When adding the point of sale take payment page in bug 23354 we missed
    the permission check script side along with adding the permission at
    install time (update was caught).
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0ad865d8222adc3c2fde88a7d1572060c357e508
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 23 08:50:31 2020 +0000

    Bug 24481: DBRev 19.12.00.012
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 451752009243fdfa6ddbb51a0f5a070f982e0ad6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 22 14:46:20 2020 +0000

    Bug 24481: Permissions update for POS menu include
    
    This patch updates the point of sale menu include to reflect the updated
    permissions name for cash registers
    
    Note: Not required for 19.11
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8604e82db11944276a59ec5ea554599fd7111a1f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 22 14:45:17 2020 +0000

    Bug 24481: Permission corrections for admin menu templates
    
    This patch updates the admin menu include and admin home page to reflect
    the updated permissions name for cash registers
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 035d58617358be473503d8861359b55922ada9a3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 22 14:03:13 2020 +0000

    Bug 24481: Correct permission name in admin/cash_registers.pl
    
    The permission name for changed during the implimentation of bug 23321
    but one case was missed. This patch corrects that mistake.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 637afc8f6dbf9143380ad05a7331186a871f089f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 22 14:41:21 2020 +0000

    Bug 24481: Move manage_cash_registers to parameters permission
    
    This patch moves the manage_cash_registers subpermission to the more
    appropriate location under 'parameters'.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 59a75a60cc2caeff678bc36cc111d4d5edafc470
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 22 15:00:10 2020 +0000

    Bug 23354: (RM follow-up) Remove stray 'IGNORE' in updatedatabase
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5c11d23f000de46b13b3ded2000050dd1042cb17
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jan 22 13:44:25 2020 +0000

    Bug 23354: (QA follow-up) Add takepayment permission for new installs
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 71639accafe8323c28231aa3404992994fe9c95a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 22 12:13:18 2020 +0000

    Bug 23354: (RM follow-up) Change $q to $input for consistency
    
    As pointed out by Jonathan, this script introduced a third form for the
    CGI variable. This patch updates the script to use the more common
    $input variable name.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9e432877cd48e6b9cdd87385b92cb93b58ca8d29
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Jan 16 01:50:07 2020 +0000

    Bug 19793: Change label to match patron record: Primary email
    
    As we have multiple email fields in the patron record, we should
    be clear which one can be changed from the batch mod now. Easiest
    is to use the same label.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 417e76d7e087be4f4d29a95fcaaaf43c19a812d3
Author: David Roberts <david.roberts@ptfs-europe.com>
Date:   Mon Jan 13 22:43:46 2020 +0000

    Bug 19793: Add a field for email in batch patron modification
    
    This adds the email field to the patron batch modification tool.
    
    To test:
    
    1) Install patch
    2) Open Batch Patron Modification tool, and input a borrowernumber to edit
    3) Add some data (e.g. test@foobar.com) into the Email address field, and click Save
    4) The Primary Email address in the user record should now contain your email address
    5) Test that running the tool again with the option to delete the data clears the field correctly
    6) Repeat steps 1-5 with a file of user borrowernumbers
    
    Sponsored-by: PTFS Europe
    Signed-off-by: Sal <sally.healey@cheshiresharedservices.gov.uk>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5733398a596953d9f23c92583a25416c9f89c1a1
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jan 3 15:58:53 2020 +0000

    Bug 24336: Ask for confirmation before deleting a suggestion in the OPAC
    
    This patch modifies the OPAC suggestions interface so that patrons will
    be asked for confirmation before deleting suggestions.
    
    The patch also makes some minor markup changes to improve consistency
    between this interface and others in the OPAC.
    
    To test, apply the patch and log in to the OPAC as a user who has
    submitted multiple suggestions.
    
     - From the list of your suggestions, confirm that the "New purchase
       suggestion" and "Delete" links have Font Awesome icons.
     - Check the checkbox corresponding to one of your suggestions. You can
       also now click the title of the suggestions to control the checkbox.
     - When you check a box the "Delete" link at the top of the page should
       activate.
     - Clicking the delete link should trigger a confirmation modal showing
       the title(s) you selected.
       - The message and button labels should reflect whether one or
         multiple titles are being deleted.
       - Test that the confirm and cancel controls work correctly.
     - Also test this process via the delete button at the bottom of the
       table of suggestions.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a07842b2d860e4160dbaf6f7256250906669643
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Jan 16 01:34:35 2020 +0000

    Bug 7468: Use Modern::Perl
    
    Just a tiny coding guidelines fix.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b45e43b3c52d1f95ad82dc5d37dc5f9d6a370d8a
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Thu Jan 16 09:19:39 2020 -0500

    Bug 7468: fix the export labels popup header
    
    When exporting a barcode range, the export popup should display "1 batch
    to export" instead of "0 batches to export". In this context, it can be
    considered a label batch and should be counted as such.
    
    To test:
    When clicking the "Print range" button, the popup should show "1 batch
    to export".
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0296ba2755915e73a2ae71851a190781febd0edd
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Wed Jul 17 11:51:26 2019 -0400

    Bug 7468: (follow-up) Add missing filters
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d6740cf57336e75072b1337eee903969057a7c0
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Wed Jul 17 09:41:09 2019 -0400

    Bug 7468: (follow-up) fix label-edit-range template
    
    Edit the labels/label-edit-range.tt template to follow current
    standards :
        - Use footer javascript
        - Use bootstrap grid
        - Use jQuery Validation plugin for validation
    
    Also fixes breadcrumbs to be more specific.
    
    To test:
    Make sure the page looks correct and still works as expected.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b2261a766bffe542774b9c3b03794354bb26753
Author: Charles Farmer <charles.farmer@inLibro.com>
Date:   Wed Aug 8 16:20:40 2018 -0400

    Bug 7468: (follow-up) Make sure only integers are accepted as from/to values
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit de20a6fbfdb215d462f07d7f960506ca2f6ecb8b
Author: Charles Farmer <charles.farmer@inLibro.com>
Date:   Fri Jan 26 15:49:48 2018 -0500

    Bug 7468: Showing the error message according to the community interface patterns, fixing a javascript condition
    
    TEST PLAN++
    
    1) Apply all the patches
    2) Connect to the intranet with an account with permissions to visit the "Tools" page
    3) Go to /cgi-bin/koha/labels/label-home.pl
        . Either by entering the URL directly
        . OR, from the front page, by clicking "Tools", followed by the hyperlink "Label creator" under the "Catalog" section
    4) Under the "+ New" button, a new option should be available: "Barcode range"
    5) Fill the "From:" and the "To:" fields of the "Print barcode range" form
        . Keeping both fields at "0" should trigger a warning beside the first field: "*Cannot be smaller than 1"
        . If the value "From:" is greater the "To:" value, a warning should appear beside the second field: "*Cannot be smaller than the starting value"
        . Make sure the form doesn't let you enter non-numerical values
        . For a casual test, use "From: 1000" and "To: 1100"
    6) After pressing the "Print Range" button, choose a template, a layout, and a starting position
        . The "DEFAULT TEMPLATE 01" has a page height of 5pt and a page width of 0pt, don't use it
        . All the default layouts should look alike, since we're only printing a barcode over a number, and not bibliographic information
        . Using a layout not defined as 'Barcode' will show a warning message
    7) Clicking the "Export" button should lead to a second dialog window with a "Download as PDF" hyperlink. Clicking the link should prop up a download dialog box
    8) Save the PDF locally, or simply open it, and make sure the options you used were taken into account
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dc68633a1f2a8410c949c595dcebb66ada2e2cfb
Author: David Bourgault <david.bourgault@inlibro.com>
Date:   Thu Oct 5 09:40:19 2017 -0400

    Bug 7468: Add warning when range has non-existent barcodes
    
    + Added a warning when the user selects a range with some non-existent barcodes, and a layout without barcodes.
    This allows the user to print barcodes of items not in the database if he so desires, but will warn him if he tries to print only biblios (which results in missing entries or a blank page).
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a7ef5c96550ac9eefa15ca841c4296e2fd24e8b
Author: David Bourgault <david.bourgault@inlibro.com>
Date:   Wed Oct 4 09:12:11 2017 -0400

    Bug 7468: Fix 'false' message on Firefox
    
    It seems I was using an href to a javascript function in the 'Print Range' button, which Chrome didn't mind, but Firefox did understand.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 89b658885f53fbc8836080b83ae1e67c945f1aa0
Author: David Bourgault <david.bourgault@inlibro.com>
Date:   Mon Sep 18 10:55:05 2017 -0400

    Bug 7468: Print barcodes by range
    
    Adds an option to the label creator to print a range of barcodes.
    Only allows printing to PDF.
    
    C4/Label.pm had to get minor changes to override database-based barcode
    generation. Same with labels/label-create-pdf.pl. By default, the
    barcode is fetched from the database using the itemnumber, but when
    printing ranges, you might not have a corresponding  database entry.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d653251562e75a3da5a5df287a126e9a33707320
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Jan 16 01:00:28 2020 +0000

    Bug 3426: Keep note about sequence of subfields
    
    Bug 9156 changed the wording of the pref slightly to make it
    clear that the subfield sequence of the record will be used,
    not the sequence of the subfields defined in the pref.
    
    This just reinstates the note:
    The order of the subfields in the record will be preserved.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2aa49ebab4cb4d36bea42f094df9ccb03945454e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Dec 19 05:29:47 2019 +0000

    Bug 3426: Allow for multiple fields in itemcallnumber syspref
    
    Note that we change both cataloguing/additem.pl and C4/Items->PrepareItemrecordfordisplay
    
    I can find no code that uses callnumber from the C4/Items sub, except for the itemrecorddisplay script
    which is not called with an itemnumber from Koha and should be deprecated for REST or ILSDI or OAI (imho)
    
    To test:
     1 - Define itemcallnumber syspref as "082ab,092ab,9520,245a"
     2 - Find a record with no items
     3 - Ensure it has no 082 field, but an 092 field
     4 - Go to add an item - itemcallnumber is empty
     5 - Apply patch
     6 - Go to add item, itemcallnumber should be the 092ab fields
     7 - Delete the 092 field
     8 - Go to add item, itemcallnumber should be the 245a
     9 - Edit the callnumber to be "testing" and save item
    10 - For should now show itemcallnumber="testing" as default
    11 - Browse to http://localhost:8081/cgi-bin/koha/services/itemrecorddisplay.pl?itemnumber=## subbing the correct itemnumber
    12 - Ensure the callnumber is defaulting to testing
    13 - delete the item you created
    14 - browse to URL above - callnumber should now be 245 again
    15 - Add an 092 field to record and ensure it is now default callnumber
    16 - Add an 082 field, it should now be default
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 637e82729b76e406517c140f69e9071cc48ca199
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 16 13:32:25 2020 -0300

    Bug 24435: Add Koha::Biblio->items_count
    
    This patch introduces a handy shortcut to get the items count for a
    biblio. So instead of calling:
    
      $count = $biblio->items->count;
    you can call:
      $count = $biblio->items_count;
    
    The use case for this, is when we want to embed information on objects
    to be sent as API responses. In that case, calling ->items->count needs
    to be done manually on the controller script, with interesting added
    complexity. With this kind of method, we can just require it to be
    embedded automagically by calling the following on the API:
    
       $biblio->to_api({ embed => { items_count => {} } });
    
    If there are several nested layers of objects, doing manually can get
    really tricky and error prone.
    
    To test:
    1. Apply this patches
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Biblio.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 293f9565d05293aee53a999992e75487e61300bc
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 16 13:32:04 2020 -0300

    Bug 24435: Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f31993d126ed97fdc80605931f41ed29b1dac5d1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jan 15 16:28:00 2020 -0300

    Bug 24430: Remove CountBiblioInOrders and its traces
    
    This patch replaces the only uses of CountBiblioInOrders and makes that
    code use $biblio->orders->count instead.
    
    Test nothing breaks in basket.pl and parcel.pl
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f30c2874cdcbaf008ecc44fafccb89d44403e5f6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jan 15 16:25:52 2020 -0300

    Bug 24430: Add ->orders and ->active_orders_count to Koha::Biblio
    
    This patch introduces an accessor to the related orders, and a method
    that returns the active orders count. The target usage for the count is the
    API. In the rest of the codebase, we would just call:
    
        $biblio->orders->count
    
    To test:
    1. Apply this patches
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Biblio.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f06578b34e9a31ff9b2ee3575b3770a88fccdece
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jan 15 16:25:19 2020 -0300

    Bug 24430: Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d0446c835c88c44711cc98dba95ccc757bada54b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 14 12:47:19 2020 -0300

    Bug 24419: Add Koha::Suggestion->suggester accessor
    
    This patch adds a ->suggester accessor to the Koha::Suggestion class. It
    will return undef if no suggester, and a Koha::Patron object otherwise.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Suggestion.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 000cf4eba32fe67fb41d797583f3a13e3896c3d6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 14 10:09:12 2020 -0300

    Bug 24418: Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c10b49b5df8d71ac11967b759fcd7473d67f883
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 14 10:11:00 2020 -0300

    Bug 24418: Add koha_object(s)_class methods to Suggestion
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d2642d33e08d85d8a215a09100886d1e94a43c8
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 14 10:09:40 2020 -0300

    Bug 24418: Add Koha::Biblio->suggestions
    
    This patch adds the mentioned accessor. To test:
    
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Biblio.t
    => SUCCESS: Tests pass
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c0e2912ee6e16c1236688f10b60454689d9405e5
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Thu Nov 14 08:50:30 2019 -0500

    Bug 12502: (follow-up) Adds formatting for datatables export
    
    Add a format option to the datatables export that remove .noExport
    elements present in a data cell, just as .noExport columns are
    not exported.
    
    To test:
    1. For late orders (which uses .noExport elements in data cells) :
        Export data in any format using the export button at the top
        of the datatable.
            => data should exclude "Add/Edit note" label, but
            otherwise look the same as before the patch.
    2. Try exporting data in other datatables in Koha and make sure
    exported data is the same before and after applying the patch.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 032e09a7b387ebb219c1944c6834abc64b5a8b5a
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Thu Nov 14 08:48:13 2019 -0500

    Bug 12502: (QA follow-up) Remove the Save button
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e4860aeeede07a30ddb425a075a26b442a13a538
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Tue Jul 16 15:24:51 2019 -0400

    Bug 12502: (follow-up) Use modal to add/edit order notes
    
    Replace inputs to edit notes by a link opening a modal, similar
    to the basket summary page. This makes it possible for the notes
    to appear in the datatable exports.
    
    Also fix exporting with the export as csv button at the bottom
    of the page to export notes.
    
    Test plan :
    1) In the late orders table (acqui/lateorders.pl), a link should
    appear in both the internal and vendor note column, following the
    current value if it exist.
        -> This link should read "Add ..." if there is no existing note
        or "Edit ..." if there is.
    2) Click on the link. A modal should appear. Confirm that saving a
    note works as expected.
    3) Try exporting to any format using either the button at the top
    of the table or the one at the bottom of the page.
        -> The three new columns and their values should appear in the
        export.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 34dfe783c6e13f8298c4e296860711e44889980d
Author: David Bourgault <david.bourgault@inlibro.com>
Date:   Mon Sep 25 15:18:38 2017 -0400

    Bug 12502: Add vendor note, internal note, ordernumber and isbn to late orders page
    
    Test plan:
    
    0) Make sure you have a late order
        a) Create a test vendor unless you have one
        b) Create a test basket unless you have one
        c) Close the basket to mark the order as late
    1) Go to the late orders table
    Before patch : Orderno, ISBN, vendor notes, internal notes are absent
    After patch: fields are present
    
    2) Edit the vendor note and/or the internal note
    3) Press the save notes button
    4) Refresh page and cache (CTRL+F5), if notes have been correctly saved, your modifications should be displayed.
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ebb2b54d3498ec81d656ffe654bc9534a9aa8e9b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jan 15 18:00:18 2020 +0000

    Bug 16784: (follow-up) Add missing filter
    
    This follow-up adds a missing template filter quiet qa tool warning.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fb526fb155143a62ea24a8433f58c1c79c1a0179
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sun Jan 12 20:28:16 2020 +0000

    Bug 16784: Add table configuration on suggestions table
    
    This patch adds DataTables column configuration and export options to
    the suggestions management tables in the staff interface.
    
    The columns settings made via the administrative interface will affect
    tables under each tab in the interface whether it be organized by
    status, library, etc. However because of the way the KohaTable function
    is currently written, changes made via the "Columns" button will only
    affect the visible table.
    
    To test, apply the patch and go to Acquisitions -> Suggestions.
    
     - Under each tab, the table of suggestions should have a DataTables
       toolbar with export and columns buttons. These controls should work
       correctly:
       - Showing and hiding columns should work as expected
       - Exports should work, excluding the first and last columns
     - Test the tables when using the various "Organize by" settings.
     - Test changing the settings in Administration -> Columns settings.
       - Verify that the changes you make to that configuration are
         reflected in the suggestions tables.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7b25cc903e21fae100453e079ac79516631b3f6b
Author: Lisette Scheer <lisettes@latahlibrary.org>
Date:   Fri Jan 10 21:26:16 2020 +0000

    Bug 15686: Rename "item level holds" circ rule column to "OPAC item level holds"
    
    This patch changes the column heading on smart-rules.pl to indicate that it only effects item level holds on the OPAC side, rather than the intranet.
    To test:
    1. Go to Administration, circulation and fine rules.
    2. Observe incorrect heading on both the top and bottom of the table.
    3. Apply the patch.
    4. Repeat step 1.
    5. Observe new headings.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bcc537db059076ebed648846f40b59ddce27dace
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sat Jan 4 21:53:45 2020 +0000

    Bug 24343: Show subtitle, number and parts in course reserves list of titles in staff client
    
    Adapted from Bug 23784: At the moment only the title will display in the
    course reserves details, but not the information from other title
    fields. For series with multiple volumes that can lead to confusing
    display. The patch makes use of the new include to display 245$abnp.
    
    To test:
    - Add mulitple records to a course reserve course
      Make sure you have titles with different combinations of 245$b$n$p
      - Look at the course details in the staff client
      - Verify only $a displays
      - Apply patch
      - Reload
      - Verify now the full information displays
    
      Depending on your installation, you might want ot check that the 245
      are correctly mapped and save the record once so the database
      fields are correctly filled.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2f2f02297fbd09821f99544ba4d5027f08169fc8
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sat Jan 4 23:12:25 2020 +0000

    Bug 24344: Modify OPAC link to suggest existing record for purchase
    
    This patch modifies the link to suggest purchase of an existing record
    from the OPAC. The icon is changed to "gift" and the text shortened to
    "Suggest for purchase."
    
    To test, apply the patch and view the detail page of any record in the
    OPAC. Confirm that the modifications look good.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d8726c2e46b62a599a031dad442c45a6cfde0179
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jan 20 14:39:06 2020 +0000

    Bug 24289: (RM follow-up) Correction to DB update version
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 94ba314d58fdc1076387822456055ec522771ef0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 23 15:35:25 2019 +0100

    Bug 24008: Remove minus sign when displaying credit value
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3b3179a2145224d2f90a23dbe1d4d65df73f0279
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 10 12:27:08 2019 +0100

    Bug 24008: Display warnings in a list
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e6e039c7c7f419717ad1817352fd3d8bee70784a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 2 14:24:04 2019 +0100

    Bug 24008: Display a warning message when deleting a patron with outstanding credits
    
    So far nothing is displayed if a librarian removes patron with
    outstanding credits.
    Note that outstanding debits blocks the deletion.
    
    Test plan:
    - Create a patron with outstanding credit
    - Create a patron with outstanding debits
    - Delete the 2 patrons
    => With credit - You get a warning but do not block the deletion
    => With debits - You get a warning message that blocks the deletion
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f4949a649c68a0e0f6bd7b4af18668abb72fbc32
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 11 12:20:54 2019 +0100

    Bug 24214: Fix due date formatting when sticky
    
    When checking out and sticky due date is selected, on the next screen
    the due date is displayed iso-formatted, instead of following the
    dateformat syspref
    
    Test plan:
    0/ Do not apply the patch
    1/ Check an item out, with a selected due date. Tick "Remember for
    session"
    2/ Next screen you see the date like YYYY-MM-DD HH:MM
    regarless the value of the dateformat syspref
    3/ Apply this patch
    4/ Reload the page
    => The date is correctly formatted
    5/ Check an item out
    => Due date is correctly set
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d103621ada02496c1aa2ee4e6300b683b5a105f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jan 20 13:56:04 2020 +0000

    Bug 24289: DBRev 19.12.00.011
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2dbce72a07a5bdb664cc0faa4f989d97029a1249
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 26 12:06:10 2019 +0100

    Bug 24289: Make sure sample_holidays will load after sample_libraries
    
    They are inserted depending on their alpha order, and sample_holidays
    will fail because of missing branchcode.
    This patch suggests a simple fix: rename sample_holidays to
    sample_libraries_holidays, to make sure it will be loaded after
    sample_libraries
    
    Test plan:
    Start a fresh installation and select all sample data
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit be2ccfb25761c88d9ab0162f88325264ab4b57c0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 26 11:53:57 2019 +0100

    Bug 24289: DBIC changes
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 89f572ff5f9788d5e392804d04c5ce39d0655424
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 26 11:42:43 2019 +0100

    Bug 24289: Add foreign keys on *_holidays.branchcode tables
    
    Those are missing foreign keys, it will also clean the holidays tables
    and automatically remove the holidays when a library is removed.
    
    Test plan:
    0. Do not apply this patch
    1. Create a new library
    2. Create special and repeatable holiday for this library
    3. Remove the library
    => Notice that the holidays still exist in DB
    4. Apply this patch
    5. Execute the update database entry
    => Notice that the holidays for this library have been removed from the DB
    6. Repeat 1-3
    => Notice that the holidays have been removed along with the library
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 90c92686eb037ff032614a0f5b79da6c66e640eb
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jan 9 19:09:31 2020 +0000

    Bug 24393: Remove event attributes from patron clubs list template
    
    This patch removes some instances of the "onclick" attributes from the
    template that lists patron clubs and templates.
    
    To test, apply the patch and go to Tools -> Patron clubs.
    
     - Test the process of deleting a club template. Clicking the "Delete"
       button should trigger a confirmation. Confirming should delete the
       template.
    
     - Test the process of deleting a club. In the "Clubs" section of the
       page, click the "Actions" menu next to any club. Clicking the
       "Delete" link should trigger a confirmation. Confirming should delete
       the club.
    
     - Also in the "Clubs" section of the page, find a club which has
       enrollments. Select "Search to hold" from the "Actions" menu. It
       should take you to the advanced search. On the search results page
       you should have the option to place a hold for the club you selected.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 42b2292b4fb8b06f596f40aed2ec99b9f3dea30d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 22 10:16:15 2019 +0100

    Bug 24061: Close after timeout if onafterprint no supported
    
    Not supported on Chrome < 63
    https://www.w3schools.com/tags/ev_onafterprint.asp
    
    Signed-off-by: Gabriel DeCarufel <gabriel@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 98784cc9724ee917952fa3ea7e74e9695d131858
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 20 09:19:51 2019 +0100

    Bug 24061: Close the window after the page has been printed
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d07450e7efca8cd4cc30027dcc12d6fd15fa0d0
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Nov 21 16:26:53 2019 +0000

    Bug 16683: Help links to fields 59X in cataloguing form are broken
    
    This patch adds more specificity to handling of MARC21 documentation
    links in the basic MARC editor.
    
    To test, apply the patch and make sure the "advancedMARCeditor" system
    preference is set to "Display."
    
    You may need to edit a bibliographic framework so that 09x, 59x, and 69x
    tags will display in the editor.
    
    Edit or create a bibliographic record using that framework. Next to each
    tag label in the editor should be a "?" link. Clicking this link should
    open a new window with the correct Library of Congress documentation
    page.
    
    Check the links for 09x, 59x, and 69x tags as well as others to confirm
    they open the correct pages.
    
    Signed-off-by: Cori Lynn Arnold <carnold@dgiinc.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f94fc0c3905e190d0ee002ad17ad7c7619eb3281
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 18:10:07 2019 +0100

    Bug 17667: Add tests
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a155575f9df8b61cfc6efaa013e08fa647627acd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 18:10:15 2019 +0100

    Bug 17667: Do not modify quantity of the original standing order when a receipt is cancelled
    
    When cancelling a receipt, the quantity of the original order is
    increased.
    
    Test plan:
    Create a basket, mark is as "standing orders"
    Create an order
    receive it
    cancel the receipt
    => Without this patch the quantity of the original order is 2
    => With this patch applied the quantity it always 1
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a734156013b776e419c16dc72522ab3a913b241f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jan 16 14:52:00 2020 +0000

    Bug 24433: OPAC account page no longer asks for confirmation before deleting hold
    
    This patch restores markup added by Bug 21870 and subsequently removed
    accidentally by Bug 21772. This allows the OPAC user summary page to
    display a confirmation dialog before deleting a hold.
    
    To test, apply the patch and  log in to the OPAC as a user with holds.
    
     - On the "Your summary" page, click the "Holds" tab.
     - Click the "Cancel" button next to any hold.
     - You should see a modal dialog asking for confirmation, showing the
       correct title.
     - Test both the "Yes" and "No" actions.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 117c276859c4ed744580af46997c4d7eff0d78da
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jan 3 17:40:34 2020 +0000

    Bug 24341: Allow for more complex markup in OPAC confirmation dialogs
    
    This patch changes the globally-available confirmModal() function in the
    OPAC so that it uses jQuery's html() function for adding information to
    the confirmation modal's body. This will allow for more than just plain
    text to be added.
    
    This patch also removes some obsolete lines from the JavaScript in
    opac-user.tt and renames some variable for clarity.
    
    To test, apply the patch log in to the OPAC as a user who has holds and
    article requests.
    
     - Test the following interactions, both the confirmation and cancel
       options for each:
         - Cancel a hold
         - Suspend all holds
         - Resume all holds
         - Cancel an article request
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f2e5339a0313149e3cd6d96bddc40170d90a89be
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Nov 20 20:04:10 2019 +0000

    Bug 21296: suspend hold ignores system preference on intranet
    
    This patch modifies the DataTable configuration for the table of holds
    which displays under the "Holds" tab on the patron's checkout and
    details pages. A variable is now defined in the JavaScript with the
    value of the "SuspendHoldsIntranet" system preference. This variable is
    passed to the DataTable configuration to determine whether the column is
    visible or not.
    
    One of the changes made in this patch moves a <script> block so that it
    appears before some of the JS includes on the page. This helps keep the
    string-defining JS together in one block.
    
    To test, apply the patch and set the "SuspendHoldsIntranet" system
    preference to "Allow."
    
     - Open the checkout page for a patron with one or more holds.
     - Under the "Holds" tab, the table of holds should have a "Suspend"
       column with controls for suspending or resuming holds.
     - Check that the same is true on the patron detail page.
     - Set the "SuspendHoldsIntranet" system preference to "Don't allow."
     - Test the checkout and detail pages again and confirm that the
       "Suspend" column does not appear.
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 31413de662ecd81ea1b4116bb1d60dfaefed11d8
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Jan 12 10:32:17 2020 +0100

    Bug 24404: Add missing space on invoices page / remove . from status
    
    On the bottom of the invoices page the summary of adjustments and
    shipping shows as:
    
    Adjustments plus shipping:2.00
    
    The patch adds the missing space between text and amount.
    
    To test:
    - 'Receive shipment' from a result in your vendor search
    - Start a new invoice by entering an invoice number, amount
      for shipping cost and fund.
    - Finish receive (you don't need to receive anything)
    - You should now be on invoice.pl
    - Verify Status is 'Open.' and in 'Invoice details' we
      have the amount with the missing space.
    - Apply patch, reload the page.
    - Verify the missing space is there and the . is gone.
    - Close invoice, no . there either.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0763a69ec3a910dc416cae1dbfc2785eb1cff6f7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jan 9 12:48:04 2020 +0000

    Bug 24333: Add password class to AutoSelfCheck syspref
    
    To test:
    1 - Go to Administration
    2 - Search sysprefs for AutoSelfCheck
    3 - Enter something into AutoSelfCheckPass
    4 - Note it is not masked
    5 - Apply patch
    6 - Reload page
    7 - Note password is now masked
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eaee34f47a138dfcb9fd2caf59a6fc3befc37932
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 16:10:53 2019 +0100

    Bug 24018: Remove die "Not logged in"
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eb4a843aced59b6c80d772e9b6d15a3e963d0af6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jan 15 15:27:56 2020 +0000

    Bug 24423: Add biblionumber to modify items link
    
    To test:
    - Find/create a bib with at least one item
    - From detail.pl, use the checkboxes in the holdings table to select one or more items
    - click the "Modify Selected Items" link just above the holdings table to take your item(s) to batch modification
    - Change something and click save
    - Observe that the Return to the Record link points to a url without a biblionumber: "/cgi-bin/koha/catalogue/detail.pl?biblionumber="
    - Apply patch
    - Repeat
    - The link now works!
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    
    Signed-off-by: David Nind <david@davidnind.com>
    
    Bug 24423: Fix for deletion - cleanup accidental debug inclusiopm
    
    To test:
    Repeat prior test plan with 'Delete selected'
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d7ab16402a4955a3436d3da857fa4ac4f4427269
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue Jan 14 18:44:01 2020 +0000

    Bug 24395: Show initial float using the Price TT plugin on summary page
    
    For displaying monetary amounts, we should be using the Price TT
    plugin everywhere. This adds it to the cash register summary page.
    
    To test:
    - Create a cash register
    - Check the cash register table for "Initial float"
    - Verify the amount shows with more than 2 decimals
    - Edit cash register - verify the same display there
    - Apply patch
    - Check again - it should display now with only 2 decimals
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Caroline Cyr La Rose <caroline.cyr-la-rose@inlibro.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d135f229cd67fa68a1d55ee0206b501e329d2f1e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jan 16 14:33:39 2020 +0000

    Bug 22220: Fix bib Apache rewrite rule for intranet
    
    Trivial change. Speaks for itself.
    Since koha/detail.pl does not exist, we cannot break things ;)
    
    Test plan:
    [1] Copy the change in apache-shared-intranet.conf to your actual
        apache configuration. Probably in /etc/koha/.
    [2] Restart Apache.
    [3] Try a biblionumber say 123 on intranet with [your_staff_client]/bib/123.
        Does the detail page come up?
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 234b8a256232f25217d40e2edc44a00db891e1a0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jan 20 13:33:58 2020 +0000

    Bug 21520: (RM follow-up) Add missed schema update
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e59ebe938a93cab552780171f93eefe7a0fd04a6
Author: Mason James <mtj@kohaaloha.com>
Date:   Fri Nov 29 12:11:15 2019 +0000

    Bug 24445: Add z3950 to makefile (bug 13937 follow-up)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2dc48d09886200796fe9fa94686781abb1fd2edf
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 16 14:37:15 2020 +0000

    Bug 21520: (RM follow-up) Reduce added constraints
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eed6cc84c32eabab354bb515364fc897ef098003
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 15 16:17:41 2020 +0000

    Bug 21250: DBRev 19.12.00.010
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e6a6f4237ed108879653a2dbf3d4ca29ae4fca64
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Dec 19 13:19:11 2019 +0000

    Bug 24275: Apply anti-the to title column in inventory table
    
    To test:
    1 - Go to Tools->Inventory
    2 - Click submit (or add options to get a subset of titles)
    3 - Try sorting by title, note that titles with leading articles sort including the articles
    4 - Apply patch
    5 - Reload the page
    6 - Note that leading articles are ignored for sorting
    
    Signed-off-by: Deb <dstephen@dubuque.lib.ia.us>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 43c8ca958f217251d8d52eb1f3a3f48fae3051ca
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Mon Jan 13 16:26:30 2020 +0100

    Bug 21520: (QA follow-up): Updatedatabase
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e7c032e1dd75df48d7192d5a67759fc532ea3a6b
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Fri Jan 3 10:53:34 2020 +0000

    Bug 21520: QA Follow-up: do not build html tags with TT conditions
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit de0161db1ecbf2106bdf9fbbcf5a4cd9e36a192b
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Wed Nov 20 15:59:28 2019 +0100

    Bug 21520: More complex OAI sets mappings
    
    Currently, the rules used to create OAI sets are processed with the 'or'
    boolean operator between each rule.
    
    This patch allows to use 'or' or 'and' between the rules.
    
    The evaluation of the rules is done according to the boolean operators
    precedence: AND has a higher precedence than OR.
    
    For example:
    
    A and B or C and D
    
    will be evaluated as follow:
    
    (A and B) or (C and D)
    
    Test plan:
    
     - Apply the patch
     - Apply the atomicupdate
     - Prove t/db_dependant/OAI/AndSets.t
     - Check that existing mappings still work
     - Try modifying existing mappings
     - Try creating new mappings
     - Check that the boolean operators precedence is correctly taken into account
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1906a69e512789ebbf194bd487aa8f88768de4c8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 14 10:34:48 2020 +0100

    Bug 20567: Count found holds for holds limit
    
    Signed-off-by: Hans Palsson <hans.palsson@hkr.se>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d29766433b5291b8cb97607934f6f3476ad516e6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 14 10:33:03 2020 +0100

    Bug 20567: Add tests
    
    Signed-off-by: Hans Palsson <hans.palsson@hkr.se>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b130c2eed52ba108752269470741c1321c67e96
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jan 15 09:45:24 2020 -0300

    Bug 23893: Special care for booleans
    
    This patch acknowledges the fact that in D8 the Mojo::JSON->true and
    Mojo::JSON->false values don't translate into integers when passed to
    DBIC. It works correctly on D9 onwards, but we haven't formally
    deprecated Jessie. This is adding back this translation, in the right
    place now that all mappings code has been integrated into
    Koha::Object(s) directly.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Object.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit feb625ce50af6765498feb2ab15912e0286f48a9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jan 9 17:45:47 2020 +0000

    Bug 24391: Remove event attributes from patron clubs edit template
    
    This patch removes "onclick" attributes from the template for adding and
    editing patron club templates.
    
    To test, apply the patch and go to Tools -> Patron clubs -> New club
    template.
    
    Test the process of adding and deleting both club and enrollment fields.
    Test during the template add process and when editing an existing
    template.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd3506465737a388679b905b73d8310f7014ba1d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 13 16:45:58 2020 -0300

    Bug 24366: Make sure accessors are used on the right object
    
    This patch makes the Koha::Biblio->to_api method try the accessors on
    $self first, and fallback to $self->biblioitem on those he can't.
    
    This way it won't happen that (for example) ->holds will be tried
    against ->biblioitem.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Biblio.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52bb48ab4500a5bf507e0a3083710dfeeec52f4b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 13 15:16:20 2020 +0100

    Bug 24366: Improve hashref construction
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52d3b5439ddf5efd374749548a523a4a8e7ccd8a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 7 14:41:50 2020 -0300

    Bug 24366: Merge biblioitem in Koha::Biblio->to_api
    
    This patch moves the bilbioitem object merge into the
    Koha::Biblio->to_api method, as opposed to doing it in the controller.
    This is an inevitable change as other endpoints might require to embed
    biblio objects, and they need to carry the biblioitem information.
    
    Also, if we merge the tables, the transition will be straightforward
    (remove the tests this patch introduces, and merge the mappings from
    Koha::Biblioitem into Koha::Biblio).
    
    To test:
    1. Apply this patches
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Biblio.t \
               t/db_dependent/api/v1/biblios.t
    => SUCCESS: Tests pass! i.e. the new to_api method is tested, and the
    API tests don't expect any behavior change.
    3. Sign off :-D
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d634ca43057f679009294bb11931f831914fff9
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 7 14:45:41 2020 -0300

    Bug 24366: Unit tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c07a433a188ea72814d9efb91c63835b4a60dd6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jan 14 10:29:47 2020 -0300

    Bug 24350: ->pickup_locations returns unblessed objects
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2d03cfca1fdf6096cff021ac09847be27a9a6ab8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jan 14 09:29:45 2020 +0000

    Bug 23354: (RM follow-up) Italian sample notice
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c742686651b155c409486ae3aa4d54ebc288c0a9
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 13 15:44:33 2020 -0300

    Bug 18731: Overload K::A::Fund->to_api to avoid conflict
    
    This patch overloads the to_api methods on the Fund class, so
    conflicting (on mapping) attribute names are not a problem.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Acquisition/Fund.t \
               t/db_dependent/Koha/REST/Plugin/Objects.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cfba7e7364dc1f1fd84dfff3021b51c06d159c92
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jan 13 16:46:24 2020 +0000

    Bug 23354: (RM follow-up) Update translated sample_notices
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b28378267f613f9c69c83a496a44ed443edc998
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jan 13 16:36:21 2020 +0000

    Bug 23354: (RM follow-up) Reword remaining can_be_added_manually
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c89fd3989990beaef8056c946d1dd642d0042bf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 13 15:35:57 2020 +0100

    Bug 24361: Remove warning from GetAgeRestriction
    
    Use of uninitialized value $record_restrictions in uc at /kohadevbox/koha/C4/Circulation.pm line 3981
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f1df9f17287d47fbaef9085a2e969df170306249
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jan 13 14:13:41 2020 +0000

    Bug 23354: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ceba85dfd56b474594d0f6911d02f80621e8b74d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jan 13 14:12:47 2020 +0000

    Bug 23354: DBRev 19.12.00.009
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3fbe262eb2b8d79279f905ba764b0df4d275e309
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Sun Jan 12 18:43:03 2020 +0000

    Bug 23354: (QA follow-up) Fix spelling in templates
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ade421e89634b99f6e08f4c8c3e98f358c8621d0
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Sun Jan 12 18:41:30 2020 +0000

    Bug 23354: (QA follow-up) Make db update idempotent
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2d6801eb5ca024935ffaffb1488789fba08b2a50
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 10 11:52:31 2020 +0000

    Bug 23354: (QA follow-up) Rename test file
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8767a6bc3565522c36c7b760675bcda7a82127bf
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 10 11:48:56 2020 +0000

    Bug 23354: (QA follow-up) Allow manual receipt printing
    
    This patch adds an alert message that allows receipt printing for
    transactions when FinePaymentAutoPopup is not enabled.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2210e9485faaea9ca3d6dcedceaa57a1cefd948e
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Jan 10 09:16:21 2020 +0000

    Bug 23354: (QA follow-up) Add missing filters, remove tab chars
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12fce1495207a87af28345a72e4ff396ef6ed190
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Jan 10 09:11:30 2020 +0000

    Bug 23354: (QA follow-up) Mark boolean columns in schema
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a65363acd50e8c1dae2797117d01f6b6687ee870
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 20 12:52:13 2019 +0000

    Bug 23354: Prevent negatives from being entered
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b151f71ddc084ff75008b2db07b123ed307b2241
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 20 12:38:57 2019 +0000

    Bug 23354: Format price on item add
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e71b615cf63ed9c5f1cba1facbdce80f119ef7df
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 20 09:30:48 2019 +0000

    Bug 23354: (follow-up) Fix for sending code instead of description
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 01faf14d8b0b0239e22d1b3a6ae3874b5597cdcc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 20 07:53:05 2019 +0000

    Bug 23354: (follow-up) Update for bugs 23049 and 23805
    
    Remove all mentions of accounttype and replace with debit_type_code and
    credit_type_code as appropriate.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4543156930c1074bdd929a1c9d340917feb4a148
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 25 14:37:34 2019 +0100

    Bug 23354: (follow-up) Ensure 'CASH' payment type is present
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 454d4745b72aaf339a86cc1cd4c12ec8e00c82e5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 17 13:19:34 2019 +0100

    Bug 23354: (follow-up) Make display of debit types configurable
    
    This patch adds a the ability to define where a debit type will be
    available as a option for use.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cae27cb5934005ce0ad1724e4447668739650f4e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 3 17:13:25 2019 +0100

    Bug 23354: Update to account for bug 23049
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a63932af346b0d29f189a84bd7e30a8d38a65b9f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 3 14:39:00 2019 +0100

    Bug 23354: Add Icon for POS system
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd996e1ff98d9e9013830ff877b036075da1ef94
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Sep 23 14:12:13 2019 +0100

    Bug 23354: (follow-up) Use 'format_price' for totals
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 49e5debfc2a1f1c5a18704b6742fd0f27f063b7c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Sep 23 13:51:11 2019 +0100

    Bug 23354: (follow-up) Input type on jEditable
    
    Update the jEditable plugin to a maintained version and use the new
    'number' type to enable increment arrows on click and remap onblur event
    to submit.
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cf27a62f707bbf474023fb5edf86960c7cf4e4b4
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Sep 17 12:28:56 2019 +0100

    Bug 23354: Add tests for Koha::Charges::Sales
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9688209732e5e3498c6da5d2a1181fabfac11c64
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Sep 11 10:44:56 2019 +0100

    Bug 23354: Add permissions
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd2dc613a361b379a229e34cabdcb68493a46a8f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Sep 5 10:13:57 2019 +0100

    Bug 23354: (follow-up) Responses to feedback
    
    This patch impliments a number of refinements requested after the first
    round of feedback from the sponsors.
    
    1) Fix padding on pay page
    2) Switch 'items to add' from right to left on the page
    3) Fix editable columns on pay page
    4) Add explanitory text to pay page
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit deb596a210fb48e579cd790b33abbca72b305dac
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Aug 13 11:16:25 2019 +0100

    Bug 23354: Add ability to remove items
    
    This patch adds the ability to remove items from a transactions on the
    new Point of Sale pay page.
    
    Test plan:
    1) Populate a transaction with at least one item.
    2) Note the new button to 'Remove item' on the items table.
    3) Click the button and confirm the item is removed
    4) Signoff
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd9cfda29f1b6007919506839eb83dbe1034a43f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Sep 17 12:28:30 2019 +0100

    Bug 23354: Add receipting to Pay page
    
    This patch adds receipt printing to the new Point of Sale pay page.
    
    Test plan:
    1) Apply patch and run database update
    2) Enable automatic receipt printing via the `` system preference.
    3) Make a payment for an item via the new POS pay page.
    4) Note that a receipt printing dialogue is shown automatically after
       payment.
    5) Note that a new notice is available under tools where you can alter
       the content of the receipt.
    6) Signoff
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3e6ef8614a5c7eaf47a903b68518c404cc657091
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jul 23 17:23:55 2019 +0100

    Bug 23354: Add a Point Of Sale 'pay' screen
    
    This patch adds a new Point Of Sale module to Koha's staff client front
    page. The module button leads directly to a 'Pay' page giving the staff
    user the ability to record anonymous payments for items that would not
    normally require a patron to be registered at the library.
    
    Test plan:
    1) Enable `UseCashRegisters` via the system preferences.
    2) Ensure your user has the 'manage_cash_registers' permission.
    3) Add a cash register for your current branch.
    4) Add at least one 'MANUAL_INV' authorized value.
    5) Navigate to the new 'POS' pay page via the main menu.
    6) Add an item to the 'sale' by clicking 'add' from the right side of
       the screen.
    7) Note that said item was added to the table of items this sale on the
       left.
    8) At this point you should be able to 'click to edit' the quantity or
       price of the item in the table on the left.
    9) Enter an amount greater than the price of the item into the 'amount
       collected from patron' box.
    10) Click 'Confirm'
    11) Varify that the same change to give modal from the paycollect pages
        appears here.
    12) Click 'Confirm'
    13) Payment will have been recorded (check the database) and you will be
        back at a fresh 'Pay' page ready for the next transaction.
    14) Signoff
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a7091d48c05020f2179184b7e50fdcd6d4b0ba3
Author: Caroline Cyr La Rose <caroline.cyr-la-rose@inlibro.com>
Date:   Wed Oct 9 15:34:24 2019 -0400

    Bug 23790: fr-CA translation of ACCOUNT_DEBIT and ACCOUNT_CREDIT notices
    
    This patch provides the fr-CA translation of the ACCOUNT_DEBIT and ACCOUNT_CREDIT notices.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Tested deleting from letter table, then loading the file.
    File loads without problem, no errors.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 312e773d65624f37bc9597df2db471c3f7877127
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 29 10:57:18 2019 +0000

    Bug 18355: (QA follow-up) Rearrange comments, improve code
    
    Comments were hard to read (for me) but tastes differ..
    
    Code should reflect that permanent_location is a code and that location
    may be already an authval. See detail.pl:
    $item->{'location'} = $shelflocations->{$shelfcode} if ( defined( $shelfcode ) && defined($shelflocations) && exists( $shelflocations->{$shelfcode} ) );
    
    Obviously, this kind of logic divided over two places should be reduced.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 44e4110d6ee712e0a78646590d6df12aa7d0449f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 1 11:23:48 2018 -0300

    Bug 18355: Display permanent location with cart location
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4e8ecf0d3dbd3dc1bc58a42586abe72b26395c8d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 5 17:04:45 2019 -0300

    Bug 21466: Catch any values that should be defined in the AV but are not
    
    Let's expand the idea of the first patch to catch the wrong values for
    any others AV.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e48d396002588d7d6c16ec7d72bcc32227eae6ee
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 17 15:08:58 2018 -0300

    Bug 21466: Search for items.location inconsistencies
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit df80750e5e8151ee08b7ed49a205d7e27d983e4b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 10 11:10:50 2020 +0100

    Bug 24408: Do not compare floats with precision in tests
    
    We should not compare floating precision in tests.
    
    Test plan:
    Confirm that the tests still pass after this patch
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a6b0ebfb09e6d9c7005887c7b68eb49ba9878998
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Dec 6 15:35:27 2019 +0000

    Bug 24146: Illustrate increasing and decreasing fine
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f94b32f074df1dbded3e074877418aaae7a55315
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Dec 6 15:10:17 2019 +0000

    Bug 24146: Corrections to UpdateFine logic concerning maxFine
    
    The `maxFine` system preference actually refers to the amount of
    outsanding debt (in fines) a patron may have at a given time. This patch
    corrects the functionality of UpdateFine such that it properly respects
    that counter given the payment of accruing fines scenario.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a1e1a1f88dbab6ad604244b442e7519aa9a3d3d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Dec 5 10:14:51 2019 +0000

    Bug 24146: Increment existing fine
    
    We should increment an existing fine even if it has been fully paid off
    whilst it is still incrementing and not create a new fine.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ba7c2236d529143b0eac0e458778658574cdc5f2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Dec 4 14:23:14 2019 +0000

    Bug 24146: Add test cases
    
    This patch adds test cases for both checking amountoutstanding values
    are handled correctly and also that the paid down accruing fines do not
    add additional fines on increment.
    
    Test plan:
    Read the changeset and asses whether the changes/additional tests are
    correct as per the expected behaviour.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0c4f4dbadaacaf952bd5696c238643877c39aa64
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Sun Jan 12 03:11:13 2020 -0300

    Bug 24350: (follow-up) Fix pickup_location test in t/db_dependent/Template/Plugin/Branches.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6cd1ffab4e491349c99769018a7df33dc8a8aabf
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Sun Jan 12 01:11:52 2020 -0300

    Bug 24350: (follow-up) Clear Koha::Libraries->pickup_locations() and move logic to Koha::Template::Plugin::Branches->pickup_locations().
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3e6963e1831bfbf782c35c7fc0781ebc405f5e1f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jan 13 09:27:35 2020 +0000

    Bug 23676: (RM follow-up) Test Correction
    
    We altered the query form passed by the ElasticSearch Query Builder
    but neglected to update the test.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 98cb9a5ebd6bafc95051bffa4b7460ce6dcfec4d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jan 13 09:22:20 2020 +0000

    Bug 15142: (RM follow-up) Fix tests
    
    We removed the su-ut facet from zebra config for UNIMARC as it makes no
    sense for that case, but we neglected to remove it form the test that
    checks the config response.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d8f1c88fee7b4c7b4fef9b8383a91a9d741e75f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jan 13 09:11:26 2020 +0000

    Bug 24206: (RM follow-up) Add bug number to DB revision
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fbf326f8573c74359f3b1914184d132e629d89c6
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Jun 17 16:09:38 2019 +0200

    Bug 22426: Map 'loc' to 'location' when building ES queries
    
    A search made on Shelving location tab in advanced search gives 0 result.
    
    Test plan :
    Without patch:
        - in advanced search, choose a location in shelving location tab and start search (opac-search.pl?idx=kw&op=and&idx=kw&op=and&idx=kw&do=Search&limit=mc-loc)
        - 0 result
        - check that location exist by doing a simple search and filtering on the    location facet
        - have some results
    With patch:
        - in advanced search, choose a location in shelving location tab and start search (opac-search.pl?idx=kw&op=and&idx=kw&op=and&idx=kw&do=Search&limit=mc-loc)
        - found results
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bed334ee4dd8e8f0ec5205c1faabdc1e40e00061
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Sep 25 19:04:13 2019 +0000

    Bug 23676: Use 'false' for opac suppression
    
    To test:
     1 - Enable ES
     2 - Enable OpacSuppression
     3 - Suppress a bib in staff client
         Edit 942n to be 1
     4 - Search the opac for anything
     5 - Tail the plack logs and note a deprecation warning
     6 - Apply patch
     7 - Restart all the things
     8 - Repeat search on opac
     9 - No error/warn in logs
    10 - Record is correctly suppressed
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c0dc6efffa35bb6ecaf579a9c63cfb3e04137eb
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Fri Aug 31 15:32:20 2018 +0300

    Bug 17885: Koha::SearchEngine::Elasticsearch->reset_elasticsearch_mappings throws DBD::mysql Duplicate entry exceptions
    
    When executing
    Koha::SearchEngine::Elasticsearch->reset_elasticsearch_mappings()
    against populated search engine mappings tables, one gets this
    exception:
    
    DBD::mysql::st execute failed: Duplicate entry '388-73' for key
    'PRIMARY' [for Statement \"INSERT INTO `search_marc_to_field` ( `facet`,
    `search_field_id`, `search_marc_map_id`, `sort`, `suggestible`) VALUES (
    ?, ?, ?, ?, ? )\" with ParamValues: 0='', 1='73', 2='388', 3=undef,
    4=''] at /usr/share/perl5/DBIx/Class/Storage/DBI.pm line
    1834.\nDBIx::Class::Storage::DBI::_dbh_execute(): Duplicate entry
    '388-73' for key 'PRIMARY' at /home/koha/Koha/Koha/SearchField.pm line
    38"
    
    This patch fixes this, by first deleting all entries, then adding the
    default ones.
    
    If a subroutine says reset_elasticsearch_mappings(), I expect it to
    reset the elasticsearch mappings without errors.  When writing tests it
    is better to call that one subroutine reset_elasticsearch_mappings
    instead of the bunch of code in
    admin/searchengine/elasticsearch/mappings.pl?op=reset_confirmed
    Also this promotes code reuse.
    
    TEST PLAN:
    
    a. perl -e 'use Koha::SearchEngine::Elasticsearch; Koha::SearchEngine::Elasticsearch->reset_elasticsearch_mappings'
    b. Run misc/devel/populate_db.pl on an already populated DB and you eventually
    face this problem.
    
    After this patch, step a. works.
    
    This patch is adapted from the original patch made by Olli-Antti
    Kivilahti <olli-antti.kivilahti@jns.fi>.
    
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 73ce2a36856f2738f304d4212d918ba424896263
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Oct 31 13:52:05 2019 -0400

    Bug 23934: Item level holds not checked for LocalHoldsPriority in Holds Queue
    
    Test plan:
    - Set LocalHoldsPriority to "Give priority for filling holds to patrons
    whose pickup library matches the item's holding library"
    - set yourself at Library A
    - find at item at Library A
    - place an item-level hold (Hold 1) for item for pickup at Library B
    - set an item-level hold (Hold 2) for item for pickup at Library A
    - Confirm Hold 1 shows priority=1
    - Check in item
    - confirm item would be captured for Hold 2, ignore hold
    - run holds queue
    - check item in
    - confirm item is captured for Hold 2
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c470d9cb2ba44edc100aa775bc658550b81bb0eb
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Oct 31 13:51:33 2019 -0400

    Bug 23934: Unit test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6bba5a35c0d901b6b0f9d4c22dacd64b4fc428bb
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue Dec 31 10:30:32 2019 +0100

    Bug 15142: (follow-up) Remove facet configuration from .xsl file
    
    Removes last remaining bit of configuration for the Titles facet
    configuration.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5a4ac1577b17dcb1eab32766b258059049b608a8
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Nov 26 09:44:08 2019 +0100

    Bug 15142: (follow-up) remove from Zebra UNIMARC config files
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 790f0ee5728493719bb63b89a5e3007a499b4bd0
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Nov 22 15:16:51 2019 +0100

    Bug 15142: Remove titles facet for UNIMARC
    
    There is a facet using 500$a, 501$a and 503$a and Subject index.
    In UNIMARC 500$a, 501$a and 503$a are not indexed as Subject.
    I propose to remove this facet for UNIMARC, looks like it does not make
    sens.
    
    Test plan:
    1) Install UNIMARC database
    2) Edit some records to have 500$a
    3) Perform a search to find those records
    4) Check you dont see the titles facet
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd5e488c2b3c12b13b96adda86598ada6da626fa
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jan 2 18:06:20 2020 +0000

    Bug 9156: Clarify order in the syspref
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 24fe303be11af93199f8d881a04170484a5571e7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Dec 19 19:05:36 2019 +0000

    Bug 9156: (follow-up) Simplify code
    
    The MARC::Field as_string method can join multiple subfield using a delimiter, this simplifies the code here
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da2f9e7500b08f4a8f942617a2d10bef922b16ed
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Nov 19 14:56:05 2019 +0000

    Bug 9156: itemcallnumber not pulling more than 2 subfields
    
    When the itemcallnumber system preference is defined, the item add form
    pulls data from the specified tag and subfield(s) to pre-populate the
    call number field. This update makes it possible to build the
    prepopulated callnumber from more than just the first two subfields.
    
    To test, apply the patch and update the itemcallnumber system preference
    so that it includes more than two subfields. For instance, "092abef"
    
     - Edit a bibliographic record and populate the specified subfields.
       e.g. subfield a -> "One", b-> "Two", e-> "Three", f-> "Four".
     - Save the record and go to the add/edit items screen.
     - The call number field should contain a string which contains each of
       the subfields you populated, concatenated with spaces: "One Two Three
       Four."
     - Test with other numbers of subfields.
     - Test with an empty itemcallnumber preference.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8c6cb79f660921d8d3dd35dcdbaa2aff18e3820f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 10 16:11:56 2020 +0000

    Bug 24206: DBRev 19.12.00.008
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1599fb92e99f02bccfb8b02561495f4f4de028e7
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Dec 22 13:07:46 2019 +0000

    Bug 24206: Update content of OpacSearchForTitleIn for existing installations
    
    This includes a database update for existing installations.
    Using the REPLACE function it makes the same changes to the URLs
    as the previous patch did for new installations:
    
    - Worldcat: now https
    - BookFinder: now https
    - OpenLibrary: remove / before search parameters
    
    To test:
    - Verify the current content of your preference OpacSearchForTitleIn
      (without changes from first patch!)
    - Run the database update
    - Verify everything still works, but changes have been made
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5eceeb1bc823eb3602de698b2938d75cddd69a6d
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Dec 22 13:05:34 2019 +0000

    Bug 24206: Update URLs for default options in OPACSearchForTitleIn
    
    - Worldcat: now https
    - BookFinder: now https
    - OpenLibrary: remove / before search parameters
    
    To test:
    - Verify changes to the installer files are correct
    - Bonus: run the web installer for en, de-DE and nb-NO and
      verfiy the content of OPACSearchForTitleIn is correct
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 553f5f1944ef7e5afa62d20166afbf91ea16595e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 6 23:08:55 2020 +0100

    Bug 24358: (bug 21232) Make the alert string translatable
    
    "Bibliographic record does not exist!" was not translatable as it was
    defined in the .js file
    
    Test plan:
    Repeat test plan from bug 21232
    
    Bonus point: update and install a localized version and confirm that the
    message is translatable
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b7bf4bd354bbba55a00ddebe166048dc5d33b4e2
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jan 10 15:37:46 2020 +0000

    Bug 24350: (follow-up)  Unbless each library, not the array
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 263c01312164164da951733f2d28e58c9b80335b
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jan 10 10:49:45 2020 +0000

    Bug 23377: (QA follow-up) Use OVERRIDE_SYSPREF
    
    SYSPREF_OVERRIDE unfortunately is not supported ;)
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f036038318acb99d56a251ca6c59218a233610d0
Author: Ian Walls <ian@bywatersolutions.com>
Date:   Wed Jul 31 16:32:23 2019 +0000

    Bug 23377: use ENV syspref override instead of complete disable
    
    In an attempt to save time, bulkmarcimport temporarily sets CataloguingLog
    and AuthoritiesLog to 0.  It does this by disabling syspref caching and saving
    the changes to the database (then replacing the original values at completion).
    
    Unfortunately, this disables other key sysprefs from being cached, and results in
    a 50% increase in processing time for the script.
    
    This patch instead utilizes the ENV variable override feature of sysprefs, which
    preempts the cache in C4::Context->preference().
    
    To test:
    1. Perform a bulkmarcimport with a reasonable number of biblios (~1000 will do)
    2. Note the time taken to complete
    3. Apply patch
    4. Revert the biblio load performed
    5. Perform another bulkmarcimport with the same biblios and commandline options
    6. Note the time taken to complete
    7. Compare times.  The time from step 6 should be about 33% less than the time from step 2
    8. Check Cataloguing and Authorities Logs to verify imported records were not logged
    9. Profit!
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3e93514ac3fbf35691aaad90fa6121d176bdb9b1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 10 11:48:09 2020 +0100

    Bug 24200: Try to fix random failures from Borrower_PrevCheckout.t
    
    It failed inconsistently, let's try to use build_sample_item and see if
    it fixes the random failures.
    
    Test plan:
     % prove t/db_dependent/Patron/Borrower_PrevCheckout.t
    must return green
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2278ff2b08e3e3b4ddd320fa665ee468420874bf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 10 11:29:15 2020 +0100

    Bug 24396: Fix Suggestions.t with MySQL 8
    
     #   Failed test 'DelSuggestion deletes the correct suggestion'
     #   at t/db_dependent/Suggestions.t line 413.
     #          got: 'my title 3'
     #     expected: 'my deleted title'
     t/db_dependent/Suggestions.t .. 112/113 # Looks like you failed 1 test of 113.
    
    Suggestions were returned in the reverse order. Adding an ORDER BY clause fixes the problem.
    
    Test plan:
     % prove t/db_dependent/Suggestions.t
    must return green
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1c38ddf41032a7da72ce8dedead385e581bf1ff6
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jan 3 20:02:26 2020 +0000

    Bug 24337: Checkout note cannot be marked seen if more than 20 exist
    
    This patch modifies the event handler on the individual "Mark seen" /
    "Mark unseen" buttons in the table of checkout notes. For an event to be
    successfully attached to a hidden element it must be given a context.
    
    To test you should have multiple checkout notes to work with, both seen
    and unseen. Apply the patch and go to "Checkout notes pending" from the
    staff client home page.
    
     - Navigate to the second "page" of data in the DataTable.
     - Test the functionality of the "Mark seen" and "Mark unseen" buttons.
       They should work correctly.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f78eaf0461b4a685b3e13856f4c738a6429c0514
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jan 3 18:43:15 2020 +0000

    Bug 24335: Cannot mark checkout notes seen/not seen in bulk
    
    This patch changes the way checkbox events are handled on the checkout
    notes page so that checking a checkbox enables the batch operation
    controls.
    
    Note: The addition of a "markseen" class is a preventative measure to
    avoid future problems where using the "btn-small" class might not be
    specific enough.
    
    To test you should have multiple checkout notes to work with, both seen
    and unseen. Apply the patch and go to "Checkout notes pending" from the
    staff client home page.
    
     - Check any checkbox. The "Mark seen" and "Mark not seen" should go
       from disabled to enabled.
       - Test that the buttons work correctly.
     - Click the "Select all" and "Clear all" controls and confirm that the
       buttons are enabled and disabled correctly.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 50d2d3d139621dfe6c81941aea1c40dbb45e3c50
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 26 12:57:17 2019 +0000

    Bug 23274: Mock simple_search_compat to cover both search engines
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bae538dcddd58cd7e387b2bfe178771071da942d
Author: Cori Lynn Arnold <carnold@dgiinc.com>
Date:   Tue Dec 31 17:10:14 2019 +0000

    Bug 24323: Advanced editor - Display an error message if the record did not save
    
    Invalid 008 with helper silently fails to save.
    
    This patch adds a "else if" to fall through if the error message isn't
    one of the previously defined ones ("syntax" and "invalid") and presents
    the human with a generic message that "Something went wrong, cannot
    save."
    
    Prior to testing:
    a/Verify that Advanced Editor is enabled
    b/Download the errorrecord.mrc from bug
    
    To test:
    1/Apply patch
    2/Go to Cataloging->Advanced Editor
    3/Click "Import Record" button and navigate to the record saved from
    step b/
    4/Add an 003 field (as required by the default cataloging config)
    5/Hit "Save to catalog"
    6/Verify that a message is passed to the user that the file was unable
    to be saved
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a12fca041c81cb10fd1e8f24658f7adf6d5d112d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jan 10 09:56:12 2020 +0100

    Bug 24371: Fix "Show all items" avaibility link (use $raw filter) - intra
    
    Same fix for the intranet side
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e4078e0d98031dff7ce773209afa9191e5b644b7
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Tue Jan 7 18:54:49 2020 +0000

    Bug 24371: Fix "Show all items" avaibility link (use $raw filter) - opac
    
    TO TEST:
    1. Make an OPAC search with plenty of results.
    2. Use the search facets to limit the search in some way, item type, author, etc.
    3. Click on 'Limit to currently available items', everything is still fine.
    4. Attempt to return to 'Show all items', there will be no search results.
    5. Apply patch
    6. Ateempt steps 1-4 again.
    7. Should work this time.
    
    Signed-off-by: Rhonda Kuiper <rkuiper@roundrocktexas.gov>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 09c985822eec479a351b869e2556cefe36e9824b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jan 7 19:52:25 2020 +0000

    Bug 24373: Correct basic cataloging editor CSS
    
    This patch makes minor corrections to the basic MARC editor CSS, fixing
    an error caused by Bug 23259.
    
    To test, apply the patch and clear your browser cache if necessary.
    
    Open the basic MARC editor and check the numbered tabs. There should be
    no stripe of green background showing below the tabs.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Guillaume Paquet <guillaume@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d7a772d04c54442e7d38ad8ff2a60e1242e0d29
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 9 16:17:12 2020 +0100

    Bug 14759: Add test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7ea3cb0c9c7ef1bd198ab914451ac46e13301a8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 8 09:13:18 2020 +0000

    Bug 14759: Replace Text::Unaccent with Unicode::Normalize
    
    As shown in the comments on the bug, it appears that Unicode::Normalize
    is the most reliable way to strip accents from strings for this use
    case.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4fcf7af117153690cc4aca55eb47290dfc5814f6
Author: Caroline Cyr La Rose <caroline.cyr-la-rose@inlibro.com>
Date:   Thu Jan 9 14:52:24 2020 -0500

    Bug 24394: Typo when adding a new cash register
    
    This patch corrects a typo in the cash register template.
    
    To test:
    1) Go to Administration > Global system preferences
    2) Search for UseCashRegisters
    3) Enable UseCashRegisters and save
    4) Go to Administration > Cash registers
    5) Click on 'New cash register'
    6) Notice the title says 'Add new cash_register'
    7) Apply patch
    8) Refresh and notice it now says 'Add new cash register'
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d3bdb77d9a3be685fea2164da808d5ef963c114a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 10 08:43:30 2020 +0000

    Bug 23442: DBRev 19.12.00.007
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c1705b2b2cce73a84dc681fdd5c5dc20a2b9877
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 9 11:59:43 2020 +0000

    Bug 23442: Prevent payouts from being reduced
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2cfefec1f6b1c70e946dafb2dc50ed63513bb094
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jan 8 15:51:45 2020 +0000

    Bug 23442: Add html filter to a couple lines in template
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 199d2c56b7814e9d2260625dcd1114246ffbf3f3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 21 13:09:47 2019 +0000

    Bug 23442: Add refund option to patron account page
    
    This enhancement adds a refined workflow to allow librarians
    to refund payments to patrons and record these refunds on the
    patrons account.
    
    The use case is that a patron has paid for something before
    then performing an action that may require some level of refund
    to be actioned.  Perhaps they are returning a lost and paid for
    book.
    
    Test plan:
    1) Undertake a series of transactions that result in a debit
       accountline being partially or fully paid off.
    2) Note that a new 'Issue refund' button appears next to a
       debit (but only if your user has the refund permission or
       is a superlibrarian)
    3) Click the 'Issue refund' button and a modal should appear
       pre-populated with the amount - amountoutstanding.
    4) You should be able to edit the amount you wish to refund,
       record the refund or cancel.
    5) Signoff
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2a6cc4c911e013b3137ce9430a686275351a8fad
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 21 15:04:56 2019 +0000

    Bug 23442: Add refund permission
    
    Add a new subpermission called 'refund' to the 'updatecharges'
    permission group which will allow/prevent refund actions to be
    performed by staff.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4b16375d2a1b94e792ba2f6042211b42536961b3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 21 12:10:41 2019 +0000

    Bug 23442: Add 'reduce' method to Koha::Account::Line
    
    This enhancement adds a 'reduce' method to Koha::Account::Line which can
    be used to reduce a charge/debit by adding a credit to offset against
    the amount outstanding.
    
    It may be used to apply a discount whilst retaining the original debit
    amounts or to apply a full or partial refund for example when a lost
    item is found and returned.
    
    The created credit will be immediately applied against the debit unless
    the debit has already been paid, in which case a 'zero' offset will be
    added to maintain a link to the debit but the outstanding credit will be
    left so it may be applied to other debts.
    
    Test Plan:
    1) Run the included tests and verify they pass.
    2) Signoff
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 741f785b7f559da6a936ce30abcac53cbd695640
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 21 15:20:45 2019 +0000

    Bug 23442: Add account credit types
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 909caec446b936023158fe99aa8ecf56e775cb6d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Dec 13 17:08:58 2019 +0000

    Bug 10352: Get add operations too
    
    When an add for biblio or item is recorded there is no space in the info field
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b96b3eceef2b4db3ae88c26f8096f8f2925228ae
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Nov 25 12:09:45 2019 +0000

    Bug 10352: (follow-up) Show the biblionumber for items in modification logs
    
    This patch adds a link to the the biblio that shows the biblionumber of the item. It makes things a little more obvious
    
    To test:
    1 - Find a biblio with an item where an itemnumber on another biblio is equal to that biblionumber
       i.e. In the sample data:
            biblionumber 59 with item with itemnumber 127
            item with itemnumber  59 on biblionumber 23
    2 - Edit both items however you wish
    3 - On biblionumber 59 click the modification log
    4 - You should see "Item 127"
    5 - Click "Submit" on the form - this searches as itemnumber
    6 - You should see "Item 59"
    7 - Apply patch
    8 - On biblionumber 59 click the modification log
    9 - You should see "Item 127 from Biblio 59"
    10 - Click "Submit" on the form - this searches as itemnumber
    11 - You should see "Item 59 from Biblio 23"
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3d99d21a2fe48609902849352ef7eb7acc1e58a8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 25 11:28:40 2019 +0100

    Bug 10352: Use a new object_type parameter instead of the module's name
    
    To dissociate a search on biblio and item, we pass a new "object_type"
    parameter to viewlog.pl. If equals 'biblio' we will assume that "object"
    contains a biblionumber
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 602d9c836bd92ccf5e64915ee113632bc690c1b9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 13 10:36:14 2019 -0500

    Bug 10352: Display the correct modification logs for bibliographic records
    
    The 'Modification log" link in the cataloguing module returns confusing
    results. The 'object' parameter is the biblionumber, but the all log
    from itemnumber=biblionumber will be displayed as well.
    Since bug 11473 we have the action_logs.info column that is prefixed by
    'item ' or 'biblio ' to disociated an item modification from a biblio
    modif.
    This patch suggests a quick and dirty approach, use this column to make
    sure we are searching for the correct logs.
    /!\ As bug 11473 did not update the existing rows, we will no longer display
    the logs created prior to this change.
    
    Test plan:
    Make sure you have at least 2 bibliographic records with some items
    Make sure you have the biblionumbers of those records that match
    existing itemnumbers
    Edit them (no matter what you change)
    Go to the bibliographic detail page (staff) and click "Modification log"
    You should see the correct changes.
    
    Signed-off-by: hc <hc@interleaf.ie>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3015fc1bae473d897b232cca7625413db8c221eb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 27 14:55:36 2019 +0100

    Bug 24313: Always display XSLT errors in logs
    
    From
      commit 295ae33800a322facfdf56795f4c02b2fd53432b
      Bug 20272: Replace error numbers by codes in XSLT_Handler
    
    """
        Make XSLT_Handler a little bit less noisy by defaulting print_warns to
        false unless $ENV{DEBUG} is set. (See also bug 19018).
    """
    
    I think we should warn the errors in the logs. They are not debug messages here, we should not rely on DEBUG.
    If too noisy we should fix the original issues, not hide all the errors (which make the XSLT debugging super hard)
    
    Test plan:
    Break a XSLT, reload the page and confirm that there are useful errors in the Koha log file
    
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c121a53dd73b506e4405356cbd1a540ac882176b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 10 15:24:36 2019 +0100

    Bug 24123: Fix import of UTF-8 encoded MARC21 MARCXML using bulkmarcimport (elastic only)
    
    If elastic is used as search engine, the bulkmarcimport.pl will not
    handle correctly UTF-8 encoded MARCXML
    
    Koha::SearchEngine::Search->new uses a require statement to load the correct Search module.
    This is done l.257 of bulkmarcimport.pl:
      257 my $searcher = Koha::SearchEngine::Search->new
    
    Koha::SearchEngine::Elasticsearch::Search will `use MARC::File::XML`, and so resets the arguments set before:
      216     $MARC::File::XML::_load_args{BinaryEncoding} = 'utf-8';
    
      220     $MARC::File::XML::_load_args{RecordFormat} = $recordformat;
    
    An easy (but dirty) fix could be to move the declaration of my $searcher before in the script.
    The tricky (but correct) fix would be to remove the long standing "ugly hack follows" comment.
    
    This patch is the easy, and dirty, fix
    
    Test plan:
    Use the command line tool to import MARXCML records that contains unicode characters into Koha
    
    Something like `misc/migration_tools/bulkmarcimport.pl -biblios -file record.marcxml -m=MARCXML`
    
    Without this patch you will notice that unicode characters will not be displayed correctly
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7df88be2a47f0163c4f1a1e0a8dcd57ae91fdb7d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Dec 2 09:22:31 2019 +0000

    Bug 23974: Add test descriptions
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b8a582b0572517e8b02f42963db76caca5aadcd
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Dec 2 09:00:18 2019 +0000

    Bug 23974: Add tests for issue on closed day
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b619db20d5341fa9c907a8623484b4c97917751
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Nov 29 17:09:06 2019 +0000

    Bug 23974: Test Notes
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 75b2586cb7ecaa48ae88598850019e22542c4a5b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Nov 29 16:44:45 2019 +0000

    Bug 23974: Add POD for hours_between
    
    Add a bit of missing POD whilst we're working in here
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b6872ccbd52ee3e7b5b7e30b0a120f83b365e85a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Nov 8 13:37:17 2019 +0000

    Bug 23974: (follow-up) Add same day loan tests
    
    Hourly loans can be short enough to not cross a day boundary and as such
    we should test for that scenario in the hour_between tests too.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a4f8daacb9e49ce5ddf2c3cd0a72a03214580a09
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 5 17:44:36 2019 +0100

    Bug 23974: Both methods should have the same logic/construction
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e0f22d36c675d171e890536f77d2e117a5d80540
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 5 17:13:53 2019 +0100

    Bug 23974: Add tests for days_between
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5029ed9bd2b248d123b30ec7a02bbbb5ae1203e5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 5 16:23:00 2019 +0100

    Bug 23974: Add new tests for hours_between
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7f506d4163e02b2e384d75723ee753acce7544d2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 5 15:18:38 2019 +0100

    Bug 23974: Improve readability
    
    This patch does not change anything, just a bit of cleaning
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 96ab49823291d441fd43ed0cbef242f7beb58d37
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 9 16:52:23 2020 +0000

    Bug 21959: Add sponsor details
    
    Sponsored-by: City of Nîmes
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 836079c1002273f9c6ab2b1c6b1dc638aa062768
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Dec 17 15:58:21 2019 +0000

    Bug 24255: Add summation methods to Koha::Account::Lines
    
    This patch adds a number of summation methods to Koha::Account::Lines
    giving quick access to overall total, total credits and total debits.
    
    Test plan
    1) Run the included tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a2bd9e361a6ec1f489f5a51892dcaa63b7d7a9a5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 10:37:00 2019 +0100

    Bug 24257: Fix close of modal on 'Yes, print slip'
    
    When a item-transfer-modal is prompted by returns.tt and the option
    "Yes, print slip" is selected the transfer is not initiated and the
    modal does not disappear.
    
    The print_slip hidden input must be in the same form as the
    submit/button .print, otherwise the browser logs
      this.form.print_slip is undefined
    
    Test plan:
    1. set AutomaticItemReturn to "don't"
    2. Check out an item and attempt to check it in at a branch it doesn't
    belong to.
    3. When the popup modal appears select 'Yes, print slip'.
    => Observe that the transfer does initiate and the modal closes
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b6d1579b7fdd5e1210283a52f8da3411d0c1c87
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 9 16:24:13 2020 +0000

    Bug 18731: (QA follow-up) Spelling and POD corrections
    
    Just a coulpe of very minor tweaks to keep the QA scripts happy
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5cd9c904c4ecef58a4e9b8d38ddb587f67c5a617
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Oct 4 15:43:03 2017 -0300

    Bug 18731: OpenAPI definitions
    
    This patch introduces the OpenAPI definitions required for the orders
    endpoint. It matches the voted RFC.
    
    Sponsored-by: Camden County
    Signed-off-by: Matthias Meusburger <matthias.meusburger@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 021f5c95d7d0b9bff8eb703abc6fb65a656bd3de
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jan 6 13:00:26 2020 -0300

    Bug 18731: Use the stashed koha.embed in objects.search
    
    This patch makes the objects.search helper use the koha.embed structure
    that is embedded in the authenticate_api_request step.
    
    This way, any controller using it will benefit from automatic embed
    handling.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/REST/Plugin/Objects.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d8ae2e6c8fd6f0de86f13ed444aec6fe69d9147
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 30 15:36:57 2019 -0300

    Bug 18731: Add API mappings to K::A::{Basket,Invoice}
    
    This patch adds to_api_mapping definitions to the following classes:
    
    - Koha::Acquisition::Basket
    - Koha::Acquisition::Invoice
    
    They are implemented following the proposed RFCs:
    https://wiki.koha-community.org/wiki/Acquisitions_baskets_endpoint_RFC
    https://wiki.koha-community.org/wiki/Acquisitions_invoices_endpoint_RFC
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 441cde5dbdf914953986cae2af9bb7bac569f87a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 5 16:44:43 2017 -0300

    Bug 18731: /acquisitions/orders endpoint
    
    This patches implement the /acquisitions/orders endpoint.
    
    The attribute names are consistent with the voted RFC
    
    To test:
    1. Apply this patchset
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/acquisitions_orders.t
    => SUCCESS: Tests pass!
    3. Test the API with your favourite tool (Postman?)
    => SUCCESS: It works as expected!
    4 Sign off :-D
    
    Sponsored-by: Camden County
    Signed-off-by: Matthias Meusburger <matthias.meusburger@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6659a45b6ea6f957f3c9c0d0f022a086ea78432e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Nov 5 11:37:57 2019 -0300

    Bug 18731: Unit tests
    
    This patch implements unit tests for the orders endpoint.
    
    Sponsored-by: Camden County
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 110170760c3ae2b4ec842bca651f767b71dd0701
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 30 15:34:43 2019 -0300

    Bug 18731: Make authenticate_api_request stash the embed structure
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4dff91004e8275f8d392340e95b3d05006d5770e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 23 10:26:04 2019 -0300

    Bug 24302: Add a way to specify nested objects to embed in OpenAPI
    
    This patch introduces a helper for handling x-koha-embed headers on API
    requests. It reads the embed definitions and adds them to the stash for
    later use (either manually on the controllers, or in the objects.search
    helper.
    
    x-koha-embed needs to be defined as a list on the OpenAPI spec.
    
    It throws an exception when invalid combinations are found.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/Koha/REST/Plugin/Query.t
    => SUCCESS: Tests pass!
    3.Sign off :-D
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 954c742cc63d569cdba06325904a88097c4cc2ba
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 23 12:03:12 2019 -0300

    Bug 24228: Make ->to_api params a hashref
    
    This patch makes the parameters for Koha::Object(s)->to_api a hashref
    preparing the ground for new parameters. The proposed syntax is:
    
    $object->to_api(
        {
            embed => {
                'items' => {
                    'children' => {
                        'homebranch' => {}
                    }
                }
            }
        }
    );
    
    Tests are added for the Koha::Objects implementation and tests for
    Koha::Object are adjusted to the new syntax, and a test for the single
    result accessor is added as well.
    
    To test:
    1. Apply this patches
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Object.t t/db_dependent/Koha/Objects.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f87ebb9ab1eb61002a5b97f9bf31e2b5d77b25d0
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Dec 19 15:50:49 2019 -0300

    Bug 24228: Add parameters to Koha::Object(s)->to_api to automatically embed objects
    
    This patch makes Koha::Object(s)->to_api have an 'embeds' parameter that
    using dot notation (e.g. resource.related_resource.another_one) allows
    embedding objects recursively.
    
    To test:
    1. Apply this patch
    2. prove t/db_dependent/Koha/Object.t
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9bcf22b0d57fce9d0c38006cd204e3a1cba5b361
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 13 14:03:11 2019 +0100

    Bug 24252: Add relations to Koha::Account::Line
    
    This patch adds two new relationships to the Koha::Account::Line object.
    
    * credit_offsets - returns all credit type Koha::Account::Offsets
      related to this Koha::Account::Line.
    * debit_offsets - returns all debit type Koha::Account::Offsets related
      to this Koha::Account::Line.
    * credits - returns all credits related to this Koha::Account::Line.
    * debits - returns all debits related to this Koha::Account::Line.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 16413c24ca514205aaa5c5a9c93aaa68345cffee
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Jan 7 11:30:53 2020 +0000

    Bug 24321: (follow-up) Fix number of tests in t/db_dependent/Koha/Objects.t
    
    Test plan:
    prove t/db_dependent/Koha/Objects.t
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 08936de74b6e7a3eda2b86e6321ac13cc4dc5b71
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jan 2 11:04:10 2020 -0300

    Bug 24321: Clean /patrons
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1fd210a093e81a3f457efdf11d591e0c1ab3f17f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 12:53:26 2019 -0300

    Bug 24321: Clean /holds
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9d0a11c2b6b767762707d3d4473e15ba3318d8e2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 12:35:43 2019 -0300

    Bug 24321: Clean /patrons/{patron_id}/account
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d22b0cefa9d22a1fdb3162939483afddae51e1db
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 12:31:24 2019 -0300

    Bug 24321: Clean /items
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f909333a9ffee89212243ac2f2e7432ef4d1ae23
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 12:26:46 2019 -0300

    Bug 24321: Clean /biblios
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a6218a1cdc2bd63354353ccafdf4cbdc7c1573a3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 11:50:36 2019 -0300

    Bug 24321: Clean /checkouts
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4ba67994a9f9aabf24ce3e9b59b4e2820cdbedc6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 11:07:37 2019 -0300

    Bug 24321: Clean /libraries
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3ac92ea881c99ee997d42dac483b26db36848b45
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 10:50:15 2019 -0300

    Bug 24321: Clean /acquisitions/vendors
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8fbb7caed3ac43386b44379501ec48ebd4d74d5a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 10:42:38 2019 -0300

    Bug 24321: Clean /acquisitions/funds
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 477fa63fad94943ab6bc09891a091e2cffc613e5
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 10:35:15 2019 -0300

    Bug 24321: Clean /cities
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ee14689d5151838d62b244b5cae721fac2109c2a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 10:23:44 2019 -0300

    Bug 24321: Make objects.search use mappings from Koha::Object(s)
    
    This patch simplifies the objects.search helper so it relies entirely on
    the result set object for the attribute mappings.
    
    The result is no more to_api or to_model mappings are passed. The
    controllers need to be cleaned up after this patch.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/REST/Plugin/Objects.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Note: the original version of this helpers accepted arbitrary mappings
    and are now constrianed to real mappings on the Koha::Object level. As
    such, the number of tests got reduced.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 451e7dacd2df7ac731c4a721c1f6c6ab4602719d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 09:48:54 2019 -0300

    Bug 24321: Make dbic_merge_sorting accept a result set as parameter
    
    This patch makes dbic_merge_sorting accept a result set as parameter and
    solves a FIXME in _build_order_atom.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/Koha/REST/Plugin/Query.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fabcedca05e4c5ba21888974bba31d0fe4b079e2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 31 09:16:17 2019 -0300

    Bug 24321: Add Koha::Objects->attributes_from_api
    
    This patch makes the 'attributes_from_api' method from the singular
    class available from the result set class.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Objects.t
    => SUCCESS: Tests pass!
    4. Sign off :-D
    5. Yeah, I skipped 3 :-P
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit badbd7d85913749e33d9bdba397dc79836080719
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 27 15:21:30 2019 -0300

    Bug 23893: Catch dt_from_string exceptions
    
    This patch adds exception handling to the attributes_from_api() method.
    This can happen with invalid date/datetimes, for example.
    
    Tests are added:
    
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Object.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4104f782d89d2b16ab4f8379da8afea3823be8ab
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 27 17:03:16 2019 +0100

    Bug 23893: Remove Overloaded method from Koha::Patron
    
    That way we are dealing with any date fields for any Koha::Object
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d9b93b7bc5e1928906710403dabee78f569b0d4
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Dec 27 12:15:39 2019 -0300

    Bug 23893: (QA follow-up) Explicit date format
    
    This patch makes the input date format explicit. It also adds a missing
    POD.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9b48de9cad3e48793353c4a2ac8701646bdc4b31
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 27 15:21:27 2019 +0100

    Bug 23893: No special care for booleans
    
    Tests pass without that changes. If we need them they should be at
    Koha::Object anyway.
    
    About the date, I also think that that should be moved to Koha::Object
    (we can guess it, like we do in Koha::Object->store, retrieve the
    datatype and adjust). Also we can send a DT object to DBIC, no need for
    an sql formatted date
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 09bfdddc7af2a93b61280b1d2d6059ef23c31586
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Nov 12 10:00:14 2019 -0300

    Bug 23893: Use in /patrons
    
    This patch makes the patrons endpoint use the new methods from
    Koha::Object.
    
    To test:
    1. Apply this patch
    2. Run:
      $ kshell
     k$ prove t/db_dependent/api/v1/patrons.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c46c86b3e7f6c7eb7e482a7c18745d02fd11e346
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Nov 12 09:59:53 2019 -0300

    Bug 23893: Use in /cities
    
    This patch makes the cities controller use the new methods from
    Koha::Object.
    
    To test:
    1. Apply this patch
    2. Run:
      $ kshell
     k$ prove t/db_dependent/api/v1/cities.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 340f77732a82d368cdafc622ae636bff19f997af
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Nov 11 16:07:03 2019 -0300

    Bug 23893: Add new_from_api and set_from_api to Koha::Object
    
    This patch introduces the following methods to the Koha::Object class:
    - set_from_api
    - new_from_api
    
    This methods are going to be used when writing API controllers that map
    to the attributes to the DB schema ones.
    
    To test:
    1. Apply this patchset
    2. Run:
      $ kshell
     k$ prove t/db_dependent/Koha/Object.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b9af3d71b130ed72db899a9191249d9bc9505ec6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Nov 11 15:03:28 2019 -0300

    Bug 23893: Implement Koha::Object->from_api_mapping
    
    This patch implements the from_api_mapping method, that calculates (and
    caches) the reserve mapping from the to_api_mapping method.
    
    A generic to_api_mapping is added to simplify things a bit in the generic
    to_api method and so the mappings are reusable in the way they are in
    from_api_mapping.
    
    To test:
    1. Apply this patches
    2. Run:
      $ kshell
     k$ prove t/db_dependent/Koha/Object.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 474f5a3bfdb31bcab3cd04523c206807f09ed7ba
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Nov 11 15:03:29 2019 -0300

    Bug 23893: Unit tests
    
    This patch introduces tests for the implemented methods.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ae5728020ae7ab5330d191a8800fc32aadc1125a
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Tue Apr 2 16:14:39 2019 +0200

    Bug 21959: allow only i and g regex modifiers
    
    Signed-off-by: Mathilde Formery <mathilde.formery@ville-nimes.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b1f198600f02b1f0389ddf63c809a312b77e8f2a
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Tue Apr 2 15:20:34 2019 +0200

    Bug 21959: use a link instead of a checkbox
    
    Signed-off-by: Mathilde Formery <mathilde.formery@ville-nimes.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6fb8b680c0a3bc50b5a2cf772b624d382e80ea44
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Dec 6 09:43:42 2018 +0100

    Bug 21959: Batch item modification - ability to apply regular expression on text fields
    
    Test plan:
      - go to Tools > Batch item modification,
      - select items to modify,
      - for one or some text fields, check the second checkbox (Use regular
        expression) and type your regex,
      - check the regex has been applied.
    
    Signed-off-by: Pierre-Marc Thibault <pierre-marc.thibault@inLibro.com>
    Signed-off-by: Mathilde Formery <mathilde.formery@ville-nimes.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 234dbc65f7df31876eadd33e917c462254a6f972
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Thu Dec 26 17:12:25 2019 +0000

    Bug 24308: Suggestions table on suggestions.pl should have separate columns for dates
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f5739acdd8154fd18a50e3265f35f3f9ae1aab45
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 23 16:19:47 2019 +0100

    Bug 24277: Fix date received editing when receiving an order
    
    Bug 8417 added the ability to edit the date received, but a merge
    conflict was wrongly resolved during a rebase of
      commit 20d9ed618fbe3cdcb9c04444a1f8a584b0364069
      Bug 13321: Rename variables
    
    Test plan:
    Create an order
    Receive it
    Set a date (different from today)
    => The date you picked should have been set in DB for the order
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1b651eea450c59b8eb36bfed1dcca430066b06dd
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jan 8 10:55:40 2020 -0300

    Bug 24277: Regression tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9f9cc7afbe3bff9cf72090f9520e856cab5562bb
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 8 14:21:23 2020 +0000

    Bug 24263: DBRev 19.12.00.006
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 881746df45a8d66d28ebc219cf566b8476066924
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jan 8 10:11:07 2020 -0300

    Bug 24263: (QA follow-up) Atomic update fixes
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dcbf7ada6ece94db759243194b684aebf903743b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 14:04:58 2019 +0100

    Bug 24263: Replace borrowers.relationship with NULL when was empty string
    
    When you create a new patron, its relationship field is populated with
    an empty string when we are expecting NULL.
    
    Otherwise the about page will display a warning about a missing/wrong
    relationship in data (that is not in the syspref)
    
    Test plan:
    0/ Do not apply the patches from this bug report
    1/ Create a new patron (child)
    2/ Notice that relationship column in DB is set to an empty string
    3/ Go to the about page, notice the invalid warning about relationship
    values not in the syspref
    4/ Apply DB changes and tests
    5/ Execute the update DB entry
    => The value in DB is now NULL when was ""
    6/ Execute the tests
    => It fails
    7/ Apply the last patch
    8/ Add and edit a patron (child)
    => relationship is set to NULL in DB
    9/ Execute the tests
    => They pass!
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6dd95916e22da23af4cd90ec3e271f4fd6d0395f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 14:08:34 2019 +0100

    Bug 24263: DB changes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dc10499411113bacbc0c5f3f56d3c4097f478091
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 14:04:35 2019 +0100

    Bug 24263: Add tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 07d7950b9f2b91b8cff682d73e5c95ec1037ab0f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 2 11:38:18 2020 +0100

    Bug 24327: Redirect to the login form if AnonSuggestion misconfigured
    
    Test plan:
    Turn on AnonSuggestion but set AnonymousPatron to an invalid value
    Go to /cgi-bin/koha/opac-suggestions.pl?op=add
    => You see the login form
    
    Signed-off-by: hc <hc@interleaf.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3c2e40c224e1aac8628e994bb7e15170faea88e8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 2 11:26:49 2020 +0100

    Bug 24327: Add warning to the about page is AnonSugggestions but AnonymousPatron
    
    This patch adds a warning to the about page if AnonSuggestions is set
    but AnonymousPatron.
    
    Test plan:
    Turn on AnonSuggestions and set AnonymousPatron to 0
    => You see a warning on the about page
    Turn on AnonSuggestions and set AnonymousPatron to an invalid value
    => You see a warning on the about page
    Turn off AnonSuggestions
    => No warning
    Turn on AnonSuggestions and set AnonymousPatron to a valid value
    => No warning
    
    Signed-off-by: hc <hc@interleaf.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 73300e3c003d0698a5a7b6e13a8d28fe2f0a3c41
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Sun Dec 29 07:40:37 2019 -0300

    Bug 24054: Typo in ClaimReturnedWarningThreshold system preference
    
    Fixed type: cliams -> claims
    
    To test:
    1) Apply the patch
    2) Go to System preferences > Circulation preferences > ClaimReturnedWarningThreshold
    3) Check the text is fixed.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 63fe93482c5cff0b706508f309e4b58c898f42e0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 25 16:48:15 2019 +0100

    Bug 24104: Item search - Prevent "Edit" dropdown button to overflow
    
    Making it displays on the left fixes the problem.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2db8898d1119f81ab77440ee1db7803e981a5f36
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 8 11:09:54 2020 +0000

    Bug 24329: DBRev 19.12.00.005
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eba0050d7ef831ee42f1d090c97679792df1fc83
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Jan 5 23:08:28 2020 +0100

    Bug 24329: Add a test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 99593d9e8524169c113f23ff6775acb40875e5fc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 2 13:03:07 2020 +0000

    Bug 24329: Prevent update of timestamp on action_logs updates
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ef3525cb9e851cf6ffe5238d90001d212de81c97
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 2 12:56:19 2020 +0000

    Bug 24329: Correction to updatedatabase
    
    Ensure timestamp is not overwriteen during upgrade when applying updates
    for bug 3820
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6b6f7f1654a8ce0ba3ccfb6c3e2c717d9c2d2466
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jan 8 10:02:02 2020 +0000

    Bug 24361: (RM follow-up) Restore 0 handling in CalcFine
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ba892d39d2e197cc9fad942ac5202d0706ef505f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 6 22:10:16 2020 +0100

    Bug 24350: Fix Branches.pickup_locations
    
    This will fix the following error:
    Template process failed: undef error - Not a HASH reference at
    /home/vagrant/kohaclone/Koha/Template/Plugin/Branches.pm line 96.
     at /home/vagrant/kohaclone/C4/Templates.pm line 122
    
    Koha::Libraries->pickup_locations does not always return an array, but
    arrayref if $biblio is not a Koha::Biblio object.
    
    I do not think it's the correct fix, the pattern in
    Koha::Libraries->pickup_locations is wrong: we should not expect 2
    different types for a given parameter, biblio should always be a
    Koha::Biblio (idem for item btw).
    That could be fixed easily if the template had the Koha::Biblio object
    sent.
    
    Signed-off-by: Caroline Cyr La Rose <caroline.cyr-la-rose@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b8c0a387c858c011d193f1023b75285a05dc0383
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 7 16:06:38 2020 +0100

    Bug 21684: Fix Hold.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 276b64692520108431c539b4d9124b3371129419
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 7 13:30:32 2020 +0100

    Bug 21684: Koha::Object->delete must return a Koha::Object
    
    Not a DBIx::Class object.
    
    Tests have been added, add Bookseller.t fixed
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c66637670b4fa084438925d3e9a4bfa8e0275ef2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 7 12:10:05 2020 +0100

    Bug 21684: Fix UploadedFile[s]->delete
    
    Tests were failing with:
     #   Failed test 'Test delete via UploadedFile as well as UploadedFiles'
     #   at t/db_dependent/Upload.t line 193.
     DBIx::Class::Row::delete(): Not in database at /kohadevbox/koha/Koha/Object.pm line 219
    
    I am not sure this patch is perfect, a set of uploaded files should be
    deleted in a transaction, which would be rollback if something is wrong.
    But it will be tricky to restore the files after they have been deleted.
    It seems that we should deal with that with a more complicated process
    and should be part of a separate bug.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7514ecb6c99851e9334875973a8085b6447fb2b9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 7 16:02:36 2020 +0100

    Bug 24150: Prevent random failure comparing updated_on
    
    Jenkins is currently failing (slow server, datetime comparison, etc.)
    
    koha_1       |     #   Failed test at t/db_dependent/Koha/Old.t line 48.
    koha_1       |     #     Structures begin differing at:
    koha_1       |     #          $got->{updated_on} = '2020-01-07 14:15:22'
    koha_1       |     #     $expected->{updated_on} = '2020-01-07 14:15:21'
    koha_1       |     # Looks like you failed 1 test of 1.
    koha_1       |
    koha_1       | #   Failed test 'Koha::Old::Patrons'
    koha_1       | #   at t/db_dependent/Koha/Old.t line 49.
    koha_1       | # Looks like you failed 1 test of 2.
    koha_1       | [14:15:22] t/db_dependent/Koha/Old.t ...............................................
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e5ce7f54a47b34b2aae87ed3e064f2d7d3de0d24
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jan 2 13:12:58 2020 +0100

    Bug 24328: Fix bibliographic frameworks install (linkid)
    
    With strict mode enabled (tested with MariaDB 10.4.11)
    
    ERROR 1366 (22007) at line 8029: Incorrect integer value: '' for column
    `koha_kohadev`.`auth_subfield_structure`.`linkid` at row 769
    
    Test plan:
    Insert the .sql files from this patch and confirm that you can now
    insert them correctly
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2405ab761889480a91e64f8d4431e320c78603be
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Dec 29 03:36:35 2019 +0000

    Bug 24314: Update de-DE MARC21 frameworks for updates 28+29 (May and November 2019)
    
    This updates the MARC framework files in the de-DE (German) installer
    to the latest MARC standard. The files also include some translation
    changes and fixes.
    
    Files have been generated using the po files on translate.koha-community.org.
    
    To test:
    - Run the de-DE installer on a fresh database
    - Verify that all files are installed without errors
    - Verify that the frameworks are correctly in place
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    MARC21 files load without problems, no qa errors.
    Loaded into 'en' install (delete fw then load) all frameworks look good.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a1450e4a6e10a788678b999df84cf22f9e5bc5e9
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Fri Dec 27 10:09:22 2019 -0300

    Bug 24312: Update MARC21 frameworks to Updates 28+29 (May and November 2019)
    
    MARC21 format changes
    
    Bibliographic
    -------------
    Update 28 (May 2019)
    
    New subfield f in 540
    New subfield g in 506,540
    New subfield q in 506,540
    New subfield 2 in 540
    New subfield 2 in 100,110,111,130,240,
                      700,710,711,730,758
                      800,810,811,830
    New subfield 7 in 856
    New code b in 007/01 Sound Recording
    
    Update 29 (November 2019)
    
    New field 688
    New subfield i in 041
    New subfield t in 041
    New subfield g in 751
    Renamed subfield g in 041
    
    Authority
    ---------
    Update 28 (May 2019)
    
    New subfield 0 and 1 in 024
    Renamed subfield 2 in 024
    New subfield 7 in 856
    
    Update 29 (November 2019)
    No changes
    
    To test:
    1) Remove all your frameworks
    2) Check mandatory bibliographic and authority files load without problem
    3) Check new fields/subfields
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2aedb2dfa6473dfec825f51ce7ab3d8071b38366
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 7 15:47:14 2020 +0100

    Bug 24365: (bug 24217 follow-up) Fix encoding issue for translator script
    
    I am not sure what happened here, but adding strict for TmplTokenizer.pm
    breaks a test for translation.
    
    It has been caught by a failing test:
     % prove xt/author/translatable-templates.t
    will display lines "invalid multibyte sequence"
    
    I did a diff between the generated files and found:
    < msgid "Ã rbok"
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 094f0623c2c740aa2be5fb6364694b88442e03cf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 7 12:26:01 2020 +0100

    Bug 24361: (bug 24217 follow-up) Fix several warnings in C4 modules
    
    With bug 24217 pushed, lot of warnings appears during the tests are run.
    Most of them are "Use of uninitialized value in "
    
    Test plan:
    Take a look at the output of run 1049
    https://jenkins.koha-community.org/job/Koha_Master_D9/1049/consoleFull
    
    Most of the warnings from this run will be removed by this patch
    
    At least 2 are not fixed:
    Use of uninitialized value in numeric eq (==) at /kohadevbox/koha/C4/Reserves.pm line 791.
    t/db_dependent/Items_DelItemCheck.t => see 23463
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 60e5f77770e45be9af2b1408a7a08a107e4fd835
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jan 7 12:26:01 2020 +0100

    Bug 24361: Fix warning in C4::Record line 435
    
    Use of uninitialized value in concatenation (.) or string at /kohadevbox/koha/C4/Record.pm line 435
    
    Caught by a failing test:
        #   Failed test 'Export csv with wrong marcxml should raise a warning'
        #   at t/db_dependent/Exporter/Record.t line 113.
        # found warning:  problem with :721 : :1: parser error : Start tag expected, '<' not found
        # found warning: Use of uninitialized value in concatenation (.) or string at /kohadevbox/koha/C4/Record.pm line 435.
        # expected to find warning: (?^u:.*Start tag expected.*)
    
    Test plan:
    Make sure the tests pass now
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit af50ec6e5fa1f9d415af6b8655c927a20b86b705
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jan 6 23:49:37 2020 +0100

    Bug 24150: Add missing koha_object[s]_class methods and skip for deletedborrowers
    
    deletedborrowers does not have a PK, and adding it is out of the scope
    of this patchset. Indeed we will have to handle possible duplication of
    borrowernumber values, which does not seem trivial.
    Having bug 20271 in mind, we will have to deal with this problematic
    anyway later.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3bd2c3cf3a56cb61e107de2899c8324f1a5c5ec7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 3 16:46:23 2020 +0000

    Bug 24080: DBRev 19.12.00.004
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc1c4b7cfe2767a07aa59fe6e63e3e2aee535875
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Dec 23 14:58:48 2019 +0000

    Bug 24080: (QA follow-up) Remove processing for removed field
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7f0d36cdbd92d3ea65ccfb97aeee1332dc2f09a
Author: Kelly McElligott <kelly@bywatersolutions.com>
Date:   Mon Dec 23 10:03:00 2019 -0300

    Bug 24080: Adjust text in modal
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 861036872568b2fc3b656fe94bfb600e8864d818
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 21 13:59:43 2019 +0000

    Bug 24080: Add payout option to patron account page
    
    This enhancement adds a refined workflow to allow librarians to pay out
    money to patrons and record these payouts on the patrons account.
    
    The use case is that a patron has somehow accrued credit, through a
    refund perhaps, and the library wants to be able to physically hand over
    some money to balance the patrons account.
    
    Test plan:
    1) Undertake a series of transactions that result in some outstanding
       credit on a patrons account.
    2) Note that a new 'Issue payout' button appears next to a credit with
       an outstanding balance (but only if your user has the payout
       permission or is a superlibrarian)
    3) Click the 'Issue payout' button and a modal should appear
       pre-populated with the amountoutstanding.
    4) You should be able to edit the amount you wish to payout, make
       payment or cancel.
    5) Signoff
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6043b4fb2490b910a5af29e5989c8e5d1d87b638
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 21 14:28:03 2019 +0000

    Bug 24080: Add updatecharge payout permission
    
    Add a new subpermission called 'payout' to the 'updatecharges'
    permission group which will allow/prevent payout actions to be performed
    by staff.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9bd650f98b1af6e6cc62f30a82069fdf8ed610a6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 21 13:22:39 2019 +0000

    Bug 24080: Add 'payout' method to Koha::Account::Line
    
    This enhancement adds a 'payout' method to Koha::Account::Line which can
    be used to 'pay out' a credit to a patron.
    
    When such a credit is 'paid out' this method will create a corresponding
    account debit line with an amount equal to the amountoutstanding on the
    original credit and the two acocuntlines will be immediately applied against
    each other.
    
    Test Plan:
    1) Run the included tests and verify they pass.
    2) Signoff
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f6575398927a3f463088288f7aaf42ec0ada08c8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 21 14:50:12 2019 +0000

    Bug 24080: Payout account debit type
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5be3ed3fe4b9072bcb952cdc7270eeef7eb3fa75
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Dec 13 23:42:28 2019 +0000

    Bug 10469: Display more when editing subfields in frameworks
    
    This patch removes the accordion feature from the MARC subfields
    structure editor. The form is not long, and I think in this case the
    accordion makes the process more difficult to navigate.
    
    To test, apply the patch and go to Administration -> MARC frameworks ->
    Framework structure -> Subfield structure -> Edit. Choose a tag with
    multiple subfields to best test the changes.
    
    The whole form should apppear, and tabs functionality should work
    correctly. Test that making changes under multiple tabs works correctly.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da72f9b7d08c283712c94bb5e4ae315c03f184dc
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Dec 17 15:19:56 2019 +0000

    Bug 7882: (follow-up) Only show sortable icon for sortable tags
    
    Only tags which can be repeated can be sorted, so the "bars" icon should
    not display by these tags.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a37d89d83546d808234a9b6831e5e0900e40ca6b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Dec 16 19:06:57 2019 +0000

    Bug 7882: (follow-up) Update sorting interaction
    
    This follow-up modifies the CSS for the sortable fields so that a
    different icon is used. Elsewhere in Koha (stock rotation stage sorting)
    we use the "bars" icon to indicate a sortable element. I think it would
    be good to continue to use this. The cursor is now styled as a "Move"
    cursor.
    
    The configuration of the sortable function in the script has been
    updated in two ways: 1. The movement of the element is constrained along
    the y-axis, and 2. The movement of the element is contstrained to the
    container within which it can be moved (for the tag, the tab, and for
    the subfield, the tag).
    
    To test, apply the patch and edit a MARC record in the basic cataloging
    editor.
    
    Confirm that the new icon is used, and that the "Move" cursor shows when
    you hover over the icon.
    
    Confirm that a tag can be dragged up and down within the constraints of
    the visible section. A subfield should be only movable within its parent
    tag.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 802d7d30c98bdd2cece637574ab48c8409399862
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Wed Oct 23 15:34:39 2019 -0400

    Bug 7882: Add ability to move and reorder fields in MARC editor
    
    Use jQueryUI sortable to make fields and subfields moveable in the
    MARC editor for both records and authorities.
    
    This patch convert items from div's to ul's and consequently alter css
    and js to match. It also replace the up arrow with a more adapted icon
    (from font awesome).
    
    Primary authorship by Elliott Davis.
    
    To Test:
    
    1. Add or edit a record in cataloguing module.
    2. You should be able to move the fields and subfields around.
        - You can click on any part of the element to drag it, the move
        icon to the left of the item is a good place to do it.
        => You can only change the order of fields of the same tag.
    3. Make sure all of the javascript driven fonctionnality still work :
        - Duplicate fields/subfields
        - Remove fields/subfields
        - Using the tag editor for control fields or to link authorities
        - etc
    4. Reorder some fields/subfields and save the record.
    5. Edit the record again.
    6. The order in the editor should match the changes which were saved.
        - Empty subfields should appear after the ones with content.
    7. Repeat steps 1-6 with the authority editor.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b9e8b50b50b2b47bb176bdaac412afbe46b4a567
Author: Cori Lynn Arnold <carnold@dgiinc.com>
Date:   Wed Dec 18 18:18:59 2019 +0000

    Bug 24173: Advanced Editor: Show subtitle & published date on the search page
    
    To test:
    
    Prior to patch:
    1/Verify that EnableAdvancedCatalogingEditor syspref is set to "enable"
    2/Go to Cataloging
    3/Click on "Advanced Editor" button
    4/In left hand box put "specious" under Keywords and hit "enter"
    5/verify that "Library of Congress" (or some other server) Z39.50 is checked
    6/Verify that there are no headings for "Subtitle" and "Published"
    
    Apply Patch
    1/Go to Administration->Koha to MARC mapping
    2/Add or verify that there are entries for "biblio.subtitle" and
    "biblio.copyrightdate"
    3/Go to Cataloging
    4/Click on "Advanced Editor" button
    5/In left hand box put "specious" under Keywords and hit "enter"
    6/verify that "Library of Congress" (or some other server) Z39.50 is checked
    7/Verify that there are headings for "Subtitle" and "Published" and the
    data matches with the fields from Koha to MARC mapping when you click on
    "View MARC" link for that record.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2b1ea752a968e8744ad0eca2a1347b857097e2aa
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Nov 18 18:21:52 2019 +0000

    Bug 24059: Remove unused Greybox assets from detail.tt
    
    This patch removes reference to the Greybox include file because it is
    unused.
    
    To test, apply the patch and view the bibliographic details page. Test
    various JavaScript-driven interactions to make sure no functionality has
    been broken: Menus, tabs, table filters, MARC Preview, etc.
    
    Searching for "gb-" or "GB_" should return no results in any files
    related to the details page.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 721c7d86e891a9107c4a35304ee3b84add9ffa4e
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Wed Dec 11 05:07:31 2019 +0000

    Bug 24212: Increase size of OPAC 'send list' dialog box for IE
    
    To test:
    1) Create a list and view it in the OPAC (ensure you are using Internet
        Explorer as a browser)
    2) Click Send list
    3) Notice the dialog box cuts off the content in the window
    4) Close the popup, apply the patch
    5) Click Send list again
    6) Confirm the dialog box shows the entire window
    7) Confirm the box is resizable and has scrollbars
    
    Sponsored-by: Toi Ohomai Institute of Technology
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0f6df45b0de1e8b88609be5cfa27a0b0b532f465
Author: Pasi Kallinen <pasi.kallinen@koha-suomi.fi>
Date:   Tue Nov 19 11:26:01 2019 +0200

    Bug 24063: Add Sami language characters to Zebra
    
    Some Sami languages need few more characters to be mapped, or
    are otherwise very hard to search for.
    
    Test plan:
    
    1) Catalogue a new record with title "Ǩoǯeŋa"
    2) Make sure zebra indexed that record, then try to search for
       it with the text "kozena"
    3) Apply patch
    4) Redo 2, now the record should be found.
    
    Signed-off-by: Pasi Kallinen <pasi.kallinen@koha-suomi.fi>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 124b7ce31c25dbef5dedf7766edc673071b3fa33
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 3 15:53:18 2020 +0000

    Bug 24181: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40b69281616beb86a6c1eaf2c84c7fd0cd7c23f8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 5 16:33:00 2019 +0100

    Bug 24181: Move the icon back into the input
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8dab309040d2f275a301f0312239a9f272be7284
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 5 16:27:35 2019 +0100

    Bug 24181: Make our datepicker inputs sexy
    
    They are skinny and different from others.
    Not that a problem, I am too.
    But I do not think it is what they need.
    
    Test plan:
    Edit a patron and take a look at the input for "Date of birth"
    => Before this patch they are not looking great
    => After this patch they are beautiful
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6c9d6bf940beb67e1f226dffba0831fc234528fb
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Nov 22 13:23:21 2019 +0000

    Bug 24089: Upgrade jQuery Validate plugin in the staff client
    
    This patch upgrades the jQuery Validate plugin in the staff client from
    v1.10.0 to v1.19.1.
    
    To test, apply the patch and clear your browser cache if necessary.
    
    Test various pages to confirm that form validation works as expected:
    
     - Patron password change form:
       - Password must conform to minPasswordLength
       - Password must not contain leading/trailing spaces
       - Passwords must match
    
     - Administration -> Add or edit budget:
       - Description, start date, and end date are required
       - Start date must be before end date
    
     - Administration -> Add or edit Z39.50/SRU server:
       - Server name, hostname, port, and database are required
       - Port, rank, and timeout must be a number
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4b1ced97ff98e4aeba23429beb7ded645551fc5b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 3 15:44:09 2020 +0000

    Bug 23957: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d43b01ba1302fa99e7d8f396af5a3137333995e0
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Dec 10 13:36:19 2019 +0000

    Bug 23957: (follow-up) Disable both place hold buttons
    
    This follow-up adds the correct markup to the second of two "Place hold"
    buttons so that it is disabled when the first is disabled.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40bae6db38a4eb2d15ca9f7a1abfab46cc756239
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sun Nov 3 23:45:44 2019 +0000

    Bug 23957: Remove button style with famfamfam icon background and replace with Font Awesome
    
    The patch modifies the markup and CSS related to the holds template in
    the staff client when holds policy override is necessary. The CSS
    background image is replaced with a Font Awesome icon. <input>s are
    replaced with <button>s to allow for the icon markup.
    
    To test, apply the patch and regenerate the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
     - Enable the AllowHoldPolicyOverride system preference.
     - Start the process of placing a hold for a patron on a title which
       would not normally be available for hold. For instance: The patron
       already has too many holds.
     - On the hold confirmation screen the "Place hold" buttons should
       appear with a little yellow "warning" icon.
     - Clicking either of the two "Place hold" buttons should trigger a
       confirmation dialog. Test both the "Confirm" and "Cancel" options.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6051f8686b58054446f26e2ba2e5c71bf2b53873
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 3 15:42:12 2020 +0000

    Bug 23956: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 886c8c593dadc83d92d0d066a15861b3ad11e26a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sun Nov 3 22:31:39 2019 +0000

    Bug 23956: Replace famfamfam calendar icon in staff client with CSS data-url
    
    This patch modifies the staff client CSS so that the backround image for
    datepicker input fields is defined as a data-url rather than a reference
    to an image file.
    
    To test, apply the patch and regenerate the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
     - In the staff client, view any form which includes a datepicker-styled
       input. For instance, patron entry: date of birth, expiry; Aquisitions
       -> Late orders -> Filter results.
     - Confirm that the calendar icon looks correct.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 642f7386924bc799f0855ecf7baff6197c1ffaa6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 3 13:05:39 2020 +0000

    Bug 22284: DBRev 19.12.00.003
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 23bddb729dc2655958b6860c8f2d9f9872754ccf
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Sat Dec 21 00:14:10 2019 -0300

    Bug 22284: (QA follow-up) Make pickup locations be Koha::Library objects
    
    This patch makes the following methods return array references of
    Koha::Library objects instead or unblessed objects;
    
    - Koha::Item->pickup_locations
    - Koha::Biblio->pickup_locations
    - Koha::Libraries->pickup_locations
    
    Bonus:
    
    - The template plugin is adjusted to unbless things to keep behavior
    - Tests are moved to the right .t file.
    - Tests for the new behavior are added.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1072e364bd93419ead69c85222eb21d76a6b9060
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed Dec 18 14:50:31 2019 -0300

    Bug 22284: (follow-up) Anotate boolean values in Koha::Schema::Result::LibraryGroup
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b91b53a10388446ace1907d41f1bbc1c2a8352a6
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Jul 3 22:29:42 2019 +0000

    Bug 22284: Schema update
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 01cf725b990baf30b3f98406593eaa003b91862c
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed May 29 02:06:46 2019 -0300

    Bug 22284: (follow-up) Squash multiple follow-ups
    
      * Bug 22284: (follow-up) Use GetReserveControlBranch in Koha::Item->pickup_locations
      * Bug 22284: (follow-up) Fix tests
      * Bug 22284: (follow-up) Fix typo in request.tt
      * Bug 22284: (follow-up) Filter pickup on specific item click
      * Bug 22284: (follow-up) Fix typos transfered -> transferred
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3b25ea7c94b4b23632e2bb0971dd3cf3e7c4f5c7
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon May 27 23:49:05 2019 -0300

    Bug 22284: Add "patron's hold group" as new hold_fulfillment_policy option
    
    This patch adds "patron's hold group" as a new option to Hold pickup library match
    
    To test:
    1. Set ReservesControlBranch preference to item.
    2. Create a hold group
    3. Go to circulation and fines rules
    SUCCESS => in 'Hold pickup library match' there is a new option called "patron's hold group"
    4. In a library not in hold group set 'Hold policy' to "any" and 'Hold pickup library match' to "patron's hold group"
    5. Search for a user in the hold group
    6. 'Search to hold' for items of the library of step 4
    7. Select an item and 'Place hold for [user]'
    SUCCESS => in 'Pickup at' you should see patron's hold group as options
    8. In OPAC sign in as the same user of step 5
    9. Search for the item in step 7
    SUCCESS => in 'Pick up locations' you should see patron's hold group as options
    10. Sign off
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da620fdf91278d7a5d9d57ff75a2659565aa995d
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Tue Apr 23 16:18:59 2019 -0300

    Bug 22284: (follow-up) Squash multiple follow-ups
    
      * Bug 22284: (follow-up) Remove commented warn and address test failures
      * Bug 22284: (follow-up) fix test count after merge
      * Bug 22284: (follow-up) fixes after 15496
      * Bug 22284: (follow-up) fixes after 18936
      * Bug 22284: (follow-up) Remove HomeOrHolding from reserves
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fb36449fa9b1a43d3233fa58f3eeb09063edbe4b
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Tue Apr 30 08:05:17 2019 -0300

    Bug 22284: Filter item's pickup locations in holds_table.inc
    
    This patch filters pickup locations per item in holds_table.inc
    
    To test:
    1) Go to Circulation and fines rules and change max holds allowed to > 0, and change 'Hold pickup library match' to homebranch
    2) Search for a patron
    3) Click on "Search to hold"
    4) Search for any bilio
    5) Place hold on a specific item
    CHECK => Item's pickup location is a select with all libraries
    6) Apply this patch
    7) Repeat steps 2 to 5
    SUCCESS => Item's pickup location is filtered by allowed pickup locations
    8) Sign off
    
    Sponsored-by: VOKAL
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 546a3b6d4d6333fe938572f0247dfcbe4a4d35a8
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Apr 4 01:10:16 2019 -0300

    Bug 22284: New message, new column and filter pickup locations in reserve/request.tt
    
    This patch adds a new message to 'Hold' column in 'Place a hold on a specific item' table.
    
    The message is "Cannot place hold from patrons's library". It appears when patron's homebranch is not in item's hold group, and hold_fulfillment_policy is set to 'holdgroup'.
    
    This patch also adds a new column "Allowed pickup locations" that lists allowed pickup locations per item.
    
    Finally, the select that displays pickup locations is filtered by allowed pickup locations, when multi_hold is not enabled
    
    To test:
    1) Apply this patch
    2) In library groups add a root group and check it as hold group.
    3) Add two libraries to the group
    4) In circulation and fines rules, in 'Default checkout, hold and return policy', in Hold policy change the value to 'From local hold group'
    5) Search a patron from a different library than step 3, select one and click 'search to hold'
    6) Search by location for items in any library of step 3
    7) On any item, clic on 'Place hold for ...'
    SUCCESS => when the page is loaded, in the 'Place a hold on a specific item', you should see the message "Cannot place hold from patrons's library" in 'Hold' column
            => You should see a new column called "Allowed pickup locations" and the message is "Any library"
    8) In circulation and fines rules, in 'Default checkout, hold and return policy', in 'Hold policy' change the value again to 'From any library' and change 'Hold pickup library match' to "Item's hold group"
    8) Repeat steps 5 to 7
    SUCCESS => when the page is loaded, you should see the "Pickup at" select filtered by libraries in hold group
            => You should see in "Allowed pickup locations" a coma separated list of the libraries in item's hold group
            => If biblio has an item whose control branch is not in a hold group, you should see the control branch name in "Allowed pickup locations"
    9) Sign off
    
    Sponsored-by: VOKAL
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 28b155ca1e33832f9aebc7aa6937fbe2f0e2f54c
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon Apr 29 23:07:28 2019 -0300

    Bug 22284: (follow-up) Default to circulation control branch when no hold libraries are found
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f668fecec3771b633068f89dcead2312471f9425
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri Apr 12 10:32:48 2019 +0000

    Bug 22284: Opac pickup_locations
    
    This patch modifies Koha::Libraries->pickup_location and moves most of the logic to
    Koha::Item and Koha::Biblio in preparation for api endpoints in the future.
    
    There where 2 methods added
    
    1) Koha::Item->pickup_locations that given a patron, returns all pickup locations of
    this item, considering hold fulfillment rules, and hold allowed rules.
    
    2) Koha::Biblio->pickup_locations that given a patron, returns a distinct list of
    libraries returned by each of this biblio items pickup location.
    
    Koha::Libraries->pickup_location analyzes input param and calls Koha::Item->pickup_locations
    or Koha::Biblio->pickup_locations as needed.
    
    Also in opac-reserve.tt the way options where obtained to fill the pickup location select
    was modified to pass the patron as a parameter.
    
    To test:
    1) opac: try to place hold on a item and check that all libraries are shown in the
    pickup location select.
    2) intranet: in Library groups, add 2 root groups marked as local hold group and
    add different libraries to each.
    3) opac: login as a user of a library belonging to one hold group, and search try to
    place a hold on an item belongin to the other hold group.
    4) intranet: in Circulation and fines rules, play with 'Hold policy' and 'Hold pickup
    library match' rules.
    5) opac: On each modification of the rules reload the page.
    SUCCESS => Every time you reload the page, the number of pickup locations showed in
    select varies.
    6) prove t/db_dependent/Koha/Biblios.t t/db_dependent/Koha/Items.t
    SUCCESS => Result: PASS
    7) Sign off
    
    Sponsored-by: VOKAL
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 13322855088ed073acce531742460e57e109ef0e
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Sun Mar 24 23:00:36 2019 -0300

    Bug 22284: New methods in Koha::Library::Groups and Koha::Library
    
    This patch adds new methods in Koha::Library::Groups and Koha::Library.
    1) For Koha::Library::Groups adds get_root_ancestor that returns all root
    groups for a given search parameters, for example
    Koha::Library::Groups->get_root_ancestor( { id => $group_id } )
    2) For Koha::Library adds
    2.1) get_hold_libraries: returns all libraries (including self) that
    belongs to the same holdgroups. If $self belongs to several holdgroups
    it will return a distinct list of all libraries belonging to them.
    2.2) validate_hold_sibling: Returns 1 if the given parameters matches any of the
    libraries that belong to any of the holdgroups this library belongs. For example
    $library->validate_hold_sibling( { branchcode => $branchcode } )
    
    To test:
    1) apply this patch
    2) prove t/db_dependent/Koha/Libraries.t t/db_dependent/LibraryGroups.t
    SUCCESS => green letters :-D
    3) Sign off
    
    Sponsored-by: VOKAL
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a998ba5714c8dc1b78062e95bd78e2738112737d
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon Mar 25 00:45:58 2019 -0300

    Bug 22284: Control hold groups in C4::Reserves
    
    This patch modifies C4::Reserves to control when hold group options where selected
    in smart rules.
    In CanItemBeReserved adds 2 new error status messages
    1) branchNotInHoldGroup: when a patron's homebranch is not in item's hold group
    2) pickupNotInHoldGroup: when a selected pickup location is not in item's hold group
    Also CheckReserves is modified when item's priority is defined, to control by hold
    group when required.
    Finally, IsAvailableForItemLevelRequest was also modified to control by hold group when
    required.
    
    To test:
    1) Apply this patch
    2) prove t/db_dependent/Holds.t
    SUCCESS => Result: PASS
    3) Sign off
    
    Sponsored-by: VOKAL
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8141ebbac6e65f7c76a9ec70ab7329564404b738
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon Mar 25 00:43:05 2019 -0300

    Bug 22284: New hold group options in smart-rules
    
    This patch adds new options for 'Default checkout, hold and return policy'
    and 'Default holds policy by item type', both in 'Hold policy' and 'Hold
    pickup library match' columns
    
    To test:
    1) Go to 'Circulation and fines rules' in admin
    2) Check that there are no options for hold group in 'Hold policy' and 'Hold
    pickup library match' columns
    3) Apply this patch
    SUCCESS => in 'Hold policy' you should see 'From local hold group' option, and in
    'Hold pickup library match' you should see "Item's hold group"
    4) Select any of those options and save
    SUCCESS => options should be selected when page reloads
    5) Sign off
    
    Sponsored-by: VOKAL
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7c731050337afdcc509cdfb39fa31ed537b495ab
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Sun Mar 24 22:56:06 2019 -0300

    Bug 22284: Add new checkbox in Library Groups
    
    This patch adds a new checkbox option 'Is local hold group' when you create a new root group.
    
    To test:
    1) In intranet go to Library Groups in admin module
    2) Add new root group
    3) Check that there is no 'Is local hold group' checkbox
    4) Apply this patch
    5) Add new root group
    SUCCESS => a new 'Is local hold group' checkbox appears
    6) Select 'Is local hold group' and save
    7) Click edit button for root group
    SUCCESS => 'Is local hold group' is checked
    8) Sign off
    
    Sponsored-by: VOKAL
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 59d5ada70e6abe7c9bdbf53450e5e7c11c9d3099
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Sun Mar 24 22:50:42 2019 -0300

    Bug 22284: New ft_local_hold_group column, and 'holgroup' enum option
    
    In order to add groups for holds, this patch provides a new column in
    library_groups to identify them. Also provides new enum option for
    hold_fulfillment_policy column of default_branch_circ_rules,
    default_circ_rules, default_branch_item_rules and branch_item_rules.
    
    To test:
    1) check that there is no ft_local_hold_group column in library_groups
    and that there are no 'holdgroup' enum option in hold_fulfillment_policy
    in default_branch_circ_rules, default_circ_rules, default_branch_item_rules
    and branch_item_rules
    2) apply this patch
    3) perl installer/data/mysql/updatedatabase.pl && dbic
    SUCCESS => !(step 1) ;-D
    4) Sign off
    
    Sponsored-by: VOKAL
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 309754a143cb2f4ce1adc9b4bfeeca3e9af900a0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 13 16:01:46 2019 +0100

    Bug 21684: Adjust some tests
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52a9dee300e43873268bcd87b1908dc9f89fe9a2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 12 14:28:03 2019 +0100

    Bug 21684: Fix delete methods and add more tests
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3dd6a2cb934c3a4ae8540dfb2e0a05cbecb45a13
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Oct 26 13:54:47 2018 -0300

    Bug 21684: Add tests to show some of the discrepancies
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cd4dfc6e121a8f867fee5fcf8ccfd594bf163ba7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Sep 24 18:00:00 2019 -0300

    Bug 24150: Add Koha::Old::*[s]
    
    This bug report will add new classes for:
      * Koha::Old::Patron[s]
      * Koha::Old::Biblio[s]
      * Koha::Old::Item[s]
      * Koha::Old::Biblioitem[s]
    
    Sponsored-by: Association KohaLa - https://koha-fr.org/
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 42d40e372e25cc4790290dcd0bb31c50f237f5fe
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jan 3 10:49:15 2020 +0000

    Bug 23261: (RM follow-up) Add missing uri filter
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dc5fe323d2e8393caa76103c1402a0448003f61e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 11 13:02:07 2019 +0100

    Bug 24217: use Modern::Perl for modules when strict is missing
    
    We absolutely need that for modules.
    We are enabling strict by using Modern::Perl.
    Note that other modules from C4 use strict and warnings, instead of
    Modern::Perl
    
    Test plan: git grep 2505 **/*.pm should not return any results
    
    And let's see later what needs to be fixed.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 65fb97389b229c0a4de2a09570168ee4a48359bc
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Tue Dec 17 13:59:55 2019 +0000

    Bug 24016: (QA follow-up) Format code to adhere to perltidy format
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 500400077e471567197d1ad6a551c441d889e9c8
Author: Lari Taskula <lari.taskula@hypernova.fi>
Date:   Tue Nov 12 12:18:27 2019 +0000

    Bug 24016: manager_id in Koha::Patron::Message->store should not depend on userenv alone
    
    Koha::Patron::Message->store has this
    
        my $userenv = C4::Context->userenv;
        $self->manager_id( $userenv ? $userenv->{number} : undef);
    
    This breaks in REST API when userenv is not set.
    
    Let API user pass manager_id without relying on C4::Context->userenv.
    
    To test:
    1. prove t/db_dependent/Koha/Patron/Messages.t
    2. Observe success
    
    Sponsored-by: Koha-Suomi Oy
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 31e5359a6cd0dc1b5f02ec1930f418a1344f6478
Author: Lari Taskula <lari.taskula@hypernova.fi>
Date:   Tue Nov 12 12:24:30 2019 +0000

    Bug 24016: Add a failing test for overwrite-able manager_id in Koha::Patron::Message
    
    To test:
    1. prove t/db_dependent/Koha/Patron/Messages.t
    2. Observe failure
    
    t/db_dependent/Koha/Patron/Messages.t .. 2/12
       Failed test 'Manager id should be overwrite-able even if defined in userenv'
       at t/db_dependent/Koha/Patron/Messages.t line 90.
              got: '1100'
         expected: '1101'
     Looks like you failed 1 test of 12.
    t/db_dependent/Koha/Patron/Messages.t .. Dubious, test returned 1 (wstat 256, 0x100)
    Failed 1/12 subtests
    
    Sponsored-by: Koha-Suomi Oy
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bcd7e4c94ccc1ec14ea04d66c80b20a7aecddf96
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Dec 17 02:07:47 2019 +0000

    Bug 23261: (follow-up) Use logged_in_user and move test
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d917d4eb9d9d1c19330710868909b50a0d715876
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jul 3 19:11:54 2019 +0000

    Bug 23261: Add notice for login/registering to RBdigital results
    
    To test:
     1 - You will need a valid library RBDigital account
     2 - Fill in the RecordedBooks system preferences
     3 - Open the catalog, perform a search with RBDigtal resuls, 'love' often works
     4 - Click to the results
     5 - Note if not logged you don't see availability
     6 - Log in with a patron with no email, note you do not see any notice that you must register your email with RBDigital
     7 - Apply patch
     8 - Reload results, you now see a notice to register with rbdigital, do so unless you already have an account
     9 - Add your associated email to the koha account
    10 - Reload results, note you see availability
    11 - Log out, reload results
    12 - Note you see a promp to login to see availability
    
    Signed-off-by: Jessica Zairo <jzairo@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bebdbd535b9e28b982f615a301a2817aa1454951
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Oct 28 16:02:35 2019 +0000

    Bug 23913: Use a single menu to sort lists in the OPAC
    
    This patch modifies the sorting form on the OPAC list contents view so
    that the two menus (sort field and direction) are combined into one.
    This makes it consistent with the sort menu on the search results page.
    
    To test, apply the patch and view a list with multiple titles on it.
    
    Test the "Sort by" menu, trying all the various options. Confirm that
    the pre-selected item in the sorting menu is correct after each re-sort.
    
    Edit the list to change the default sorting and verify that the "Sort
    by" menu reflects your selection.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8dd4bf35a96bf7543e8eaa66794963136e29b627
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 2 14:38:03 2020 +0000

    Bug 23889: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c5fdc5e10f6d45b83068757549cb98ccc2fb3eec
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 16 15:11:27 2019 +0100

    Bug 23889: Use same css class on the basic editor view
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e357bc6a9d770ead4e24436ec625a8b78daa603b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Oct 24 14:15:41 2019 +0000

    Bug 23889: Improve style of menu header in advanced cataloging editor
    
    This patch updates the style of dropdown menu headers to make it apply
    more globally and changes the advanced cataloging editor template so
    that the correct class is applied to the menu header.
    
    To test, apply the patch and rebuild the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    Test the interfaces where these kinds of menu headers can be found:
    
     - Catalog search results: The "Sort" menu (Popularity, Author, etc.
       headings).
    
     - Saved report results: Run a report which returns a column of
       biblionumbers or itemnumbers. Check the "Batch operations" menu
       (Bibliographic records or item records headings).
    
     - Advanced cataloging editor: The settings menu (Change framework
       header).
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f480ca803ba9d4552678b3e326b3c19b9c6aec00
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Dec 20 07:14:32 2019 +0000

    Bug 24267: (QA follow-up) Remove two calls, add transaction
    
    Call to GetAuthorizedHeading is already done just before calling ImportBreedingAuth.
    Call to GuessAuthTypeCode is not used.
    Adding transaction to test (check your database, kidclamp ;)
    
    Test plan:
    Add new authority via Z3950 in the interface.
    Run t/db_dependent/Breeding.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 42cca4afc718dacd93bc66be50f82ca32006a164
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Dec 19 17:37:23 2019 +0000

    Bug 24267: Unit tests
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7abb7350ef63cb81e87b2c07141e800ed542cc8a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Dec 18 18:27:33 2019 +0000

    Bug 24267: Improve ImportBreedingAuth
    
    git grep ImportBreedingAuth - there is only one call to this routine
    from SearchZ3950Auth
    
    We pass it a MARC record, '2' for overwrite_auth
    
    We then check for this record in the DB and get the breeding id,
    however, when overwrite_auth is 2 we always add the auth to the batch
    and return the new breeding id.
    
    We don't actually use any of the other parameters returned here either
    
    To recreate:
    1 - Browse to Authorities
    2 - Select New form Z3950
    3 - Perform a search that returns results
    4 - SELECT COUNT(*) FROM import_auths
    5 - Repeat the search
    6 - SELECT COUNT(*) FROM import_auths
    7 - There are 20 more records
    8 - SELECT * FROM import_auths - note the repeated rows
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ac29b2029de81a24897f4fdfb88bdfddbb01c954
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Mon Dec 30 20:55:41 2019 -0300

    Bug 24316: (follow up) Fix es-ES web installer
    
    Same correction, as other languages, removing
    obsolete authorised value MANUAL_INV.
    
    Same test
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1887d0a8cc5554574ca05ccc40b892a838f2a690
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Dec 29 23:21:06 2019 +0100

    Bug 24316: Remove obsolete sample data for MANUAL_INV authorised value
    
    Bug 23049 replaced the MANUAL_INV authorised value by a dedicated table,
    but missed to remove the authorised value sample data from the non-English
    installers.
    
    This patch corrects this oversight.
    
    Note:
    The German (de-DE) file was changed a bit more, adding 2 missing translations
    for the new RETURN_CLAIM_RESOLUTION and to match the sequence of the en
    file.
    
    To test:
    - Verify the SQL file changes are valid by loading those files OR
    - Run the installers for each language on an empty database
    - Verify there is no error loading the optional authorised value data
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    
    Tested with 24317 and a small followup for this bug for es-ES
    
    Tested doing clean install for de-DE es-ES fr-CA it-IT nb-NO pl-PL
    up to loading of all mandatory & optional data.
    All languages load without problems.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ddfeea9c57e2af5b01e86b9790480f79f851044f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 2 13:15:05 2020 +0000

    Bug 14973: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3fc405ab40e20abb3f8a41e2364663f618b89cc5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 7 19:15:08 2019 +0100

    Bug 14963: Fix ergonomic issue on small screen
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c1f7eb84294cd48c7975f21a732834e6763f5808
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 7 18:18:31 2019 +0100

    Bug 14963: Set status=ORDERED for suggestions created from existing record
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd9be62a2ae6b247aeee25290e1199bea16f79db
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 5 19:42:43 2019 +0100

    Bug 14963: Add the ability to suggest purchase on existing title
    
    This patch adds the ability to create a new purchase suggestion from an
    existing title. This will prevent the creation of bibliographic records
    that already exist in the catalogue. Also it will ease the process
    during acquisition.
    
    Test plan:
    - Login at the OPAC and go to the detail of a bibliographic record.
    - Note that there is a new link "New purchase suggestion for this title"
    on the right of the screen
    - Please suggest an other icon if that one is not appropriated
    - Click on it and submit your new suggestion
    => You should not get the confirmation screen (introduced by bug 14973)
    warning you that the title already exists.
    - Login staff side and order from this suggestion.
    - Receive items and confirm that a new bibliographic record is not
    created.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 93a06105a825e9ef585d7acb0b7cad319580dce5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 18 16:53:41 2019 +0100

    Bug 14973: Fix edit a suggestion and dup found
    
    The find duplicate call must only be done when the suggestion is new. It
    does not make sense to search for a duplicate when the suggestion
    already exists.
    
    This patch also fixes a side-effect:
    - Create a suggestion using an existing biblio title
    - Ignore the warning and save
    - Edit again and save
    => BOOM on date
    
    Template process failed: undef error - The given date (18/11/2019) does
    not match the date format (iso) at /kohadevbox/koha/Koha/DateUtils.pm
    line 168
    
    The dates are not processed and so badly formatted when sent to the
    template.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52196919f22cb4e72dc61b670ea400f15c4a9cf6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 17:25:57 2019 +0100

    Bug 14973: Add missing filters in templates
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4fe524c93f3ec882620c1c00d2338b3826a66f9e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 17:23:33 2019 +0100

    Bug 14973: Remove double declaration of suggestions_loop
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8111e4c116bbdcb5e03040e1c90ab48531eeaefb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 16 15:54:39 2019 +0200

    Bug 14973: Remove double textarea for notes
    
    Certainly a bad merge conflict resolution (I am certainly the one to
    blame).
    However I do not understand where this "note" variable come from.
    
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d6400a7024eceb8a234de78c23b9eac5f5674385
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 16 15:46:56 2019 +0200

    Bug 14973: Do not skip validation step when submiting a suggestion - OPAC
    
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5e5e50ac177b4d29b24c58ce08516a08a0ced503
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Wed Mar 8 11:23:12 2017 +0000

    Bug 14973: Check existing biblio when submitting a purchase suggestion (staff side)
    
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 880fc53d741308ff8148d0be976009ee00896322
Author: Alex Arnaud <alex.arnaud>
Date:   Wed Oct 7 17:34:33 2015 +0200

    Bug 14973: Check existing biblio when submitting a purchase suggestion (opac side)
    
    Test plan:
    - Go to opac suggestions page (opac-suggestions.pl) and click on "New purchase suggestion",
    - type the title (and author?) of a document that stand in you database
    - you should get a warning message about an exiting biblio.
    - clicking on confirm your suggestion add it, cancel does nothing
    
    Signed-off-by: Nicole Engard <nengard@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ffeda45d23c578bd36bf7ba3ca542bcab403fa23
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Nov 2 00:19:33 2019 +0000

    Bug 23783: Show languages from MARC21 field 041 in OPAC
    
    This copies the changes made in bug 20364 for the staff
    interface to the OPAC.
    
    Some slight changes have been made in comparison:
    - OPAC uses the class "separator" for the characters
      that are used between repeatable tags. "sep" as
      used in the original patch set has some CSS rules
      attached to it that break display, so it makes
      double sense to change it.
    - We revently removed ending . from the display in
      OPAC - so it's done here too.
    
    To test:
    1) Apply patch
    2) Do a search in the OPAC and check the results look correct
    3) Check some biblio detail pages and verify that they look correct
    4) Add some 041 subfields (a, b, d, h, j) in any combinations
    5) Repeat 2 and 3
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 91bf28ced90470addb6aee265cabf442fb645be8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jan 2 12:18:48 2020 +0000

    Bug 24282: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3078524db838170d9d5f99a32360fe5b0b2d9325
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Dec 20 08:40:37 2019 +0100

    Bug 24282: SCSS conversion broke style in search results item status
    
    Before SCSS conversion, there was a style for search results item status :
      #searchresults span.status {
    Conversion to SCSS added ul :
      #searchresults ul span.status {
    Now style does not apply anymore.
    You can see that items on loan are not red anymore.
    
    To test, apply the patch and regenerate your CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    Clear your browser cache if necessary.
    
    All rules using #searchresults in 17.11 :
        font-size : 90%;
        list-style: url(../img/item-bullet.gif);
        padding : .2em 0;
            clear : left;
    }
    
        clear : left;
        color : #900;
        display : block;
    }
    
        clear : left;
        display : block;
    }
    
        display : block;
    }
    
        float : left;
        margin : 3px 5px 3px -5px;
    }
    
        vertical-align : top;
    }
    
    Apply patch update intranet CSS file and check you see the same rules.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ee4d99cc76a79ad11c1b0a2b096abb2f9b85bf0e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Dec 13 19:58:52 2019 +0000

    Bug 24244: Send null instead of empty string if branch not set
    
    Fix NewSuggestion if branchcode is passed with an empty string.
    Error was "Broken FK constraint"
    
    Test plan:
    Create a new suggestion, select "any" for the library.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 611cb461893cf09481895ee23b769cb5ee078bed
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Dec 15 12:43:25 2019 +0100

    Bug 24244: Add test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d52062219bc898e46aff1920f1ccc4e61d4c604
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Dec 30 06:52:03 2019 -0500

    Bug 24317: Sample patron data not loading for non-English installations
    
    Bug 14570 removed the guarantorid column from the English sample data but missed the other translated installers. This means the sample patrons can no longer be installed for other languages.
    
    Test Plan:
    1) Attempt to install the sample patron data in German, Spanish, Norwegian, and Polish
    2) Note the error
    3) Apply this patch
    4) Repeat step 1
    5) No error!
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    
    On top of Bug 24316 + followup
    
    Tested doing clean install for de-DE es-ES fr-CA it-IT nb-NO pl-PL
    up to loading of all mandatory & optional data.
    All languages load without problems.
    A small qa error fixed in commit message.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c1d56dde9300dfed53e72612276717cce0f65de2
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Dec 22 13:30:02 2019 +0000

    Bug 24208: (follow-up) Change page title from payment to writeoff
    
    This makes a change requested by the first tester:
    Also change the page title when a writeoff is done vs
    a payment.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e74208b8dc4b3cde2e5ff5f23184d15567e0796f
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Tue Dec 10 13:58:45 2019 -0500

    Bug 24208: Remove change calculation for writeoffs
    
    Bug 11373 added change calculation to the payment page.
    
    This doesn't work very well in the case of writeoffs:
        - The "Amount paid" and "Change to give" fields don't make much
        sense in the case of writeoffs.
        - The amount for a partial writeoff has to be entered in the
        "Amount paid" field instead of the one labeled "Writeoff amount"
        just underneath.
    
    This patch removes these unwanted fields and use the "Writeoff amount"
    label on the right input.
    
    Test plan:
    1) Choose a patron who has fees.
        You can add a manual invoice if necessary.
    2) Go to Accounting > Make a payment.
    3) Select some fines and click "Write off selected".
    4) Note the form has a lot of inputs, not all are necessary for a
    writeoff.
    5) Make a partial writeoff by entering a different amount in the
    "Writeoff amount" field.
        => The amount written off is the amount entered in the "Amount
        paid" field.
    6) Apply patch.
    7) Repeat steps 1-3.
    8) Notice the form only has "Amount outstanding", "Writeoff amount"
    and "Note" fields, which are enough for a writeoff.
    9) Entering any amount lower than or equal to the amount outstanding
    in the "Writeoff amount" field should create a writeoff of the selected
    amount.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b6937d790e8224b3e1b61d72f5a24ec7ce83311e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Dec 16 11:45:51 2019 +0000

    Bug 7047: (QA follow-up) Fix tests
    
    Tests fail on biblionumber constraint for suggestions if 'RenewSerialAddsSuggestion' is enabled
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f50106a605b59570e03a601034387505a7a0c525
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Dec 16 11:22:58 2019 +0000

    Bug 7047: (QA follow-up) Add missing filters
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2c9d7079b282e77413a08c4cfd9c72aa60279830
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 16 11:55:48 2019 +0100

    Bug 7047: Revert changes relative to the new column on suggestion list
    
    We should move that to its own bug report if needed, not sure we will
    all agree on that new column.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 15db14d62f9a5e830c6ed9b6c27658b203cf0933
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 16 11:54:05 2019 +0100

    Bug 7047: Change ReNewSubscription prototype - use hashref
    
    It also removes a warn statement.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5c5f8ecfed387cef647dcc9d37b8bca1eac7480c
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Mon Dec 4 13:35:01 2017 +1300

    Bug 7047: Storing subscription renewal note in suggestion to be displayed on the suggestion page.
    
    Additionally I have added a library input field in case the librarian wants to set a library branch whilst renewing a subscription. With the use case being they may have ommitted to set the branchcode whilst creating the subscription.
    
    Test plan:
    1. Create a subscription (if one does not already exist)
    
    2. Set the RenewSerialAddsSuggestion syspref to 'Add'
    
    3. Renew the item making sure to write in a value into the note field
    
    3. Visit the suggestions page and notice that the note is not displayed
    for the newly created suggestion
    
    4. Apply patch
    
    5. Repeat step 3. Notice that there is now a new branchcode dropdown
    box. Select one of your libraries and write in the value into the note
    field
    
    6. Visit suggestions and notice there is now a 'Suggestion note' column
    in the table containing the note.
    
    Also note that the suggestion has the correct branchcode associated with
    it
    
    Sponsored-By: Catalyst IT
    Signed-off-by: Maksim Sen <maksim@inlibro.com>
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 58a36dd18612b0d6c1734992937f8e9fd40f510f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 11:09:51 2019 +0100

    Bug 24166: Do not hang when displaying checkout list if barcode is not set
    
    If a barcode is not set, there is a JS error in the log:
      TypeError: oObj.barcode is null
    We should not call escapeHtml() on it if not barcode is set for a given
    item.
    
    Test plan:
    Check an item out
    Remove its barcode
    Load the checkout list
    => Without this patch you get the "loading" popup and the table is never
    displayed
    => With this patch applied you see the checkout list
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f93e5bc59ace4696ca721be116f029b07506a673
Author: Pedro Amorim <pjamorim91@gmail.com>
Date:   Wed Dec 11 10:28:34 2019 -0100

    Bug 24121: Item types icons in intra search results are requesting icons from opac images path
    
    When searching in INTRA you'll notice the item type icons not showing.
    
    To test:
    1) Set syspref item-level_itypes to biblio
    2) Confirm that there is a biblioitems.itemtype mapping to a MARC field
    3) Verify that item type icons are set for all the types
    4) Perform a search where biblios with said MARC field is filled with a type value
    5) Verify that where the icon should appear, it's showing the browser icon for image not found
    6) Apply patch.
    7) Repeat step 4.
    8) Observe the icons are now displayed correctly
    
    Sponsored-by: Governo Regional dos Açores
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 83749931604043f3321820c8584dc53c09c36430
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Dec 19 09:47:44 2019 +0000

    Bug 24274: Remove field 01e from sql installer files
    
    Field 01e comes from an older utility (RLIN) and does not belong here.
    Note: It is the only non-numeric field tag in Koha. And it seems to be
    an violation of the MARC standard.
    
    Test plan:
    Run a new install and check the bibliographic frameworks.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dbf4b49ae9685f12c994f92c3d17eeac400aa0ff
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Fri Dec 20 09:03:39 2019 -0500

    Bug 24281: Fix the list of types of visual materials
    
    In the MARC21 XSLT files for results in both staff and OPAC, the
    type of visual material for code "g" is "legal article" instead
    of "game". This patch change the value to "game".
    
    To test:
    0. Set up:
        - have a MARC21 database
        - use default XSLT file for display of results :
            OPACXSLTResultsDisplay : default
            XSLTResultsDisplay : defaul
        - If needed, catalog a game. In the 008 tag editor :
            Type of Material : VM - Visual Materials
            33 - Type of visual material : g - Game
    1. On both staff and OPAC, make a search which returns results
    including visual materials of type game (the title catalogued
    in previous step).
    2. Note that in the list of results, the label "Type of visual
    material" is followed by "legal article".
    3. Apply patch.
    4. Repeat step 1.
    5. Note "legal article" has been replaced by "game".
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3d662f087772d3d71c56a237aa8c7e111e6808fd
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Dec 20 11:29:39 2019 +0000

    Bug 24283: (bug 21446 follow-up) close strong and add missing parens
    
    To Test:
    1) Create a course in course reserves, make it inactive
    2) Add an item to it, changing item type and location
    3) Make the course enabled
    4) Note that the normal item type is no longer bold and has both opening and closing parentheses; Note that the normal location is also not bold and has both opening and closing parentheses.
    5) Disable the course
    6) Note that the normal item type is in bold with an opening parentheses but no closing parentheses; Note that the normal location is in bold with both opening and closing parentheses.
    7) Apply patch
    8) Note view is fixed
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6e3e8fef6ac203fc1fbe6666af92f0694570496e
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Mon Dec 9 20:41:45 2019 -0300

    Bug 18688: Warnings about UTF-8 charset when creating a new language
    
    This patch removes some warnings when creating new languages,
    those related with uft8 and two not related.
    
    Tipical messages are:
    >Warning: Can't determine original templates' charset, defaulting to UTF-8
    >Warning: Charset Out defaulting to UTF-8
    >...
    >Removing empty file /../xx-YY-marc-NORMARC.po
    >I UTF-8 O UTF-8 at /../kohaclone/misc/translator/tmpl_process3.pl line 365.
    >Use of uninitialized value $pref_name in concatenation (.) or string at /.../misc/translator/LangInstaller.pm line 197.
    >Created /../misc/translator/po/xx-YY-messages.po.
    
    First four are 'normal' messages
    The fifth one correspond to an unquoted preference string
    The sixth one is a normal output message from msgint command
    We will hide them unless verbose '-v' option is selected,
    and fix the error.
    
    To test:
    1) Go to misc/translator
    2) Create new language files
      $ perl translate create xx-YY
    3) Check warnings and messages
    4) Apply the patch
    5) Remove created files, and create them again
       Ther must be no messages
    6) Repeat 5) with verbose option '-v', check
       old messages
    
    7) BONUS: without the patch update a language,
       for example de-DE:
       $ perl translate update de-DE
       Note (git status) a new file, po/de-DE-messages.po~
       This is a backup file from msgmerge command
       With the patch this backup is removed.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 61ca2359f276e04c554ea7020fe2298e65eff249
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Nov 22 14:42:56 2019 +0000

    Bug 11500: Use dateformat syspref and datepicker on additems.pl (and other item cataloguing pages)
    
    This patch modifies the cataloging plugin dateaccessioned.pl so that it
    triggers the addition of a datepicker widget to fields it is linked
    with. Despite its name the plugin can be used on any item field which
    requires a date.
    
    To test, apply the patch and make sure you have one or more item
    subfields linked to the dateaccessioned.pl plugin. For instance, in
    MARC21:
    
     - Administration -> MARC bibliographic framework -> MARC structure ->
       952 -> Edit subfields:
       - subfields d ("Date acquired") and w ("Price effective from"):
         - Other options -> Plugin -> dateaccessioned.pl
    
     - Go to cataloging and add or edit an item on a bibliographic record
     - The "Date acquired" and "Price effective from" fields should be
       styled as datepickers.
     - Clicking in these fields should populate the field with today's date
       and trigger the datepicker popup.
     - Test that all the datepicker features work correctly.
     - Test that manual entry of a date works.
    
     - With the AcqCreateItem system preference set to "placing an order,"
       go to Acquisitions -> Vendor -> Add to basket.
       - Add a title to your basket using your preferred method.
       - In the "New order" form, find the section for adding an item.
       - Test the "Date acquired" and "Price effective from" fields, which
         should behave just like they did in the cataloging module.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 403763679a3f2ec7c19fbae0813a1012c22b75ed
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Oct 13 16:04:40 2017 -0300

    Bug 19465: Document koha-create --elasticsearch-server option switch
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d8c95abe96f2874291d68f73c0bffeb35587119c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Oct 13 15:59:25 2017 -0300

    Bug 19465: Add --elasticsearch-server option to koha-create
    
    This patch adds the --elasticsearch-server option switch to koha-create.
    It allows choosing a different Elasticsearch configuration. It defaults
    to the current 'localhost:9200' value.
    
    To test:
    - Apply this patches
    - Run:
      $ reset_all
      $ man koha-create
    => SUCCESS: The man page shows correct information about the added
    option switch
    - Run:
      $ sudo koha-create --create-db test
    => SUCCESS: /etc/koha/sites/test/koha-conf.xml contains the default
       value (i.e. the current behaviour is kept)
    - Run:
      $ sudo koha-create --create-db --elasticsearch-server tomas:1234 test2
    => SUCCESS: /etc/koha/sites/test2/koha-conf.xml contains the passed
       value in the <elasticsearch><server> section.
    - Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d82856f0e79f2d3871df94786583631ce6863ef
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Mon Nov 18 08:50:52 2019 -0500

    Bug 24046: Untranslatable 'Activate filters'
    
    Bug 9573 moved the code for the table filters activation to it's
    own javascript file. The strings contained in this file are not
    translatable. This patch moves the strings to the datatables
    include file since the filters are related to datatables.
    
    Test plan:
    Visit the catalogue/detail.pl and reports/itemslost.pl and test
    that the 'Activate/Deactivate filters' option still work correctly.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e28f9861a94dc0428832cc15511d97cb9c51cfad
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Dec 15 12:32:34 2019 +0100

    Bug 24242: Display funds that the logged in user can access - suggestions
    
    The design of this script is pretty bad and any modifications is a
    challenge.
    Here we are trying to display to display the funds available for the
    logged in user. I did not understand previous code, as we are doing a
    limit using CanUserUseBudget, I do not think it makes sense to retrieve
    funds for a given library.
    Also, I am wondering if the dropdown list in the filters has ever been
    populated: budgetid_loop in the template *never* appeared in the history
    of suggestion.pl (??)
    
    Test plan:
    Search for suggestions
    Add/edit suggestions
    => The funds in the dropdown list should be the ones the logged in user
    can use.
    
    Signed-off-by: hc <hc@interleaf.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 92c6d3511ee42d9040fd8c4cda1fc1661024b075
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 13 12:41:20 2019 +0100

    Bug 21232: Add a client-side check on biblionumber when creating a subscription
    
    This patch adds an AJAX call to the REST API (/api/v1/biblios/) to
    retrieve and display the biblio's title.
    On clicking the "next" button a check is done to make sure the title
    exists, which means the biblionumber we manually entered is valid (can
    we assume a title is mandatory?)
    
    Test plan:
    - Create or edit a new subscription
    - Enter an invalid biblionumber in the input
    => A friendly note is telling you that the biblio does not exist
    - Try to switch to the next screen
    => You get an alert
    - Enter a valid biblionumber in the input
    => The title is displayed
    => Try to switch to the next screen
    => It works!
    
    Signed-off-by: hc <hc@interleaf.ie>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8112e2a6361af871cada25c328ab9c04c0796fb7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Dec 15 12:53:06 2019 +0100

    Bug 24243: Do not explode if invalid metadata when searching catalogue
    
    If the bibliographic record metadata cannot be decoded, the get_coins
    call should catch the exception raised by Koha::Biblio::Metadata->record
    to not explode
    
    Error is: "Invalid data, cannot decode objec"
    
    Test plan:
    0/ Do not apply the patch
    1/ Search for record at the OPAC
    2/ Note one of the biblionumber from the first page result
    3/ Set to empty string the biblio_metadata to make the error appears:
      update biblio_metadata set metadata="" where biblionumber=42;
    4/ Try the same search
    => You get an internal server error
    5/ Apply the patch, restart plack and try again
    => It now works, ie. it does not explode
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3c222cf569c3b7d236c93df92696548a8bb8e1c5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 17 14:57:58 2019 +0100

    Bug 24175: Simplify tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2bdccdb64b950114ae485970d85ec9e6598d0b5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 17 14:23:16 2019 +0100

    Bug 24175: Take advantage of Koha::Item->holds
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 09aa99391f0111f06f29b5cfb65ccfec2f1f538f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Dec 4 18:50:41 2019 +0000

    Bug 24175: Use itemnumber when searching for holds in SIP drop_hold
    
    To test:
    1 - place a hold for a patron
    2 - Get SIP running
        https://wiki.koha-community.org/wiki/Koha_SIP2_server_setup
    3 - edit the sip_cli_emulator.pl for hold_mode from '+' to '-'
    4 - Attempt to cancel hold
    5 - It fails
    6 - Apply patch
    7 - Try again
    8 - It succeeds
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c3a1a6b9ad0bcec770293f437b1bf594a2314801
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Dec 4 18:38:22 2019 +0000

    Bug 24175: Unit tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5432cbd92a85513e68f65fede2b4d31f078f1cfa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 10:50:43 2019 +0100

    Bug 24259: Handle non existing default circ rule in Charges::Fees
    
    Can't call method "lengthunit" on an undefined value at
    /usr/share/koha/lib/Koha/Charges/Fees.pm line 101.
    
    Test plan:
    1 - Remove all/all rule form circulation rules
    2 - Define a rental fee per day for an itemtype
    3 - Checkout an item of this type ot patron
    4 - Should get note of no circ rule defined
    5 - Confirm the checkout
    => item is checked out
    
    Signed-off-by: hc <hc@interleaf.ie>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b58cee945a33fa5a66ec5786ce10aee9eb6256d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 19 07:41:11 2019 +0100

    Bug 24169: Add a comment to clarify the use of the dataTable class
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 53966685c028533f96ed8052e33c415d00560c59
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Dec 17 15:53:38 2019 +0000

    Bug 24169: Advanced editor: icons/buttons for sorting the search results are missing
    
    This patch "manually" adds the "dataTable" class to the table of search
    results in the advanced cataloging editor. This allows the correct
    styles to get picked up from existing CSS.
    
    To test, go to Cataloging and open the advanced editor. Perform a search
    using the sidebar search form. In the table of results, confirm that
    table sorting indicators look correct and that sorting works correctly.
    
    Signed-off-by: Cori Lynn Arnold <carnold@dgiinc.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c9ca38dcdf2abddc9becab4f2ff2f8d9c17fa60b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 09:46:51 2019 +0100

    Bug 24232: Hide the "Delete biblio" if permission edit_catalogue not set
    
    The script moveitem.pl requires editcatalogue => 'edit_items', the
    deletion of a biblio editcatalogue => edit_catalogue. Even if weird I
    guess we could have a librarian with edit_items but edit_catalogue.
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 62dcfa95da212f1ed4c35d94334cf9f6de616f02
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 17 14:43:54 2019 -0300

    Bug 24232: Fix required permissions in DELETE /biblios/:biblio_id
    
    This patch fixes the required permissions defined on the spec for the
    mentioned endpoint.
    
    To test:
    1. Apply the tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/biblios.t
    => FAIL: Tests fail due to badly defined permissions
    3. Apply this patch
    4. Repeat 2
    => SUCCESS: Tests pass! Notice parameters: edit_catelogue didn't exist
    5. Sign off :-D
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 41abacfbaa5718ef23dc2fe65a7f87051778e0a0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 17 14:38:41 2019 -0300

    Bug 24232: Regression tests
    
    This patch enhances the tests for the DELETE /biblios/:biblio_id
    endpoint so more fine grained permissions are tested.
    
    It highlights the fact that the required permissions defined on the spec
    are not correcttly defined.
    
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/biblios.t
    => FAIL: Tests fail because the user (that now has subpermissions only)
    does not have enough permissions for a non-existent subpermission
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a72417f04fa074655844ce41a363f231704304ed
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Dec 18 18:53:04 2019 +0000

    Bug 24268: Break assignment and warn into separate actions
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e3209e7110c44ffd79377f49dc40f37fcf875416
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Dec 18 19:01:26 2019 +0000

    Bug 24268: Unit tests
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 96f3ae0285656292b26e372a5e548363eaea009b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 18 09:04:38 2019 +0100

    Bug 24215: Do not always display an empty entry
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 50446f777b9fc07422ff401d92de3a6fcdf61c00
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Dec 11 11:33:51 2019 +0000

    Bug 24215: Correct display of guarantor relationship errors
    
    Test plan:
    1) Add some bad data to your borrower_relationships table. ( add or
       update a relationship such that the 'relationship' field contains a
       value not listed in the corresponding system preference.
    2) Go to the about system information page and note the nasty display of
       ARRAY(whatever)
    3) Apply the patch
    4) Repeat step 2 and note that a list of bad values is now displayed
       instead.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 637b6dca86b4f60697eade81afa70f64669f48fb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 16 10:34:27 2019 +0100

    Bug 24137: Same fixes for *_local.sql files
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    tested using
    
    $ export L=uk-UA (and ru-RU)
    $ for o in mandatory optional;
     do for a in installer/data/mysql/$L/marcflavour/marc21/$o/*.sql; do
      mysql kohatest < $a;
     done;
    done
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 62a03b5a651fa8756d127e96ec95f208c5dc0e43
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 10 12:03:09 2019 +0100

    Bug 24137: Manual replacement for hidden
    
    Arbitrary set to -6 when was NULL
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Fixed 991 in uk-UA marc21_bibliographic_DEFAULT_local.sql
    
    All files load without errors, mandatory and optional
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9b5b8e43cb9483eb8b56b259dee5875b75b1b872
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 10 12:02:44 2019 +0100

    Bug 24137: Fix biblio frameworks install for ru-Ru and uk-UA (repeatable)
    
    Replace repeatable='' with repeatable=0
    
    perl -p -i -e "s/^\s\('', '(\d+)', (\d), '', / ('', '\1', \2, 0, /" installer/data/mysql/ru-RU/marcflavour/marc21/mandatory/marc21_bibliographic_DEFAULT_general.sql installer/data/mysql/uk-UA/marcflavour/marc21/mandatory/marc21_bibliographic_DEFAULT_general.sql
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f29b554665a43b4531e79f6eb581a6b2b8f70675
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 10 11:59:51 2019 +0100

    Bug 24137: Fix biblio frameworks install for ru-Ru and uk-UA (mandatory)
    
    Replace mandatory='' with mandatory=0
    
    perl -p -i -e "s/^\s\('', '(\d+)', '', / ('', '\1', 0, /" installer/data/mysql/ru-RU/marcflavour/marc21/mandatory/marc21_bibliographic_DEFAULT_general.sql installer/data/mysql/uk-UA/marcflavour/marc21/mandatory/marc21_bibliographic_DEFAULT_general.sql
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d7fe53d7e5a6c5796d31b2db3612551d13224ba8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Dec 17 09:07:44 2019 +0000

    Bug 23233: (RM follow-up) Rename syspref in test
    
    The AllowItemsOnHoldCheckout system preference was renamed to
    AllowItemsOnHoldCheckoutSIP to clarify it's use, but one case was missed
    in the test suit.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aea4407ef8728ec3cf130f3f910e01f31c96de47
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Sat Dec 14 00:55:39 2019 +0000

    Bug 24245: rename self reg confirm page body id
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e6af0471c281accd5dcf6205d5684712d835b050
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Wed Dec 4 23:49:31 2019 +0000

    Bug 22381: Change wording on Calendar-related system
    
    TEST PLAN:
    1. Apply Patch
    2. Look at the 5 sysprefs (useDaysMode, OverdueNoticeCalendar, finesCalendar, ExcludeHolidaysFromMaxPickUpDelay, SuspensionsCalendar)
    3. Make sure the wording and options all make sense
    4. Make sure the options are properly ignoring or using the calendar.
    
    Signed-off-by: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
    Fixed double 'when' on line 740
    No errors
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 92d7749640172b7fc0fe815ee9edcd4e225b3ecd
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Dec 13 14:24:33 2019 +0000

    Bug 24240: Move form closing tag outside of conditional
    
    To test:
    1 - Create a public list
    2 - View the list as a user not signed in
    3 - Validate the HTML, note the div closed with open elements, and a form tag unclosed
    4 - Apply patch
    5 - Those errors are fixed
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 568cbb3a0e698c2b263bc27ead9cacb3fcd170ea
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Dec 13 23:01:05 2019 +0000

    Bug 24085: Make print and cancel-hold buttons instead of submit
    
     To test:
     1 - Place a hold on an item
     2 - Check in the item to trigger the hold
     3 - Test both the print and cancel buttons to make sure all looks
         correct
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f497008d7f7e029909f4a801ba8fa41482e03fdf
Author: Radek Šiman <rbit@rbit.cz>
Date:   Fri Dec 13 16:30:56 2019 +0000

    Bug 24235: DUEDGST not sent if PREDUDGST checkbox is off
    
    DUEDGST notice required PREDUEDGST to be on, but both messages have to
    be generated independently
    
    Test plan:
    0) Do not apply the patch and reproduce the bug
        - turn OFF sms PREDUEDGST and turn ON sms DUEDGST for a given borrower
        - Sms version of DUEDGST is never generated into the message queue.
    1) Apply the patch
    2) Ensure that the bug is fixed
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f115158d6df03b6238a1b2c22998b8c3a5a4cd07
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Dec 13 17:50:59 2019 +0100

    Bug 24241: (bug 23049 follow-up) Add description for manage_accounts
    
    Test plan:
    Edit permissions for a patron
    Unfold "Manage Koha system settings (Administration panel)"
    => Without this patch a checkbox appears without description
    => With this patch you see the description for manage_accounts
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a5ce70d3bf01d91c5864ef7c83273d22e536376
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Dec 16 11:00:27 2019 +0000

    Bug 23233: DBRev 19.12.00.002
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dac488b55f76b511a5c9bd66ced6b1813368c83e
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Tue Oct 22 11:20:39 2019 +0000

    Bug 23233: (follow-up) Correct test description
    
    AllowItemsOnHoldCheckout is not checked anymore but instead only
    whether the tmp_holdsqueue is empty or not.
    
    Signed-off-by: Lari Taskula <lari.taskula@hypernova.fi>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b2b9f2ceb87189eab1cbfab8b291afe95101c4b8
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Tue Oct 22 11:04:48 2019 +0000

    Bug 23233: (follow-up) Add description to atomic upgrade
    
    Signed-off-by: Lari Taskula <lari.taskula@hypernova.fi>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1bd6c7d4571c1e7ad9ea8ee6f456260cb3636669
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Tue Oct 22 11:00:51 2019 +0000

    Bug 23233: (follow-up) Remove accidentally left comment
    
    The line
    
    t::lib::Mocks::mock_preference( 'AllowItemsOnHoldCheckout', 0 );
    
    was removed from below this comment line but the comment explaining
    what it does was forgotten.
    
    Signed-off-by: Lari Taskula <lari.taskula@hypernova.fi>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f4746340c1bf1d6408aedae93d713f49760e1279
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jul 1 08:56:09 2019 -0400

    Bug 23233: Remove use of AllowItemsOnHoldCheckout from C4::Items::GetItemsInfo
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f5435839263c31ef1c29e54f244a98ef7cce812e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Jul 1 07:19:33 2019 -0400

    Bug 23233: Remove use of AllowItemsOnHoldCheckout from Koha::Item::has_pending_hold, it can cause false data to be returned
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 50bb8e96f10638278dcec9a8eebf52c7f74209f2
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 28 14:07:39 2019 -0400

    Bug 23233: AllowItemsOnHoldCheckout is misnamed and does not indicate it is for SIP-based checkouts only
    
    The system preference AllowItemsOnHoldCheckout only affects SIP based checkouts. I believe we should rename it AllowItemsOnHoldCheckoutSIP so it matches AllowItemsOnHoldCheckoutSCO. We should also update the description as well.
    
    As far as I know AllowItemsOnHoldCheckout has never affected anything except SIP traffic. That does not preclude the addition of another AllowItemsOnHoldCheckout syspref that would affect the staff interface, but that would be an enhancement and is outside the scope of this bug report.
    
    Test Plan:
    1) Test AllowItemsOnHoldCheckout via SIP
    2) Apply this patch
    3) Test AllowItemsOnHoldCheckoutSIP via SIP
    4) Note there is no difference!
    5) Note the syspref description has been update to mention SIP
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 044b6eadd591f6f6c02496ed3d47403cc2d3f7f5
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Thu Dec 5 21:52:31 2019 +0000

    Bug 24184: Reword FallbackToSMSIfNoEmail syspref text
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 83e83adfb5aa2c5ca3459acc640739ba2dfb9c13
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 5 13:19:20 2019 +0100

    Bug 21270: Display "Make an Interlibrary loan request" even if "suggestions" is turned off
    
    Test plan:
    - Turn off "suggestions"
    - Turn on "ILLModule"
    => When logged in you should see the "Make an Interlibrary loan request"
    
    - Turn on "suggestions"
    - Turn off "ILLModule"
    => When logged in you should see the "Make a purchase suggestion"
    
    - Turn on "suggestions"
    - Turn on "ILLModule"
    => When logged in you should see both links.
    
    - Turn off "suggestions"
    - Turn off "ILLModule"
    => You should not see the "Not finding what you're looking for?" block
    
    - Turn on "suggestions"
    - Turn on AnonSuggestions
    => You should see the "Make a purchase suggestion" even when logged out
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1cce77631aea7b3e24aeed8daa649001d4b56b10
Author: Philippe Blouin <philippe.blouin@inlibro.com>
Date:   Fri Aug 24 11:46:54 2018 -0400

    Bug 21270: "Not finding what you're looking for" displaying uselessly
    
    When doing OPAC search, at the bottom you have an offer presented with "Not finding what you're looking for" to introduce Suggestions or ILL if enabled.
    
    Bug 7317 modified the if-else and now if you enable ILLModule but not AnonSuggestions and are not logged, you have this little string sitting there, offering nothing to the user.
    
    Just taunting them...
    
    TEST:
    0) Set IllModule to true, AnonSuggestions to false.
    1) Without login, just to an OPAC search.  At the bottom will be a nice string laughing at your failed search
    2) Apply the patch.
    3) Problem at 1) is fixed.
    4) Login to validate that ILL link now appear.
    5) Modify combination of IllModule and AnonSuggestions to validate links appearing.
    
    Signed-off-by: Dilan Johnpullé <dilan@calyx.net.au>
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 219c2de66adea29ff26b9a580c039a1d59fd8864
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Nov 22 16:47:45 2019 +0000

    Bug 13806: Sanitize inputs where creating Reports subgroup
    
    This patch adds validation of report group and subgroup inputs so that
    the user can't enter data into only one half of the group code/name
    pair.
    
    To test, apply the patch and go to Reports -> Use saved.
    
      - Create or edit a report which doesn't have a group or subgroup
        assigned.
    
      - Under "Report group," select the "or create" radio button.
    
      - Click the "Update SQL" button to submit the form without entering a
        group code or name. The form should require taht you enter data into
        both fields.
    
      - Enter data into the report group code and name fields. Add data to
        either the code or data field under "Report subgroup." You should
        not be able to submit the form without populating both.
    
      - Start over editing a report which doesn't have a group or subgroup
        assigned.
    
        - Select an existing group under "Report group."
    
        - Under "Report subgroup," select the "or create" option.
    
          - You should not be able to submit the form without adding data in
            both the code and name fields for the report subgroup.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e25944a8b195d2cde6c979adadfc03f4b7314ddc
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Dec 13 07:01:23 2019 +0100

    Bug 24230: fix intranet_js plugin hook before body end tag
    
    The plugin hook intranet_js is after body tag in intranet-bottom.inc :
        </body>
    [% KohaPlugins.get_plugins_intranet_js | $raw %]
    </html>
    
    It must be before like in opac-bottom.inc
    
    Test plan :
    1) Install a Koha plugin with intranet_js hook, like KitechenSink
    2) Go to an intranet page
    3) Look at source of the page to see plugin code is before body end tag
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f8030195f7a93190f25319dc0f1491cc88a25316
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Dec 13 10:03:20 2019 +0000

    Bug 23800: (QA follow-up) Remove useless line
    
    The lines with my @barcodes makes no sense anymore.
    
    Test plan:
    Test with a barcode file.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8da531afc361d6605bacdbbe051394a1023119d3
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Dec 13 09:28:28 2019 +0000

    Bug 23800: (QA follow-up) Fix item case, reduce code
    
    The solution for items does not work, since it compares barcodes.
    Instead of a grep in a map, we could do simpler.
    
    Test plan:
    Try barcode file, order not by itemnumber. Toggle with case. Add wrong code.
    Try same via barcode list text area.
    Try an itemnumber file, reorder again. Add wrong number.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 73870efdb78e6ff93b4186244f51516f69e063e7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 11 11:09:45 2019 +0100

    Bug 23800: Does not order items by barcode in batch item modification
    
    They must be displayed in the same order they have been scanned (or they
    appear in the file)
    
    This is an alternative patch. Same behavior for barcodes or itemnumbers,
    as well as if a file has been used or items scanned.
    Code is duplicated, but refactoring is out of the scope.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ed6fdb916c14983cfb898ba204510e11e423e412
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Nov 22 15:04:34 2019 +0100

    Bug 24090: Subfield text in red when mandatory in record edition
    
    In biblio or autority record edition, color subfield text in red when mandatory.
    Like patron fields in patron edition form.
    
    Test plan :
    1) Edit a biblio record
    2) See that mandatory subield text is red (#C00)
    3) Same in autority record edition
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c926c934ad6a607f80d6afac9553761cca511ea2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 4 15:44:53 2019 +0100

    Bug 24170: Fix sysprefs search result order
    
    The same sysprefs search will not always return the results in the same
    order.
    If you search for 'd' in the "search system preferences" box
      /cgi-bin/koha/admin/preferences.pl?op=search&searchfield=d
    you will see that the modules are not ordered consistently.
    
    This patch makes them display alphabetically
    
    Test plan:
    Search the same string several times in the syspref list.
    The search result should always be ordered the same way
    
    Signed-off-by: cori <corilynn.arnold@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 773f7ca461d90fef78311bb09aebc64ff47a3e33
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 11 10:14:14 2019 +0100

    Bug 23785: Fix call get_coins on undef value in opac-search.pl
    
    If the search engine index returns a record that is no longer in the DB,
    an OPAC search will explode with:
      Can't call method "get_coins" on an undefined value at
      /usr/share/koha/opac/cgi-bin/opac/opac-search.pl line 692.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 916bb2a2b888873d3ace0aa9ff8aeda89c722b24
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Nov 25 13:18:16 2019 -0500

    Bug 24106: In returns.pl, don't search for item if no barcode is provided
    
    When loading returns.pl, code to check rotating collections fires off an search for items by barcode, but doesn't check for a barcode first. This means the code will search for items where barcode is NULL, which is definitely not the intended function.
    
    Test Plan:
    1) Apply this patch
    2) Set up a rotating collection with items
    3) Transfer the collection
    4) Check in a rotating collection item
    5) Note no change in functionality
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6ca1330e0dedd28bd0ea3808a7a0536085ba35a6
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Dec 2 15:14:33 2019 +0000

    Bug 24124: Fix authorities selection in batch deletion tool in Chrome
    
    This patch adds some inline CSS to force clearing on some elements in
    the forms for batch record modification and deletion. The problem with
    selecting the "Authorities" radio button stemmed from the fact that
    non-clearing floats caused elements to invisibly overlap in the form.
    
    To test, apply the patch and test both batch record modification and
    batch record deletion. Upon selecting the "Authorities" radio button in
    each case the "Select a list of records" tab should disappear. Selecting
    the "Biblios" option should re-display the tab.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 76cd9cd7e75539954e9840ed4f688285e566004a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Dec 3 19:55:19 2019 +0000

    Bug 24164: Copy the letter for each email
    
    To test:
    1 - Set or have two patrons with emails - note thier borrowernumber for the report
    2 - Create a report - note the report id ($REPORT_ID)
    SELECT borrowernumber, surname, firstname, email FROM borrowers WHERE borrowernumber IN (##,##);
    3 - Create a notice in circulation with code TESTEMAIL
    4 - The content should be "[% surname %]"
    5 - perl misc/cronjobs/patron_emailer.pl --report $REPORT_ID --notice TESTEMAIL --module circulation --from anyone@anywhere.com --verbose
    6 - Note that the emails both have the same surname
    7 - Apply patch
    8 - Repeat 5
    9 - Emails now have correct content
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Jessica Zairo <jzairo@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3a00e676dc04f0b721c5c318b5006001fb16b6e6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Dec 3 19:54:07 2019 +0000

    Bug 24164: Unit test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ea7311fedfc8e3e031b4f387c148b158b82e5db0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 9 15:31:36 2019 -0300

    Bug 24191: Make objects.search pass to_model to dbic_merge_sorting
    
    This patch makes objects.search pass the to_mode method reference so it
    can be used to map API attributes to column names when building the
    sorting portion of the query.
    
    To test:
    1. Apply the regression tests on this patchset
    2. Run:
      $ kshell
     k$ prove t/db_dependent/Koha/REST/Plugin/Objects.t
    => FAIL: Tests fail!
    3. Apply the rest of the patchset
    4. Run:
     k$ prove t/Koha/REST/Plugin/Query.t
    => SUCCESS: Tests pass! changes to the methods work as expected!
    5. Run:
     k$ prove t/db_dependent/Koha/REST/Plugin/Objects.t
    => SUCCESS: Tests pass!
    6. Sign off :-D
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 741b9a1c73ce366b02016a8bc80b5c01d5712c07
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 9 14:48:48 2019 -0300

    Bug 24191: Add to_model param to _build_order_atom and dbic_merge_sorting
    
    This patch adds a to_model parameter to dbic_merge_sorting so it is
    passed when used (for example from objects.search). The to_model param
    is passed along to the _build_order_atom method where it is finally
    used.
    
    In the process I wrote tests that reflected some problems in the current
    code:
    - Mojolicious automatically returns a scalar if a query parameter only
    happens once on a request. The code expected an arrayref in every case.
    - There's a design issue that forced me to use some hacky code in
    _build_order_atom.
    
    The first issue is dealth with, by using Scalar::Util::reftype as the
    Perl docs recommend.
    
    The second issue, I don't plan to clean it here, as there's ongoing work
    on a Koha::Objects->search_from_api method that will obsolete this code
    most probably (see bug 23893 for a better picture of where the mappings
    will be living soon).
    
    To test:
    1. Apply this patch
    2. Run:
      $ kshell
     k$ prove t/Koha/REST/Plugin/Query.t
    => SUCCESS: Tests pass!!
    3. Sign off :-D
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2a169e94cdabf77098425b8bccfbbfa4b0fdf926
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Dec 9 14:41:35 2019 -0300

    Bug 24191: Regression tests
    
    This patch adds missing tests for calling objects.search with
    non-existent column names for sorting, that should be mapped using
    to_model for that matter.
    
    Tests should fail as there's no current use of to_model for building the
    order_by portion of the query.
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 704ea1a62ea2d80361545101129eb3725e3fe99a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 29 14:45:25 2019 +0100

    Bug 24138: Fix calculation of suspension days when a limit is set
    
    If there is a limit for the number of suspension days
    (maxsuspensiondays), the calculation is wrong. We are reducing the
    number of days before taking into account the suspension charging
    interval.
    
    For instance, a checkin is 1 year late and the circ rules are defined to
    charge 7 days every 15 days.
    It results in 365 * 7 / 15 days of suspension => 170 days
    
    Before this patch the calculation was:
    365 * 7 limited to 333, 333 / 15 => 22 days
    
    Test plan:
    Given the examples in the commit messages and the description of the bug
    report, setup complex circulation rules and confirm that the debarment
    dates are calculated correctly
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc72ce1a5fcc002b0e1b0e399d66b2ac8afdcf51
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 29 13:55:27 2019 +0100

    Bug 24138: Move the calculation out of the sub
    
    No changes expected here. For the next patch we are going to need to add
    test and calculate the new debarment date. To ease the writing of these
    tests the calculation is moved out of the existing subroutine.
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 20a8cac651a2844bc8e16e751ef2c81193d0607e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 25 13:35:25 2019 +0100

    Bug 23970: Make search with "Publication date" field work at any position
    
    The changes made in the following commit:
      commit 0d2e83bca5b91376e9262b6cb0b993f09b919018
      Bug 14636: Item search - fix search and sort by publication date for MARC21
    was put at the wrong place. It was inside a "if $i == 1" test that
    impacts the first field only.
    
    Test plan:
    0/ Use a MARC21 installation
    1/ Search items by publication date, use twice the field using different
    values.
    For instance:
      publication date: 2005 OR
      publication date: 2006
    => Without this patch you only get results for 2005
    => With this patch applied you get results for both years.
    
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c35a5418226f5771be91a8c3ed17f7c56751b81
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 10 10:50:58 2019 +0100

    Bug 21761: Do not call $self->store in ->set_password
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b6206a3e23a9a933a8981c587e15aa268f5fb331
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jun 21 16:47:55 2019 +0100

    Bug 21761: Call set + store as update
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 13323c328596e8aa173ea18c7719d16ccd6866c4
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Dec 10 11:44:44 2019 -0300

    Bug 24177: (QA follow-up) Fix warning
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9325e6b6989baab9e3b072d397a3bea277eb7cd5
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Dec 10 07:56:55 2019 +0000

    Bug 24177: Import Koha::Account::CreditTypes to cash_register_stats.pl
    
    Test plan:
    0) Do not apply the patch
    1) Confirm the bug - go to Reports -> Cash register
    --> You will see ISE
    2) Apply the patch, and restart_all
    3) Confirm the ISE is gone and you see the form for Cash register report
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b022b37db75e468cc56f3189b2f284f03e81ca2d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 10 11:22:59 2019 +0100

    Bug 24199: (bug 23042 follow-up) Prevent t/Auth_with_shibboleth.t to fail randomly
    
    CGI->url_param does not always return the parameters in the same order.
    
    Test plan:
    0/ Recreate the random failure, does not apply the patch and run
    t/Auth_with_shibboleth.t several times.
    You will notice that it fails inconsistenly
    1/ Apply the patch and confirm that it now passes 100% of the time
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit adcd95bca61babe0dba25f5c7469a57996e8b312
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Dec 10 11:17:36 2019 +0100

    Bug 20948: Add missing html filter
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cef3745aae53dad48c5cea654041d7bd24e0e71e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Dec 9 14:56:10 2019 +0000

    Bug 17831: DBRev 19.12.00.001
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 34e931d5a2c5cdeb2e968dda3216a554f196c5b9
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Nov 24 12:39:57 2019 +0000

    Bug 17831: Database update - Tidy up frameworks in existing installations
    
    The mapped table and column doesn't exist, so we should also remove
    it from existing installations.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 285e1eb8ca8db3a28f82b8c86ce3488dc9f44b9b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jan 10 17:16:38 2017 +0000

    Bug 17831: Remove non-existig bibliosubject.subject mapping from frameworks
    
    This patch removes the assignment of non-existent koha field
    'bibliosubject.subject' to MARC subject fields in the installer data
    for koha
    
    To test:
    You'll want a new fresh db
    
    1 - Apply patch
    2 - Run websintaller
    3 - Ensure that thigns go smoothly
    4 - Add/delete/edit some records and ensure that things are working with
    the installed frameworks
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9d68838af66cc93bb256d31f9e4296fab5d99a6f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Nov 27 11:26:45 2019 +0000

    Bug 24128: Add alias for biblionumber search
    
    To test:
    1 - In staff or OPAC using ES, search for "biblionumber:3" or any existing biblionumber
    2 - No results
    3 - Apply patch, restart all the things
    4 - Search again
    5 - You go to the biblionumber
    
    Signed-off-by:  Bob Bennhoff <bbennhoff@clicweb.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ca501374afa83ffe4f02920597cb977766704e5b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 18 10:30:04 2019 +0100

    Bug 20948: Only display item-level hold info if first hold
    
    On the item list of the catalogue detail page we display next item-level
    hold info even if it is not the next hold. That leads to confusion as it
    will not necessarily be the accurate info.
    
    This patch makes the following changes:
    - Display the item-level hold only if it is the next hold (priority ==
    1)
    - Display "There is an item level hold on this item (priority=X)"
    if there is at least 1 item-level hold placed on this item
    
    Test plan:
    - Place several next available holds on a single item record
    - Place an item level hold on the item
    - Go the the biblio detail page
    => Without this patch, the item will show the item level hold
    => With the patch you see "There is an item level hold on this item"
    - Check the item in, confirm the hold
    => No changes, the item will show the waiting hold info
    - Cancel all the holds except the item-level one
    => No changes, the item will how the item-level one
    
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 93b2905bdf5c18063ab30d029c5e7a09a8f91641
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 18 10:10:56 2019 +0100

    Bug 20948: Simplify existing code
    
    No changes expected here.
    
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6938b0eac577b1f0e3833ccf5cc0c05aa133d879
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 1 14:13:15 2019 -0300

    Bug 23246: (follow-up) Hardcoding tab position is not enough
    
    There are many conditions that determine the tab number for 'media'.
    Translated into variables that hold the tabs count on each condition, it
    is clear that '3' was not good enough:
                [%- holdings      = (SeparateHoldings)   ? 2 : 1
                    notes         = (MARCNOTES || notes) ? 1 : 0
                    acq           = (Koha.Preference('AcquisitionDetails')) ? 1 : 0
                    frbr          = (FRBRizeEditions  && XISBNS) ? 1 : 0
                    local_covers  = (LocalCoverImages && (localimages || CAN_user_tools_upload_local_cover_images)) ? 1 : 0
                    media_tab     = holdings + notes + acq + frbr + local_covers
                -%]
    
    This patch gets rid of the hardcoded value, adds an id to the 'media'
    tab (i.e. 'media_tab') and uses JS to get the right index.
    
    To test:
    - Play with the different options governing those variables
    => FAIL: 3 is not always the 'media' tab
    - Apply this patch
    - Repeat your tests
    => SUCCESS: It always picks the 'media' tab
    - Sign off :-D
    
    Sponsored-by: American Numismatics Society
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 142a0235ad9a266aeb5fdc0f0686aabdce43f5e6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 1 13:16:42 2019 -0300

    Bug 23246: Only jump into the 'images' tab HTML5MediaEnabled is set
    
    This patch makes jumping into the third tab happen only if
    HTML5MediaEnabled is set to 'both' or 'staff'.
    
    To test:
    - Have HTML5MediaEnabled set to 'opac' or 'not at all'
    - Open the detail page of a record with no holdings
    => FAIL: The 'images' tab is selected
    - Apply this patch
    - Reload
    => SUCCESS: The 'holdings' tab is selected as it should be.
    - Sign off :-D
    
    Sponsored-by: America Numismatic Society
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9fa2818899bf4495ca94c6d311ec750d39298167
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Nov 26 17:31:15 2019 +0000

    Bug 24126: Article requests tab appears twice on patron's checkout screen
    
    This patch removes duplicated markup on the checkout page which results
    in the "Article requests" tab appearing twice.
    
    To test, apply the patch and enable ArticleRequests.
    
    Check out to a patron. In the set of tabs that includes checkouts,
    holds, restrictions, etc., the "Article requests" tab should appear only
    once.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d94cbefdc0f06c9cc9b57a9e3016f52fdf2d71a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 20 10:56:24 2019 +0100

    Bug 23987: "return to cataloguing" if the record is deleted from bachMod-del
    
    If a bibliographic record is deleted after having deleted all their items in a batch,
    we should not display a "return to the record" button but "return to cataloguing" instead
    
    Test plan:
    1 - Have/make a bib with items
    2 - On details page select Edit->Delete items in a batch
    3 - Select all items and check "Delete record if no items remain"
    4 - Delete the things
    5 - On confirmation screen you have a count of items/bibs deleted
    => Without the patch there is a 'Return to record' button that leads to nowhere
    => With this patch there is a "Return to cataloging module" button
    6 - Repeat using the "Delete selected items" link on top of the items table
    => Without the patch there is a 'Return to where you were' button that leads to nowhere
    => With this patch there is a "Return to cataloging module" button
    
    Note that there is a link AND a button, coming from
      commit 928c0af2b6a2c7aa6ed54019c5bd7dbddbccf4ee
      Bug 15824 - 'Done' button is unclear on batch item modification and deletion
    I do not think it makes sense to have both.
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3225d049bef956d5fd66ed93561ddc9108ce138a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 20 10:53:32 2019 +0100

    Bug 23987: Use src=CATALOGUING for edition/deletion in batch from items table
    
    There are 2 ways to land in batchMod from the detail page of a bib
    record: from the Edit menu, and the action buttons on top of the items
    table.
    
    We want the same behavior for both and so use src=CATALOGUING
    It will make batchMod to behave identically for the "return" button
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fa41a4a94d9493377a71d1272ec5b3cabed5ff85
Author: Lisette Scheer <lisetteslatah@gmail.com>
Date:   Thu Nov 14 21:53:25 2019 +0000

    Bug 24033: Fix column labelling on basket summary page (ecost)
    
    When viewing a basket, some of the column names are unclear
    and are different than the terms used for the same field
    on the order form. This patch edits the column titles to
    match the order form.
    
    To test:
    1) In acquisitions, create a budget.
    2) In acquisitions, create a fund.
    3) In acquisitions, create a vendor.
    4) In acquisitions, create a basket and add a test item to the basket.
    5) Observe the column titles ecost tax inc. and ecost tax exc.
       Check the column visibility settings if you don't see
       the columns.
    6) Apply the patch.
    7) Observe the column titles have been updated.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fa1fa51562fbf018a1c11bf51895fd42034d8c4c
Author: Lisette Scheer <lisetteslatah@gmail.com>
Date:   Tue Nov 19 18:15:17 2019 +0000

    Bug 24056: Capitalization: Cash Register ID on cash register management page
    
    When editing a cash register, Cash register ID doesn't follow
    our capitalization guidelines. This patch fixes that.
    
    To Test:
    1) Turn on cash register usage in the system preferences.
    2) Add a cash register.
    3) Edit the cash register.
    4) Note the incorrect capitalization.
    5) Apply the patch.
    6) Edit the cash register.
    7) Note the correct capitalization.
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 243e4cd03140732b4156d6d0bb1156f0aa90c2b6
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Nov 18 16:10:14 2019 +0000

    Bug 24057: Hea is not an acronym
    
    This patch changes "HEA" (incorrectly capitalized) to "Hea" on the
    staff client administration home page.
    
    To test, apply the patch and set the "UsageStats" system preference to
    "No, let me think about it."
    
     - Go to Administration in the staff client.
     - There should be a message at the top asking if you want to share
       anonymous usage statisitcs with the community. The word "Hea" in this
       message should be capitalized correctly.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 543e11fdfacb6c7a4a7aecb015fd2443cbcc3df6
Author: Lisette Scheer <lisetteslatah@gmail.com>
Date:   Tue Nov 19 17:50:45 2019 +0000

    Bug 24053: Typo in FinePaymentAutoPopup description
    
    There is a typo in the FinePaymentAutoPopup system preference description.
    This patch fixes that.
    
    To test:
    1) Go to the systems preferences in administration.
    2) Search for FinePaymentAutoPopup
    3) Observe .. at the end of the preference description.
    4) Apply the patch
    5) Repeat steaps 1-2
    6) Ovserve correct punctuation at the end of the preference description.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 25ddfb15c5b0ec957ebf73874d41275701b818f7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Nov 29 10:49:37 2019 +0000

    Bug 24136: Update sponsors for 19.11 cycle
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ad3e5bae0cde4c9d8770f3f0414ee6add0d80c44
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Dec 4 16:04:45 2019 +0100

    Bug 24168: (bug 23116 follow-up) AllowHoldPolicyOverride allows a librarian to almost place a hold on an item already on hold
    
    This patch actually fixes the issue described on bug 23116.
    
    Test plan:
    See bug 23116 and comment 5. Important to note that the later comparison with
    itemAlreadyOnHold assumes that the variable is a string.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ece3e5a6a2be3870b53cde01516a189d23423a68
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 2 17:50:40 2019 +0100

    Bug 24145: (bug 22543 follow-up) Fix Auth.t
    
    Auth.t is failing because of: 1. recent changes from bug 22543 and 2. wrong mocked CGI->param in tests
    Without this patch we hit the exit statement that breaks the tests with the following error:
    
    t/db_dependent/Auth.t .. 1/22 Un-mocked method 'url()' called at /kohadevbox/koha/C4/Auth.pm line 1223.
    Un-mocked method 'redirect()' called at /kohadevbox/koha/C4/Auth.pm line 1227.
    A context appears to have been destroyed without first calling release().
    Based on $@ it does not look like an exception was thrown (this is not always
    a reliable test)
    
    This is a problem because the global error variables ($!, $@, and $?) will
    not be restored. In addition some release callbacks will not work properly from
    inside a DESTROY method.
    
    Here are the context creation details, just in case a tool forgot to call
    release():
      File: t/db_dependent/Auth.t
      Line: 74
      Tool: Test::More::subtest
    
    Cleaning up the CONTEXT stack...
        # Looks like you planned 22 tests but ran 1.
    t/db_dependent/Auth.t .. Dubious, test returned 255 (wstat 65280, 0xff00)
    Failed 21/22 subtests
    
    Test Summary Report
    -------------------
    t/db_dependent/Auth.t (Wstat: 65280 Tests: 1 Failed: 0)
      Non-zero exit status: 255
      Parse errors: Bad plan.  You planned 22 tests but ran 1.
    Files=1, Tests=1,  2 wallclock secs ( 0.02 usr  0.00 sys +  1.54 cusr  0.24 csys =  1.80 CPU)
    Result: FAIL
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1a78447367d9fb23f17f64ed405bfad9c333e190
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Dec 2 17:12:06 2019 +0100

    Bug 24144: (bug 23836 follow-up) Fix regressions.t tests
    
    Bug 23836 changes the behavior for tracklinks.pl but did not adjust the
    tests.
    
    We must then expect 404 if the pref is turned off.
    Also mock_preference cannot work (we are hitting the web server and so
    need to set the value in DB and flush the L1 caches)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1548f0300ffbfaade13d276fc904475d0fa54222
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Dec 2 17:10:11 2019 +0000

    Koha 19.12 - Dobbie is a free elf...
    
        “Dobby has got a sock. Master threw it, and
        Dobby caught it, and Dobby — Dobby is free."
    
    Koha, the worlds first completely open library system. 🧦
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0553463d0407275c2aab20bebd16c9453abe634c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 15:21:08 2019 +0000

    Update release notes for 19.11.00 release
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 019eff289ba9db77096b9d38dd5e8d0428b6772a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 28 18:23:44 2019 +0000

    Maintanence team template corrections
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bdf9e11abb64d42eb6163d8d94b5db8db6dcf807
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 28 16:51:02 2019 +0000

    Add release team for 20.05 cycle
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 24504b320ea93b2b326cd559b46575566154f57e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 13:38:14 2019 +0000

    Increment version for 19.11.00 release
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5a2ef6fe576dda596cc9ee2583a86f2d79c5aeaa
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 16:33:51 2019 +0000

    Align DB updates
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2135352417a9bc4df0b48d3d907d2b66b5627097
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 13:33:45 2019 +0000

    Translation Fixes
    
    Correct some fatal errors in the translation files
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d5a386db8e9a52da8d613576016802559d263f3b
Author: Koha translators <>
Date:   Wed Nov 27 08:37:58 2019 -0300

    Translation updates for Koha 19.11.00
    
    (cherry picked from commit bc938166712f17d731a1f190628c27593a082419)
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e493cca4a0cba37894b5327d4cc8776e2e0148db
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 15:52:57 2019 +0000

    Bug 24130: (RM follow-up) Fix old invalid data
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 92d3e72da0c0220dc3cf17636ff061cefcb601c8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 11:33:21 2019 +0000

    Update contributors statistics for release
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8a766c2208d0b01fa5b5ec83256608a628e9c2e5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 19 12:12:15 2019 -0500

    Bug 23042: Correct shib param escaping
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4e02adb5dfee46aacadc74a054da26d0de83a73a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jun 13 17:02:33 2019 +0100

    Bug 23042: Only include GET params in return URL for Shibboleth
    
    The shibboleth return target included POST parameters in the URL string,
    this meant that a failed local login POST would include the username and
    password used in the attemtped login in plaintext in the redirect URL
    that is appended to the shibboleth login URL.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d93f17bfaa13988fadc745cf5f6b3e6b479adcff
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jun 19 10:56:30 2019 +0100

    Bug 23042: Add tests to catch POST params in return URL
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3493cffd5490d315130f728c13d0152b2ca5e24b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 30 13:15:38 2019 +0100

    Bug 23836: exit after output_error
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 863a961dcb1dc38ae0a928d07eba150e44a35f0b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 17 15:26:18 2019 +0000

    Bug 23836: Don't forward form tracklinks if not tracking
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bbf7fad55f47fe7023c9d3dda442fa487a2fc522
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Aug 15 08:54:59 2019 +0100

    Bug 23329: (RM follow-up) Restore DB after test
    
    Test plan:
    1) Dump your DB before the tests is run
    2) Run the test
    3) Dumper your DB again and compare to the first dump
    Success if there are no differences (other than the timestamp of the
    dump)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 20854939b4d8d989d7219941c0d907a09b77642a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 14 14:56:48 2019 -0400

    Bug 23329: Fix tests
    
    - www.google.com vs https://www.google.com
    - Remove transaction otherwise data are not available from webserver
    - Use new C4::Output::output_error to avoid 302 (redirect)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7fa1cde78e451f30da007bcecd88ab3b4e71e37b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 14 14:56:46 2019 -0400

    Bug 23329: Move error page to its own subroutine
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fde00fefec9a82dbd6371093bd47aace3fb6a5f3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Aug 14 11:34:47 2019 +0100

    Bug 23329: (RM follow-up) Add regression tests
    
    Test plan:
    
    Run the new tests and they should all pass once we've caught all cases
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eb89795328a7ecb228df59ad4fb1c1905fd509eb
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 9 09:27:18 2019 +0000

    Bug 23329: (QA follow-up) Resolve warning on wrong biblionumber
    
    Passing a wrong biblionumber generates a warning:
        GetMarcUrls called on undefined record at opac/tracklinks.pl line 58.
    
    Test plan:
    [1] Try it again with a wrong biblionumber and check the logs.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b2ec43cd8c67be70a1994d49e05a0017018c2d23
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 9 09:18:13 2019 +0000

    Bug 23329: (follow-up) Allow item URI with a biblionumber parameter
    
    If you pass a URI with a biblionumber without specifying the itemnumber,
    tracklinks did not redirect an item URI.
    
    Test plan:
    [1] Add URI in an item.
    [2] Pass this URI with the itemnumber to tracklinks. Should pass.
    [3] Pass this URI with the biblionumber to tracklinks. Should pass now too.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 608cf1b073d0a61f14967c64ef1b55d3cec218d1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jul 23 16:39:18 2019 -0300

    Bug 23329: (follow-up) Use any instead of grep
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e11b1e6d3c1af3f36b2aa27bb75bc37e39921fe6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jul 17 11:01:01 2019 +0000

    Bug 23329: Only redirect tracklinks.pl to urls contained in records
    
    Bug 19487 limited redirection to urls contained in a record/item if we were tracking.
    We should probably limit forwarding if not tracking as well.
    Additionally, if we don't have a soucre, let's not forward
    
    To test:
     0 - Set TrackClicks syspref to 'Don't track'
     1 - Hit localhost:8080/cgi-bin/koha/tracklinks.pl?uri=http://www.google.com
     2 - You get forwarded to google
     3 - Set TrackClicks to 'Track anonymously'
     4 - You get a 404
     5 - Apply patch
     6 - Hit localhost:8080/cgi-bin/koha/tracklinks.pl?uri=http://www.google.com
     7 - You get a 404
     8 - Set TrackClicks syspref to 'Don't track'
     9 - Hit localhost:8080/cgi-bin/koha/tracklinks.pl?uri=http://www.google.com&biblionumber=1
         Choose a biblionumber that exists
    10 - You get a 404
    11 - Add http://www.google.com to the 856$u of the record used above
    12 - Hit localhost:8080/cgi-bin/koha/tracklinks.pl?uri=http://www.google.com&biblionumber=1
    13 - You are redirected
    14 - Confirm redirection and 404 as expected with other settings of TrackClicks
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d20c9ff5882377793d311f3a7a4621c4bdc31469
Author: Magnus Enger <magnus@libriotech.no>
Date:   Fri Sep 6 09:54:04 2019 +0200

    Bug 22543: Prevent "back and refresh attack"
    
    To reproduce and test:
    - Log into the OPAC, you are taken to /cgi-bin/koha/opac-user.pl
    - Log out, you are taken to /cgi-bin/koha/opac-main.pl?logout.x=1
    - Click "Back", you are taken to /cgi-bin/koha/opac-user.pl
    - Reload the page, you see an error like "Confirm new submission
      of form"
    - Reload the page again and confirm the submission of the form
    - You are now logged in to the OPAC again!
    - Log out again
    - Apply this patch
    - Log in to the OPAC, you are taken to /cgi-bin/koha/opac-user.pl
    - Log out, you are taken to /cgi-bin/koha/opac-main.pl?logout.x=1
    - Click back, you are taken to /cgi-bin/koha/opac-user.pl
    - No matter how many times you reload /cgi-bin/koha/opac-user.pl,
      you should not see anything other than the login form.
    - Check that Self Check Out still works as it should, by making
      sure you have a user with self_check permissions, then setting
      WebBasedSelfCheck, AutoSelfCheckAllowed, AutoSelfCheckID and
      AutoSelfCheckPass appropriately. Then visit
      /cgi-bin/koha/sco/sco-main.pl and verify everything works as
      expected.
    
    The messages and errors pages you see related to resubmitting the
    form might differ from the ones described here, depending on what
    browser you use. I tested in Chromium 76.0.x.
    
    This fix was originally proposed by LMSCloud:
    https://github.com/LMSCloud/Koha-LMSCloud/commit/74a7fe0f0c5b2ce0d65bd26452c6dcaf0a7f65ad
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5a8f202cb291095e660cf97ef307fa310f3672b7
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 14 13:39:43 2019 -0400

    Bug 23451: Fix other similar wrong filterings
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9f10889c858409dc8b5ae1b4d294758d52b329bf
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 14 13:31:53 2019 -0400

    Bug 23451: Prevent XSS vulnerabilities in opac-imageviewer.pl
    
    And certainly in other sripts as it is in opac-bottom.inc
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit df5bf098d33beb080d530394835e035630d40b97
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Nov 22 08:46:20 2019 +0000

    Bug 23025: Update yarn.lock
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 78bf5b3ec68d3732a63a9619d57a0fb5b7d60fb0
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri May 31 16:34:34 2019 +0000

    Bug 23025: security vulnerability detected in fstream < 1.0.12 defined in yarn.lock
    
    This patch updates the version requirements for modules used by yarn.
    Running "yarn upgrade" will upgrade the project's direct dependencies as
    listed in package.json. However, the output of "yarn audit" will
    identify more vulnerabilities with libraries further down the dependency
    tree.
    
    Adding a "resolutions" list in package.json seems to be the way to
    include these upgrades in an installation.
    
    After making these changes I ran "yarn install" and "yarn audit" again.
    The audit reported no vulnerabilities.
    
    Upgrading yarn.lock should allow for the installation of newer versions
    of npm modules in new installations. I believe it is necessary to run
    "yarn upgrade" on existing installations in order to bring dependencies
    up to versions matching those on existing installations.
    
    To test, run the yarn commands we use to compile SCSS in the staff
    client and the opac:
    
    yarn build
    yarn build --view opac
    
    They should complete without error.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a5339bb41f3dc8607c82aedec698e12c79003650
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 11:19:32 2019 +0000

    Bug 20954: (RM follow-up) Add Sponsor
    
    Sponsored-by: South East Kansas Library System [http://www.sekls.org]
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 17ee5f70866c906fc5eef552bf93ca64ff6cdd79
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 11:18:01 2019 +0000

    Bug 20292: (RM follow-up) Add Sponsor
    
    Sponsored-by: Duchesne County Library [http://uintahlibrary.org/]
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8f350a34314f3a2a63193587631ac4d3f295e9af
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 11:16:04 2019 +0000

    Bug 17168: (RM follow-up) Add Sponsors
    
    Sponsored-by: Sponsored by: Round Rock Public Library [https://www.roundrocktexas.gov/departments/library/]
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cd5b4807f48d013d81360de6b5dc9f7cac82eac8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 11:06:31 2019 +0000

    Bug 20595: (RM follow-up) Add Sponsor
    
    Sponsored-by: PTFS Europe
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4ac4c4316b17c5f6731b473be113c8607024aaa8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 11:03:56 2019 +0000

    Bug 23522: (RM follow-up) Add Sponsors
    
    Sponsored-by: Virginia Tech [https://lib.vt.edu/]
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 051a646bd74c4e2128511719b1872674ddd64709
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 10:39:36 2019 +0000

    Bug 14570: (RM follow-up) Add Sponsors
    
    Sponsored-by: Northeast Kansas Library System [http://www.nekls.org]
    Sponsored-by: Vermont Organization of Koha Automated Libraries [http://gmlc.org/index.php/vokal]
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0a597b6ef855e987e0a1d6ce726799b7f1622a03
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 09:26:01 2019 +0000

    Bug 23958: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f23e49c08cabe4ee76ac0683dffc157c02c0905d
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sun Nov 3 19:38:20 2019 -0500

    Bug 23958: Use Font Awesome icon to replace "new window" icon image
    
    This patch modifies several templates in order to eliminate the
    dependency on an image file for styling certain links which open popups
    or new windows. A Font Awesome icon is used instead.
    
    To test, apply the patch and rebuild the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    Cataloging:
    
     - Create a new MARC record which has the same ISBN as a record in your
       catalog.
     - When you save the record it should warn you that it is a possible
       duplicate. The message should contain an icon-prefixed link to the
       existing record.
     - Clicking the link should open details about the title in a new
       window.
    
    Circulation:
    
     - Enable the itemBarcodeFallbackSearch system preference.
     - Open a patron for checkout and enter a word in the "barcode" field
       instead of a barcode.
     - The page should return a list of titles to choose from. Each title
       should be a link with an icon. Clicking the link should open details
       about the title in a new window.
    
    Acquisitions:
    
     - Go to Acquistisions -> Vendor -> Basket.
     - Choose "Add to basket" -> From an external source.
     - Search for and select a record which exists in your catalog.
     - You should be taken to a page with a "Duplicate warning" message. The
       message should contain an icon-prefixed link to the existing record.
     - Clicking this link should open details about the title in a new
       window.
    
     - Create a MARC file with two records: One which exists in your catalog
       and one which doesn't. Stage that file for import.
     - Choose "Add to basket" again and select "From a staged file."
     - Select the file you staged.
     - You should be taken to a page with a "Duplicate warning" message. The
       message should contain an icon-prefixed link to the existing record.
     - Clicking the link should open details about the title in a new
       window.
    
    Patrons:
    
     - Create a new patron which has the same name and birthday as an
       existing patron.
     - When you save the record you should be shown a duplicate warning. The
       link to the possible duplicate patron should be prefixed with an icon
       and should open the patron's details in a popup window.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d6dc7622d39630667909942c53720873bbb77473
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 27 09:24:39 2019 +0000

    Bug 23955: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 528b1e2905b6f224d47677613fda4ae4e9631212
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sun Nov 3 22:03:46 2019 +0000

    Bug 23955: Replace famfamfam icon in OPAC holds template
    
    This patch modifies the OPAC holds template so that when an item isn't
    available for an item-level hold a Font Awesome icon is displayed
    instead of a famfamfam image.
    
    To test, apply the patch and regenerate the OPAC CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
     - Make sure you have items which can be placed on hold at the item
       level.
     - Locate a title with more than one item, at least one of which isn't
       available to be placed on hold (item is marked withdrawn, for
       instance).
     - Start the process of placing a hold on the item.
     - On the "Confirm holds" scren, click "Show more options" and select "A
       specific item."
     - In the table of items, any item which isn't available to be put on
       hold should be inidicated with a red X. The title attribute of the
       icon should show "Cannot be put on hold."
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b694fea9a00db7470d0942195ec4d131ee16928
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 25 11:53:45 2019 +0100

    Bug 23927: Do not copy invoiceid for a new duplicated order
    
    When an order is created from an existing one (duplication), then the
    invoice should be set to null instead of retrieved.
    
    Test plan:
    - receive an order
    - in a new basket, add an order "From exisitions orders (copy)"
    - search your received order
    - duplicate
    - go to the bibliographic record "Acquisition details" tab
    => Without this patch you will see that the invoice is the same for the
    two orders
    => With this patch the invoice for the new order is not set
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4d2f7668665f9fafc945be93cda71eab333029f9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 25 11:53:00 2019 +0100

    Bug 23927: Add tests
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04fab26ccc25d70a3b94b3bd2ceea22752b8714e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 26 14:12:01 2019 +0000

    Bug 24120: (follow-up) input_name too
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 59ea9b3cc27c27d16880fc238f4a173a9e38b479
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 26 13:19:28 2019 +0000

    Bug 24120: URI filter search terms in sort dropdowns
    
    To test:
    1 - Search for C++
    2 - Sort your results
    3 - Note search is now for "C  "
    4 - Apply patch
    5 - Search for C++
    6 - Reorder results
    7 - Still searching for C++
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7f6f4f3c687cf287ac19a6035f11c63b7a66ade8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 26 10:23:36 2019 -0500

    Bug 24113: guarantor info lost when a duplicate is found
    
    When a patron is created with a guarantor but a duplicate is found (or any other warnings I guess) the guarantor's info are lost.
    
    This patch improves on previous functionality by retaining the select guarantor relationship as well.
    
    Test Plan:
    1) Create a new child with a name already used, add a guarantor
    2) Attempt to save, no the guarantor is not shown when the editor is redisplayed
    3) Apply this patch
    4) Restart all the things!
    5) Repeat 1
    6) Note the guarantor is retained and the relationship is as well!
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 067403e437803fd6a6c28571b491da3a231c67c1
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Nov 26 16:02:07 2019 +0000

    Bug 21390: (RM follow-up) Add Sponsor
    
    Sponsored-by: Goethe-Institut
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e919d431a51915d54e19cb1d6a62cd115b0e176
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Nov 26 16:01:16 2019 +0000

    Bug 14570: (RM follow-up) Stray console.log
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 164eda8333e60608c8e74893bc351c318daccb32
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Nov 20 18:11:55 2019 +0000

    Bug 24076: Remove inline CSS to center patron home library in search results
    
    This patch removes code from the patron search results DataTable
    configuration which was designed to add "text-align:center" to the table
    cells containing patron home library. I don't think there's a good
    reason to centering to that data.
    
    To test, apply the patch and perform a patron search in the staff
    client. The "Library" column should contain left-aligned data, matching
    almost every other column in the table.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7657163d8f9fb0f2932dc663fdec1ce8e2c8e3c4
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Mon Nov 4 10:50:11 2019 -0300

    Bug 23452: Multiple select options in system preferences are not translatable
    
    Translate script ignores multiple options in system preferences,
    this patch fix that.
    
    To test:
    1) Apply the patch
    2) Go to misc/translator
    cd misc/translator
    3) Update your preferred language
    perl translate update xx-YY
    4) Updated pref file must contain new strings, eg.
    egrep "when cataloguing an item" po/xx-YY-pref.po
    5) Edit & translate that string
    6) Install the updated translation
    perl translate install xx-YY
    7) Check that the translated pref file has
    a) multiple options present
    b) the message from 5) is translated
    see for example circulation.pref
    en: koha-tmpl/intranet-tmpl/prog/en/modules/admin/preferences/circulation.pref
    xx: koha-tmpl/intranet-tmpl/prog/xx-YY/modules/admin/preferences/circulation.pref
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7da1644fd5ad7506cfe410f8c04f6d0f2e416668
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 20 14:35:10 2019 +0100

    Bug 23256: Remove the http:// prefix before OPACBaseURL in OPAC_REG_VERIFY
    
    The title explained everything, compare with
    installer/data/mysql/fr-FR/1-Obligatoire/sample_notices.sql and other
    notices.
    It's certainly due to the fact that fr-CA took time to be integrated and
    the change happened in the meanwhile
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d69762d931d88d159a21856d7dfb21a1d6969c63
Author: Lisette Scheer <lisetteslatah@gmail.com>
Date:   Tue Nov 19 16:58:45 2019 +0000

    Bug 21574: Local use system preferences page doesn't have the system preferences menu
    
    The "local use" tab in system preferences is showing the admin menu instead of the
    system preferences menu tabs. This patch fixes the menu display.
    
    To test:
    1) Go to the system preferences in administration.
    2) Click the 'Local use' tab.
    3) Observe the inncorrect menu.
    4) Apply the patch.
    5) Repeat steps 1-2
    6) Observe the correct menu.
    
    Signed-off-by: Caroline Cyr La Rose <caroline.cyr-la-rose@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eb279027e826af140bf3d781e94c54a55464fdec
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Nov 26 11:38:34 2019 +0000

    Bug 23624: (RM follow-up) Add Sponsor
    
    Sponsored-by: Higher Education Libraries of Massachusetts
    Sponsored-by: Fenway Library Organization
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4d0c49e1ee8fbe4e3a48154f34cd8f51d2f2452c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Nov 26 11:35:17 2019 +0000

    Bug 23626: (RM follow-up) Add Sponsor
    
    Sponsored-by: Higher Education Libraries of Massachusetts
    Sponsored-by: Fenway Library Organization
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 24c2e88640562a7ba5851edd271f337124882d0b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Nov 26 11:28:45 2019 +0000

    Bug 14697: (RM follow-up) Add Sponsor
    
    Sponsored-by: Fargo Public Library
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 03847f77b755dac9e6f1eb06fe0651c6ca91b542
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Nov 26 11:21:34 2019 +0000

    Bug 17179: (RM follow-up) Add Sponsor
    
    Sponsored-by: Round Rock Public Library
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2d9bfcbfbecca0418ed9cb7f1247a5ce37a95a1c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 26 10:16:19 2019 +0100

    Bug 23905: Remove extra closing span
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dcb9bf358151bcca6189581871aeb937125bc896
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Nov 25 11:50:46 2019 -0500

    Bug 23905: Button "Search to add" doesn't work on Quick add new patron
    
    This issue is caused by duplicating the patron guarantor fieldset.
    The solution is to move it between the two forms insetad.
    In addition, this patch moves the guarantor information fieldset to the area below the "Quick add" fieldset, instead of *inside* it. This change preserves the correct styling and layout of the Guarantor information fieldset whilst it is moved back and forth by the "quick add"/"full form" toggle.
    
    Test Plan:
    1) Quick add a child patron
    2) Attempt to use the "Search to add" button
    3) Note it does nothing
    4) Apply this patch
    5) Repeat steps 1 and 2
    6) It works now!
    7) Test toggling between the quick add and full form views,
       note the "Guarantor information" fieldset shows correctly
       in the full form view.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 53c8014557326e9a67c3c53b016e2fd10ac4f3ad
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Nov 21 17:12:30 2019 +0000

    Bug 14741: Selecting all child permissions doesn't select the top level check box
    
    This patch modifies the patron flags page so that manually selecting all
    the child permissions also checks the checkbox for the parent
    permission.
    
    To test, apply the patch, open a patron record, select More -> Set
    permissions.
    
     - Expand a set of permissions, for instance "Add, modify, and view
       patron information."
     - If any boxes are checked, uncheck them.
     - Check each of the "child" checkboxes ("Add, modify, and view..." and
       "View patron infos..." ).
     - When both checkboxes are checked, the "Add, modify, and view" parent
       permission should be automatically checked.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc7da400acfb26c33bfa941ba0f63e3aeba97c04
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Nov 25 11:21:52 2019 +0000

    Bug 24100: (bug 23788 follow-up) Capitalization correction
    
    Correct the capitalization of the class name introduced in bug 23788.
    
    Test plan:
    1) Prior to patch attempt to 'pay off selected' - Note a server error
    2) Apply patch
    3) Attempt to 'pay off selected' - Note it now works as expected.
    4) Signoff
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0f4bc4fd812b34bf15f593d769363dde1ca0247b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Nov 25 11:32:32 2019 +0000

    Bug 23964: (follow-up) We should check for only active holds when determining to set waiting
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1f3a9722e4f8d32c7a839137252fc935ad599f74
Author: Magnus Enger <magnus@libriotech.no>
Date:   Wed Nov 20 15:15:15 2019 +0100

    Bug 24072: Typos in advance_notices.pl causes DUEDGST not to be sent
    
    There are two typos in advance_notics.pl that cause DUEDGST messages
    not to be sent. See Bugzilla for full details.
    
    If you think the typo is sufficiently obvious, you can just eyeball the
    patch and sign off, methinks. Otherwise, testing can be done something
    like this:
    - Make sure you have enabled enhanced messaging preferences, and a
      patron with "Email" and "Digests only" set for "Item due" messages
    - Issue an item to this patron, with due date today
    - Run something like this to generate advance notices:
      $ sudo koha-shell -c "perl \
      /home/vagrant/kohaclone/misc/cronjobs/advance_notices.pl -n -c" kohadev
    - See that no notices are shown (-n means messages will go to stdout,
      instead of into the message queue).
    - Apply the patch and run advance_notices.pl again, as before. A DUEDGST
      message should now be displayed.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8606ca9a0e8d476b4674ec0325402c16de8e58da
Author: Lari Taskula <lari.taskula@hypernova.fi>
Date:   Fri Oct 25 13:39:12 2019 +0000

    Bug 23901: Fix indentation
    
    This patch only fixes the indentation of code inside the if-block.
    
    To test:
    1. Apply patch
    2. Run: git diff -w HEAD~1 and observe no result
    
    Sponsored-by: Koha-Suomi Oy
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7b8780daa14dad446c0c7b0cdf4f01fe90531ed3
Author: Lari Taskula <lari.taskula@hypernova.fi>
Date:   Fri Oct 25 13:36:11 2019 +0000

    Bug 23901: Fix sms_input is null in opac-messaging.tt
    
    When sms messaging is disabled, JavaScript breaks in opac-messaging.tt.
    Bug introduced in Bug 22862.
    
    To test:
    1. Enable EnhancedMessagingPreferences system preference
    2. Disable sms messaging by unsetting SMSSendDriver system preference
    3. Go to OPAC -> your messaging
    4. Observe JavaScript error "sms_input is null" in your browser console
    5. Apply patch
    6. Refresh page and observe the error is gone
    
    Sponsored-by: Koha-Suomi Oy
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c853b0034e20d127a42149dd9d6239867d9df67
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 20 11:52:04 2019 +0100

    Bug 24013: Fix transferbook if item is checked out
    
    Wrong conflict resolution, the following
      commit 6eade474ed3a84a5ba372a26ac27bf9fb4bd2299
      Bug 18276: Remove GetBiblioFromItemNumber - Easy ones
    restored a previous change from
      commit 546379cc92b733cb29a0b70247a72c770afdad26
      Bug 17680: C4::Circulation - Remove GetItemIssue, simple calls
    
    Not that "easy" or "simple"...
    
    Test plan:
    Run the test before and after this patch.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95d5be238cb69b8f4a38bebc6128b82c23d1c208
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 20 11:55:55 2019 +0100

    Bug 24013: Add tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e9163adf3f7bbd4ca0ae7721b272ab2493e4d5ff
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Nov 22 18:41:28 2019 +0000

    Bug 24093: Sorting indicators broken on list contents view
    
    This patch updates the table markup for the lists contents view so that
    the table sort state is correctly indicated by arrows in the table
    headers. The markup changes allow the standard DataTables CSS to apply
    to this table even though it is not a DataTable.
    
    To test, apply the patch, go to Lists, and view any list with multiple
    titles attached.
    
     - The list should be sorted by default according to the list's
       settings, and the arrow in the header row should correctly reflect
       the sorting column and direction.
     - Test re-sorting the table by each of the different sortable columns,
       confirming each time that the sorting arrows are correct.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 770f24d4f7da01434fb2318425e4275ec791db8f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Nov 21 18:08:48 2019 +0000

    Bug 24084: PlainMARC view broken on OPAC if other $.ajax calls produce errors
    
    This patch removes the use of jQuery's ajaxSetup() and load() to get the
    "plain" MARC view and replaces it with $.get(). This allows for
    error-handling on this specific AJAX request rather than all on the
    page.
    
    To test, apply the patch and view a bibliographic record in the OPAC.
    
     - Click the "MARC view" tab.
     - Click the "view plain" link.
      - The plain-text MARC view should load.
      - Clicking "view labeled" should return you to the original view.
    
    To test error handling, edit opac-MARCdetail.tt line 185 and add a typo
    to the URL, e.g. "opac-showmark.pl." Repeat the above steps. Clicking
    the "view plain" link should trigger an error message: "Sorry, plain
    view is temporarily unavailable."
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1ca7b6c40cfc78bbeaf0c9d5bebeeb2e3b5ce611
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Nov 21 06:34:11 2019 -0500

    Bug 24075: Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 39cc13d070e1613b4a903ec5e0e2513ebd561285
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Nov 22 12:31:09 2019 +0000

    Bug 24075: Backdating a return to the exact due date and time results in the fine not being refunded
    
    When you use the date picker or book drop mode and check in an item that is due on that date, a fine is assessed and not refunded.
    
    For example: item 12345 is due on 11/19/2109 23:59.  On 11/20/2019 I check the item in using date picker/book drop setting the check in date to 11/19/2019 23:59, the patron is charged a fine, and the fine is not cleared as would be expected, since the item is being checked in before it is overdue.
    
    Test Plan:
    1) Back date a checkout so it is overdue
    2) Run fines.pl to generate the fine
    3) Return the item, backdating to the same date/time is was due
    4) Note the fine was not removed
    5) Apply this patch
    6) Repeat steps 1-3
    7) Fine should be zeroed out now!
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 737d8d1c7c044905c22e4ed735f7782589cf1f80
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Nov 22 14:47:19 2019 +0000

    Bug 24068: (RM follow-up) Enhance the POD
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9abdc5945b937dd7a7d9888c63654c35a67c2675
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 19 17:26:52 2019 +0100

    Bug 24068: Fix I18 plugin - tnpx must call __npx
    
    Test plan:
    Use the following code to test this change
        [% PROCESS 'i18n.inc' %]
        [% SET nb_stuffs = 1 %]
        [% tnpx('context', 'There is one stuff.', 'There are {count} stuffs.', nb_stuffs, { count = nb_stuffs }) | $raw  %]
        [% SET nb_stuffs = 42 %]
        [% tnpx('context', 'There is one stuff.', 'There are {count} stuffs.', nb_stuffs, { count = nb_stuffs }) | $raw  %]
    
    Compare with and without the patch
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 000c42cd60f324a9c1d3fd92900b3be834505327
Author: Lisette Scheer <lisetteslatah@gmail.com>
Date:   Wed Nov 13 19:41:20 2019 +0000

    Bug 24034: Capitalization on suggestion edit form: No Status
    
    When editing a purchase suggestion, the "No status"
    option in the status pulldown is incorrectly capatalized.
    This patch fixes the capitazliation.
    
    To test:
    1) Create a purchase suggestion in the acquisitions module.
    2) Edit the suggestion. Notice the capitalization in the
       status dropdown is incorrect.
    3) Apply the patch.
    4) Repeat step 2.
    5) Note the capitalization has been fixed.
    6) Sign off.
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 43a72e09989a8a8fd943fa3a87a1488b4078fe4f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Nov 18 18:55:39 2019 +0000

    Bug 24058: acquisition table displayed even if no order exist (bib detail)
    
    This patch corrects the template check for existence of acquisitions
    data on the bibliographic detail page. Now it will correctly hide the
    DataTable when there is no data.
    
    To test, apply the patch and enable the AcquisitionDetails system
    preference.
    
     - View the bibliographic detail page for a title which has no
       associated Acquisitions data. Under the "Acquisitions details" tab
       you should see only a message, "There is no order for this biblio."
    
     - View the detail page for a title which has associated Acquisitions
       data. The "Acquisitions details" tab should show the correct
       information.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fbd46dd3a7f231479c031808df967a9286a864d0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 19 11:12:32 2019 +0100

    Bug 23721: Use basketgroup's name to name the CSV export file
    
    When exporting a basket group, the names of the files are different:
     * pdf => aqbasketgroup.name(.pdf)
     * csv => aqbasketgroup.id(.csv)
    
    Better to use basketgroup's name for consistency and readability
    
    Test plan:
    Create a basketgroup and export it in pdf and CSV. The name of the
    generated file must be the basketgroup's name suffixed by the extension.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d4589500d197ddb543b63b4c84e87e763d050b40
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 19 13:01:56 2019 +0000

    Bug 24065: Fail shib login if multiple users matched
    
    Ideally you could test against active shib, but is a small code change and
    covered by tests and should be readable
    
    To test:
    prove -v t/Auth_with_shibboleth.t
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2e310fa7f38426b2a53bcca6e66d2ffae3688d17
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Nov 4 12:45:16 2019 +0000

    Bug 23184: Don't select branches for export by default
    
    This patch changes the include to require passing "selectall=1" to select all items
    
    This include is only used in this page, so changes should not have side effects
    git grep "branch-selector\.inc"
    
    This patch also corrects a mismatch in the class names
    
    To test:
    1 - Browse to Tools->Export data
    2 - Note all branches are selected
    3 - Note this will exclude records wiuthout items if you click 'Export bibiographic records'
    4 - Apply patch
    5 - Visit page again
    6 - Note no branches are selected by default
    7 - Confirm 'Select all/Clear all' still work
    8 - Note record with no items are exported by default now
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5cd071d66e2bba70f712b4fa4347648a51e1ed1a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 12 18:29:58 2019 +0000

    Bug 24024: Invert names on halds waiting report
    
    Signed-off-by: Rhonda Kuiper <rkuiper@roundrocktexas.gov>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b9422bef708fb8e57bb7cf482efbddd62860ab61
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 11 09:42:42 2019 +0100

    Bug 23964: Clarify and expand tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f847cfdd7efa8dcf13985409dcd333a933dbe416
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Nov 6 14:59:03 2019 +0000

    Bug 23964: (follow-up) Add comments and improve readability
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e083287048f8672f3a32372b88e13d53fb3a8c97
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Nov 4 16:06:15 2019 +0000

    Bug 23964: ReservesNeedReturn should only apply to available items
    
    To test:
     1 - Checkout an item to a patron
     2 - Make sure 'ReservesNeedReturn' is set to 'Automatically'
     3 - Place an item level hold on the checked out item
     4 - Note the hold is marked waiting
     5 - Delete the hold
     6 - Apply patch
     7 - Place a new hold
     8 - Hold is not marked waiting
     9 - Please a hold on a different item
    10 - Note it is marked waiting
    11 - Test when item is damaged and hold not allowed on damaged items
    12 - Test when item is in transit
    13 - Test when item has another hold
    14 - Only in the case where none of the above are true should the hold be marked waiting
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 838b8cb2f4bdbaaeba1e6958cbeddc0672b776e8
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Nov 4 16:06:02 2019 +0000

    Bug 23964: Unit tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 75c2cbed874f32fafe4df31f832e9c3259b5e887
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 20 10:17:27 2019 +0000

    Bug 23805: (RM follow-up) Add credit_type relation to Koha::Account::Line
    
    The credit_type relation was missing when I pushed this patchset
    originally; It is already referenced in the account description include
    files and as such should be added
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c0a34045df6eb84c2622fcfc69ce48debb365a5d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 20 09:49:23 2019 +0100

    Bug 23982: Fix the failing test
    
        #   Failed test 'nb_rows returns 0 on bad queries'
        #   at t/db_dependent/Reports/Guided.t line 441.
        #          got: undef
        #     expected: '0'
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fda209ca505a2a0e0099788aa5f654601f1caf07
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 19 10:14:31 2019 +0100

    Bug 24062: Make sure TestBuilder will stop generate X or other invalid category's types
    
    To make sure this kind of random failures will not appear in a future we
    are going to fix it at TestBuilder level.
    
    Test plan:
      prove t/db_dependent/TestBuilder.t
    and confirm it returns green
    
    You could also only apply the tests against master, run them several
    times and confirm that they fail most of the time.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cbe22553fe4bdcb9bf1bfc127dd4371f09ef43e9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 19 09:40:07 2019 +0100

    Bug 24062: Fix the failing test
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5df9c63eea6ecbd75079dbd62759db01927548dd
Author: Magnus Enger <magnus@libriotech.no>
Date:   Mon Nov 18 21:41:45 2019 +0100

    Bug 24064: DUEDGST typoed as DUEGST
    
    Bug 20478 introduced a typo where the letter code DUEDGST was changed
    to DUEGST. This patch fixes it.
    
    To test:
    - Run "grep -r DUEDGST *" on the Koha git repo. Notice that this letter
      code is used in e.g. sample notices.
    - Run "grep -r DUEGST *" and notice that this code only occurs twice,
      in misc/cronjobs/advance_notices.pl.
    - Aply this patch.
    - Run "grep -r DUEGST *" again, and notice there are no more occurences
      of this typo.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 24f780e22f68fb0e5968ae065cf0f73a9c978799
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 18 11:20:46 2019 +0100

    Bug 23982: (bug 23624 follow-up) Handle SQL error caused by derived table
    
    Caused by
      commit bca4453c50d8b5b1d3c7029ded2b522a9a2bf868
      Bug 23624: (QA follow-up) Optimize even more
    
    A report like:
    SELECT * FROM issues JOIN borrowers USING (borrowernumber)
    
    will have two borrowernumber columns - SQL will give us there rsults,
    but if we try to wrap them in a SELECT COUNT(*) FROM (report) it throws
    a duplicated column error.
    
    This patch suggests to execute the query the old way if the derived
    table optimization failed.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 468513a5de60696a7d98ca64ba5d5babaddbbaa5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Nov 19 07:19:14 2019 +0000

    Bug 23049: (RM follow-up) Add missing userpermission to installer
    
    The manage_accounts permission was duly added to updatedatabase.pl, but
    it was missed from userpermissions.sql.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 73198bc4bdafa6817c916c777a51a73d937ba2aa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 22 11:10:59 2019 +0200

    Bug 23854: Fix failure on dates when editing a suggestion
    
    - Watch plack-error-log
    - Change an accepted suggestion to 'No Status'
    - Verify error in the logs (use strict mode, depending on DBMS version)
    - Status changed was not saved
    - Apply patch
    - Verify the error is gone, change is saved now.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0498ffb6336cd5c3f5c580181c513bff968b8c58
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 5 11:07:19 2019 +0100

    Bug 23825: table name is not always displayed
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e5cdf8854473d6c766816355d080376afa1766d5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Mon Oct 28 09:00:26 2019 +0000

    Bug 23825: (QA follow-up) Remove database name
    
    As requested on comment15.
    
    Test plan:
    Run t/db_dependent/Koha/Object.t again
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a2c5d665e67bdc050c44030cc75ca732970f9da
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 24 12:51:19 2019 +0200

    Bug 23825: Add tests
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    [EDIT]
    Changed 'is' to 'like' with regex since we also have the db name.
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 480afea9ddf642fbd6ec499172e5ef6400905424
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 18 09:31:10 2019 +0000

    Bug 23825: Koha/Object.t might fail on a backtick
    
    If the SQL error message contains a backtick instead of a regular quote,
    the regex for throwing an exception did not work.
    Example:
    Incorrect datetime value: 'wrong_value' for column `koha_master`.`borrowers`.`lastseen`
    Note the backtics where the regex contains a regular quote.
    
    This patch makes it more flexible: it allows one \W character before the
    column name, even optional.
    
    Test plan:
    Run Koha/Object.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d23e50f0b239603a05ddbb62591e80657f5f6cae
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 11 12:35:30 2019 +0100

    Bug 23822: Fix deletion of patrons with credit
    
    There are bugs in both master and 19.05, but different.
    
    Anyway we should have this check to make sure a negative value will have
    the same behavior: trigger the confirmation message (instead of a blank
    page).
    
    If we want to reject the deletion of a patron with credit we should
    handle it on a separate bug report (behavior change)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 17d221144605875b6efb1569093b76f412f8aea5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 18:00:02 2019 +0100

    Bug 23985: (bug 21206 follow-up) Fix checkout list when "Hold pickup library match" not set
    
    This patch restores the behavior prior to bug 21206.
    If "Hold pickup library match" is "Not set", then
    hold_fulfillment_policy equals an empty string.
    
    Test plan:
    1. Go to "Circulation and fines rules"
    2. Under "Default checkout, hold and return policy", unset "Hold pickup
    library match" and Save
    3. Place a hold on one item for one patron
    4. Try to checkout the same item with another patron
    
    => Without this patch you the checkout list do not show, and the logs
    contain "The method Koha::Item-> is not covered by tests!"
    => With this patch applied you see the checkout list
    
    QA will take care of comparing the statement with the one before bug 21206
    and make sure they are equivalent
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c4ca7bff689a37debc7aa850fdd42bfc5a19386e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 13 12:35:45 2019 +0100

    Bug 24026: (bug 22847 follow-up) Display correctly max[onsite]issueqty (not the propagated ones)
    
    See bug 22847. We should never call ->Get in this template, we want
    to display the values in the DB, not the calculated ones
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4ad2bedb97712b4d574d6779ceff9753558c1db0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 13 12:35:39 2019 +0100

    Bug 24026: (bug 22847 follow-up) Remove c/p issues
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 86f999812e1fb281742d79757964227ea0f5d330
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 7 11:41:29 2019 +0100

    Bug 23765: Do not display localized templates if TranslateNotices is off
    
    To test:
    1. Enable multi-languages
    2. Set the preference 'TranslateNotices' on  'Allow'
    3. Go to: tools==>Notices & slips==>Edit, make sure it has multilingual
    email templates.
    4. Set the preference TranslateNotices on 'Don't allow'.
    5. Go to: tools==>Notices & slips==>Edit, the template shows several tab
    for the same transport type.
    6. Apply the patch.
    7. Repeat the steps 4 and 5
    8. Success. It only shows the default template when TranslateNotices is
    'Dont allow'.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dfb33b7f87f905e044bb6c23bccead0551c1190f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 13 11:09:37 2019 +0100

    Bug 24030: Fix GetItemsForInventory under MySQL 8
    
    t/db_dependent/Items/GetItemsForInventory.t .. 1/9 DBD::mysql::st execute failed: Expression #1 of ORDER BY clause is not in SELECT list, references column 'koha_kohadev.items.cn_sort' which is not in SELECT list; this is incompatible with DISTINCT [for Statement "
            SELECT DISTINCT(items.itemnumber), barcode, itemcallnumber, title, author, biblio.biblionumber, biblio.frameworkcode, datelastseen, homebranch, location, notforloan, damaged, itemlost, withdrawn, stocknumber
    
            FROM items
            LEFT JOIN biblio ON items.biblionumber = biblio.biblionumber
            LEFT JOIN biblioitems on items.biblionumber = biblioitems.biblionumber
         ORDER BY items.cn_sort, itemcallnumber, title"] at /kohadevbox/koha/C4/Items.pm line 838.
    
    We simply follow what the error says, and add items.cn_sort to the SELECT list
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7aa84d28e5aad61126242afe31142d3f3c946337
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 13 11:09:43 2019 +0100

    Bug 24030: Remove OldWay comparaison from GetItemsForInventory.t
    
    This has been introduced to make sure there were no regression at a
    given point. But now we are fixing the "old way" so it does not make
    sense to keep it any longer
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5aa8db502cee2a86e6da29d5ab12b924275c9df6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 13 10:50:41 2019 +0100

    Bug 24029: Remove "Truncated incorrect DOUBLE value: '01e'" from marcrecord2csv.t
    
    marc_subfield_structure.tagfield is a varchar(3)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9e6fe7ac38a4720ca645652c0633e0e6b1cc3a47
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 17:34:42 2019 +0100

    Bug 24022: Try to fix 'connect failed'
    
    I am assuming that the tests fail on Jenkins's nodes because they are
    too slow. The server is not setup yet when we are trying to access it.
    Just a guess...
    
    Note that sleep is usually a bad idea...
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 37bc254581362689fa3a5e2bee2940eba3ea4cc2
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 17:16:44 2019 +0100

    Bug 24022: Remove unecessary delete from authorised_values
    
    Why do we need that exactly?
    The cache is not flushed so it should not be needed.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fab29f7fd47452fc2cab8aa57fe5b59eb5ef8da4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 17:15:35 2019 +0100

    Bug 24022: Prevent Session2.t to fail if run after Session.t
    
    Cache must be cleaned!
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c2c5004066b3fbff2e89df43eb18319162765c6f
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Nov 13 11:19:42 2019 +0000

    Bug 23983: Remove comment
    
    I think we can do without the comment - suggesting removal with
    this patch.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 923aab2774a51741aab6c056255d84fd1f556f03
Author: Caroline Cyr La Rose <caroline.cyr-la-rose@inlibro.com>
Date:   Wed Nov 6 18:24:13 2019 -0500

    Bug 23983: Contextualization of 'Order' (verb) vs 'Order' (noun)
    
    This patch adds context (word class, either verb or noun) to the word
    'Order' when it is displayed alone in the acquisitions module.
    
    The following files have been modified:
    basket.tt
    neworderbiblio.tt
    newordersubscription.tt
    newordersuggestion.tt
    ordered.tt
    parcel.tt
    spent.tt
    transferorder.tt
    uncertainprice.tt
    z3950_search.tt
    
    To test, check all those pages in English to make sure there is
    no change.
    1- Go to Acquisitions
    2- Create a basket
    3- Add to basket from an existing record (neworderbiblio)
    4- Add to basket from a subscription (newordersubscription)
    5- Add to basket from a suggestion (newordersuggestion)
    6- Add to basket from an external source (z3950_search)
    7- In one of the orders, check the uncertain price box
    8- Check the basket display table (basket)
    9- Click transfer on one of the orders (transferorder)
    10- Go to the vendor page and click on 'Uncertain prices' (uncertainprice)
    11- Click on 'Receive parcel' (parcel)
    12- Go to the Acquisitions home page and click on the
    amount for 'ordered' (ordered)
    13- Go to the Acquisitions home page and click on the
    amount for 'spent' (spent)
    
    Next, install a new language (fr-CA used as example)
    1- translate create fr-CA
    2- open fr-CA-messages.po and add a translation for Order
    (verb) and Order (noun) (it doesn't have to be real, just
    write something different for each)
    3- translate install fr-CA
    4- in the system preferences, enable the french language in
    'language'
    5- change interface language to french
    
    Redo the tests above to make sure the word you put in the translation
    for the verb is in the places where 'Order' should be a verb and that
    the translation you put in for the noun is in the places where 'Order'
    should be a noun
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a02aeec94f1c5f4d661450cce195fc43005ae6e4
Author: Séverine Queune <severine.queune@bulac.fr>
Date:   Fri Nov 8 14:22:18 2019 +0100

    Bug 23932: Typo on 'aqinvoice_adjustments.encumber_open' description in Koha Schema
    
    Correct a typo in Koha Schema comment. finds --> funds
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cce358f9af5ee9761a875816f603344873838359
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 18:18:23 2019 +0100

    Bug 23846: Handle exception gracefully at the OPAC
    
    I do not think we should have the same trick as the intranet, and
    display a message. This should be enough.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e1c5d17a268c6d493c2c71d4b456da7749655c3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 11:15:46 2019 +0100

    Bug 23846: Add a check to the data inconsistencies script
    
    This may be quite long for big catalogue, but I think it is a good one
    to have.
    
    Test plan:
    Same as first patch, then execute search_for_data_inconsistencies.pl
    Notice the error.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 068943f18d60edc231b59b6232fecabaf1c799ab
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 12 11:04:42 2019 +0100

    Bug 23846: Display degraded view when MARCXML is invalid (staff detail)
    
    When an invalid bibliographic record is imported into the catalogue
    there is not warning or error. However the bibliographic record detail
    page will explode (Koha::Biblio::Metadata->record will raise an
    exception).
    
    This patch proposes to catch the exception on this view and display a
    warning about the situation.
    Note that editing/saving the record will fix the MARCXML data and so
    removes the warning (some black magic we should get rid of I suspect).
    
    Test plan:
    - Import a bibliographic record with invalid XML, you can add non
    printable characters, like 0x1F (CTRL-V 1F with vim)
    - Go to the detail page
    => Without this patch you get a 500
    => With this patch applied you get a "degraded view" with a warning
    message, telling you what the error is.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 150361c0e58e9a049b03693ce4859b9035d5c558
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 8 15:44:49 2019 +0100

    Bug 24002: One more occurrence of datecancellationprinted
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a70320077c7bb9878762e42d39211ab4de8e19dd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 8 14:49:48 2019 +0100

    Bug 24002: Incorrect DATE value: '' in C4/Acquisition.pm
    
    DBD::mysql::st execute failed: Incorrect DATE value: '' [for Statement "
        SELECT aqbasket.basketno,
            aqorders.ordernumber,
            DATE(aqbasket.closedate)  AS orderdate,
            aqbasket.basketname       AS basketname,
            aqbasket.basketgroupid    AS basketgroupid,
            aqbasketgroups.name       AS basketgroupname,
            aqorders.rrp              AS unitpricesupplier,
            aqorders.ecost            AS unitpricelib,
            aqorders.claims_count     AS claims_count,
            aqorders.claimed_date     AS claimed_date,
            aqbudgets.budget_name     AS budget,
            borrowers.branchcode      AS branch,
            aqbooksellers.name        AS supplier,
            aqbooksellers.id          AS supplierid,
            biblio.author, biblio.title,
            biblioitems.publishercode AS publisher,
            biblioitems.publicationyear,
            ADDDATE(aqbasket.closedate, INTERVAL aqbooksellers.deliverytime DAY) AS estimateddeliverydate,
    
            aqorders.quantity - COALESCE(aqorders.quantityreceived,0)                 AS quantity,
            (aqorders.quantity - COALESCE(aqorders.quantityreceived,0)) * aqorders.rrp AS subtotal,
            DATEDIFF(CAST(now() AS date),closedate) AS latesince
    
        FROM
            aqorders LEFT JOIN biblio     ON biblio.biblionumber         = aqorders.biblionumber
            LEFT JOIN biblioitems         ON biblioitems.biblionumber    = biblio.biblionumber
            LEFT JOIN aqbudgets           ON aqorders.budget_id          = aqbudgets.budget_id,
            aqbasket LEFT JOIN borrowers  ON aqbasket.authorisedby       = borrowers.borrowernumber
            LEFT JOIN aqbooksellers       ON aqbasket.booksellerid       = aqbooksellers.id
            LEFT JOIN aqbasketgroups      ON aqbasket.basketgroupid      = aqbasketgroups.id
            WHERE aqorders.basketno = aqbasket.basketno
            AND ( datereceived = ''
                OR datereceived IS NULL
                OR aqorders.quantityreceived < aqorders.quantity
            )
            AND aqbasket.closedate IS NOT NULL
            AND aqorders.datecancellationprinted IS NULL
         AND (closedate <= DATE_SUB(CAST(now() AS date),INTERVAL ? DAY))  AND aqorders.quantity - COALESCE(aqorders.quantityreceived,0) <> 0 AND orderstatus <> 'cancelled'
    ORDER BY latesince, basketno, borrowers.branchcode, supplier" with ParamValues: 0=0] at /kohadevbox/koha/C4/Acquisition.pm line 2248.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b16c7c0615f41dde587370ba32ca5711ae8127dd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 8 14:46:38 2019 +0100

    Bug 24002: Incorrect DATE value: '0000-00-00' in C4/Acquisition.pm
    
    t/db_dependent/Acquisition/close_reopen_basket.t .. DBD::mysql::st execute failed: Incorrect DATE value: '0000-00-00' [for Statement "
            SELECT COUNT( DISTINCT( biblionumber ) )
            FROM   aqorders
            WHERE  basketno = ?
                AND (datecancellationprinted IS NULL OR datecancellationprinted='0000-00-00')
            " with ParamValues: 0='2'] at /kohadevbox/koha/C4/Acquisition.pm line 3012.
    DBD::mysql::st execute failed: Incorrect DATE value: '0000-00-00' [for Statement "
            SELECT COUNT( DISTINCT( biblionumber ) )
            FROM   aqorders
            WHERE  basketno = ?
                AND (datecancellationprinted IS NULL OR datecancellationprinted='0000-00-00')
            " with ParamValues: 0='2'] at /kohadevbox/koha/C4/Acquisition.pm line 3012.
    
    And anticipating other failures
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3d3336ed6607d80b72502075ebf9567cf48e1709
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 8 14:44:28 2019 +0100

    Bug 24002: Incorrect DATE value: '00-00-0000' in C4/Serials.pm
    
    t/db_dependent/Biblio.t .. 2/12 DBD::mysql::st execute failed: Incorrect DATE value: '00-00-0000' [for Statement "
      SELECT    serial.serialid,
                serial.serialseq,
                serial.planneddate,
                serial.publisheddate,
                serial.publisheddatetext,
                serial.status,
                serial.notes as notes,
                year(IF(serial.publisheddate="00-00-0000",serial.planneddate,serial.publisheddate)) as year,
                biblio.title as bibliotitle,
                subscription.branchcode AS branchcode,
                subscription.subscriptionid AS subscriptionid
      FROM      serial
      LEFT JOIN subscription ON
              (serial.subscriptionid=subscription.subscriptionid)
      LEFT JOIN aqbooksellers on subscription.aqbooksellerid=aqbooksellers.id
      LEFT JOIN biblio on biblio.biblionumber=subscription.biblionumber
      WHERE     subscription.biblionumber = ?
      ORDER BY year DESC,
              IF(serial.publisheddate="00-00-0000",serial.planneddate,serial.publisheddate) DESC,
              serial.subscriptionid
              " with ParamValues: 0='446'] at /kohadevbox/koha/C4/Serials.pm line 482.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5e5c47ea300b7eb34cbcd3e71ff4a1ac9a3eaa38
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 8 14:03:37 2019 +0100

    Bug 24002: Incorrect DATE value: '0000-00-00' in C4/Serials.pm
    
    DBD::mysql::st execute failed: Incorrect DATE value: '0000-00-00' [for Statement "SELECT   serialid,serialseq, status, planneddate, publisheddate,
            publisheddatetext, notes, routingnotes
           FROM     serial
           WHERE    subscriptionid = ?
           AND      status IN ( 2,4,41,42,43,44,5 )
           ORDER BY IF(publisheddate<>'0000-00-00',publisheddate,planneddate) DESC
          " with ParamValues: 0=8] at /kohadevbox/koha/C4/Serials.pm line 688.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 508a5addf15170d32dea0f21e3acf569596db228
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 8 14:00:43 2019 +0100

    Bug 24002: Incorrect DATE value: '' in C4/Bookseller.pm
    
    t/db_dependent/Bookseller.t .. 3/86 DBD::mysql::st execute failed: Incorrect DATE value: '' [for Statement "
            SELECT DISTINCT aqbasket.booksellerid, aqbooksellers.name
            FROM aqorders LEFT JOIN aqbasket ON aqorders.basketno=aqbasket.basketno
            LEFT JOIN aqbooksellers ON aqbasket.booksellerid = aqbooksellers.id
            WHERE
                ( datereceived = ''
                OR datereceived IS NULL
                OR aqorders.quantityreceived < aqorders.quantity
                )
                AND aqorders.quantity - COALESCE(aqorders.quantityreceived,0) <> 0
                AND aqbasket.closedate IS NOT NULL
        "] at /kohadevbox/koha/C4/Bookseller.pm line 100.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e602c275b3687460c55f3f103781f2a44bdbee8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 8 13:58:32 2019 +0100

    Bug 24002: Incorrect DATE value: '00-00-0000' in NewsChannels.pm
    
    % prove  xt/author/valid-templates.t
    
    DBD::mysql::st execute failed: Incorrect DATE value: '00-00-0000' [for Statement "
         SELECT opac_news.*,timestamp AS newdate,
         borrowers.title AS author_title,
         borrowers.firstname AS author_firstname,
         borrowers.surname AS author_surname
         FROM   opac_news
         LEFT JOIN borrowers on borrowers.borrowernumber = opac_news.borrowernumber
         WHERE   (
            expirationdate >= CURRENT_DATE()
            OR    expirationdate IS NULL
            OR    expirationdate = '00-00-0000'
         )
         AND   DATE(timestamp) < DATE_ADD(CURDATE(), INTERVAL 1 DAY)
         AND   (opac_news.lang = '' OR opac_news.lang = ?)
         AND   (opac_news.branchcode IS NULL OR opac_news.branchcode = ?)
         ORDER BY number
        " with ParamValues: 0='OpacNavRight_', 1=''] at /kohadevbox/koha/C4/NewsChannels.pm line 216.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5ef116c58debd516903607aed5852601f1283ece
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Oct 9 13:08:10 2019 -0400

    Bug 23788: Recalculate ammount due for selected accountlines
    
    Individual fees cannot be overpaid of over-written off, but it's possible to 'overpay' a writeoff of selected fees.
    
    Test Plan:
    1) Create 3 fees
    2) Pick 2 and choose "Write off selected"
    3) Write off more than the total amount of those fees
    4) Apply this patch set
    5) Restart all the things!
    6) Try again, you should no longer be able to!
    
    Signed-off-by: Sean McGarvey <seanm@pascolibraries.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4975e8b958ec6b3a01176911e765599aea566d09
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Oct 9 12:45:33 2019 -0400

    Bug 23788: Rename $select_lines to $selected_lines
    
    Signed-off-by: Sean McGarvey <seanm@pascolibraries.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 059788e7368d1cbfcee270ee3d3dc5034d08e642
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Oct 9 12:43:54 2019 -0400

    Bug 23788: Rename $select to $selected_accts
    
    Signed-off-by: Sean McGarvey <seanm@pascolibraries.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cdea121ddb5c3e609ce698171a8dc319593a7780
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Nov 7 19:38:24 2019 +0000

    Bug 23986: Pass strings to Catmandu for deletion
    
    The deletion subroutine expects to get a string, this is fine in most places, but when
    we sort our records for batch deletion they are cast to numbers and the delete is not processed.
    
    This patch quotes the biblionumbers as strings before passing them to Catmandu
    
    To aid in detecting orphaned records you can use the patches on bug 22831
    
    To test:
     1 - Have or create a bib
     2 - Go to Tools->Batch record deletion
     3 - Click 'Enter a list of record numbers'
     4 - Enter the biblionumber'
     5 - Confirm deletion
     6 - Search for the record, it still appears
     7 - Apply patch, restart all the things
     8 - Repeat 1-6
     9 - This time the record is deleted
    10 - Test other methods of record deletion to confirm the record is removed
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aae3dfe1232d8df452c7e677c6fa443017fb0417
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 22 11:36:28 2019 +0200

    Bug 23851: Add the homebranch prefix to the barcode when adding multiple copies of an items
    
    See the comment in the code for more information.
    
    Test plan:
    - Set autoBarcode to hbyymmincr
    - Create an item and click on the barcode field
    - A barcode prefixed by the homebranch is generated
    - Click the "Add multiple copies of this item" and enter 4
    - Save
    => Without this patch only the first item has the homebranch prefix
    => With this patch applied they all have a barcode in the same format
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a74f1dabe23bdcc17b68c8053fcf868d62f9231e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 21 09:37:25 2019 +0200

    Bug 23847: Fix custom item search fields if subfield is '0'
    
    The subfield is not used if is false, so if 0. We want to test if the
    subfield is defined and not an empty string.
    
    Test plan:
    - Define a new custom item search fields using a subfield '0'
    (withdrawn=952$0 for instance)
    - Define one which does not have a subfield (control field)
    - Search items using those newly created fields.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0eb9edbf229bdbde02ff65e5f955fb18cf0cc7db
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 4 12:25:33 2019 +0100

    Bug 23933: (bug 10132 follow-up) Fix commit_file.pl
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b687c60b27fa5a813b148bd5730b2d8278062ad5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 10:45:56 2019 +0100

    Bug 5365: Make more clear how to reopen a basket in a basket group
    
    The "reopen basket" button will be visible but disabled if the basket
    cannot be reopened. A tooltip is attached to the button to add more
    information.
    
    Note that the export button is still hidden, would it makes sense to
    display it (visible and active)?
    
    Test plan:
    - Create a basket
    - Close it
    - Go to the basket detail view
    => The reopen button should be displayed and enabled
    
    - Attach it to a basket group
    - Go to the basket detail view
    => The reopen button should be displayed but disabled
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bd30a17d3bc0040460543ced27140690f50d27f0
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Nov 8 09:00:32 2019 +0000

    Bug 22857: (QA follow-up) Cosmetic changes: typo, whitespace
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eaf4b79c32a6f173db8177b8ee365ec10f4532a6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 5 11:23:04 2019 +0100

    Bug 22857: Sync koha-conf.xml files
    
    Missing entries are added to those files.
    
    Test plan:
    Search for typos
    Compare the two files and comfirm the entries are the same in both.
    Exception: supportdir exists in etc/koha-conf.xml only, but I think it's
    obsolete.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 832086ad7237c04ba6bc978ab786f8ce0a4f5d40
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Nov 6 16:09:15 2019 -0300

    Bug 23949: Add z3950 directory to koha-common.install
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2fc80e71e2bac4e0881f79eb712c0f62f5e68986
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 5 18:34:28 2019 +0100

    Bug 23949: Update documentation
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 56d87af81ac2bda6d1cf0b42807484982a45e1c4
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Nov 1 15:51:00 2019 -0300

    Bug 23949: Add missing actions for koha-z3950-responder in koha-common.init
    
    This patch makes the init script deal with koha-z3950-responder in --stop
    and --restart actions. Currently, only --start calls the script.
    
    To test:
    - Enable the server:
      $ koha-z3950-responder --enable kohadev
    - Stop koha-common
      $ service koha-common stop
    => SUCCESS: No koha-z3950-responder running
    - Start koha-common
      $ service koha-common start
    => SUCCESS: It is loaded (even if failing because of config issues)
    - Stop koha-common
      $ service koha-common stop
    => FAIL: It is still running (no --stop issued)
    - Repeat for restart
    - Apply this patch
    - Redo
    => SUCCESS: Things behave as expected!
    - Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ed45a4f333fb9f6569d150410ef99d8ffe13f54c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 24 18:21:04 2019 +0200

    Bug 23398: Disable the XML import/export format for biblio framework
    
    It gives incomplete results and not sure it ever worked.
    To prevent data loss it is better to remove this option.
    
    Note that the code in C4/ImportExportFramework.pm is too complex to
    attach with this patch to deletion of the code related to the XML
    import/export. Safer to keep it for a separate bug report.
    
    Test plan:
    Import/export biblio frameworks and confirm that there is no more
    reference to the xml format.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5ebf75ecd07f99b5d8bb56edc9b1758d262a30c1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 8 11:46:58 2019 +0100

    Bug 23997: Escape z3950servers.rank as it's a new MySQL 8 kw
    
    This patch will fix installation of Koha on MySQL 8
    DBD::mysql::st execute failed: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'rank, syntax, encoding,recordtype) VALUES
    ('lx2.loc.gov',210,'LCDB','','','LIBRA' at line 2 at /usr/share/perl5/DBIx/RunSQL.pm line 273.
    
    https://dev.mysql.com/doc/refman/8.0/en/keywords.html
    => RANK (R); added in 8.0.2 (reserved)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0d2cc574d1c8ac00cebd91816277c75a461eef3b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Nov 8 10:27:06 2019 +0000

    Bug 23995: Remove CHECK constraints from kohastructure
    
    MySQL8 and MariaDB10.3 impliment check constraints but utilise
    different, incompatible, syntaxes to do so.
    
    This patch removes the check constraints entirely whilst we work on a
    better solution to work around the incompatabilities of the two DBs.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6f464191ffcca26d65c158c37f21216cee8aa227
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Nov 8 10:28:01 2019 +0100

    Bug 23994: Fix random failure from AdditionalFields.t (U18)
    
    t/db_dependent/Koha/Objects/Mixin/AdditionalFields.t .. 1/12
     #   Failed test '->additional_field_values should return the correct values'
     #   at t/db_dependent/Koha/Objects/Mixin/AdditionalFields.t line 82.
     #     Structures begin differing at:
     #          $got->[0]{value} = 'bar value for basket2'
     #     $expected->[0]{value} = 'foo value for basket2'
     # Looks like you failed 1 test of 12.
    
    We do not really know why, but the values are not returned in the order they
    are stored in DB. Fixing this random failure for now at test level.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1a8de78c20ef05d7b11c5d97724643bc98c4354e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Nov 8 08:06:10 2019 +0000

    Bug 23049: (RM follow-up) remove 'IGNORE' from ALTER TABLE
    
    We have updated the update to use our column_exists method, but had
    forgotten to remove the corresponding IGNORE keyword from the SQL
    itself.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d51aeb7f9b498ba80470655161e654cc385c1062
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Oct 11 09:07:14 2019 -0700

    Bug 23806: FinePaymentAutoPopup does not trigger pop-up for writeoff by "Write off" button
    
    Test Plan:
    1) Enable reciept popups for payments and writeoffs
    2) Test the "Write off" button, no popup
    3) Apply this patch
    4) Restart all the things!
    5) Test again, you should get the popup!
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Sean McGarvey <seanm@pascolibraries.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 119347c76e5acc262380cc22b13684cca5a19e8d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 7 13:34:31 2019 +0100

    Bug 23427: Simplify sort logic
    
    This is the usual syntax.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b4a6d79e4dbd6de90d453140f696cf8ba75a2159
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Aug 5 15:25:02 2019 +0200

    Bug 23427: Better sorting of previous checkouts
    
    In patron circulation or details page, previous checkouts are displayed sorted by due date.
    Many checkouts may have same due date so it would be better to sort on timestamp as second sort criteria, like todays's checkouts.
    
    Test plan :
    1) Create for a patron two issues with same due date and a few seconds between them
    2) Create another issue with a different due date
    3) Come back a day later
    4) Set preference previousIssuesDefaultSortOrder = "latest to earliest"
    5) Go to patron circulation page and check sort order is OK : sorted by "Due date" then "Cheked out on"
    6) Go to patron details page and check sort order is OK : sorted by "Due date" then "Cheked out on"
    7) Set preference previousIssuesDefaultSortOrder = "earliest to latest"
    8) Go to patron circulation page and check sort order is OK : sorted by "Due date" then "Cheked out on"
    9) Go to patron details page and check sort order is OK : sorted by "Due date" then "Cheked out on"
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6b2d1093155c07e43522b0f926742698598d09ea
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Aug 5 15:11:49 2019 +0200

    Bug 23427: Fix previous checkouts sort order
    
    In patron circulation or details page, previous checkouts are displayed sorted by due date.
    Actual sort order is not honoring system preference "previousIssuesDefaultSortOrder". Todays's checkouts is correct thanks to Bug 13908.
    
    Patch adds comments that refer to the text of system preferences "previousIssuesDefaultSortOrder" and "TodayIssuesDefaultSortOrder" :
      latest to earliest = asc
      earliest to latest = desc
    
    Test plan :
    1) Create for a patron two old issues with a few days between them
    2) Set preference previousIssuesDefaultSortOrder = "latest to earliest"
    3) Go to patron circulation page and check sort order is OK
    4) Go to patron details page and check sort order is OK
    5) Set preference previousIssuesDefaultSortOrder = "earliest to latest"
    6) Go to patron circulation page and check sort order is OK
    7) Go to patron details page and check sort order is OK
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cd3ef03e76e1441675c90135c42d033bf99f73cd
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Nov 2 06:54:31 2019 +0000

    Bug 21939: Fix permissions for holds history tab
    
    The tab will show when the staff user has edit_borrowers
    permission, but the page itself will not be accessible.
    This patch fixes the page permissions to allow access
    with the edit_borrowers permission as suggested by the
    comments on the original bug report.
    
    To test:
    - Create a staff user with only "edit_borrowers" permission
      from the borrowers module
    - Try to access the holds history tab from any patron account
    - Verify you are blocked
    - Apply patch
    - Try again and verify the page is accessible now
    - Repeat with superlibrarian and full borrowers permission.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Bob Bennhoff <bbennhoff@clicweb.org>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc04f6535be59350c3b01491bded356ba30470fb
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 7 13:20:08 2019 +0000

    Bug 23293: DBRev 19.06.00.050
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 341b8266d70dd887adc646b6d931e251f4d33242
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Nov 6 15:40:57 2019 -0300

    Bug 23293: (QA follow-up) Minor fix for tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5f555d865d1cd683c7aec48e6bd51c542a0a4a68
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Sep 25 10:59:03 2019 +0100

    Bug 23293: (follow-up) Add tests for C4::Circulation change
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d9cd7ff1fd4fdb65d04a3489a78fddd5f1cc88f7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jul 10 14:50:06 2019 +0100

    Bug 23293: Apply OPACFineNoRenewalsIncludeCredit preference
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8044ac7344c8281837cc35f2dadf07d83d53e641
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jul 10 14:34:47 2019 +0100

    Bug 23293: Add system preference
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b6fbc138f2ac93cf42ee9c6346bdc67f7268489
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Nov 2 12:30:58 2019 +0100

    Bug 23751: Make staffaccess permission description more precise
    
    The permission description was missing 'username' from the description.
    
    To test:
    - Look at the permissions of a patron
    - Verify the staffaccess permission is labelled:
      Allow staff members to modify permissions and passwords for other staff members
    - Apply patch
    - Check description again:
      Allow staff members to modify permissions, usernames, and passwords for other staff members
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ccf9eaf62fc05abe318fe4652025ac3979c50c19
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Nov 2 01:58:00 2019 +0000

    Bug 23952: Fix body tag on OPAC course details page
    
    The id was not changed, when the page was added and
    remained opac-main. The patch changes it to
    opac-course-details so the page has its own unique id.
    
    To test:
    - Add a course reserve to your installation
    - Go to the course reserves page in the OPAC
    - Click on the course to see its details
    - Look at the source code, the <body> tag should show:
      Without patch: opac-main
      with patch applied: opac-course-details
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 551097f85049c96119038879dfe368611ca87f30
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Sun Nov 3 21:41:04 2019 +0000

    Bug 23954: Format notes in suggestion management
    
    This patch makes minor CSS and markup changes in order to deliniate
    suggestion notes from the other data in the suggestions list view.
    
    To test you should have at least one suggestion with a note. Apply the
    patch and go to Acquisitions -> Suggestions.
    
    In the table of suggestions, check that the notes display clearly.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9af572c7969f5372853d238ee35f530e4e9fc9f6
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Oct 8 17:11:17 2019 +0000

    Bug 13749: On loading holds in patron account 'processing' is not translatable
    
    This patch updates the DataTables configuration for two tables: The
    checkouts and holds lists shown on the checkout and patron details
    screen.
    
    The tables lacked the standard application of a custom set of
    defaults defined in js/datatables.js. It is in this file that custom
    language strings are defined for DataTable interface elements, pulling
    in the translated values from datatables.inc.
    
    Without our custom defaults applied, DataTables used its own defaults,
    which are not translated.
    
    To test, apply the patch and check out to a patron who has both
    checkouts and holds. The more the better to give you more time to
    observer the loading state of the tables.
    
     - Checkouts: This table doesn't exhibit any visible problems because
       page-specific text is defined for the table's "Loading" message.
       However, it still makes sense to apply the defaults to the table for
       consistency's sake. There should be no visible changes to the table.
    
     - Holds: From the checkout or patron details page click the "Holds"
       tab. While the table loads there should be a "Processing" message. If
       you switch to another translation the message should appear in that
       language.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 342baeecbb37bc39245c5df5dccfb983f7f84e0f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Nov 7 11:48:59 2019 +0100

    Bug 23768: Adjust the test for invalid ISBN
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 050f43f73c4857b26996e15e3d8b8ad536b32763
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Oct 7 17:46:30 2019 +0000

    Bug 23768: Return invalid ISBN when searching with variations
    
    To test:
    1 - Enable SearchWithISBNVariations and  IntranetCatalogSearchPulldown
    2 - Refresh page and click on 'Search the catalog' tab
    3 - Search for 'ISBN' 0385299209
    4 - Note no results
    5 - Note the search says if searched 'kw,wrdl: (nb=)'
    6 - Apply patch, restart all the things
    7 - Repeat search
    8 - Search looks correctly formed
    9 - Add the isbn above to a record, confirm it is returned by search
    10 - Confirm searches for valid ISBNs still work as expected
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ff3d7b9f8e27a1c8547012f062daccc33b12dc27
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Oct 22 12:42:09 2019 +0200

    Bug 23813: (bug 18925 follow-up) Remove invalid circ rules to avoid FK constraints to fail
    
    There is not FK constraints on the itemtype, categorycode and branchcode
    columns of the issuingrules table, because of the '*' value we use for
    default.
    We created the new table circulation_rules with those constraints, and
    when we moved the rules for maxissueqty, the INSERT failed.
    
    To avoid the FK constraints to fail we are going to delete the invalid
    rows before.
    
    It could lead to data lost, but this situation certainly comes from a
    bad data manipulation at some point of the history of the installation.
    
    Test plan:
    git reset --hard 1e4f442442844cfaf17f5b06f122f6259d5fee92 # before 18.12.00.020
    reset_all
    
    insert into branches(branchcode, branchname) values('rmme', 'rmme');
    insert into categories (categorycode, description) values ('rmme', 'rmme');
    insert into itemtypes (itemtype, description) values('rmme', 'rmme');
    
    Go to http://pro.kohadev.org/cgi-bin/koha/admin/smart-rules.pl
    Create a new rule for the patron category
    Create a new rule for the item type
    Copy all the default rule to the new library
    Create other rules for "Default checkout, hold policy by patron category" and "Default holds policy by item type" using this patron's category and itemtype.
    Same for patrons' categories and itemtypes you will not delete.
    
    delete from branches where branchcode="rmme";
    delete from categories where categorycode="rmme";
    delete from itemtypes where itemtype="rmme";
    
    git checkout master
    and execute the DB process.
    
    => With this patch applied you will not get the error and the rules will
    be moved correctly.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aab956af68d0bc72c6268866cc8b5083dc6dee43
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 7 09:14:48 2019 +0000

    Bug 13958: DBRev 19.06.00.049
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f59a34a9ca80c54159b976c6fb658a85dc3eef79
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 27 12:10:57 2019 -0300

    Bug 13958: Use SuspensionsCalendar syspref for more granularity
    
    This patch makes the calculation of suspension expiration configuration
    detached from the finesCalendar syspref. This way libraries have more
    flexibility when setting circ rules.
    
    I wrote this path as a bugfix, because the recent change pushed by bug 19204
    changed this behavior and libraries have been complaining since they got
    upgraded.
    
    It is a minor change, just adding the new syspref, and replacing the
    single place in which it is used for debarment calculation for the new
    one.
    
    The tests are updated similarly, just adding the new mocked syspref as
    it was with the old one.
    
    To test:
    - Apply this patches
    - updatedatabase
    - Run:
      $ kshell
     k$ prove t/db_dependent/Circulation.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Sponsored-by: Universidad Nacional de Córdoba
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 44c73324700e41de62bda13d4db8c5fa26507607
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon May 27 11:30:33 2019 -0300

    Bug 13958: Add SuspensionsCalendar syspref
    
    Sponsored-by: Universidad Nacional de Córdoba
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 44424b209cd73273796272ba4b32fe7280f912a5
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon Nov 4 15:09:33 2019 -0300

    Bug 23868: Check if threshold is undefined in javascript block of opac-account.tt
    
    This patch fixes a bug introduced by checking payment plugins threshold
    
    To test:
    1. do not apply this patch
    2. configure paypal options in intranet
    3. create a manual invoice for a patron
    4. in opac try to pay that invoice
    CHECK => Make Payment button is disabled, even when invoices where checked.
    5. apply this patch
    6. repeat step 4
    SUCCESS => Make Payment button is enabled when an invoice is checked.
    7. Sign off
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b28c71a7145435a38f69361d0b0bedb718240a58
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Nov 7 07:54:53 2019 +0000

    Bug 23075: (RM follow-up) Update mock in tests
    
    To prevent GET request redirects we switched from ->request to
    ->simple_request. This patch updates the mock in the corresponding test
    to mock simple_request rather than request.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 626811814c3ab8b363d2c181e148910205e560f9
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Oct 14 22:28:45 2019 +0200

    Bug 22677: Include hint to OAI page path on OAI-PMH preference
    
    This copies the way we are doing it for othe rprefs (ILSDI and similar)
    and adds a hint to the description to make it easier to find the
    right path for the OAI server.
    
    To test:
    - Apply patch
    - Verify that the system preference for OAI-PMH includes
      now a hint to: /cgi-bin/koha/oai.pl?verb=Identify
    - Verify the hint is correct (add OPAC base URL)
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5e3ed8d52d3b81e725f54b43da28e60a3dc116b9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 10:10:00 2019 +0100

    Bug 23414: Replace delimiter of regexs to ease readability
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d3ff3c5c032cf7435e2509db12384f2e048bb34
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 10:06:46 2019 +0100

    Bug 23414: Add tests for previous effective_itemtype change
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4b97ca915e2054b549e4234533894beb040b2ed6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Nov 4 14:22:44 2019 +0000

    Bug 23414: Unit tests
    
    To test:
    1 - Apply this patch alone
    2 - prove -v t/db_dependent/XSLT.t
    3 - All pass
    4 - Apply other patches
    5 - prove -v t/db_dependent/XSLT.t
    6 - All pass
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 032343b98dfb84e9e8dfbf5d5ecf4fec3bcf8754
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 4 16:34:35 2019 +0100

    Bug 23414: Use effective_itemtype
    
    We should use effective_itemtype instead of itype to take
    the item-level_itypes pref into account.
    Note that we should not need to test for the existence of the key as we
    now assume that item types are correctly set to a valid item type.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 89cd2c440083e7aa87af2fdeb06f88eb9cfafe0e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 4 16:29:23 2019 +0100

    Bug 23414: Easy readability and simplify logic in buildKohaItemsNamespace
    
    This patch improves true/false logic and avoid autovivication.
    Also note that xml_escape already deals with empty string.
    
    An unecessary call to GetReserveStatus is removed.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ff7c422af09ee6b70cd6e28c21f1644ff360cd7c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Aug 1 17:01:28 2019 +0000

    Bug 23414: Prefetch transfers, use only default framework, use elsif
    
    This further cleans up the code, before we tested each condition though we return only one status line.
    
    Koha mappings can no longer differ by framework so we don't need to fetch the biblio framework
    
    Prefetching should offer a boost
    
    To test:
    Same as before - there is not as big a boost form this, but there shouldn't be a hit
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ba184df84a9a56373677c56a1aa64cdd48bd8a3c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Aug 1 15:42:16 2019 +0000

    Bug 23414: Use Koha Item objects in buildKohaItemsNamespace
    
    Removing the use of C4::GetItemsInfo cuts down on the number of DB requests and speeds things up
    
    To test I added 100 items to each of the first 20 records returned by a search for 'a'
    I saw a reduction from ~30 seconds to ~26 seconds
    
    This also makes the code a little cleaner and moves us toward the Koha namespace
    
    To test:
    1 - Perform a search in the OPAC and STaff Client with the Browser Console opened (F12)
    2 - View the netwrok tab and see how long the pages take to load
    3 - Apply the patches, restart all the things
    4 - Repeat and note if the results are returned faster
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 89931b4bb02d6ca1796ece2647fc6104382c0b7d
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Nov 3 22:48:04 2019 +0000

    Bug 23483: Show the description, not the patron's title when writing off an individual fine/fee
    
    When writing off an individual fine, the description shown
    was the patron's title, instead of the fine description.
    Fixing it by changing it to the same template variable used for
    paying individuals so they match up.
    
    To test:
    - Pick a patron and make sure salutation is set (Mr, Mrs, ...)
    - Create a manual fine
    - For the fine, compare the description shown when using the Writeoff
      and Pay buttons next to the fine
    - Verify the display is different and writeoff displays the salutation
    - Apply patch
    - Repeat, descriptions now should match up
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a4f2ad76f98e023489dec44f481f290302f44c78
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 10:59:26 2019 +0100

    Bug 23467: Exit after output_html - opac-reserve.pl
    
    To avoid double screen
    
    There are several ways to recreate the issue, the easiest is:
      /cgi-bin/koha/opac-reserve.pl?biblionumber=
    
    You should see "ERROR: No record id specified."
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 45a89f47090e783513841a087256c76fff84b29f
Author: Lari Taskula <lari.taskula@hypernova.fi>
Date:   Mon Nov 4 16:32:58 2019 +0000

    Bug 23774: Server-side confirmation for hold pickup location in OPAC
    
    While placing a hold on a book, if a user opens up Inspect Element on the
    Pick up location drop down box they can change the pick up location in
    the code to a library that is not listed as a pick up location.
    
    How to replicate:
    Search for a book
    Select book
    Click Place Hold
    
    On the screen Home > Placing a hold
    
    Right click on Pick up location
    Select 'Inspect Element'
    
    Under
    <!-- HOLDABLE -->
    
    <li class="Branch">
    <select name="Branch ******"> Pick Up location:</label>=$0
    
    Option values are listed that relate to the pick up location, this value
    can be changed to another new location and when the hold is placed
    the hold will be placed for this new location instead of the listed options
    in the Pick up location drop down list.
    
    To test:
    1. Apply patch
    2. Repeat "How to replicate"
    3. Observe it is no longer possible to place holds on libraries not defined
       as pickup location by changing option value via Inspect Element tool
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4a36c1ac044ed9da3b67d32e9c315e61d2adc3bd
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 31 14:34:53 2019 +0000

    Bug 23719: (follow-up) Add warn when passed invalid search field in marclist
    
    Note: I also remove warnings for undefined operation in this patch, is a trivial fix
    
    To test:
    prove -v t/db_dependent/Koha/SearchEngine/Elasticsearch/QueryBuilder.t
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 33595e1a3edd881e6b5489894c4676293839ed19
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Oct 2 11:17:13 2019 +0000

    Bug 23719: Allow searching specific fields for matching authorities in ES
    
    To test:
    1 - Export your authorities via Tools->Export data
    2 - Define a record matching rule in Admin->Record matchign rules
        Use index: LC-card-number
        field: 010$a
    3 - Stage the exported records for import and use the rule created above for matching
    4 - The process does not complete
    5 - Check intranet error logs - exception on unknown marclist
    6 - Apply patch
    7 - Repeat
    8 - Success!
    9 - prove -v t/db_dependent/Koha/SearchEngine/Elasticsearch/QueryBuilder.t
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c0786a1106ed170cbf80f0ebf71599b7ac9d3e9
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Nov 6 09:50:01 2019 +0100

    Bug 23075: Correct indendation
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 42ebef689fb45255613381a4d176977cddc9dc9d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 4 15:09:34 2019 +0100

    Bug 23075: Do not 'Send' if the url is not correct
    
    Just in case.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e47e5a849fb0297f7da1a5ebd5d94f5b8cd46f9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Nov 4 13:13:16 2019 +0000

    Bug 23075: (follow-up) Dissallow transparent redirects
    
    GET request redirects were causing the http URL to 'pass' our 'good url'
    test for http => https redirected mana servers. However, on the
    subsquent POST request to get a mana security token we would fail as the
    POST was not transparently redirected.
    
    This patch changes the request to be a simple_request so we will catch
    bad urls earlier and it also prevents submissions for security tokens if
    the configured URL is identified as bad.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a1161ced1d977d872ab4238fc38ae30440978204
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 17 18:24:04 2019 +0100

    Bug 23075: Report if mana-kb server is not found
    
    This patch adds a status check into the mana configuration page and
    prompts the user to ask an adminstrator to check the configured mana
    service url.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b920cb708b8acacbf2075b00c0c68e70b6d5a29b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Nov 5 10:25:50 2019 +0100

    Bug 17359: Use a unicode character in tests
    
    And remove an unused variable.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b03d4be39497be0dbdce17ef26867ca80affec1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 16 10:47:28 2019 +0200

    Bug 17359: Correct encoding when displaying patron import summary
    
    There is an encoding issue when the patron import summry, the string
    must be UTF8 decoded before being sent to the template.
    
    Test plan:
    - Create a patron import CSV file with import issues. Use UTF8 characters.
    See file attached to the bug report 'patron_import.csv'
    => The screen should display the line correctly
    - Correct the import issue (add a surname for Chloé)
    => The imported patrons should contain the correct values.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c58fc50128eff5d23ac7e9c71b6f78da3bba3c71
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 16 10:22:38 2019 +0200

    Bug 17359: Add tests
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cffa7623e13d8a21e66f5c9dc8caaa5668738411
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Nov 5 09:55:25 2019 +0100

    Bug 23968: Add div this id around OPACMySummaryNote content
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d5c501bf63f9d42bc9d872eef391c0864753c8ba
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Nov 5 09:52:59 2019 +0100

    Bug 23968: fix OPACMySummaryNote feature
    
    The system preference OPACMySummaryNote is used to display on the logged-in patron summary page at OPAC.
    It does not display anymore.
    
    Looks like it comes from code :
    [% IF OPACMySummaryNote %][% Koha.Preference('OPACMySummaryNote') | $raw %][% END %]
    OPACMySummaryNote used to be a provided variable.
    
    Test plan:
    1) Enable system preference OPACMySummaryNote
    2) Enter some HTML into it
    3) Go to OPAC and loggin
    4) Check you see the HTML in opac-user.pl
    5) Disable the preference
    6) Check you dont see the HTML anymore
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fad70512c0d6ebe72f34848406e00d9eb927930b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Apr 17 18:44:27 2019 +0000

    Bug 11514: Untranslatable "Uncertain" text in acq
    
    This patch modifies two pages so that the "Uncertain price" information
    is shown by the template rather than the Perl script, making the text
    translatable.
    
    To test, apply the patch and go to Acquisitions.
    
     - Locate or create an order in a basket which has an uncertain price.
     - When viewing the contents of that basket the order which was marked
       as having an uncertain price should be labeled "Uncertain."
     - The same should be true for the invoice page. If you don't have an
       existing invoice with an "uncertain" order,
       - Go to "Receive shipments" for the vendor your "uncertain" order is
         with.
       - Create a new invoice.
       - Receive one or more orders which has an uncertain price.
       - Press the "finish receiving" button.
       - In the "Invoice details" section of the invoice page you should
         see the "Uncertain" label on the correct order.
    
    Signed-off-by: Christophe Croullebois <christophe.croullebois@biblibre.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    For the invoice view: close, receive, reopen, mark prices uncertain, go
    to the invoice page (not sure it's expected however)
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e395844982d952d627dd40180f38303c50eb5402
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 6 14:45:12 2019 +0000

    Bug 23382: (RM follow-up) Ensure tests pass on Wednesdays
    
    Koha::Calendar assumes we never issue an item on a closed day.. this is
    a fair assumption but the hardcoded closed day in our tests means it
    does not hold true in this case.
    
    This patch sets the closed day dynamically to prevent such a case.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 137f4d167982c3be488592a573fc732644582877
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Nov 6 12:12:31 2019 +0000

    Bug 23523: (follow-up) Clarify meaning configurations in tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2e0a69609f0577829d089222d07747d33006b427
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Nov 6 12:09:11 2019 +0000

    Bug 23523: (follow-up) Adjust tests for new expectations
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b8a5194d24cb8ce5c2f7687376cdcd24cd52e67a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Nov 6 12:09:49 2019 +0000

    Bug 23068: (RM follow-up) Make Net::Netmask required
    
    Net::Netmask is used in the new Plack::Middleware::RealIP module, which
    is in turn used in the psgi plack startup script.  We don't have access
    to C4::Context inside the startup script and as such don't have access
    to the config to work out if loading this module should be optional.
    
    As such, I'm taking the easy route and just making the dependancy a
    required one. It's small and already packaged for debian and as such
    should not cause anyone any issues.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 622d4f713be7d3984443f4c5d3a25fd88671fa82
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Nov 5 14:18:28 2019 +0000

    Bug 23382: (RM follow-up) Revert "hours_between should match..."
    
    This reverts commit a693c7243c23f888e2fad38a4fff9f37ff4a9301 which
    caused regressions.
    
    The original loop compared start date to end date and iterated all the
    way to start date equals end date. The alternate implimentation
    inadvertantly looped from start date, skipped the first day then
    iterated up to one day beyond end date.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dda82b52a77411e3ab76b262a0c0a1d1d1a21638
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Nov 5 13:53:06 2019 +0000

    Bug 23050: (RM follow-up) Add Try::Tiny to controller
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9b2d782813589fe4cd30ce51f8f61428f7e82c3d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Nov 4 11:52:33 2019 -0300

    Bug 23050: (QA follow-up) Add Koha::Plugins::Tab class
    
    This minimal class encapsulates the tabs to be passed around to the
    templates, so error checking on missing bits is done in a single place.
    
    It throws exceptions on errors
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e7b3f8e362b2198233a92710b82a40fb1d534168
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 10:10:17 2019 +0200

    Bug 23050: Fix creation of biblio tab's id
    
    (Too much javascript in my head...)
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f981da7494cd094d45a5e21159642dd54f688bdb
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Jul 15 14:28:47 2019 +0200

    Bug 23050: Fix tab's id to avoid compatibility issues
    
    MDN says:
    
      Using characters except ASCII letters, digits, '_', '-' and '.' may
      cause compatibility problems, as they weren't allowed in HTML 4.
      Though this restriction has been lifted in HTML5, an ID should start
      with a letter for compatibility.
    
    https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/id
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 00db9a7624306c3f9282bce1a133b0e45396aeac
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Jul 15 14:10:25 2019 +0200

    Bug 23050: Add missing template filters
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d753993290a867752fcdd439fe65e94691a996fb
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Jun 5 16:26:34 2019 +0200

    Bug 23050: Plugin hook to add tabs in intranet biblio details page
    
    Test Plan:
    1) Enable plugins
    2) Download and install the latest version of this plugin
    https://git.biblibre.com/biblibre/koha-plugin-intranet-detail-hook
    3) Browse to catalogue/detail.pl for a record
    4) Note you see two new tabs with content
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 73c0100a3dfb542710fd338b15672cd122f02152
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Nov 4 20:25:11 2019 +0000

    Bug 23522: (QA follow-up) Typo fix in comment
    
    Tiny typo fix in a new code comment
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 39bc68c90b9e6ebdd880c4450b426ba30fe6f893
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Aug 29 14:51:16 2019 +0000

    Bug 23522: Show actual price on in baskets
    
    To test:
     1 - Create a new basket in acq, mark it as 'standing'
     2 - Add an item, leave the RRP and Vendor price as 0
     3 - Receive shipments for the vendor
     4 - Select the title from this basket
     5 - On receipt enter an actual cost
     6 - Finsih receiving
     7 - Go to the basket
     8 - Note the total for the order and the basket are 0, keep this browser tab open
     9 - Open a new browser tab and create a new non standing basket
    10 - Add to basket, again with no RRP or vendor price
    11 - Close the basket, receive the item
    12 - Enter an actual cost on receipt
    13 - Return to view the basket
    14 - Total and order are $0
    15 - Apply patch
    16 - Refresh the basket in both tabs
    17 - You now see the actual price for the orders
    
    Signed-off-by: Rhonda Kuiper <rkuiper@roundrocktexas.gov>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 025f9ebe80125fdfacf86f95274b249762384a7f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Nov 4 20:12:58 2019 +0000

    Bug 23523: (QA follow-up) Minor POD corrections
    
    This just fixes a couple of typos in the POD that predate this patch but
    I noticed whilst QAing this ;)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f601941b50eae7e1a09829313ed020afbf915c0f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Aug 29 18:42:24 2019 +0000

    Bug 23523: unitprice tax column values are not populated if entered upon ordering
    
    To test:
     1 - Add an item to an acquisitions basket
     2 - Make sure to enter 'Actual cost'
     3 - Check the db:
        SELECT * FROM aqorders WHERE ordernumber={your ordernumber}
     4 - Note that unitprice_tax_included and unitprice_tax_excluded are not populated
     5 - Apply patch
     6 - Edit that order
     7 - Check DB
     8 - Values should be populated
     9 - Place another order, ensude values populated on creation
    10 - QA people: prove -v t/db_dependent/Acquisition/populate_order_with_prices.t
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 549a09c52178937af28cc11c5bfa7f00cbced1b5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 24 12:29:23 2019 +0200

    Bug 23234: Mock DateTime->now using the time zone
    
    The timezone of the two dt was different, one was UTC, the other one was
    my local one.
    When we mocked DateTime->now we did not use the time zone, we must use
    dt_from_string instead
    
    Test plan:
    Make sure your environment has a different time zone than UTC
    `prove t/db_dependent/Circulation.t` should fail without this patch
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c4466e7d714d32808ee2e553320431005ec7cc69
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 21 08:51:15 2019 -0400

    Bug 23181: Unable to use payment library in ACCOUNT_PAYMENT or ACCOUNT_WRITEOFF notices
    
    Do to a simple semantic typo, the branches key will always be null for the tables key of the parameters for GetPreparedLetter.
    
    Test Plan:
    0) Activate UseEmailReceipts
    1) Attempt to use [% branch.branchname %] in the ACCOUNT_PAYMENT notice
    2) Note it produces no output
    3) Apply this patch
    4) Make another payment
    5) You should now see the branche's name!
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Also requires UseEmailReceipts to be activated.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 88db3b587e319f97f47e6699c1af1ac2acd0ae6d
Author: Katrin Fischer <katrin.fischer@bsz-bw.de>
Date:   Sat Nov 2 01:05:06 2019 +0000

    Bug 23181: Extend unit tests
    
    Run t/db_dependent/Accounts.t
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 323c57bf53dc929230b1c07645879636eb8f2077
Author: Jon Knight <j.p.knight@lboro.ac.uk>
Date:   Wed Aug 21 15:14:19 2019 +0100

    Bug 23429: ilsdi.pl GetRecords documentation does not match output
    
    Updated contents of Describe for GetRecords to match current behaviour.
    
    To test, ensure ILSDI is configured and then compare the output of:
    
    http://yourserver/cgi-bin/koha/ilsdi.pl?service=Describe&verb=GetRecords
    
    before and after applying the patch. Note that afterwards it includes
    things like <onloan> and has removed elements such as <date_due> that no
    longer get returned.
    
    https://bugs.koha-community.org/show_bug.cgi?id=23429
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 35670b0495e0333f57773b0375ea7aa1122d5372
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Nov 4 13:25:19 2019 +0000

    Bug 23963: Revert bug 21987 to restore image quality
    
    Bug 21987 had unexpected effects upon image quality for thumbnails.
    Currently, we are working to resolve those issues but have not managed
    to correct them inside the release window for this cycle. As such, I
    have chosen to revert the original bug whilst we work on a resolution.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 86e3a73e49dc5ad6bbe5488d6f3b26afb8ffab2e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Nov 4 13:21:16 2019 +0000

    Revert "Bug 21987: Add tests"
    
    This reverts commit afb39b132b10b74efec31cd8191cdcd72a61d8d3.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f5b6ad48e0a2ccccb62d811059bbd4c28ec0c7db
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Nov 4 13:21:13 2019 +0000

    Revert "Bug 21987: Do not generate true color thumbnails if not needed"
    
    This reverts commit 5c41d584cb654efbfd8c854bac0d30d87a054ab5.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dc9e2a4e6940ff75040fea976b53dc80d057e201
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Nov 4 13:21:09 2019 +0000

    Revert "Bug 21987: (RM follow-up) Add text for simple tests"
    
    This reverts commit 1464328718619a673f233406fdb238f0391b0785.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6ce9ce442d89f46a67d68aa55cb030b96131d46f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Nov 4 12:01:21 2019 +0100

    Bug 23903: (QA follow-up) Fix selenium tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3675e9cf78ba40c6efcf78742e62b88fda3646b2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Nov 4 10:43:49 2019 +0000

    Bug 22581: (RM follow-up) Add sysprefs to Search.t
    
    This patch adds explicit disablement of the sysprefs introduced by this
    bug to the Search.t test to silence warnings.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bd9c93da5479747ab3682d0761b4dfe5eeaf9a55
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Nov 4 10:09:40 2019 +0000

    Bug 23834: (RM follow-up) Add new file to Makefile.PL
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ebf7c6eacb09f3ec4d128eb4032e215d87238e64
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Sun Nov 3 08:14:08 2019 +0000

    Bug 22581: DBRev 19.06.00.048
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9cf52fe8912dd860da4c5b0b88e0acde41f405c5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Sun Nov 3 08:10:42 2019 +0000

    Bug 22581: (RM follow-up) Add License to about page.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 426a055a07a6b8c019d71831f1cf7aca512ee592
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon Oct 28 18:15:22 2019 -0300

    Bug 22581: Show and play musical inscripts
    
    This patch adds musical inscripts to OPAC's detail page
    
    To test:
    1. run previous patch test plan
    2. apply this patch
    3. edit a the marc structure of a MARC bibliographic framework, and in tag 031 enable the following subfiels to be visible in editor: 2, g, n, o, p, u
    4. search the catalog for a record that belongs to that framework, and edit tag 031 with the following:
       * 2:pe
       * g:G-2
       * n:xFCGD
       * o:3/8
       * p:'6B/{8B+(6B''E'B})({AFD})/{6.E3G},8B-/({6'EGF})({FAG})({GEB})/4F6-
       * u:http://nonexistent.org/url/of/a/midi
    5. save and click in opac view
    CHECK => even though you add a 031 tag there is no musical inscript shown in opac view
    6. in admin module enable OPACShowMusicalInscripts preference
    7. refresh opac view
    SUCCESS => it takes a few seconds to load, but you see a link that says 'Audio file' pointing to the URL you placed in 'u' subfield, and below you see the musical inscript
    8. in admin module enable OPACPlayMusicalInscripts preference
    9. refresh opac view
    SUCCESS => You see a play button below the musical inscript, and when you click, the song is played
    10. sign off
    
    Sponsored-by: Biblioteca Provincial Fr. Mamerto Esquiú (Provincia Franciscana de la Asunción)
    Co-authored-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 292262367ee39eb112b44b1dd27f8071521ab713
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon Oct 28 18:15:22 2019 -0300

    Bug 22581: Add new system preferences
    
    This patch adds 2 new system preferences:
    1. OPACShowMusicalInscripts - to toggle musical inscripts to appear in opac's detail page
    2. OPACPlayMusicalInscripts - to toggle musical inscripts to be transformed and payed in midi. Depends on OPACShowMusicalInscripts to be enabled.
    
    To test:
    1. apply this patch
    2. perl installer/data/mysql/updatedatabase.pl
    3. search for this new preferences in admin module
    SUCCESS => they appear in OPAC section.
    4. sign off
    
    Sponsored-by: Biblioteca Provincial Fr. Mamerto Esquiú (Provincia Franciscana de la Asunción)
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6ea1afa89a646b636a326166c7d1a37031d877b0
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Oct 17 13:46:42 2019 +0000

    Bug 23834: Add default ESLint configuration
    
    This patch adds a default ESLint configuration for use when editing
    JavaScript, as recommended in the coding guidelines:
    
    https://wiki.koha-community.org/wiki/Coding_Guidelines#JS8:_Follow_guidelines_set_by_ESLint
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6e1d759981b442b00306405ddb0c0c970dea9d29
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Thu Mar 28 13:37:13 2019 +0200

    Bug 22592: Add index scan emulation to Elasticsearch
    
    Adds support for using the "scan indexes" action in advanced search by using faceting with a prefix filter. Requires that the field be set as facetable for anything to be found.
    
    Test plan:
    1. Apply patch
    2. Go to advanced search and click "More options"
    3. Select author as the search field, enter a last name and check "Scan indexes"
    4. Perform search and observe the result list resembling scan results
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ce6ba9aac97689d296d46a200a95aa36a64a5201
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Oct 25 11:19:01 2018 +0200

    Bug 20194: Display both biblioitems.itemtype and items.itype in circulation screens
    
    Test plan:
    1. Verify that biblioitems.itemtype, items.itype are
       mapped to a MARC field. Otherwise create those mappings.
    2. Create a biblio with an itemtype
    3. Create an item with a different itemtype for this biblio
    4. Check out this item to a patron (P1)
    5. Verify that both itemtypes are displayed in the
    checkouts table (moremember.pl, circulation.pl, returns.pl)
    6. Create a patron whose guarantor is P1 and verify that both itemtypes
    and the ccode are displayed in the 'relatives checkouts' table
    
    Followed test plan, patch worked as described, also passes QA test tool
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8f23c95052ffd52885e849c9c004a3572ffb2226
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Sun Nov 3 07:46:29 2019 +0000

    Bug 23841: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 838dd983b2eca723f4c67f91b3825652ec3f8663
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Oct 21 12:00:03 2019 +0000

    Bug 23841: Add link to bibliographic details page in item details breadcrumbs
    
    This patch adds a link to the default bibliographic details page from
    the breadcrumbs menu on the item details page.
    
    The patch also makes a minor update to staff client CSS to allow for use
    of biblio-default-view.inc to generate the link and have it styled
    correctly.
    
    To test, apply the patch and update the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    Locate an record in the catalog and view the item details page. Verify
    that the breadcrumbs menu includes a link back to the bibliographic
    details page as defined in the IntranetBiblioDefaultView system
    preference.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b53e068651c521a989bd13387cef7fef8975d1e7
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Tue Oct 29 17:40:47 2019 +0000

    Bug 23506: Display correct icon in staff client and OPAC
    
    When the leader6 is set to 'i' the MARC21slim2intranetDetail.xsl
    attempts to display 'SO.png' which does not exist.
    
    TEST PLAN:
    1. Find or create a record with an 'i' as the 6th position in the 000 leader.
    2. Do to the OPAC detail page and staff detail for an item in that record.
    3. Notice the material type icon does not display because SO.png does not exist.
    4. Apply patch and restart_all
    5. Look at the opac detail and staff detail page again after clearning the browser cache.
    6. The material type icon now displays (MU.png), this is the same icon used on the OPAC results page.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b8d2d8658b7b8c7f70963c296428ee8cad49998
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Nov 1 15:38:49 2019 +0000

    Bug 23946: Remove Noun Project icons from the About page
    
    This patch removes the part of the About page which gives attribution
    for Noun Project icons on the staff client home page.
    
    To test, apply the patch and view the About page in the staff client.
    There should be no reference to Noun Project icons.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 374f59f3cd7bebc9fe7d8c7fd8eae5afda769bf4
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Oct 7 14:57:32 2019 +0000

    Bug 22661: TinyMCE/WYSIWYG editor doesn't translate
    
    This patch updates the TinyMCE editor to the latest version (5.0.16) and
    adds a translatable include file which will allow the TinyMCE interface
    to show the same translation as Koha.
    
    The configuration of the editor has been updated according to the new
    version's requirements, keeping all the tools available we had before
    and adding emoji support.
    
    To test, apply the patch and enable the UseWYSIWYGinSystemPreferences
    system preference.
    
    TESTING THE UPGRADED EDITOR
    
     - Go to Administration -> System preferences -> OPAC.
     - Multiple instances of the TinyMCE editor should appear on the page:
       opaccredits, OpacCustomSearch, OpacLoginInstructions, etc.
     - Test adding and editing content to one or more of these editors.
       Confirm that the various editor tools work correctly.
     - Verify that changing the contents of any editor (including via paste)
       enables the corresponding "Save all X preferences" button.
    
     - Test the news editor under Tools -> News.
    
     - Test the library "OPAC info" editor in libraries administration:
       Administration -> Libraries -> Edit library -> OPAC info.
    
    TESTING TRANSLATABILITY
    
     - Update a translation:
    
       > cd misc/translator
       > perl translate update fr-FR
    
     - Open the corresponding .po file for the staff client, e.g.
       misc/translator/po/fr-FR-staff-prog.po
     - Locate strings pulled from includes/str/tinymce_i18n.inc for
       translation, e.g.:
    
       #. SCRIPT
       #: intranet-tmpl/prog/en/includes/str/tinymce_i18n.inc:1
       #, fuzzy
       msgid "File"
       msgstr "Fichier :"
    
     - Edit the "msgstr" string however you want (it's just for testing) and
       remove the "fuzzy" line.
     - Install the updated translation:
    
       > perl translate install fr-FR
    
     - Go to Administration -> System preferences -> OPAC.
     - In each instance of the TinyMCE editor, the first menu item should
       have as its label the translation "msgstr" string you edited.
    
     - Check that the "About" page shows updated information about
       the TinyMCE version, 5.0.16.
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 687d3035eec7a99d1737dfdcc460a16dd4e2d476
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Fri Oct 18 12:56:43 2019 +0000

    Bug 23862: add enumchron to holds-table
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dfdf3a74454d3844b6ed82f549d67f25c7001ded
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 31 19:03:59 2019 +0000

    Bug 23938: Restore title display in last checked out box
    
    To test:
    1 - Check out to a patron
    2 - Note the display under the checkotu box does not have title
    3 - Apply patch
    4 - Checkout another item
    5 - Note the title displays
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e0a9cbd8a4446bb771d0a8104aa5e58e8da1dd60
Author: Bin Wen <bin.wen@inlibro.com>
Date:   Mon Oct 7 09:01:39 2019 -0400

    Bug 23762: Editing is_html status of email template fails under multi-languages
    
    To test:
    1.Enable multi-languages
    2.Set the preference 'TranslateNotices' on  'Allow'
    3.Go to: tools==>Notices & slips==>Edit (one notice)
    4.Click on the "Email" in the Default, uncheck the checkbox for 'HTML Messages'.
    5.Save
    6.Reopen the notice, nothing changed.
    7.Apply the patch
    8.Repeat the steps 4 and 5
    9.Success.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cce9d03bf911a2279a62e742f48fbe56be91e021
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Thu Oct 24 13:35:52 2019 +0300

    Bug 23089: Fix QueryBuilder tests.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a2ba8b6b23f482dcf8bbe53668d93519a11edf5
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 10 16:06:08 2019 +0000

    Bug 23089: Fix sorting on sum and regular fields
    
    As of bug 20589 we no longer analyze sort fields and so we no longer need to append ".phrase"
    to our sort in searches.
    
    Additionally, sort fields based on 'sum' should also use sum in building the value to sort on
    
    To test:
    0 - Be using ES
    1 - Find the most circulated item in your collection
    2 - Search for '*'
    3 - Sort by popularity DESC
    4 - Note that item is not first
    5 - Try to sort by anything but relevancy, it fails
    6 - Apply patch
    7 - Redo searches and sorts
    8 - Things should now work as expected
    
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fe4a9bdc94d1a1a7c89be645ee74b6c8991fadf1
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 10 16:05:50 2019 +0000

    Bug 23089: Unit tests
    
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f7325a6ed70fab67576eb0b5a74314d6a6191372
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Nov 1 13:09:31 2019 +0000

    Bug 23805: (RM follow-up) Remove CHECK constraints
    
    MariaDB and MySQL support different syntaxes for CHECK constraints at
    different versions. To remove complexities in the updatedatabase script
    I have opted to remove all CHECK constraints entirely.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7ddedd7b4266975d49e41481b8129f3efc5b0dfd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 13 18:24:32 2018 -0300

    Bug 21824: Add tests
    
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1bb3ed4f5b8ab81072dac85f41744c8f08c92477
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 13 12:36:17 2018 -0500

    Bug 21824: Add KohaDates method 'output_preference' to make it easy to store formatted dates in TT variable
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 67d6c469a98ec5b39dabfb6c38feaf560727fc6e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Nov 13 11:09:05 2018 -0500

    Bug 21824: Add ability to format dates in various formats in templates
    
    This patch adds the ability to set a date format for the Template Toolkit filter KohaDates
    
    Test plan:
    1) Apply this patch
    2) In a template, use the filter param "dateformat => 'iso'"
    3) Note the output is in ISO format
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4764c439f9e19e0b1a88a7503e2bb502dbd3b7ac
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Oct 10 12:53:10 2019 +0000

    Bug 22814: Make patron names on holds modal consistent (second check-in)
    
    Bug 22203 changed the behavior on the hold-found2 modal
    that pops up when a hold is found so that whether or not
    the patron's name is displayed is now governed by the
    HidePatronName system preference.
    
    However, if a hold is confirmed and you check the item
    in a second time, the modal that pops up is hold-found1
    and whether or not the patron's name is displayed in
    the hold-found1 modal is not governed by the HidePatronName
    system preference.
    
    For the sake of consistency, the display of the patron's
    name on hold-found2 and hold-found1 should both be governed
    by the HidePatronName system preference.
    
    To test:
    - Place a hold on an item
    - Check in the item to trigger the hold modal
    - Confirm hold
    - Check the item in again - verify name of patron displays
    - Apply patch
    - Repeat
    - Verify name display now matches between the two modals
    - change HidePatronName pref
    - Repeat
    - Name display should still match
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4fd52650bcb2f8a549ea55d22aadeeac7202d19d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 22 13:56:15 2019 -0300

    Bug 23860: Update tests to new style
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit abf530ddbf1897c6fc798f6fa94d643b55823d44
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 16:21:16 2019 -0300

    Bug 23860: Make the patrons endpoint add the Location header
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e1179b27e0ef7912364bc46ddf845b63443ef338
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 16:20:54 2019 -0300

    Bug 23860: Regression tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7f1f52f2e52705eacb428916a209d4c05bd9fd9d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 16:12:16 2019 -0300

    Bug 23859: Update tests to new style
    
    The /cities endpoint is refered in several places as the reference
    implementation of a route for devs to pick it for copy and pasting. Yet,
    it is outdated in terms of how the tests are written.
    
    This patch rewrites some bits so it uses BASIC auth and the built-ins
    Test::Mojo provides.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4de24b70e5d5cd2a4c5808509b6b47855a409dac
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 14:42:28 2019 -0300

    Bug 23859: Make POST add the Location header on cities endpoint
    
    According to the coding guidelines, this endpoint should be adding the
    Location header on POST actions.
    
    To test:
    1. Apply the tests patch
    2. Run:
        $ kshell
        k$ prove t/db_dependent/api/v1/cities.t
    => FAIL: Tests fail!
    3. Apply this patch
    4. Repeat (1)
    => SUCCESS: Tests pass!
    5. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bd7a012c524a7eb89283aabb1fefa956e47b79ee
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 14:41:59 2019 -0300

    Bug 23859: Regression tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c0b911c2d740951b2722a0f484b3848fd679ac25
Author: Nightly Build Bot <nightly@abunchofthings.net>
Date:   Fri Nov 1 00:28:04 2019 +0100

    Bug 17084: Automatic debian/control updates
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5dfbe1c8cd2c2d86bdf0017892c82d98e6c86b8d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 31 17:49:29 2019 +0000

    Bug 23805: (QA follow-up) Corrections for cash_register_stats
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f72087c3d4e6ee61a739a72613a3a6e5617fb7c8
Author: Nightly Build Bot <nightly@abunchofthings.net>
Date:   Wed Oct 9 00:26:59 2019 +0200

    Bug 17084: Automatic debian/control updates
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e0f44275b825fa6dec95acb750507d632d3ebf48
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 28 17:13:09 2019 +0000

    Bug 23805: (RM follow-up) updatedatabase.pl mariadb support
    
    MySQL and MariaDB have different syntax when it comes to dropping a
    CHECK constraint.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a6838a3e355797be3b100842b8b2dbde96224d24
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 6 15:35:10 2019 -0400

    Bug 23068: Add ability for Koha to handle X-Forwarded-For headers so REMOTE_ADDR features work behind a proxy
    
    Koha has a number of features that rely on knowing the IP address of the connecting client. If that server is behind a proxy these features do not work.
    This patch adds a module to automatically convert the X-Forwarded-For header into the REMOTE_ADDR environment variable for both CGI and Plack processes.
    
    TEST PLAN:
    1) Apply this patch set
    2) Install Plack::Middleware::RealIP via cpanm or your favorite utility
    3) Update your plack.psgi with the changes you find in this patch set ( this process differs based on your testing environment )
    4) Restart plack
    5) Tail the plack error log for your instance
    6) Use curl to access the OPAC, adding an X-Forwarded-For header: curl --header "X-Forwarded-For: 32.32.32.32" http://127.0.0.1:8080
    7) Note the logs output this address if you are unproxied
    8) If you are proxied, restart plack using a command like below, where the ip you see in the logs ("REAL IP) is what you put in the koha conf:
        <koha_trusted_proxies>172.22.0.1 1.1.1.1</koha_trusted_proxies>
    9) Restart all the things!
    10) Repeat step 6
    11) You should now see "REAL IP: 32.32.32.32" in the plack logs as the remote address in your plack-error.log logs!
    12) Disable plack so you are running in cgi mode, repeat step 6 again
    13) You should see "REAL IP: 32.32.32.32" as the remove address in your opac-error.log logs!
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Ed Veal <eveal@mckinneytexas.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 905993658372e664aa26ddc09da40c228622cc6a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 31 15:41:31 2019 +0000

    Bug 23903: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a6117a187df2d03bf6d7b4557ce3fe2e7fe8f2b6
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Oct 25 18:41:34 2019 +0000

    Bug 23903: Replace OPAC icons with Font Awesome
    
    This patch replaces CSS-based background image icons with Font Awesome
    icons. This will eliminate the use of sprite.png altogether.
    
    To test, apply the patch and regenerate the OPAC CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    Because JavaScript events are often triggered by class, the changes made
    in this patch require testing of JavaScript-driven behavior as well as
    visual confirmation of the changes.
    
    Enable OPAC features to expose them for testing: Login, Holds, Article
    requests, Tags, Cart, Search term highlighting.
    
     - Perform a search in the OPAC
       - In the header at the top of the search results, check the
         'Unhighlight/Highlight' link.
       - Select some search results and verify that the multi-item controls
         are enabled: Add to cart/Lists; Place hold; Tag. Check that these
         controls work correctly.
       - Verify that the following links look correct and work correctly:
         'Place hold,' 'Request article,' 'Log in to add tags,' 'Add to
         cart.'
       - Log in to the OPAC and return to the search results page. Check the
         'Add tag' and 'Save to lists' links.
    
     - View the lists page
       - Test the 'Edit' and 'Delete' controls.
       - View the contents of a list. Test the following:
          - Controls at the top of the table of results ('New list,'
            'Download list,' 'Send list,' 'Print list,' 'Edit list,' and
            'Delete list').
          - Multi-selection operations: 'Place hold,' 'Tag,' and 'Remove
            from list.'
          - Controls for each item on the list: 'Place hold,' 'Add tag,'
            'Save to another list,' 'Remove from this list,' and 'Add to
            cart.'
    
       - View the bibliographic detail page for any search result
         - In the right-hand sidebar menu, verify that these controls look
           correct and work correctly: 'Place hold,' 'Print,' 'Request
           article,' 'Save to your lists,' 'Add to your cart,'
          'Unhighlight,' 'Send to device,' 'Save record,' and 'More
          searches.'
         - Test the shelf browser by clicking 'Browse shelf' under the call
           number for any of the holdings.
           - Test the 'Next' and 'Previous' controls.
         - Check the tabs for switching between 'Normal,' 'MARC,' and 'ISBD'
           views and verify that they look correct on each of those pages.
    
     - Add some items to the Cart and open the Cart
       - Test the cart controls at the top: 'More details/Brief display,'
         'Send,' 'Download,' 'Empty and close,' 'Hide window,' 'Print.'
       - Test the multiple-selection controls: 'Remove,' 'Add to list,'
         'Place hold,' and 'Tag.'
    
     - Log in to the OPAC as a user who has items checked out which can be
       renewed. On the 'Your summary' page, on the 'Checked out' tab, test
       the 'Renew selected' and 'Renew all' links.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit de75e9a91c9bef559637ff93434993f353b2ed13
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Oct 25 18:25:28 2019 +0000

    Bug 23903: Font Awesome upgrade
    
    The switch to Font Awesome for more icons in the OPAC doesn't require a
    Font Awesome upgrade but this is a good chance to do it.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 23150020e67e32312649a391956f7edbd337ab49
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 31 14:38:10 2019 +0000

    Bug 14697: (RM follow-up) Add _type methods to ReturnClaim class
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bc8b8a7a6b08d602bf4e98255461d3b849d78a05
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 31 13:19:24 2019 +0000

    Bug 23630: (QA follow-up) Fix tests
    
    marc_records_to_documents is now an arrayref of hashes, not an arrayref of arrays
    
    _sanitise_records has been removed, we don't need those tests anymore
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a9bdeac01a732d29d32c0c6519bea3c835b49784
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 31 12:21:01 2019 +0000

    Bug 22706: (RM follow-up) Add unit tests
    
    Helps if one actually adds the new test file to the commit!
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eec93f0628d524f08860f0c727141e2e7c072d5b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 31 12:16:46 2019 +0000

    Bug 14697: DBRev 19.06.00.047
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 469b419adb6375dce2f7a4e52938c51605d491ff
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Oct 30 18:00:53 2019 +0000

    Bug 14697: (QA follow-up) Remove tab chars
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit df2a054681cca94700998ce2d142bc11212a592b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Oct 30 12:17:15 2019 -0300

    Bug 14697: (follow-up) Add auth values to the sample data
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit efa8ef9dcb5fb0bd1710c0c2866c320fbd2e084f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 29 17:43:13 2019 -0300

    Bug 14697: (QA follow-up) Restore FK on issue_id and adjust tests
    
    This patch reintroduces the FK constraint on issue_id. The tests are
    adjusted to reflect the UNIQUE constraint we also added.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 93143b207fb2647449a0a0e3446e7aeacb8ddae8
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 29 15:57:06 2019 -0300

    Bug 14697: (QA follow-up) Add missing AV category
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bfcbe72edbeed0cfbbd403a1c19427bee11eac46
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 29 15:38:48 2019 -0300

    Bug 14697: (QA follow-up) Organize tests in subtests
    
    This patch organizes the tests better, and adds some more.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9dbf0ff0e0ea968fa408fc6e12bfbc943ceb9f26
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 29 10:27:18 2019 -0300

    Bug 14697: Make controller methods rely on the stashed user
    
    This patch adjusts the return values and HTTP status codes, as well as
    removing the use of C4::Context->userenv. It also makes the date
    calculation happen on the DB engine in the case of resolving the claim.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40e841da984f0aeb13a4632ce83a638cee47a434
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 28 16:18:52 2019 -0300

    Bug 14697: (follow-up) Rely on the UNIQUE constraint and return 409 for issue_id
    
    This patch avoids querying the DB for an already existing
    Koha::Checkouts::ReturnClaim with the same issue_id, now that there's a
    UNIQUE constraint on it.
    
    Also, 409 should be returned instead. Tests added for this changes.
    
    To test:
    - Apply this patch
    - Run:
      $ kshell
     k$ prove t/db_dependent/api/v1/return_claims.t
    => SUCCESS: tests pass!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a670f9068d982d3f905967255006faf871cdaf4f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Oct 29 12:32:15 2019 -0300

    Bug 14697: Schema updates
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 291f03fe65da4476b33adf9f9e7e533668b9a313
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Oct 29 12:29:54 2019 -0300

    Bug 14697: Enhance the return claims feature
    
    This adds a "Claims returned" feature that extends and enhances the claims returned lost status.
    To use this feature, a new LOST status to represent an item claimed as returned needs to be created.
    The value of this LOST authorised value should be set in the new syspref ClaimReturnedLostValue.
    Setting this system preference turns on the feature.
    
    Once the feature is enabled, you should be able to mark checked out items as return claims from the
    checkout and patron details pages, and also modify them from the new claims tab on those pages.
    
    Returning a claimed item will notify the librarian that the item in question has a claim on it.
    
    Setting the ClaimReturnedWarningThreshold will add an alert to make librarians aware that this
    patron has many return claims on the patron's record.
    
    Test Plan:
    1) Create a "Claims Returned" lost value
    2) Create some RETURN_CLAIM_RESOLUTION authorized values
    3) Set ClaimReturnedLostValue
    4) Set ClaimReturnedChargeFee
    5) Set ClaimReturnedWarningThreshold
    6) Create some checkouts
    7) Claim some returns
    8) Verify ClaimReturnedChargeFee works with all 3 options
    9) Verify ClaimReturnedWarningThreshold shows a warning once the threshold has been exceeded
    10) Edit notes on a claim
    11) Resolve a claim
    12) Delete a claim
    
    Sponsored-by: North Central Regional Library System
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a44ffa0926d648b4b1509c56e3227784f5404942
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Oct 29 12:29:37 2019 -0300

    Bug 14697: Add routes to handle return claims
    
    This patch adds the /return_claims route to add new return claims, and
    then routes to updates notes and the resolution code.
    
    To test:
    1. Apply this patches
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/return_claims.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 15d95a74e4712139ae7b377a5879d66e6d0d5277
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Oct 29 12:28:53 2019 -0300

    Bug 14697: Add Koha::Patron->return_claims
    
    Adds the ability to get a list of a patron's return claims directly
    from the Patron object.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f08de08858f570fcf836051f490cf661142e2388
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Oct 29 12:28:36 2019 -0300

    Bug 14697: Add Koha::Checkout->claim_returned
    
    Adds the ability to generate a return claim from a Checkout object.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e97887bcbbbda9a84a9386719db242bb5043f428
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Oct 29 12:28:24 2019 -0300

    Bug 14697: Add return claim handling to AddReturn
    
    This adds the ability to alert a librarian of an item claimed as returned is actually returned.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e89c5bfed6a75d7222c8328e2b4371066ee06ff3
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Oct 29 12:26:56 2019 -0300

    Bug 14697: Introduce Koha::Checkouts::ReturnClaim(s)
    
    This patch introduces the Koha::Object(s)-derived classes for handling
    return claims. Tests are added to cover the overloaded ->store method,
    and domain-specific exceptions are added as well.
    
    To test:
    1. Apply this patches
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Checkouts/ReturnClaim.t
    => SUCCESS: Tests pass!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2e09dc9319bd95e479879a52fbbe3e8c934e741f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Feb 22 09:40:35 2019 -0500

    Bug 14697: Add new schema file
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e2eaafd939ffdeeae3ae02814dc81eb015f04808
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Feb 22 08:46:34 2019 -0500

    Bug 14697: Update database
    
    This patch introduces the new table and related sysprefs.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c76c509d830b48e009f55d7da23faf3baba600a5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 31 11:56:46 2019 +0000

    Bug 15260: DBRev 19.06.00.046
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2af0bfd57cabde7cc0e7ed49bcd27c3b09c52924
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Fri May 17 12:06:48 2019 +0100

    Bug 15260: (follow-up) Add missing POD
    
    As per comment #33
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5756adc3a3c4308a624aadbf91a5848a7af19d96
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Mon May 6 17:18:57 2019 +0000

    Bug 15260: (QA follow-up) Fix updatedatabase message
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ccc7f398491d0af7113d6548e5a38ed8f54c4a1f
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Wed May 1 12:12:14 2019 +0100

    Bug 15260: (follow-up) Fix bug in subtraction
    
    prev_open_days can receive either positive or negative numbers and
    then does the right thing with them. However, we weren't also doing this
    with the number it receives back from get_push_amt
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dad33de660724bc31684f64c7719afe48a7c3022
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Fri Apr 12 12:31:31 2019 +0100

    Bug 15260: (follow-up) Fix misnamed variable
    
    This was causing the amount to push by to be incorrectly calculated
    
    Sponsored-by: Cheshire West and Chester Council
    Sponsored-by: Cheshire East Council
    Sponsored-by: Newcastle City Council
    Sponsored-by: Sefton Council
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bca351113d8226345d9773c2a6a83abfbedfd790
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Tue Mar 26 14:43:34 2019 +0000

    Bug 15260: Fix calculation of add amount
    
    In a sequence of closed days, we should take into account the nature
    of each closed day as we encounter it in order to calculate the amount
    to add to reach the next potential closed date. We are now doing this.
    
    Sponsored-by: Cheshire West and Chester Council
    Sponsored-by: Cheshire East Council
    Sponsored-by: Newcastle City Council
    Sponsored-by: Sefton Council
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d39c14561ff7704034ac0b3c8ecba58c3b6e880b
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Mon Feb 4 15:11:34 2019 +0000

    Bug 15260: Add unit tests
    
    This patch adds unit tests of the CalcDueDate function to ensure that
    the useDaysMode "Dayweek" mode works as expected
    
    Sponsored-by: Cheshire West and Chester Council
    Sponsored-by: Cheshire East Council
    Sponsored-by: Newcastle City Council
    Sponsored-by: Sefton Council
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f9dcd9921fa20e396ddb8b6c22a06cef61154b84
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Fri Feb 1 14:07:01 2019 +0000

    Bug 15260: Implement weekly rollforward
    
    This patch will, when appropriate, roll due dates forward by full weeks,
    rather than single days.
    
    Sponsored-by: Cheshire West and Chester Council
    Sponsored-by: Cheshire East Council
    Sponsored-by: Newcastle City Council
    Sponsored-by: Sefton Council
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 780f79ae1aecbf74f8438bcf6d8e76f0fb40c752
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Fri Feb 1 12:24:54 2019 +0000

    Bug 15260: Modify next/prev_open_day
    
    We require next_open_day & prev_open_day to be more flexible. We could
    create a separate sub, but that's not very DRY given that they'll do
    pretty much the same thing.
    
    So next_open_day becomes next_open_days and prev_open_day becomes
    prev_open_days and both functions accept an additional parameter which
    determines how many days they add or subtract.
    
    All calls of these two functions have been modified accordingly.
    
    Sponsored-by: Cheshire West and Chester Council
    Sponsored-by: Cheshire East Council
    Sponsored-by: Newcastle City Council
    Sponsored-by: Sefton Council
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bf101f745c135a7295281b3c13e35080d4f18c41
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Fri Feb 1 11:42:24 2019 +0000

    Bug 15260: Modify description of Dayweek option
    
    Sponsored-by: Cheshire West and Chester Council
    Sponsored-by: Cheshire East Council
    Sponsored-by: Newcastle City Council
    Sponsored-by: Sefton Council
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2e6312e55deabd4c51b8f5f5678b2d4c72a238e0
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Thu Jan 31 15:36:52 2019 +0000

    Bug 15260: Add new useDaysMode option "Dayweek"
    
    This patch adds a new "Dayweek" option to the useDaysMode syspref, it
    has the description: "the calendar to push the due date to the next open
    day on the same weekday".
    
    Sponsored-by: Cheshire West and Chester Council
    Sponsored-by: Cheshire East Council
    Sponsored-by: Newcastle City Council
    Sponsored-by: Sefton Council
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ae92e4456423ba615cd44234de6b9fb309aa5025
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 31 11:37:33 2019 +0000

    Bug 23866: DBRev 19.06.00.045
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 66179ffd9b8f3b0bf3f203b046487089b76d0866
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 13:57:42 2019 +0100

    Bug 23866: Prompt for HEA configuration
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d3444b3728200358b9c2d7ef6da6d0db0dc9753c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 31 11:22:09 2019 +0000

    Bug 22706: (RM follow-up) Add unit tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1d54596bd3edd296061cdb5526d17eb266e6939d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 31 10:50:07 2019 +0000

    Bug 22706: (RM follow-up) Restore ability to create disabled accounts
    
    The patchset inadvertantly disabled the ability to create disabled user
    accounts when any check_password plugin was installed.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dffa5d9ba8d16ee10794617dacb3c985c690775b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 31 10:11:07 2019 +0000

    Bug 22706: (RM follow-up) Remove use of Koha::Plugins::Handler
    
    Using both Koha::Plugins and Koha::Plugins::Handler inside the same
    class causes issues for runtime module loading which in turn caused all
    the plugins tests to fail.
    
    This patch converts this patchset to use the direct call style used
    elsewhere in Koha removing the need for Koha::Plugins::Handler.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 58da3de84ada910098024e535a7d2bbaf6caf84b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 23 12:48:14 2019 -0300

    Bug 23667: Add route to GET /items
    
    This patchset introduces a route to fetch items. It relies on the
    already implemented code/mappings to get a single item.
    
    To test:
    - Apply this patches
    - Run:
      $ kshell
     k$ prove t/db_dependent/api/v1/items.t
    => SUCCESS: Tests pass!
    - Try the endpoint with your favourite API tool (Postman?)
    - Sign off :-D
    
    Note: to do exact searching on barcode, you need to build the query like
    this:
    
    GET /api/v1/items?external_id=<your_barcode>&_match=exact
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2ae0cc83f301e5e0215b35350eea39607f93e688
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 23 12:48:02 2019 -0300

    Bug 23667: Add spec
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d2b33bcac3f273ee08c1d1b5f2e6f0b922a99b3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 24 14:41:19 2019 +0100

    Bug 22706: (QA follow-up) Restore location of logaction
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c98c1994ea96c90914b8259cc6f6eb0537bafb4c
Author: Magnus Enger <magnus@libriotech.no>
Date:   Wed Apr 24 14:59:03 2019 +0200

    Bug 22706: Add plugin hooks for Norwegian national patron database
    
    The main point of this patch is to make it possible to integrate Koha
    with the Norwegian national patron database (NNPDB). Code for this was
    earlier introduced in Bug 11401 and removed again in Bug 21068.
    
    To test this is mainly a question of spotting regressions, it should
    still be possible to set and change a password in all possible ways:
    - Setting a password for a new user
    - Changing a password in the staff client
    - Changing a password in the OPAC
    If these work as expected, everything should be OK.
    
    A nice side effect of this work is that it will allow for plugins that
    validate passwords. I have created a tiny plugin that enforces PIN
    codes of 4 digits. (Yeah, I know, those are the worst passwords, but
    some libraries do require them.) It is published here:
    https://github.com/Libriotech/koha-plugin-pin
    To test this way, install the plugin and try to change the password
    of an exsisting user to something that is not a 4 digit PIN. You
    should get an error that says "The password was rejected by a plugin".
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    
    Updated 2019-10-23:
    - Moved the plugin checks to before the call to $self->SUPER::store to
      make sure patrons are not saved if the password fails a plugin check
    - Made the plugin checks in set_password respect skip_validation while
      retaining the functionality for NNPDB
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2a3429b65d47163a98a47f98458ce5c7262421a5
Author: Caroline Cyr La Rose <caroline@inlibro.com>
Date:   Mon Oct 21 10:25:55 2019 -0400

    Bug 23853: Typo in authorised_values.tt
    
    This patch corrects the Bsort1 typo in authorised_values.tt and changes the Bsort2 description to match Bsort1's.
    
    To test:
    1- Go to Administration > Authorised values
    2- Make sure descriptions for Bsort1 and Bsort2 match their category and are the same (except for 1 and 2)
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 44c44b28d4ab0fc7daf9c76c643cba6e6a204634
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Sat Sep 21 11:33:47 2019 +0000

    Bug 23663: Only process itemtype summary if using non-xslt opac results
    
    To test:
    1 - Set OpacXSLTResultsDisplay to "" to use non-xslt view
    2 - In Administration->Itemtypes define a summary for an itemtype:
        This is the summary for [245a]
    3 - Perform a search on the opac that will return results with this itemtype
    4 - Note "This is the summary" appears in results with the title
    5 - Set OPACXSLTResultsDisplay to 'default'
    6 - Refresh your search results, note the summary disappears
    7 - Try search in other places and note that summary never appears
    8 - Apply patch
    9 - Repeat 1-7 and note nothing changed
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8c94bdcd16d28d966b6b39798b212d9fcf7605e7
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu Jun 8 16:22:55 2017 +0200

    Bug 18757: Problem when importing only items in MARC records
    
    When importing records with Stage MARC records for import, one can use matching rules to only import items into existing records.
    Those imported items are stored as XML to be staged.
    
    The bug is that when MARC Flavour is UNIMARC the XML serialization fails because its is looking in field 100$a which does not exist.
    You see in logs the error : Unsupported UNIMARC character encoding [] for XML output for UNIMARC; 100$a
    
    This patch adds the format "USMARC" to XML serialization, like in C4::Items::_get_unlinked_subfields_xml
    
    Test plan :
    - On a UNIMARC database
    - Define a maching rule on title 200$a
    - Select a record with items
    - Export it using : Save as > MARC (Unicode/UTF-8)
    - Delete all items
    - Go to Tools > Stage MARC records for import
    - Upload exported file
    - Select title matching rule
    - Select "Ingore incoming record" in "Action if matching record found :"
    - Select Yes and "Always add items" in "Check for embedded item record data?"
    - Click Stage for import
    => Without patch you get the error
    => With patch the import is staged
    - Import into the catalog and check item is well recreated
    
    Signed-off-by: Amandine Zocca <azocca@ville-montauban.fr>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fb083813a8237691f0b9d419d826fdea58096cd4
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu Sep 19 16:55:51 2019 +0200

    Bug 23630: Do not remove field 999 in Elasticsearch indexing
    
    Elasticsearch indexing uses 999$c to store record id by deleting the all field first !
    So you can not store anything in field 999, even in UNIMARC and even in authorities records.
    
    Looks like it is quick fix code added to start Elasticsearch use.
    
    This behavior is disturbing and very strange for UNIMARC flavour.
    
    This patch corrects by defining record ids mandatory in Koha::SearchEngine::Elasticsearch::Indexer::update_index().
    This ids array is actually always given (except in UT).
    I think it is useless to allow adding a record without its id.
    
    Test plan :
    1) Use Elasticsearch as SearchEngine
    2) Create a subfield 999$z in default framework
    3) Create a record with default framework
    4) Enter a random string (never used in catalog) like "tototata" in 999$z
    5) In Search engine configuration, define search field "subject" for 999$z
    6) Rebuild record : misc/search_tools/rebuild_elasticsearch.pl -b -bn <biblionumber> -v
    7) Search for the random string => You get a result
    8) Optionnaly look at records in ES : <es server>:9200/<es index name>/data/<biblionumber>
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fe5c65c5cd1a797324a8c3c28d66e691a6d68b1a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 2 10:21:36 2019 +0000

    Bug 22826: Allow indexing of individual authorities in Elasticsearch
    
    To test:
    1 - perl misc/search_tools/rebuild_elastic_search.pl -h
    2 - Note it indicates the bn option can be passed to index individual authids
    3 - perl misc/search_tools/rebuild_elastic_search.pl -a -bn 92 -v
    4 - Note the error
    5 - Apply patch
    6 - perl misc/search_tools/rebuild_elastic_search.pl -h
    7 - Note new option ai|authid for indexing individual authids
    8 - Note updated text for bn|biblionumber option
    9 - perl misc/search_tools/rebuild_elastic_search.pl -a -bn 92 -v
    10 - No errors, but no records indexed
    11 - perl misc/search_tools/rebuild_elastic_search.pl -a -ai 92 -v
    12 - 1 record indexed
    13 - perl misc/search_tools/rebuild_elastic_search.pl -ai 92 -bn 92 -v
    14 - 1 authority record and 1 biblio record indexed
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b930c3f9d74a98096571134e3fca14d064d16cb
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 28 12:43:02 2019 +0000

    Bug 22445: (RM follow-up) Build CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 11c9fe380577e3e06aafefa25aad490975aaebeb
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Fri Jul 12 01:30:47 2019 +0000

    Bug 23310: Reduce noise in Koha::Biblio
    
    The use of uninitialized value flooding plack-error
    can get rather distracting and annoying.
    By using "// q{}" after each of the subfield() calls
    this eliminates the problem
    
    TEST PLAN
    ---------
    vertical break where you stop your cut-and-paste.
    This test should be repeatable with cut-and-paste
    easily.
    
    restart_all
    kshell
    
    prove t/db_dependent/Koha/Biblio.t
    -- may strangely be quiet.
    
    prove t/db_dependent/Koha/Biblios.t t/db_dependent/Koha/Biblio.t
    -- should be noisy.
    
    prove t/db_dependent/Koha/Biblio.t
    -- will always be noisy now.
    
    exit
    git bz apply 23310
    
    restart_all
    kshell
    
    prove t/db_dependent/Koha/Biblio.t
    -- will be quiet.
    
    prove t/db_dependent/Koha/Biblios.t t/db_dependent/Koha/Biblio.t
    -- will be quiet.
    
    prove t/db_dependent/Koha/Biblio.t
    -- will be quiet.
    
    qa -v 2 -c 1
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 618d8a690ee73327bd11ca30680be3f93132d74d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 14:32:25 2019 -0300

    Bug 23858: (follow-up) Return code fix
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8ac459777b13275581b7060d60cf28674bb24157
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 14:23:15 2019 -0300

    Bug 23858: Make POST add the Location header on vendors endpoint
    
    According to the coding guidelines, this endpoint should be adding the
    Location header on POST actions.
    
    To test:
    1. Apply the tests patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/acquisitions_vendors.t
    => FAIL: Tests fail!
    3. Apply this patch
    4. Repeat (1)
    => SUCCESS: Tests pass!
    5. Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 081b72c08f9279970e5364b0f86ff0b41cc6d871
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 14:22:26 2019 -0300

    Bug 23858: Regression tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6c57eca17acc78133619362ac97a32b50d6a24ae
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Oct 4 15:00:19 2019 +0000

    Bug 22114: Untranslatable "Patron note:" in checkout.js
    
    This patch modifies JavaScript used in circulation, replacing an
    untranslatable English string in the script with a variable defined in
    strings.inc which can be translated.
    
    To test you should have the AllowCheckoutNotes system preference
    enabled.
    
     - Apply the patch and log in to the OPAC as a user who has two or more
       items checked out.
     - From the list of checkouts on the "Your summary" page, add a note to
       two or more checked-out items.
     - Log in to the staff client and open the checkout page for that user.
       - In the table of checkouts, check the "Check in" checkbox next to
         one of the titles you added a note to.
       - Click "Renew or check in selected items."
       - A message should appear in that table row showing your note,
         prefixed with the text "Patron note:"
    
    To test translation, update and install the de-DE template:
    
     > cd misc/translator
     > perl translate update de-DE
     > perl translate install de-DE
    
     - Go to Administration -> System preferences and enable the "Deutsch
       (de-DE)" language under I18N/L10N preferences -> language.
     - Switch to the "Deutsch" translation.
     - Go to Ausleihe (Circulation) and check out to the same patron.
       - In the table of checkouts, check the checkbox in the "Rückgabe"
         column next to another title you added a note to.
       - Click the "Markierte Exemplare zurückgeben oder verlängern" button.
       - A message should appear in that table row showing your note
         prefixed with the text "Benutzernotizen:"
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7df185c7838f415b40de2e8f3ec918e96f8481cb
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu May 9 12:39:51 2019 +0000

    Bug 22874: Use false instead of 0 value for limiting on availability
    
    Test plan
    
      - Set up a elasticsearch 6 instance to work with Koha,
      - you may need to make koha works with ES 6 (see bug 20589),
      - make a search and limit it to available items only,
      => no result
    
      - Apply this patch,
      - make a search and limit it to available items only,
      - you should get some results
    
      - Do the same with ES 5.x
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c474b164565bac384b713ffc1b8622fc88567217
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 14 09:51:35 2019 +0200

    Bug 23525: (bug 19289 follow-up) Use biblio's framework not ACQ
    
    This patch restores the behavior prior to
      commit 84ce1fb5921cdddf2368f0c330dede0f602742d0
      Bug 19289: Use the ACQ framework to display bibliographic details
    
    Test plan is hard to provide for such a simple and obvious change. I
    would recommend you to read the previous commit and confirm that the
    change did not make sense.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1823316503331bcfffbf1e96528f53b66a8893b7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 28 12:18:04 2019 +0000

    Bug 23382: (RM follow-up) Days of the week discrepancies
    
    DateTime and C4::Calander have different notions of 'days of the week'.
    
    DateTime days go from 1..7 (Mon..Sun) whilst C4::Calendar expects 0..6
    (Sun..Sat).  This patch adapts the holday setting in the tests to ensure
    we work when testing Saturdays and Sundays.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1d275e64f044ad4eae5e29e3c410b60961d769e0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 17 17:16:58 2018 +0100

    Bug 20595: Add handling for LRP field in EDI
    
    * EDI.pm - Add handling of the LRP EDI field to automatically add an
    item to a stockrotation rota.
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8387d6a2d242c4b60e858c5a42574ec7928f3ecf
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Sat Oct 26 11:58:18 2019 +0100

    Bug 23655: Restore debian Jessie support
    
    Bug 14570 inadveratntly introduced the use of selectall_array; A feature
    that was introduced to DBI version 1.635 which is not available in
    debian jessie at the time of writing.
    
    This patch replaces the call with selectall_arrayref which is supported
    and works with the rest of the existing code.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d4af82d411613f4d12d5e3e31de399aa43355cb4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Oct 25 15:28:49 2019 +0200

    Bug 23382: Use floating time zone to prevent tests to fail because of DST
    
    Today Friday Oct 25th, DST next Sunday => Date math are wrong, 96 hours
    diff becomes 95.
    To avoid that we use the floating timezone
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a5bf7b1e558ea38998d4661f074e99d028178c96
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 25 11:29:58 2019 +0100

    Bug 23382: (follow-up) Ensure closed day is inside charge window
    
    We're testing with an hourly loan of 96 hours to catch a closed day.
    However, our closed day was hard coded to be a Wednesday so if you ran
    the tests on a Friday the 96 hour loan would not catch a Wednesday.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a693c7243c23f888e2fad38a4fff9f37ff4a9301
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 16 13:10:43 2019 +0100

    Bug 23382: hours_between should match the logic of days_between
    
    The loops for subtraction holiday dates in hours_between and
    days_between differed and as such their handling of start and end
    boundaries for days also differed.  This patch makes them handle the
    boundary days consistently.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bbdee010aa192ec0df436a79730343df2b855ff4
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 16 13:08:23 2019 +0100

    Bug 23382: Truncate dates to minutes for comparison.
    
    It's somewhat of a mess in C4::Circulation as to when dates are
    truncated and when they are not and as such Koha::Charges::Fees could
    not reliably assume that the dates passed in were consistent with each
    other. As such, we take the approach of always truncating to the
    greatest minute smaller than the passed in dates so we are comparing
    like for like.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8f3093c9a09c9c88b6885ac79b8273cf212f6f65
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 16 11:44:11 2019 +0100

    Bug 23382: (follow-up) Further improve test coverage
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 080958231e02c7e1139aea33cbe20baa184d4c4b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 2 11:20:27 2019 +0100

    Bug 23382: (follow-up) Ensure tests pass on Wednesdays
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit af9333292799695b5322a5cf1598e12f08f0a66c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Sep 19 14:48:45 2019 +0100

    Bug 23382: (follow-up) Clarify variable names
    
    This patch updates the variable name '$branch' to '$branchcode' in a
    number of places to make it clearer what the variable contains.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f8e2c489cb668aab9e7484c2dd67c1c05f37b2a5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Aug 16 08:32:55 2019 +0100

    Bug 23382: Fix logic in C4::Circulation::CanBookBeIssued
    
    It looks like over progressive rebases of bug 20912 a clause was lost
    within CanBookBeIssued such that a fatal error may be triggered if an
    item with no corresponding itemtype was passed into the routine.
    
    Additionally the we were passing a Koha::Library object to CalcDateDue
    rather than a branchcode which resulted in a different duedate being
    used in 'CanBookBeIssued' when compared to 'AddIssue'.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9063d05662ead802ebb8bbb53730834e6ea5e458
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Aug 15 14:57:08 2019 +0100

    Bug 23382: Add hourly tests for Circulation
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 34e5391d9080f6e9c7bef48878ab888510aca7d0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Aug 6 15:23:39 2019 +0100

    Bug 23382: Add tests for hourly calculations
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 28055d334741f8045423f9ac54106050e6b40d01
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Aug 6 14:38:28 2019 +0100

    Bug 23382: Improve test coverage
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a53641328c7f20ae5de9de246fb6f3a1d3edf80c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Sat Oct 26 07:48:49 2019 +0100

    Bug 23805: (follow-up) Database update corrections
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 75fa214835497bf167cacefabb6c5999ab302439
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Oct 25 18:22:01 2019 +0000

    Bug 17168: (QA follow-up) Only remove guarantor relationship if not Child AND not Professional
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2fba65eb4d8fcb61c73c70855a96d915a65e82b0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 25 17:02:59 2019 +0100

    Bug 17168: (RM follow-up) Update for bug 14570
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c1fe8d1206de84c9349fae8e0f380f334a3ddf6f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jul 19 21:21:06 2019 +0000

    Bug 17168: (follow-up) QA concerns and rebase issues
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3cc10b7e9730fdf167ebbb30336b4fb63891035b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Apr 25 19:23:58 2019 +0000

    Bug 17168: Remove j2a.pl
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 006107c429f9541e05f6fcf7d50a26e7226f0923
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Apr 25 19:23:36 2019 +0000

    Bug 17168: Add Koha:Script -cron, remove Dumper
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 436ad74399c5ca14cbbeaa21c6de82a08ea878ee
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Feb 28 08:56:04 2019 -0500

    Bug 17168: (follow-up) Address QA concerns and update for strict mode
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 424df02e23d6f96e9b35c11169308d38e99d4d6f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jul 16 11:03:57 2018 +0000

    Bug 17168: (follow-up) Clean up QA errors
    
    Cleanup variable names
    Remove Dumper
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7226ad5ead034e6376cc8f1439e64d145c66cef
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 31 10:55:18 2018 +0000

    Bug 17168: (follow-up) Tidy, clean params/options, use date tools
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit af15cbbe1b470110f9e3e901a5e8d56153f10dfe
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Feb 15 16:34:04 2017 +0000

    Bug 17168: Add a command line script for updating patron category based on status
    
    This patch adds a new script update_patrons_category.pl which allows for
    updating patron categories in a batch upon meeting provided criteria.
    This script additionally can replace j2a.pl.
    
    To test:
    1 - perl update_patrons_category.pl -h
    2 - Ensure help text makes sense and covers all options
    3 - Test converting patrons supplying only fromcat and tocat
        perl update_patrons_category.pl -f PT -t J -v --confirm
        perl update_patrons_category.pl -f J -t PT -v --confirm
    4 - All patrons should have been switched to and from Juveniles
    5 - Try without --confirm switch
        perl update_patrons_category.pl -f PT -t J -v
    6 - Should list all patrons but not update
    7 - Set the age for juvenile patrons to be outside the range provided in
    categories (or set the upper age limit for juveniles to '2')
    8 - Test with verbosity and with without --confirm
        perl update_patrons_category.pl -f J -a -t PT -v
        perl update_patrons_category.pl -f J -a -t PT -v --confirm
    9 - Repeat above and verify linked/unlinked guarantors are removed in above scenario
    10 - Test various fine and registration limits
    11 - Test matching on specific fields i.e. --field surname=acosta
    12 - Sign off
    
    Sponsored by: Round Rock Public Library
    (https://www.roundrocktexas.gov/departments/library/)
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 70a59fc694866154fce74eeaf08ee2126f34947f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Oct 25 11:31:46 2019 +0000

    Bug 23529: (QA follow-up) Fix closing bracket, add label
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 370ee3203e2325f6f5db6771775ac4b55d82c874
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Thu Oct 24 12:26:44 2019 +0100

    Bug 23529: (follow-up) Fix syntax error
    
    As mentioned by Magnus in comment #8
    
    Sorry Magnus, definitely fixed this time!
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04e9885c0f18fda2363818d4b0f2453a3aff4923
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Mon Sep 2 09:29:14 2019 +0100

    Bug 23529: Narrow scope of changed
    
    Whilst working on something else, it came to light that the previous fix
    in bug 23229 was waaaaay too heavy handed and basically kills all ILL
    related JS :( This is obviously a big problem, this patch fixes that.
    
    The main problem is that all the ILL related JS is in a single file,
    which isn't ideal as bits of it are used on different pages. Ideally,
    we'd refactor it out into more manageable chunks which can be included
    as required. Until such a time, this patch will do, it just prevents the
    "get all requests" AJAX request unless you're on the ILL list page.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4274a2f51dcf0e7ee0dfebc805036ddbc7f3e4fa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Oct 20 10:16:51 2019 +0200

    Bug 18743: Correct number of pending suggestions (acq home page)
    
    This patch could be moved to its own bug report if we want to adjust
    tests.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9f16ab9e758aeb1a9e64bde03c6c8dcfb7f6e094
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 16 16:43:46 2019 +0200

    Bug 18743: Fix suggestion listing when organized by library
    
    There are some weird behaviors happening when using the "Organize by:
    library" dropdown along with the library filter (in the "Acquisition
    information" box).
    
    I am suggesting the following test plan:
    0. Create several suggestion from different libraries
    
    A. You are superlibrarian and IndependentBranches is not set (=No)
    1. Hit /suggestion/suggestion.pl
    => Default view shows the suggestions from your library
    2. Filter by another library
    => You see the suggestions from this library
    3. Filter by "Any" libraries
    => You see all the suggestions
    4. "Organize by library"
    => You see all the suggestions, organized by library
    5. Filter by a specific library
    => You see the suggestion from your library, all in one tab
    
    B. You are not superlibrarian and IndependentBranches is not set (=No)
    Same as A.
    
    C. You are superlibrarian and IndependentBranches is set
    Same as A.
    
    D. You are not superlibrarian and IndependentBranches is set
    You will never see suggestions coming from outside your library
    
    QA: To be clear: the whole script needs a rewrite, but here we are just
    trying to fix weird behaviors.
    
    Sponsored-by: BULAC - http://www.bulac.fr/
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 14e5d38773027cd424d7bb3385804d06740097ad
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 25 13:12:38 2019 +0100

    Bug 23579: (RM follow-up) Fix failing tests
    
    Removing the default on changed_fields leads to the requirement for
    tests to specify data to add to said field when mocking data.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1d64b1b63df406508bdcde6164b179833f712aeb
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Oct 25 10:15:42 2019 +0200

    Bug 23579: Remove default value for MEDIUMTEXT borrower_modifications.changed_fields
    
    Installation under Ubuntu 18.04 is blocked:
    install.pl: DBD::mysql::st execute failed: BLOB, TEXT, GEOMETRY or JSON
    column 'changed_fields' can't have a default value at
    /usr/local/share/perl5/DBIx/RunSQL.pm line 273.
    
    https://dev.mysql.com/doc/refman/5.7/en/data-type-defaults.html
    """
     The BLOB, TEXT, GEOMETRY, and JSON data types cannot be assigned a
     default value.
    """
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 37b2e05b292c9f9e2a380467238fc3389a18f88a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Oct 25 11:42:50 2019 +0200

    Bug 23413: Fix tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f34139163b1a526acd5050c2adb20e3ac013be26
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 25 09:36:59 2019 +0100

    Bug 23805: (RM follow-up) Correction to sql installer file
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f4254cca37cc455795a5e2a7f88eb722a09da287
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 24 17:30:43 2019 +0100

    Bug 23805: DBRev 19.06.00.044
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87621206dd1e89cf9e01a8ec2ebf1fb5f80af2e2
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Oct 24 16:53:11 2019 +0100

    Bug 23805: (QA follow-up) Add missing mappings in Koha::Account::Line
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 261e887dc07569944dfcc8733ee3d891b948e790
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 15 12:00:41 2019 +0100

    Bug 23805: (follow-up) Handle unexpected types
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12568a20dbc9ab1749df2d649ea87be36de38e51
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 15 09:45:33 2019 +0100

    Bug 23805: Update mancredit to use the new credit types
    
    Test plan
    Ensure the manual credit page continues to work as it did before this
    patchset.
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 66bdfbc0a3597c4452f8adfd502a6fc6cfeb19c8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 18:19:18 2019 +0100

    Bug 23805: (follow-up) Lowercase credit type for UpdateStats
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a9576dbd1b325800994520c2a436c8be282d78f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 18:01:55 2019 +0100

    Bug 23805: Drop type lookup as it's now a foreign key
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5fbf423e94b3482eb0521b53eac9ef1f3ff8d0f2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 17:07:11 2019 +0100

    Bug 23805: Update 'W' to 'WRITEOFF' for consistency
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6bfd41eb0addf7e1d02c898696de31187320c30e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 16:54:56 2019 +0100

    Bug 23805: Update 'Pay' to 'PAYMENT' for consistency
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ce479d7a7d0b3fac21994662592690fad83dab0e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 16:36:34 2019 +0100

    Bug 23805: Update 'lost_item_return' to 'LOST_RETURN' for consistency
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2665dc909453277636eee99ec797233f473a0ae1
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 16:33:43 2019 +0100

    Bug 23805: Update 'FOR' to 'FORGIVEN' for consistency
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40613eb3c870f941e941280ab7c222a20bf778aa
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 16:20:31 2019 +0100

    Bug 23805: Update 'C' to 'CREDIT' for consistency
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b7900423a23c85edf09a5651f7b6d9d740577bde
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 11:42:57 2019 +0100

    Bug 23805: Update accounttype references in tests
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 25047ce341500fa55903e88ef283e6508bd28423
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 11:27:31 2019 +0100

    Bug 23805: Update references to accounttype to credit_type_code
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d31e5c2a87279d57df1256ebf62134b6268cee17
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 15 09:43:46 2019 +0100

    Bug 23805: DBIC Classes
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8cca4fbd3797d893496a5b3cf7c4a00f19a05e33
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 10:57:13 2019 +0100

    Bug 23805: Add account_credit_types tables
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dbd72dcfa1cc51072a48cabea9b7ce244db8b3b8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 24 17:28:40 2019 +0100

    Bug 23049: DBRev 19.06.00.043
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 08e4de2e3d77d063249e20c62bc7ab52ad8bb925
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 24 09:41:52 2019 +0100

    Bug 23049: (follow-up) Remove duplicate of mandatory data
    
    This patchset originally introduced the manadatory data into
    /en/mandatory/account_debit_types.sql. However, it was later decided to
    maintain the system types description strings in the templates and as
    such the database data file was moved to the top level.  This patch
    removes the now superflous /en/mandatory version.
    
    Once we have the sql files easily translated via the standard
    translate.koha-community.org toolchain we should restore this approach
    and update the templates to use the descriptions from the database.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 55595e200b4f6a6ec2767071d95f96c24a4584ae
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 23 16:40:31 2019 +0100

    Bug 23049: (QA follow-up) Catch '0' case debits
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 962cebd4844183be447f7b43cbe6c353f924bd30
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 23 16:39:39 2019 +0100

    Bug 23049: (QA follow-up) Explicitly set accounttype/debit_type in tests
    
    This patch corrects an incorrect ternary and move the definitions into
    the test_data array to clarify their intent.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 24c0f3015474aeccb51610b47d7adae631432dab
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 23 16:23:48 2019 +0100

    Bug 23049: (QA follow-up) Silence noisy warnings
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a7dba215bc846015eddaa255f8a9ae8270591ced
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 23 14:51:28 2019 +0100

    Bug 23049: Add DBIC Classes
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 331c80d7b0516eb03701ae92501e757120880f56
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 23 14:16:20 2019 +0100

    Bug 23049: (QA follow-up) Fix for missing types in test inserts
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a91f178d52b26332cbb74c1798d89f974680c9db
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 23 13:22:12 2019 +0100

    Bug 23049: (QA follow-up) ILSDI test data correction
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7189c4f0a23eee85e915cc7ea15407a5c6e7c427
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 11:14:43 2019 +0100

    Bug 23049: (QA follow-up) Fix swagger spec for account line
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 00970925ae848aa13b2a239b1fa3655d8ffb8441
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 21 18:37:07 2019 +0100

    Bug 23049: (QA follow-up) Check constraint test corrections
    
    TestBuilder adds random data which breaks the check constraint rule. The
    simplest way to correct this situation is to override testbuilder by
    passing in explicit undefs for accounttype or debit_type_code in the
    tests.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aec46d0c3c5bf1dd20d155a814056c2702e52f5c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 21 14:51:39 2019 +0100

    Bug 23049: (QA follow-up) Correction for missed archived filter
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9f13d9fb335e617dc8232f52fa9f41e89245f7d7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 18 13:24:48 2019 +0100

    Bug 23049: (QA follow-up) Correction to patrons_accounts.t
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f91fafbbcb1d5a978092ca7bcb2a859ec59ba4d0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 18 13:12:39 2019 +0100

    Bug 23049: (QA follow-up) Correction for 'M' => 'MANUAL'
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7555441ace13ff32cbefa890d8a7e35f5a5dc9ac
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 18 13:02:16 2019 +0100

    Bug 23049: (QA follow-up) DB Update Improvements
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b2b651d13db5471f674e82c7ff0693f2ad7ec410
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 17 12:28:18 2019 +0100

    Bug 23049: (follow-up) Types should not be deletable
    
    This patch rmeoves the 'delete' option from the debit_types system and
    replaces it with an 'archive/restore' workflow. This will help
    maintained referential integrity.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f046b5073e3305f1a4231ff981d8ff30eaef280b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 15 12:00:24 2019 +0100

    Bug 23049: (follow-up) Handle unexpected types
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cf1904bb0844da28d49c1543f233afed35ae0554
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 11:30:48 2019 +0100

    Bug 23049: (follow-up) Correction to includes
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ff66171ee289b5352c1633ef74f79d3d335ff241
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 11 12:33:55 2019 +0100

    Bug 23049: (follow-up) VARCHAR(80) + ac -> account
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87b166e38167a6f0cf1c58881956d03f620813c7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 11 08:20:24 2019 +0100

    Bug 23049: More thorough param checking
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0bd6e03c657f1d671e02f86a4279b059e13841a3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 17:09:21 2019 +0100

    Bug 23049: Update API
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d4ae2d47eead1984f9bcd9052ec5df6cee5b99f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 16:58:23 2019 +0100

    Bug 23049: Drop type lookup as it's now a foreign key
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7f0cdb83cfb7dacd3978f4bb7124cd87d96e4c50
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 16:53:52 2019 +0100

    Bug 23049: Update 'N' to 'NEW_CARD' for consistency
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit af6464d05b00656474b7bd0211dd540f48a12bc1
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 16:48:41 2019 +0100

    Bug 23049: Capitalise type passed to add_debit for `overdue`
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1eeb9d179d2f1db39eb370269e882a0a087552ad
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 16:43:48 2019 +0100

    Bug 23049: Remove manual_debit as it's never called
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 70268d49de9351243ad5bb8c594838c64ca0d442
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 16:41:22 2019 +0100

    Bug 23049: Capitalise type passed to add_debit for lost_item
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fbd640fa326a838d6406a333bfdfe4d618190d98
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 16:38:24 2019 +0100

    Bug 23049: Update 'HE' to 'RESERVE_EXPIRED' for consistency
    
    This patch updates all cases where debit_type_code was 'HE' to
    'RESERVE_EXPIRED' which is more informative and consistent with the
    new style guidelines.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 56b38464bde416b0ebab81bcbbdb5cc276424e11
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 16:31:17 2019 +0100

    Bug 23049: Capitalise type passed to add_debit for `account`
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 11bc80922855f64d94647cbf16c59ec7bcd23cba
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 17:15:39 2019 +0100

    Bug 23049: Update 'PF' to 'PROCESSING' for consistency
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c97705d1903110680ccd7fe7367bd1b05fb3a464
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 16:17:48 2019 +0100

    Bug 23049: Capitalise type passed to add_debit for `rent`
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 950074fa7e112e81415dce221824cf9e6b859e78
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 16:10:07 2019 +0100

    Bug 23049: Update debit_type_code 'Res' to 'RESERVE'
    
    This patch updates all cases where debit_type_code was 'Res' to
    'RESERVE' which is more informative and consistent with the new style
    guidelines.
    
    The patch also ensure all calls to add_debit with a type or 'reserve'
    now pass the capitalised code instead.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d661141890dbd56ca2511f435c263395c65bf55e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 17:15:10 2019 +0100

    Bug 23049: Update existing code to use debit_type
    
    * Update C4::Accounts::chargelostitem
    * Update C4::Accounts::manualinvoice
    * Update C4::Circulation::_FixOverduesOnReturn
    * Update C4::Circulation::_FixAccountForLostAndReturned
    * Update C4::Overdues::UpdateFine
    * Update C4::Overdues::GetFine
    * Update C4::Overdues::GetOverduesForBranch
    * Update Koha::Account->pay
    * Update Koha::Account->add_debit
    * Update Koha::Account->non_issues_charges
    * Update Koha::Account::Line->apply
    * Update Koha::Account::Line->adjust
    * Update controller scripts
    * Update reports scripts
    * Update tests
    
    Test Plan
    1) Run the test suit and ensure everything still passes
    2) Test reports/cash_register_stats still works
    3) Test that adding manual invoices still works
    4) Test that making payments still works
    5) Test that lost item fee handling still works
    6) Test that invoice printing still works
    7) Test that the sco still works
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8356c56cc27d628ac23758facdb559f38e77cfb9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 17:14:47 2019 +0100

    Bug 23049: Add tests
    
    Test plan:
      prove t/db_dependent/Koha/Account/DebitType.t
      prove t/db_dependent/Koha/Account/DebitTypes.t
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f48a467fbc2949f80e478b7996caf062c2cef8a4
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 17:14:39 2019 +0100

    Bug 23049: Update maninvoice to reference debit types
    
    Test plan:
    1) Naviage to a patron record and select the accounts > manual invoice
       tab
    2) Add some manual invoices and confirm they are working as expected
    3) Signoff
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9641b3c8c7f078562cf7d07500780cbcc09f7fa1
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 09:08:55 2019 +0100

    Bug 23049: Filter out system types by default
    
    Test Plan
    1) Navigate to the debit types management page added in previous patches
    2) Note that system types are now filtered out by default
    3) Click on the new unfilter button to include system types
    4) Signoff
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 86ece7d2e547032458757c5850c5c4d48ea4df37
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 10 17:14:23 2019 +0100

    Bug 23049: Account types configuration - Admin page
    
    Test plan:
    1) Go to admin home, note there is new Debit types page in Accounting
       section
    2) Go to any other admin page and confirm there is link to Debit types
       in the admin menu as well
    3) Go to Debit types page
    4) You should see a datatable listing existing debit types, ensure they
       are working as expected.
    5) Try to create, edit and delete some debit types. Note: Some debit
       types cannot be deleted as they are needed for koha functionality.
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c7181ed3bf8fd7647b7f7066e6cc8ef139e9c96
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Sep 26 14:36:06 2019 +0100

    Bug 23049: Add CHECK constraint to accountlines
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 72e10519e3b7185c0322c144df5e54d5b203b995
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Feb 28 16:58:06 2019 +0000

    Bug 23049: Add debit_type
    
    * Add account_debit_types table
    * Add ac_debit_types_branches table
    * Add account_debit_types defaults
    * Add Koha::Account::DebitType and Koha::Account::DebitTypes
    * Prevent deletion of defaults
    * Migrate MANUAL_INV values
    * Remove MANUAL_INV references
    * Migrate accounttype values
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 48ec99e0fc4918428ed0811f72132fbe33ae1a6d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 25 17:26:13 2019 -0500

    Bug 23152: Fix more pluralisation (and add tests)
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit facd6cc04140fb7b3c59277b46096e2ec47f844c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 24 15:40:47 2019 +0000

    Bug 23413: Remove wrong return
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1c34a54a0e1f2b9857ef2d509884f0d818dcd144
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Sep 3 11:20:24 2019 +0000

    Bug 23413: Update tests to use build_sample_biblio
    
    Before these changes the tests fail if run under Elasticsearch
    
    This makes sure they pass either way
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d9ec55a8a36c7974667846e41c486488606c40a3
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Sep 3 11:14:24 2019 +0000

    Bug 23413: (follow-up) Rename variables
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e428c5a4b0aea4779f743abbf8a61abe90b20dbc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 24 13:50:35 2019 +0100

    Bug 23863: Add signoff line for recognition
    
    Signed-off-by: Sarah Cornell <sbcornell@cityofportsmouth.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b0a143acd3675f59ceb408638cad322327287094
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 12:38:50 2019 +0100

    Bug 23633: Hide paid transactions by default on the OPAC
    
    This patch adds filtering on paid for type transactions to the OPAC
    accounts page.  The filtering is enabled by default but may be toggled
    to show historical transactions.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d09083fc874512e8539c721cb8d0c808df261fe2
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jul 29 13:19:19 2019 +0000

    Bug 23392: Don't display private notes in MARC21
    
    To test:
    1 - Add some notes to a record in fields 541,542,561,583,590
    2 - Ensure all of these are visible in the frameworks
    3 - Note they appear in the 'Title notes'/'Description' tabs on OPAC/Staff client
    4 - Mark first indicator '0' on all notes
    5 - They still display
    6 - Apply patch
    7 - Notes no longer show on OPAC
    8 - Notes still show on Staff client
    9 - prove -v t/Biblio/GetMarcNotes.t
    
    Signed-off-by: Myka Kennedy Stephens <mkstephens@lancasterseminary.edu>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 346f8b163a45a15b522c05ab6da532f922588559
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Oct 21 22:08:45 2019 +0000

    Bug 23863: (QA follow-up) Add missing html filter
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2f315139e213ca9241d385dfea0aa747999c8464
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Oct 22 14:07:46 2019 -0400

    Bug 23863: Editing a basket clears create_items value
    
    Test Plan:
    1) Create a basket with a non-default value for aqbasket.create_items
    2) Click Edit from basket.pl
    3) Click Save without changing anything
    4) Note that aqbasket.create_items is no longer set
    5) Apply this patch
    6) Restart all the things!
    7) Repeat steps 1-3
    8) Note create_items is unchanged!
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 030eb694a87029e3220e8f930f509556c9e816ea
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 21 17:55:17 2019 +0200

    Bug 23855: Fix "Mark selected suggestion as" status
    
    On the suggestions management page (suggestion/suggestion.pl) you can
    select suggestions and change their status.
    But it only works for "ACCEPTED" or "REJECTED".
    
    Maybe caused by bug 22905.
    
    Test plan:
    Select at least one suggestion on the screen and select the "Pending"
    status.
    => The status of the selected suggestions must have been updated
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1b9f3621dfc82144e498d6d7d53cdda3b6d352a0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 13:47:50 2019 -0300

    Bug 23843: Add mapping to Koha::Acquisition::Fund
    
    This patch adds a to_api_mapping method to the class. This in effect
    enables calling ->to_api on the object. The mapping is borrowed from the
    API controller. It is not removed from the controller so we are able to
    verify (through the tests) that there is no behavior change.
    Once this is pushed we need to implement the counter-wise methods and
    clean the controllers.
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/acquisitions_funds.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests still pass!
    4. Sign off :-D
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 70e0a23af66960fdc8d0a32fc57c1858e8f7a010
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 13:29:47 2019 -0300

    Bug 23843: Add mapping to Koha::Acquisition::Bookseller
    
    This patch adds a to_api_mapping method to the class. This in effect
    enables calling ->to_api on the object. The mapping is borrowed from the
    API controller. It is not removed from the controller so we are able to
    verify (through the tests) that there is no behavior change.
    Once this is pushed we need to implement the counter-wise methods and
    clean the controllers.
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/acquisitions_vendors.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests still pass!
    4. Sign off :-D
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 17a34e3d099f86dad4a84cdb98073d794dcd6c4e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 13:27:25 2019 -0300

    Bug 23843: Add mapping to Koha::Item
    
    This patch adds a to_api_mapping method to the class. This in effect
    enables calling ->to_api on the object. The mapping is borrowed from the
    API controller. It is not removed from the controller so we are able to
    verify (through the tests) that there is no behavior change.
    Once this is pushed we need to implement the counter-wise methods and
    clean the controllers.
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/items.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests still pass!
    4. Sign off :-D
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 255b9b98d01f330b2d6cc48fa3efa2ed599a50c7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 13:27:11 2019 -0300

    Bug 23843: Add mapping to Koha::Patron
    
    This patch adds a to_api_mapping method to the class. This in effect
    enables calling ->to_api on the object. The mapping is borrowed from the
    API controller. It is not removed from the controller so we are able to
    verify (through the tests) that there is no behavior change.
    Once this is pushed we need to implement the counter-wise methods and
    clean the controllers.
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/patrons.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests still pass!
    4. Sign off :-D
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 430be3e9f3e8ca2313a9b8487a34803edc3aaf2d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 13:26:57 2019 -0300

    Bug 23843: Add mapping to Koha::Library
    
    This patch adds a to_api_mapping method to the class. This in effect
    enables calling ->to_api on the object. The mapping is borrowed from the
    API controller. It is not removed from the controller so we are able to
    verify (through the tests) that there is no behavior change.
    Once this is pushed we need to implement the counter-wise methods and
    clean the controllers.
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/libraries.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests still pass!
    4. Sign off :-D
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 09ff41d9f12825d5dd042c12871a67300b6c535d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 13:26:07 2019 -0300

    Bug 23843: Add mapping to Koha::Hold
    
    This patch adds a to_api_mapping method to the class. This in effect
    enables calling ->to_api on the object. The mapping is borrowed from the
    API controller. It is not removed from the controller so we are able to
    verify (through the tests) that there is no behavior change.
    Once this is pushed we need to implement the counter-wise methods and
    clean the controllers.
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/holds.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests still pass!
    4. Sign off :-D
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit af2cd5e303d5a4446159110a7da27cc5befd5a64
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 13:25:34 2019 -0300

    Bug 23843: Add mapping to Koha::Club::Holds
    
    This patch adds a to_api_mapping method to the class. This in effect
    enables calling ->to_api on the object. The mapping is borrowed from the
    API controller. It is not removed from the controller so we are able to
    verify (through the tests) that there is no behavior change.
    Once this is pushed we need to implement the counter-wise methods and
    clean the controllers.
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/clubs_holds.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests still pass!
    4. Sign off :-D
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1957cb64ca8efab68001a9bdec3c0ce02133907b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 13:24:45 2019 -0300

    Bug 23843: Add mapping to Koha::Checkout
    
    This patch adds a to_api_mapping method to the class. This in effect
    enables calling ->to_api on the object. The mapping is borrowed from the
    API controller. It is not removed from the controller so we are able to
    verify (through the tests) that there is no behavior change.
    Once this is pushed we need to implement the counter-wise methods and
    clean the controllers.
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/checkouts.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests still pass!
    4. Sign off :-D
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f5f98af7be74dce81073fe0a42431db7ebac49f7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 13:24:27 2019 -0300

    Bug 23843: Add mapping to Koha::Account::Line
    
    This patch adds a to_api_mapping method to the class. This in effect
    enables calling ->to_api on the object. The mapping is borrowed from the
    API controller. It is not removed from the controller so we are able to
    verify (through the tests) that there is no behavior change.
    
    Once this is pushed we need to implement the counter-wise methods and
    clean the controllers.
    
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/patrons_accounts.t
    => SUCCESS: Tests pass
    2. Apply this patch
    3. Repeat (1)
    => SUCCESS: Tests still pass!
    4. Sign off :-D
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ecf030b798297d19926ca037507271ad4c100bfd
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 21 15:18:32 2019 -0300

    Bug 23843: Make funds endpoint tests more robust
    
    Now that we use ->to_api all the object attributes are returned, so the
    original tests that didn't follow the FKs would pass, and now they
    don't. If there is no budget linked to the fund, it will return undef,
    which is not accepted on the API (though it accepts not returning the
    attribute).
    
    To test:
    1. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/acquisitions_funds.t
    => SUCCESS: Tests pass!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 99a1a6db0f720cf0896a5ea2651cce89e35384ae
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 14 09:05:46 2019 -0300

    Bug 23793: Unit tests
    
    This patch introduces full test coverage for the EmbedItems filter.
    
    To test:
    1. Apply this patchset
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Filter/EmbedItems.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    4. Use it to improve Koha!
    
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6189f25dfae19f99800168db7be996e1239efae3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Oct 10 13:17:18 2019 -0300

    Bug 23793: Add an EmbedItems RecordProcessor filter for MARC::Record objects
    
    This patch introduces a RecordProcessor filter for MARC::Record objects
    that embeds MARC::Field's for each item that is passed to the processor.
    
    Target usage:
    
    my $biblio = Koha::Biblios->find(
        $biblio_id,
        { prefetch => [ items, metadata ] }
    );
    
    my $opachiddenitems_rules;
    eval {
        my $yaml = C4::Context->preference('OpacHiddenItems') . "\n\n";
        $opachiddenitems_rules = YAML::Load($yaml);
    };
    
    my @items  = grep { !$_->hidden_in_opac({ rules => $opachiddenitems_rules }) @{$biblio->items->as_list};
    my $record = $biblio->metadata->record;
    
    my $processor = Koha::RecordProcessor->new(
        {
            filters => ('EmbedItems'),
            options => {
                items        => \@items
            }
        }
    );
    
    $processor->process( $record );
    
    Signed-off-by: Ere Maijala <ere.maijala@helsinki.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2b149c3d7aa7e2f59fcee6d8778f8e0c685cc406
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Wed Oct 23 16:23:19 2019 +0300

    Bug 13937: (follow-up) Fix searching with UTF-8 characters.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd5d6b3281cab58198bc0c2750f7952e2dbeda1e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 15:14:43 2019 +0100

    Update docs/teams.yaml for 19.11.x development cycle
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 768b06773767948fa2c36057acc3a4a1615a7430
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 15:05:15 2019 +0100

    Bug 22445: DBRev 19.06.00.042
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5555c9d4609935273dbf24757a3dc415253de8ea
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 16 09:13:20 2019 +0200

    Bug 22445: Replace %% with {}
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 03e4c0bf5dbbea74573e0785a9f7b0fa1f3e9738
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 14:58:52 2019 +0100

    Bug 22445: Add new pattern %normalized_isbn%
    
    Quite bad to use C4::Koha from Koha::Biblio :-/
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8c858f50a85614945a14ded29675a9be409b0a92
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Mar 18 17:44:30 2019 +0000

    Bug 22445: (follow-up) Use CSS to set a max-width for images - Staff client
    
    This patch adds some CSS and markup to staff client templates so that
    custom cover images have a maximum width of 140px (to match the width of
    generated local cover image thumbnails). This prevents oversized images
    from displaying inconsistently compared to images from other services.
    
    This patch also adds a missing </a> to fix display problems.
    
    To test, apply the patch and regenerate the staff client CSS. Post an
    oversized image which corresponds to a record in your catalog.
    
    View the following pages to confirm that the image displays well:
    
     - Catalog search results
     - Bibliographic detail page
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 538ca0fb4cdfa753c279b5e6003be123241f98d6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 14:58:29 2019 +0100

    Bug 22445: (follow-up) Use CSS to set a max-width for images - OPAC
    
    This patch adds some CSS and markup to OPAC templates so that custom
    cover images have a maximum width of 140px (to match the width of
    generated local cover image thumbnails). This prevents oversized images
    from displaying inconsistently compared to images from other services.
    
    To test, apply the patch and regenerate the OPAC CSS. Post an oversized
    image which corresponds to a record in your OPAC which can be added to a
    user's checkouts and to a list.
    
    View the following pages to confirm that the image displays well:
    
     - OPAC search results
     - Bibliographic detail page
     - Shelf browser
     - List contents
     - Recent comments
     - "Your summary"
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 43f9ad15e70dbd7f4af4ead454972fa778b64c5f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 28 19:13:42 2019 -0300

    Bug 22445: Custom cover images - search resulta (staff)
    
    Test plan:
    Search for bibliographic records, the custom covers should be displayed.
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d8104c21b6efe006bd5b365f31db1a75c582ddd4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 28 19:11:19 2019 -0300

    Bug 22445: Custom cover images - detail (staff)
    
    Test plan:
    Staff side now, go the detail page of a bibliographic record
    You should see the cover image.
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 56bccf6ad57683870f1cca82d4f22fa5aaf02a67
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 14:58:00 2019 +0100

    Bug 22445: Custom cover images - opac user (checkout list)
    
    Test plan:
    - Check an item out to a patron
    - At the OPAC loggin as this patron
    On the checkout list you should see the cover image.
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 958c3ae6dfddd322538ac81e09470ee6ceb02b26
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 28 18:58:21 2019 -0300

    Bug 22445: Custom cover images - opac reviews (rss)
    
    Test plan:
    Same as previous patch, then click on the feeds link
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a5d32405942f75ea20f12725b315a1c43b451773
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 28 18:55:38 2019 -0300

    Bug 22445: Custom cover images - opac reviews
    
    Test plan:
    - enable OpacShowRecentComments
    - make a comment (OPAC)
    - approve it (staff)
    - click 'Recent comments' (OPAC)
    => You should see the custom cover
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 558929d85d1eb909459d42f2ab7288435937206b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 28 18:50:21 2019 -0300

    Bug 22445: Custom cover images - opac shelves
    
    Test plan:
    Add a bibliographic record (that has a custom image) to a shelf,
    view the shelf (OPAC).
    You should see the image.
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fcfc6ec13df46beaf2b9679a64c7d14b5d4578b0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 28 18:39:59 2019 -0300

    Bug 22445: Custom cover images - opac result (rss)
    
    This cannot be tested, it seems that the template is broken.
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 055dc2321b1c56fed01011f96ee6d0e68e131e93
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 1 08:01:28 2019 -0300

    Bug 22445: Custom cover images - opac detail
    
    Test plan:
    Go to the bibliographic record detail page at the OPAC, you should see
    the custom cover image.
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 71b1afd06ecd28886c15bfb86b6fda22c8ba4441
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 1 08:01:05 2019 -0300

    Bug 22445: Custom cover images - opac results
    
    Test plan:
    Search for bibliographic records at the OPAC, the custom cover should be
    displayed
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2bf7ddd112a3d6adb1a3bc7d2ea8f4f288dc5939
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 14:56:53 2019 +0100

    Bug 22445: Custom cover images - opac shelfbrowser
    
    Test plan:
    Go to the detail page of a bibliographic record (at the OPAC)
    and confirm the at custom cover images are displayed in the shelf
    browser
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e3b90c4cb909eee92af6893a92abaaeaa79eee4b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 14:56:40 2019 +0100

    Bug 22445: Allow marc fields as pattern
    
    %tag$field%
    
    There is a limitation here, only one replacement will work.
    Let see if it is needed later to support several patterns
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3df15701d67abb3b08567c6a908f415ea6f361da
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 14:56:25 2019 +0100

    Bug 22445: Add tests for Koha::Biblio->custom_cover_image_url
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit be162571977b642d976ee12e9db3bdfa5522dc2c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 1 08:00:53 2019 -0300

    Bug 22445: Add new method Koha::Biblio->custom_cover_image_url
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6f4994ff4dc588bab1b83173c414e6161b6d704e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Mar 1 08:00:02 2019 -0300

    Bug 22445: Add new prefs *CustomCoverImages*
    
    This patch set adds a new method to display cover images for
    bibliographic records.
    The idea is to provide a flexible way allowing several use cases:
    - local path
    - remote url
    - webservice
    which would follow a given pattern.
    
    So far only the following patterns are available:
    - {isbn} will be replaced byt the isbn of the record
    - {issn}
    - using MARC subfields:
      {024$a} to replace with the value in 024$a
    (Note that the selector has been changed from %% to {} in a coming
    patch)
    
    For example
    - /your/local/images/{isbn}.png
    - https://covers.openlibrary.org/b/isbn/{isbn}-M.jpb
    - etc.
    
    There are 3 new sysprefs:
    CustomCoverImagesURL
    => Define the path/url
    CustomCoverImages
    => Turn on/off the display of the custom cover image in the staff client
    OPACCustomCoverImages
    => Turn on/off the display of the custom cover image at the OPAC
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eb3a3df937fff981214cd6b8394ab321e09e1f7c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 22 14:25:31 2019 +0100

    Update Developer Statistics
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d1b3cf2120fbd2c9beb4317797c260d9b647f79
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue Oct 22 12:29:40 2019 +0000

    Bug 23867: Resolve "truncated incorrect double" for empty string
    
    Updatedatabase, rev. 18.12.00.051
    Solved by testing the value of the pref first.
    Tested by copying the change in a new atomic update with XXX.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f4936fd46a284aeb1976965b83a6a29caefa2890
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 8 15:43:10 2019 -0300

    Bug 23770: (follow-up) Use ->to_api in /cities
    
    This patch aims to prove the behaviour does not differ. So you can run
    the tests for the endpoints, and the behaviour remains.
    
    The mappings and methods cannot be removed until $c->objects->search is
    fixed to make use of them as well. That will happen once all used
    Koha::Object-based classes implement the mappings.
    
    To test:
    1. Apply this patch
    2. Run:
       $ kshell
      k$ prove t/db_dependent/api/v1/cities.t
    => SUCCESS: Tests pass!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1800a2e6b810d2ec789ece4b9b9c1fb2c3ad666d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 8 12:51:52 2019 -0300

    Bug 23770: (follow-up) Add tests for Koha::Objects->TO_JSON
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7ce5cb0865fb7eb9174a4b4edbf80e9acfcda920
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 8 12:13:23 2019 -0300

    Bug 23770: Unit tests
    
    This patch introduces tests for the new to_api method introduced in
    Koha::Object(s).
    
    It uses Koha::City as a sample for simplicity. And it also uses
    Koha::Illrequests to test the case in which there's no to_api_mapping
    method defined on the class, to highlight that a fallback to calling
    TO_JSON is done. [1]
    
    [1] This is done under the assumption Illrequests controller code
    doesn't use any kind of mapping as the rest of the API controllers do,
    so there's little chance it would be added in a future.
    
    To test:
    1. Apply this patchset
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Object.t \
               t/db_dependent/Koha/Objects.t
    => SUCCESS: Tests pass!
    3. Sign off :-D
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ab4a8755c22269dbe0f8809667c0e0f1e03bc3ea
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Oct 8 12:12:56 2019 -0300

    Bug 23770: Add to_api_mapping method to Koha::City
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3c0c75e6af321f02f7934979fbda0091578cfa8a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 7 15:55:09 2019 -0300

    Bug 23770: Add Koha::Object(s)->to_api method
    
    Generic method that changes the attribute names of an object in the
    presence of the to_api_mapping method. It otherwise falls back to
    returning the TO_JSON output.
    
    This is WIP submitted early for scrutiny. Tests and example usage in an
    API controller coming.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d7d5a40548c5adb918cd4b35706db0679e46b005
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 19 10:24:01 2019 +0000

    Bug 23346: Add without-db-name parameter to koha-dump
    
    Test plan:
    Run koha-dump [yourdb]. Rename the files in var/spool/koha/[yourdb]
    Run koha-dump --without-db-name [yourdb]
    Run a diff between the unzipped sql files. The last dump should not
    contain a CREATE DATABASE and USE statement. See BZ 15664 c4.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d8a26e5759fa81eff296fb733699ee8cdce3c7e
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Oct 16 16:57:01 2019 +0000

    Bug 22922: (follow-up) Markup corrections
    
    This patch adds a "size" attribute to the datepicker input fields and
    adds self-closing "/".
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 08e7273c0f9afbc40155c46432683c63b1f44e8b
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri May 17 16:06:41 2019 +0200

    Bug 22922: Use jQuery datepicker instead of <input type="date">
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95174eb36a210ea20811072db044a69396c3630a
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Fri May 17 14:40:12 2019 +0200

    Bug 22922: Allow reservedate changes only if AllowHoldDateInFuture is on
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d047f2a3391bfff0bc86edb9c706959d19ee775
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Tue May 14 16:42:24 2019 +0200

    Bug 22922: Allow to modify hold dates on reserve/request.pl
    
    Test plan:
    1. Place some holds
    2. Go to the 'Holds' tab of the biblio record
    3. Modify dates in the table and click on 'Update holds' button
    4. Verify that dates have been correctly updated
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2c10ac831bc6130b69ab295755160684ad9ccc15
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 21 09:56:43 2019 +0100

    Bug 23791: DBRev 19.06.00.041
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ee58a457ab4c1fccb35ad82b6ffbbf98d38b8931
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 21 09:52:38 2019 +0100

    Bug 23791: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 74165f986e67376360cf7d2871936bcdabe7edc3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Oct 17 15:12:46 2019 +0000

    Bug 23791: (follow-up) Add missing CSS changes
    
    This patch adds OPAC CSS changes which were missing from the original
    patch. It also adds a missing title attribute to the Twitter link.
    
    To test, apply the patch and regenerate the OPAC SCSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    Follow the previous test plan.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3c32adc05128a5f12a59a684c186d6e5b0bd439c
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Oct 14 23:36:28 2019 +0200

    Bug 23791: (follow-up) Fix database update description
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8fbc93e8b2a681b5d403510f2482c1cf322c0ddc
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Oct 11 18:32:19 2019 +0000

    Bug 23791: Allow granular control of social networks enabled by SocialNetworks syspref
    
    This patch updates the SocialNetworks system preference so that it
    offers a choice of social networks (and email) which can be enabled in
    the OPAC.
    
    This patch also replaces the social network images with Font Awesome
    icons styled so that the colors match the social networks' current
    branding. The old social networks sprite image is removed.
    
    To test, apply the patch and run the database update. Rebuild the OPAC
    CSS:
    https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client
    
     - Go to Administration -> Global system preferences -> OPAC -> Features
       and find the SocialNetworks preference.
       - If your SocialNetworks preference was enabled, all choices should
         be selected. Otherwise none should be selected.
       - If none are selected, select them all and save.
     - Locate a record in the OPAC and view the details page.
     - The social network icons should appear as expected and function as
       before.
     - Return to system preferences in the staff client and try enabling and
       disabling different options, verifying each time that the OPAC
       reflects your choices.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 194a49137f254161721b167a7e2133725e8874e9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 17 17:28:15 2019 +0100

    Bug 20086: (follow-up) No need to call ->new on Koha::Database
    
    We should use the existing pattern of calling schema directly on
    Koha::Database rather than creating a new object.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9658cd4d18b330711a7a8e3391a83d52b35050c6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 17 14:31:27 2019 +0000

    Bug 20086: Execute AddRenewal in a transaction to avoid partial success and doubled fines
    
    This patch starts a transaction and only commits if renewal and fines
    updates and charges are successful (partial in any cna be problematic)
    
    There is no feedback (as currently there is none either) but if part
    fails, all fails.
    
    I didn't include stats and notifications in the transaction, but we
    could. (Edit JD: not true, they are included)
    
    To test:
    1 - Apply patch
    2 - prove t/db_dependent/Circulation.t
    3 - Attempt circs and renewals should be no difference
    4 - If possible make part of transaction fail and ensure all fails
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Amended: commit title and one indendation (return statement)
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8a243ffd94bc1dcae49c712818a79007579b4f6c
Author: Magnus Enger <magnus@libriotech.no>
Date:   Mon Sep 30 15:01:35 2019 +0200

    Bug 23700: Fix output of koha-plack --restart
    
    To test:
    - Run "sudo koha-plack restart kohadev" and verify the output is
      out of line.
    - Apply the patch
    - If you are on e.g. kohadevbox you need to copy koha-plack to
      /usr/sbin/ thus:
      sudo cp debian/scripts/koha-plack /usr/sbin/koha-plack
    - Run "sudo koha-plack restart kohadev" again and check that you
      get two lines of output, nicely aligned with the "OK" inside the
      square brackets.
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a473e231f771ad088511ed9e8eb514fd28117a13
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Oct 18 12:34:43 2019 +0000

    Bug 23712: (QA follow-up) Silence two other warns too
    
    Caused by undefined method:
    Use of uninitialized value in concatenation (.) or string at /usr/share/koha/Koha/Illrequest.pm line 857.
    Use of uninitialized value in concatenation (.) or string at /usr/share/koha/Koha/Illrequest.pm line 859.
    
    Test plan:
    Run test again
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fcf149d32598f3c4ead2d36dbd3f7a3cafd83e30
Author: Magnus Enger <magnus@libriotech.no>
Date:   Tue Oct 1 16:41:31 2019 +0200

    Bug 23712: Silence warns from Koha/Illrequest/Logger.pm
    
    To test:
    - Run: $ sudo koha-shell -c "prove t/db_dependent/Illrequests.t" kohadev
    - Observe the warnings about "no query in themelanguage"
    - Apply the patch
    - Run prove again
    - Observe the lack of warnings about "no query in themelanguage"
      (There will be a couple of other warnings, but they are not
      related to the present bug.)
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d595a931320e7567810b48f4e896f930bace4cb2
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Aug 9 15:26:12 2019 +0000

    Bug 23444: Terminology - Use library instead of branch
    
    This changes some strings in the templates for:
    
    - Receiving orders (creating items on receive)
        Home branch    -> Home library
        Holding branch -> Current location
       (matches item display in staff)
    - Callnumber browser item value builder plugin
        Branch -> Library
    - Accounts wizard in reports
        Transaction branch -> Transaction library
    - Serials wizard in reports
        Branch -> Library
    
    Also fixes 2 capitalization issues:
      Subscription id -> Subscription ID
      Call Number     -> Call number
    
    Signed-off-by: Alex Sassmannshausen <alex@komputilo.eu>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f5a3e4cbc9fdde4b3b542f541d6362bd878bc733
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 14 08:32:58 2019 -0300

    Bug 23807: Unit tests
    
    This patch introduces tests for the Koha::Item->as_marc_field method. It
    tries to cover all the use cases.
    
    To test:
    1. Apply this patchset
    2. Run:
       $ kshell
      k$ prove t/db_dependent/Koha/Item.t
    => SUCCESS; Tests pass!
    3. Sign off :-D
    
    Signed-off-by: Jan Kolator <kolatorj@email.cz>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 342824ddf1648160cefa9a814b5894abf66c321f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Oct 11 14:43:09 2019 -0300

    Bug 23807: Add Koha::Item->as_marc_field
    
    Signed-off-by: Jan Kolator <kolatorj@email.cz>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 82e6052b5d0c1a2ff607f8e6992a64eba613b9d8
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Oct 14 09:15:43 2019 +0200

    Bug 20434: Add default authority type
    
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5e0c2164d604bc499ae26e1987bf498acbe452b3
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Oct 3 17:34:56 2019 +0200

    Bug 20434: Add missing fields
    
    018 - [Reserved for other International Standard Numbers]
    033 - Other System Persistent Record Identifier
    183 - Coded Data Field: Type of Carrier
    203 - Content Form and Media Type
    231 - Digital File Characteristics
    283 - Carrier Type
    338 - Funding Information Note
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 422bcea5b2feb0695f03b6e5c74c3cf1a6f6322c
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Oct 3 15:58:03 2019 +0200

    Bug 20434: Add missing authority types
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 109d527ccd1a36b6cff9e1dcb3e09d941ad57198
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 14:40:56 2019 +0200

    Bug 20434: Add UNIMARC field 214 and its subfields
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9e76fe8ee5f82825d7c8b9482ece15b1807af42b
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:45:32 2019 +0200

    Bug 20434: Update UNIMARC framework - script
    
    Test plan:
    1. Take a look at files in misc/migration_tools/ifla/data. It
       contains all data that will be inserted into Koha. Its content is
       based on the previous patches.
    2. Run the script misc/migration_tools/ifla/update.pl and verify
       that it effectively added the new fields, subfields, authorised
       values and authority types.
    3. Run the script again and see that it doesn't update existing fields
    4. Run with --force and verify that it update existing fields (you can
       modify unimarc_ifla.yml to see changes)
    5. Run with --force --po-file misc/migration_tools/ifla/language/fr.po
       and verify that the labels are now in french
    
    There is a POT file in misc/migration_tools/ifla/language/template.pot,
    use it to create PO files for other languages.
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit affbf289da94d35a07850d47900ca7e9473796bd
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:45:18 2019 +0200

    Bug 20434: Update UNIMARC framework - translations
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 185d9f36f395dc0b81d9bcc50f03b08e07ab3109
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:44:37 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (WORK)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12cd02f9b2906752f6a6576d4294b591de0a8c9c
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:44:31 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (TU)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2119cb5f4f1c86f6ef16dc8de2597b9ccdafa8f7
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:44:23 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (TM)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b3f17ffdb483cb1103098ea1ef38c696c5719c5a
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:44:15 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (SNG)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9b7afbde430f0d42e8ade0d33493838411905204
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:44:10 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (SNC)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a92c417883af46ce4495c2af93bcaba9d7148cc1
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:44:01 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (SAUTTIT)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 45187cea0d422f97d25ab0b0947ce4624ae6ba76
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:43:27 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (PUB)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aa5588adda935dbafbb1cee23e5e05d959396d96
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:43:16 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (PERS)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ed089d5f9885328520a7f83f37e1be9c931eff4c
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:43:08 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (PA)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dc1c3dca78cc5d62b23dc78f888d09d986aab267
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:43:01 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (NTWORK)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ca9904a28a87a0eb5543c4af91db029def6d7e21
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:42:52 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (NTEXP)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9b04c3dbacf22a005d7a8cfaa490fa01795ac99d
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:42:33 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (NP)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d0768733900f6987c3fadd3a83be4992c1101611
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:42:23 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (GENRE/FORM)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f7738abbf446548dcee196535394e5c6b2ef46c9
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:42:08 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (FAM)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 43cf2dfb682a397cfaca172af4462d9ee8ca051c
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:42:00 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (EXP)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7bbb7386b5038c19643204b9b22988176b97c119
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:41:53 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (CO)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c5055fddd8b874f41f6d1f98c8d372fdb1077d4
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:41:44 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (CLASS)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a5722224a6ab4e9ab43ff8361847ad4bb7506ac
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:41:29 2019 +0200

    Bug 20434: Update UNIMARC framework - auth (default)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b2566b97998c2eb5846557388f685f97224d2b23
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:44:56 2019 +0200

    Bug 20434: Update UNIMARC framework - authtypes
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1c98871d277681692296ce9b32226a21f64ebfba
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:41:08 2019 +0200

    Bug 20434: Update UNIMARC framework - biblio
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e75da5b00a3f7fb18602b14051c4c890fcac7e08
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:38:31 2019 +0200

    Bug 20434: Update UNIMARC framework - authorised values
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1ea8ef809f24a1e74a82628eed5f96e713adddae
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 13:40:05 2019 +0200

    Bug 20434: Update UNIMARC framework - defaults
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5bdb43c35e8cd26612b4d0f8dab990cf6aeb5ea3
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Fri Aug 9 03:34:45 2019 +0000

    Bug 23435: Add multiple copies of an item when receiving in serials
    
    This feature allows you to add multiple item records when receiving a
    serial, if the subscription is set to 'create item record when receiving
    serials'. Please note this is not the same as multi-receiving, more like
    multi-adding!
    
    To test:
    1) Create a subscription, ensure the 'Create an item record when
    receiving this serial' option is selected
    2) Receive a serial
    3) Expand the item form by selecting 'click to add item'
    4) Fill in details, including a barcode. Leave 'number of copies' as 1
    and Save.
    5) Confirm the serial is received as expected.
    6) In another tab, open the bibliographic record attached to this
    subscription
    7) Confirm the item record was created upon receiving the serial
    8) Go back to the serial collection and receive next serial
    9) Expand the item form by selecting 'click to add item'
    10) Fill in details again, this time change 'number of copies' to a
    different number e.g. 3, and Save
    11) Confirm the serial is received as expected.
    12) Check back at the biblio record that 3 item records were created and
    the barcode was incremented for each additional item.
    
    Sponsored-by: Brimbank City Council
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f1fb18c1d1dd606251d2dda4414087509daaf48b
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Wed Oct 16 21:49:34 2019 +0000

    Bug 23812: Download icon is an upload icon
    
    Signed-off-by: cori <corilynn.arnold@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9d33b82fe8ada8aee4e62bed5e147fe15f72e2e0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 16 16:21:46 2019 +0100

    Bug 23826: Correction for missing "F" -> "OVERDUE" change
    
    When replacing F and FU with 'OVERDUE' + status in bug 22521 I missed
    the cases inside the maninvoice template. This patch should correct
    that mistake.
    
    Signed-off-by: Andrew Fuerste-Henry <andrew@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8870bc334b5de70dc4169a4ff126c3798473fcf3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 16 12:25:42 2019 +0200

    Bug 23821: Remove new occurrence of create_helper_biblio
    
    create_helper_biblio subroutines have been remove from bug 21798, but
    one occurrence have been reintroduced by bug 7614. We must use
    build_sample_biblio instead.
    
    Test plan:
      prove t/db_dependent/Koha/Libraries.t
    should return green.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 195d0ba68066b109a955e8cb88a6f8bd068b9295
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Oct 15 17:28:13 2019 +0000

    Bug 23704: Typo in itemtypes.tt
    
    This patch corrects a typo:
    
    "for loans specifie in hours."
    
    corrected to "for loans specified in hours."
    
    To test, apply the patch and edit an existing item type. The description
    of the "Hourly rental charge" field should be correct.
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9fbe61180969085983fa3e3bebcc2a8212d7499b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jun 6 19:18:19 2019 +0000

    Bug 8260: user rank order instead of absolute rank to set dropdowns on routing.pl
    
    When deleting a borrower on a routing list we leave a gap in the numbering. It appears to only be a problem when viewing
    or editing the list in the staff client.
    
    Rather than use the rank in the DB to set the values, we use the implicit order
    
    To test:
     1 - Create a subscription (or find one)
     2 - Add a routing list
     3 - Add five patrons
     4 - Delete the patron who is third in the list
     5 - Edit the routing list
     6 - Note the priority for the last patron is 1
     7 - Apply patch
     8 - Reload the page
     9 - Values look correct
    10 - Confirm reordering works as expected
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0bc8fc2787a5ef29638094a0a7ec7b47be636ae1
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 11 14:18:58 2019 +0100

    Bug 23804: Correctly catch remote itemtype images
    
    Bug 20216 missed the mark and although it did start display a URL for
    the itemtype image in use, it was not limited to remote urls and as such
    broke the checked handling for displaying which local image was
    selected.
    
    Test plan:
    1) Select a local image for an itemtype.
    2) Check the correct image is displayed in the admin table.
    3) Edit the itemtype checking that the correct image is checked.
    4) Change to a remote image for the itemtype
    5) Check the correct image is displayed in the admin table.
    6) Edit the itemtype again and check that the URL still displays and is
       checked in the 'Remote image' tab.
    7) Signoff
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a24c17a2aa2053da1317c29e47a3946af2962afb
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 4 14:06:27 2019 +0100

    Bug 23551: Fix AddRenewal call in circ/renew.pl
    
    Without the patch, renewing from the renewal tab/page
    led to wrong renewal/due dates.
    
    To test:
    - Check an item out to your patron account
    - Renew it from the patron account
    - Note the due date
    - Return the item
    - Check the item out again
    - Renew it using the renewal tab
    - Verify a different due date was calculated
    - Apply patch
    - Repeat test - due dates now should be the same
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 480434bbf4a32750c5e47a3600b6a386d9732296
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 15 16:49:07 2019 +0100

    Bug 23129: (RM follow-up) Fix failing test
    
    This patch corrects a test that was testing for the oposite behaviour to
    that introduced in this patchset.  We have agreed on the bug that the
    new behaviour is desired and so I have updated the test to follow.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04cd884d10a4b9b6a889c084d40b44742e3d7279
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Oct 11 14:53:24 2019 +0000

    Bug 23528: Show 'log in to add tags' link on all search result entries
    
    This patch modifies the OPAC search result template so that each result
    shows the "Log in to add tags" link instead of just the first.
    
    To test, apply the patch and make sure TagsEnabled and TagsInputOnList
    are both enabled.
    
    Perform a search in the OPAC while not logged in. In the list of
    results, the "Log in to add tags" link should appear with every result.
    
    Log in to the OPAC and confirm that the "Add tag" link appears as
    expected.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77884d6c76319431ce98a7332be9b27b7387f94d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Oct 14 09:47:01 2019 +0200

    Bug 23038: Remove unused stderr vars
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04ec6627e2d40a9bb34f7b95e4a3276b04a5fee1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 3 11:40:31 2019 -0500

    Bug 23038: Hide expected warnings from tests
    
    When tests are ran, there are 2 warnings that are expected and raised by
    DBI.
    As they are expected they must be correctly caught and not displayed.
    
    We could have reconnect with PrintError turned off, but then reconnect
    with it on.
    
    Test plan:
    % prove t/db_dependent/Circulation/MarkIssueReturned.t t/db_dependent/Suggestions.t
    Must not display DBI warnings
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40380339f9bdd0b2a056c820bc61a3cdc8545df3
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 14 18:18:03 2019 +0000

    Bug 23129: Set holdingbranch to library that initiates transfer
    
    To test:
    1 - Find an item
    2 - Check it in at anothe rbranch and initiate a transfer
    3 - View the item details or check db - note that holdingbranch is set as the destination library
    4 - Complete or cancel the transfer
    5 - Apply patch
    6 - Initiate a new transfer
    7 - Note the holdingbranch is set to the initiating library
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 61aa04e6cb04f1628dd549008de7924c39392527
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 14 18:17:54 2019 +0000

    Bug 23129: Unit test
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f8e6c9a87e9a5e6c7b67be0ea84f714eee8544af
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Oct 9 12:39:28 2019 +0000

    Bug 17247: (follow-up) Terminology fix: Use Restricted instead of debarred
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95fd391ae710dd1f04405c534e6738feb846b0d8
Author: Arthur Suzuki <arthur.suzuki@biblibre.com>
Date:   Mon May 13 11:29:50 2019 +0200

    Bug 17247: Check if patron is restricted in HoldItem and HoldTitle
    
    Test plan:
    Make sure a restricted patron cannot hold a title or item through ILS-DI.
    Response from the WebService should be "PatronDebarred".
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da90b8736ee66bf2cde78cbf3ae52fa4cbd585f5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 11 13:36:54 2019 +0100

    Bug 23772: Revert to passing itemtype objects to the template
    
    This patch restores the methodology prior to bug 23602 of passing the
    full Koha::ItemType objects to the template and thus giving us the
    ability to use all the methods present within them.
    
    Test plan:
    1) Ensure you have at least one itemtype with an assigned icon and the
       images enabled.
    2) View the itemtypes admin page and note the icons display again
    3) Ensure you have at least one itemtype with library limitations
       defined.
    4) View the itemtypes admin page and note the library limitations still
       display.
    5) Signoff
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 82abbb29f9b660533966b358554d854cc157f4b9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 15 13:45:13 2019 +0100

    Bug 13937: (RM follow-up) Set working directory for daemon mode.
    
    When running as a daemon under Net::Z3950::SimpleServer YAZ requires a
    little help to know where it's "working directory" is located so
    relative paths in config files may resolve correctly.
    
    This patch passes the working directory as prescribed on
    https://software.indexdata.com/yaz/doc/server.invocation.html such that
    the resolution of the cql2rpn filepath works as expected in tests.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 19fbc1cfa295edc0ff7e8801dd8a7026f2d75638
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Tue Oct 15 09:39:42 2019 +0300

    Bug 13937: (QA follow-up) Make tests work with YAZ 4 and 5.
    
    Also makes add_item_status tests more robust by clearing the cache after modifying authorised values.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2332e3ad46522ca2c81579dcbb2224886e095822
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Oct 14 09:36:10 2019 -0300

    Bug 13937: (follow-up) Add missing entry to koha-common.install
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit afb5796b340b697faf960b2d1bf5c33d82b7f7bf
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Wed Oct 9 14:15:39 2019 +0300

    Bug 13937: (QA follow-up) Fix tests.
    
    Checking result set size is enough to verify that proper results were returned. The check for non-existing record could have caused a range error depending of library versions.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ea1f6986692d3658bcd7ea72f3c27ee2cdde1727
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 14 09:56:18 2019 +0100

    Bug 23809: Correction to selectall_arrayref call.
    
    This patch adds the missing `{ Slice => {} }` attribute to the database
    call introduced in bug 23265 to fix the use of Koha::Objects introduced
    originally in bug 12063.
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b9086738e9ffc8fb5a2328caf7e6719e84ba63a0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 11 14:36:22 2019 +0100

    Bug 23803: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 171573d2984733a0677d353d8f361f2bfe87e05d
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Oct 11 12:40:32 2019 +0000

    Bug 23803: (follow-up) Remove additional references and file
    
    This patch removes the cart-small.gif file and a couple other references
    to the file.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f3b3498256e8af81232ff8be84f373509485f1f9
Author: Claire Gravely <claire.gravely@bsz-bw.de>
Date:   Fri Oct 11 12:23:09 2019 +0000

    Bug 23803: Add Font Awesome icon to cart in staff interface
    
    This patch adds the font awesome icon to the cart in the staff
    interface.
    
    To test:
    
    1. Apply patch and run yarn build (see:
     https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client)
    
    2. Check that the old cart icon no longer displays and the new font
       awesome icon is positioned correctly
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c9c6dd10167bc4c60cb384651f4dc802944c4228
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Oct 7 20:09:04 2019 +0000

    Bug 23771: Don't look for patrons if we don't have a userid
    
    While the code requires external auth to test, the change is simple enough I
    think a good read would suffice
    
    To test:
    1 - You either need Shib or CAS enabled and setup
    2 - Add two users with blank.null cardnumbers
    3 - Lock those user accounts
        Set failedloginattempts to 1
        Try a bad login with the userid
        Or set via the DB
    4 - Try a good login via the external auth
    5 - Note it fails
    6 - Apply patch
    7 - Login now succeeds
    
    Signed-off-by: Mike Somers - Bridgewater State University <msomers@bridgew.edu>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9d9bb45865c9d6c88952f47f52f0e92ddcce0054
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 11 10:57:30 2019 +0100

    Bug 17140: DBRev 19.06.00.040
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77b681b5843dabd8808e6ad3e62999f1e9421280
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Oct 4 12:02:59 2019 +0200

    Bug 23484: (follow-up) add parenthesis in JOIN
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c21a9cf0b0b8fc03629837c8651c10781ddfe3c7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Aug 21 13:39:14 2019 +0000

    Bug 23484: Update pendingreserves.pl to use circulation_rules
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bc6e5902898fc3fbaa69b0fcc99359eadd6a8c76
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Oct 4 08:15:43 2019 +0000

    Bug 17140: Atomic update file
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ae075fded2a4ef8fb2f241e4cf9bb90d7587b02c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 3 11:06:47 2019 +0000

    Bug 17140: Make rounding syspref controlled
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c2df905bfef771415d47aeba7db6ea445a33f1e1
Author: Philippe Blouin <philippe.blouin@inlibro.com>
Date:   Fri Dec 21 10:33:29 2018 -0500

    Bug 17140: fix rounding errors when paying fines
    
    Whenever a fine (accountlines in DB) has a precision longer than two floating points, it becomes very hard for a user to clear it.
    Ex: 1.035 will be displayed as 1.04 or 1.03 depending on the screen.  But entering any of those value in Pay Fine will not clear it.
    The user has no way to know the exact value to enter.
    
    This fix makes sure that the intent of the user is met, by matching the EXACT needed sum when the difference is less than 0.01.
    
    TEST
    1) Create a 1.035 fine
      - Go to a Patron screen
      - Fines tab on the left
      - Create manual invoice
    2) go to Pay fines, click Pay amount on bottom left.
    3) It will show 1.03 as Total, and as Collect from patron.  Click confirm.
    4) An error message will appear.
    5) Apply patch, do again.
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 85b5abcc4e8a0d41c0e286d1b9f7deba4905636c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 10 16:40:55 2019 +0000

    Bug 23626: (follow-up) Fix JS when not viewing results
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit df32a48c27d129bbb5aa03181e58ae2c525a74b3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 31 14:41:12 2018 +0000

    Bug 20780: (follow-up) Use Koha::Object
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8a579e5c6171a641388ad98836dbdb0c410d6362
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 18 16:56:26 2018 +0100

    Bug 20780: Add handling for AcqItemSetSubfieldsWhenRecieved in EDI
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 248373506eb05039acdc54e65a6825b714ae61b6
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Tue Oct 16 16:27:17 2018 +0100

    Bug 21580: Pass buyer_ean to create_edi_order
    
    create_edi_order requires two parameters to be passed
    but if vendor was set to auto_order the subroutine
    was called with basketno only resulting in the error
    'no basket or ean passed' - pass the buyer_ean as
    passed in the quotes message
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 870f25fbd900b4f5b792125a121661a2e545297f
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Tue Oct 16 16:21:49 2018 +0100

    Bug 21580: Add test for message buyer_ean method
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 15a30c129c16e7e70c47f0be62c2651954beb428
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 9 15:03:06 2019 +0100

    Bug 20334: (RM follow-up) Fix test for case insensative filesystems 2
    
    This patch moves the Elasticsearch/Indexer.t to ElasticSearch/Indexer.t
    and thus removes the case directory name collision introduced.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 104436cb74483cfef710fcda4b221d018311a6cd
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 9 15:03:06 2019 +0100

    Bug 20334: (RM follow-up) Fix test for case insensative filesystems
    
    This patch moved the tests created in Elasticsearch/QueryBuilder.t into
    ElasticSearch/QueryBuilder.t and thus removes the case directory name
    collision introduced.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a013f2bbdd9cbf0c560a855e66d665857f8b8db0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 9 14:37:39 2019 +0100

    Bug 17179: DBRev 19.06.00.039
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8564cbcd9ab130bd06ca41db1fe4489ec51cea8b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Oct 7 23:25:38 2019 +0000

    Bug 17179: (follow-up) Add to keyboard_shortcuts.sql
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5e746f9d567921b1419e63216bdfaa85374d19c4
Author: Alex Sassmannshausen <alex.sassmannshausen@ptfs-europe.com>
Date:   Thu Oct 3 15:36:26 2019 +0200

    Bug 17179: (follow-up) Correct typos, add default select.
    
    Correct error whereby object curCursor was invoked as a function.
    
    Added action whereby the most recent entry in the clipboard is
    selected after all copy and cut operations.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3b0ab38559ba021430aa1d9775748a6cb8dc94b2
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Feb 20 17:30:36 2019 +0000

    Bug 17179: Add keyboard shortcuts to repeat (duplicate) a field, and cut text
    
    This patchset introduces an internal clipboard to the advanced editor
    and provides some new functionality to make use of this, default shortcuts are provided
    but can be edited per bug 21411
    
    The default shortcuts for new/changed functions are:
    
    Changed:
    Ctrl-X:       Now cuts a line into the clipboard area
    Shift-Ctrl-X: Now cuts current subfield into clipboard area
    
    Added:
    Ctrl-C:       Copies a line into the clipboard area
    Shift-Ctrl-C: Copies current subfield into clipboard area
    Ctrl-P:       Pastes the selected item from the clipboard at cursor
    Ctrl-I:       Copies the current line and inserts onto a new line below
    
    To test:
    Verify all functionality above and confirm it behaves as expected
    
    Note:
    Ctrl-v pastes from the system clipboard - codemirror does not have
    access and this is why we use our "Clipboard"
    
    For browser cut/paste please use mouse right click or context menus
    
    Ctrl-P can be accessed as print by focusing outside the editor window
    
    Signed-off-by: Alex Sassmannshausen <alex@komputilo.eu>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 90e2882568375bce956d0cb50edfa070c42cafce
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Oct 9 08:28:32 2019 -0400

    Bug 23626: Add missing TT failure
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit afa1106782d794b98efa90200ac793d7078a2686
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Oct 7 12:34:07 2019 -0400

    Bug 23626: [alternate] Default to including all rows
    
    If a person is fetching all data, it seems most likely that that person wants
    to see all the data in the chart. We should default to that behavior.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 83a545d8318560eb2ee385289ff8c291f07f6716
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Oct 2 09:58:59 2019 +0000

    Bug 23626: Only fetch full chart data if requested
    
    This patchset prevents the full return of report data unless explicitly requested by the user for charting purposes
    Additionally the user is warned if requesting more than 1000 rows of data
    
    To test:
     1 - Create a report that returns over 1000 rows of data
     2 - Run the report
     3 - Note you have two buttons now 'Chart data' and 'Fetch all data for chart'
     4 - Click chart data
     5 - Note the note that you are only charting visible data
     6 - Create the chart and confirm it works
     7 - Close the chart
     8 - Click 'Fetch all data'
     9 - Note the confirm window
    10 - Click 'cancel', note there is no change
    11 - Repeat and click ok
    12 - Fetch all data button is gone
    13 - Page to next data, note fetch all does not return
    14 - Click 'Chart data'
    15 - Note you now have checkbox option to use all data in report
    16 - Click it
    17 - Create chart
    18 - Confirm it works as expected
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bc9871f428af323901ebe57a6d0888f1dcf871cf
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Oct 8 14:18:01 2019 +0000

    Bug 23778: Regression: Guarantor entry section no longer has a unique id
    
    This patch adds back a fieldset ID which was accidentally removed by Bug
    14570:
    
    <fieldset id="memberentry_guarantor" class="rows">
    
    This ID is important if libraries want to customize the patron entry
    page to hide the guarantor section.
    
    To test, apply the patch and go to Patrons -> New patron.
    
    Inspect the markup and look at the fieldset labeled "Guarantor
    information." It should have the correct ID attribute.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 759790c97aee0c5e7d768459f3cf7525961666ef
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 8 15:34:24 2019 -0500

    Bug 22927: Do not check an already lost item when marked as withdrawn or damaged
    
    Due to how moredetail.pl was written it was hard to know which action
    was triggered.
    
    Test plan:
    - Set MarkLostItemsAsReturned to "from the items tab of the catalog
    module."
    - Check an item out to a patron
    - Use additem.pl to set that item to a lost status without returning it
    - go to moredetail.pl for that item
    - mark item as either damaged or withdrawn without interacting with the
    lost dropdown
    - note that item has not been returned
    
    Note for QA: Maybe we could have just tested if exists $item_changes->{'itemlost'}
    to call LostItem
    
    Signed-off-by: Claudie Trégouët <claudie.tregouet@biblibre.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ce8896f17d99cbbc663b8cc59110ce01d8e70afd
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Aug 9 13:51:46 2019 +0200

    Bug 22997: Unit test
    
    Run prove t/db_dependent/Koha/SearchEngine/Elasticsearch/QueryBuilder.t
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a94e863c3ed17c177c9ce5d284616791fd5cd380
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue May 28 15:48:54 2019 +0200

    Bug 22997: Searching gives no results in auth_finder.pl
    
    During cataloguing of an existing biblio, on an heading field,
    the use of tag editor fills authorities finder with existing value :
      Search main heading ($a only)
      Search main heading
    Default operator beeing 'contains'.
    
    Actually with Elasticsearch those search give no results.
    
    Example with heading :
    200
      $a Casaubon
      $b Isaac
      $f 1559-1614
    
    Call to Elasticsearch :
        "query" : {
            "bool" : {
               "must" : [
                  {
                 "query_string" : {
                      "query" : "Casaubon*",
                      "default_field" : "heading-main",
                       }
                  },
                  {
                 "query_string" : {
                      "query" : "(Isaac*) AND (1559-1614*)",
                      "default_field" : "heading"
                       }
                  }
                ]
             }
          },
        "sort" : [
           {
          "heading__sort.phrase" : "asc"
           }
         ]
      }
    
    Patch adds to "query_string" :
      analyze_wildcard : true.
    
    Test plan :
    1) Use Elasticsearch
    2) Edit an existing biblio record
    3) Use tag editor on a heading
    4) Click search => You get correct results
    5) Check also search in authorities-home.pl
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 13de5a93200bd6621d1fa2eab5279d51264dce8a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Oct 9 07:28:50 2019 +0100

    Bug 14669: (RM follow-up) Ensure updated include compiles
    
    The introduction of `options_for_libraries` in the filter-orders include
    template requires that we process 'html_helpers' within the file to
    ensure it always compiles.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d96de62c99e2dc8958b6ead510e66c21d89d00d2
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Wed Oct 2 23:54:21 2019 +0000

    Bug 23720: Add div wrapper to search results to make moving cover images easier
    
    TEST PLAN:
    
    1. Apply this patch and turn on some cover images.
    2. Add this CSS: '.bibliocol {display: flex;}.coverimages
       {padding-right:20px;}' to the OPACUserCSS.
    3. Notice covers on left.
    4. Remove CSS and notice covers should look normal on the right side.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c5b97485822c875a5fb59495cef9ba5123a5497b
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Thu Oct 3 06:27:27 2019 +0000

    Bug 23731: Give staff detail/OPAC detail option to display LOC classification
    
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd895dd62faa6d3fedaf767c1b3cc3672215e615
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Oct 7 21:27:03 2019 +0200

    Bug 23694: (QA follow-up) Add new class for 'by' to intranet XSLT
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 139dd6600ec6a6989b53aa66325ead03ba131c0d
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Mon Sep 30 15:29:05 2019 +0000

    Bug 23694: Author "By" should have its own class
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d50787b57b8f34693e64b576be2f4491f2c4e52
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 8 14:52:33 2019 +0100

    Bug 23697: DBRev 19.06.00.038
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7c4b28989e2e966b29d285c8430dc17fbd88ded9
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Oct 7 18:59:57 2019 +0000

    Bug 23697: (QA follow-up) Fix quotes in database update statement
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 30627be138c12c5baed5df934290b8e78dc99153
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Oct 7 20:54:29 2019 +0200

    Bug 23697: (QA follow-up) Rename PatronAutocompletion to PatronAutoComplete
    
    Just a find and replace on the changed system preference name.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e5bf67135726fde4dfa349d36348cbeadd30b3c7
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Fri Oct 4 11:16:08 2019 +0200

    Bug 23697: (follow-up) Add autocompletion search in patron module
    
     - Rename CircAutocompl system preference to PatronAutocompletion
     - Take this system preference into consideration for patron search
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a777b6376d0b49962229aa7b7b0f9ca4341afb91
Author: Matthias Meusburger <matthias.meusburger@biblibre.com>
Date:   Wed Oct 2 14:21:00 2019 +0200

    Bug 23697: Add autocompletion search in patron module
    
     Test plan:
    
      - Apply the patch
      - Go to "Patrons" (members/members-home.pl)
      - Check that autocomplete is enabled for patron search
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1feb110d05dd4b6672f9f96ed4b86aecd057819b
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Aug 26 14:33:29 2019 -0400

    Bug 23507: Add ability to show change given on auto-popup fee receipt from FinePaymentAutoPopup
    
    Some libraries would like to show the amount of change given on print reciepts triggered by FinePaymentAutoPopup
    so the patron can verify he or she has recieved the correct amount of change.
    
    1) Apply this patch
    2) Edit ACCOUNT_CREDIT slip and add "[% IF change_given %]<h1>CHANGE: [% change_given %]</h1>[% END %]" at the top
    3) Enable FinePaymentAutoPopup
    4) Make a payment
    5) Note the change given is shown on the popup receipt
    6) Note the change given is *not* shown on subsequent prints of the same receipt using the "print" button for the payment
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Hasina Akhte <hasinaa@pascolibraries.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d9bc489a23596b37eca88eec46d2ead030d8e82
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 8 14:45:03 2019 +0100

    Bug 21701: DBRev 19.06.00.037
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6e3ff481823aae285e19f01dad039bbe4dd583eb
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Oct 7 09:22:03 2019 -0400

    Bug 21701: Fix up db update
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e4c8af4f358fca3bc1ae17deb7e2cd9a45a76d64
Author: David Kuhn <techservspec@gmail.com>
Date:   Thu Nov 8 08:58:37 2018 -0800

    Bug 21701: Have PayPal optionally return to originating OPAC url rather than OPACBaseURL
    
    This enhancement will allow a library to choose whether to use the alias of the
    current OPAC or the value of OPACBaseURL as the return url when making payments
    via PayPal.
    
    To test:
    Note: you need to have PayPal enabled on your system (either Sandbox mode or
    Live) and be using an alias URL for your OPAC.
    
    1. Apply the patch.
    2. With the option "PayPalReturnURL" set to "OPACBaseURL", log into a card via
    the OPAC and start the process to pay in PayPal (you can either complete the
    payment or cancel from the PayPal page). When you are returned to the OPAC, the
    domain will be the value of OPACBaseURL.
    3. With the option "PayPalReturnURL" set to "OPAC's alias", repeat the above
    sequence to make a payment in PayPal. When you are returned to the OPAC, the
    domain will be your current alias.
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 300a7a8110b5c48f5df387b73e5240f5977a8e4e
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Tue Jul 23 15:14:51 2019 +0300

    Bug 13937: Add SRU tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit afeca7cfa8635984eacc88014696a931cbf54cb3
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Fri Mar 8 11:40:54 2019 +0200

    Bug 13937: Switch from GetItem() to Koha::Items->find()
    
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bf06e424141476542781dccc75562e0c4bbf5d0b
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@helsinki.fi>
Date:   Thu Feb 14 15:08:54 2019 +0200

    Bug 13937: Fix the daemon log path.
    
    directory _LOG_DIR_/logs does't exists.
    
    All other log4perl -logs are out to _LOG_DIR_
    
    Thank you for the good work Ere!
    
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5af4cc2e6561114f75f4cc46f5336f5ab0603c58
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Fri Jan 11 11:27:56 2019 +0200

    Bug 13937: Add support for Z39.50 responder to the Debian scripts
    
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9fb7f01f001001c12693e4538339e42f1797e77a
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Tue Jan 15 13:54:17 2019 +0200

    Bug 13937: Fix RPN conversion
    
    Fixes handling of parenthesis and removes unused quote handling.
    
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fe59ab8165278d1c64474191f5558685a4f21ca2
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Tue Nov 27 13:40:44 2018 +0200

    Bug 13937: Add tests for search and retrieval
    
    Sponsored-by: National Library of Finland
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ac28d8043d16342ed198cceca9168498ced37fd6
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Thu Nov 22 11:20:01 2018 +0200

    Bug 13937: Add support for SRU and Elasticsearch
    
    Splits Session to GenericSession and ZebraSession where Generic supports any
    search backend via the SearchEngine classes and Zebra maintains the direct
    channel to the Zebra server.
    
    Adds config files required for mapping BIB-1 attributes to Koha search fields
    and SRU indexes to BIB-1 attributes.
    
    Adds PODs.
    
    Sponsored-by: National Library of Finland
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 925db0baefe856a505cd8378aa33ba7dabcd646f
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Wed Nov 21 16:20:33 2018 +0200

    Bug 13937: Fix issues found in QA
    
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c4e5d079bf0b3475ab37d67f6387b662c33e2c9f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Nov 14 12:29:52 2017 +0000

    Bug 13937: (follow-up) Pass through yaz switches and don't ignore case
    
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 67d798fc9e4f6e64c105ee5c940a9074a6ad4cda
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Sep 7 11:50:42 2017 -0400

    Bug 13937: Add unit tests
    
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c5b5e4186260c1af3f0481a4a0b60f1e8729a19
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Sep 7 11:49:34 2017 -0400

    Bug 13937: (follow-up) Correct error call to use self
    
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5433517119f9ca1acd419efd10c3a4dac15d7419
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Dec 12 14:20:25 2016 +0000

    Bug 13937: (follow-up) Remove reference to sub _prefetch_records
    
    Remove reference to sub _prefetch_records
    
    It appears this sub is built into fetch and this call is a duplicate
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f089d393dc421f484bb806b0c587ffefe0d9020b
Author: Jesse Weaver <pianohacker@gmail.com>
Date:   Fri Dec 11 14:26:20 2015 -0700

    Bug 13937: Add a Z39.50 daemon that can inject item status MARC subfields
    
    This creates a new daemon, misc/z3950_responder.pl, which can respond to
    Z39.50 requests. By default, it just proxies searches to Zebra.
    
    If desired, however, it can also add a subfield to the item tags on
    outgoing records with a textual description of the item's status
    (checked out, lost, etc.). This is useful for certain ILL systems. These
    strings can be translated using the 'Z3950_STATUS' authorized value.
    
    Test plan:
      1) Start the Z39.50 server using `perl misc/z3950_responder.pl`.
      2) Connect to the server using `yaz-client 127.0.0.1:9999/biblios`.
      3) Run a search, such as `find @attr 1=1016 book`.
      4) Fetch the results both one at a time with `show 1` and in a batch
         using `show 1+5`.
      5) Turn on MARCXML using `format xml` and `elements marcxml`, and
         verify that the records are still correctly fetched.
      6) Enable the item status subfield by restarting the server with the
         option `--add-item-status=k`.
      7) Search for and fetch records, and verify that a $k subfield is
         added to the item tags as appropriate. It should show some
         combination of "Checked Out", "Lost", "Not For Loan", "Damaged",
         "Withdrawn", "In Transit", or "On Hold" as appropriate, or
         "Available".
      8) Add an authorized value named "Z3950_STATUS" with any of the keys
         "AVAILABLE", "CHECKED_OUT", "LOST", "NOT_FOR_LOAN", "DAMAGED",
         "WITHDRAWN", "IN_TRANSIT" or "ON_HOLD", and verify that their
         descriptions are used instead of the default values above.
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Stefan Berndtsson <stefan.berndtsson@ub.gu.se>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a3615f8c10510ed1974a1017134788d3995e99a3
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Jul 3 19:58:20 2019 +0000

    Bug 17005: Fix bad rebase
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c2d7189d0e80e5aa8b61a3fe821f40bf9a3489b9
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Apr 4 07:42:14 2019 +0000

    Bug 17005: Add plugin parameters to /checkouts endpoint
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 24245e2aefe80b9ae62395410a89477bf0cd985f
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Mon Apr 1 08:24:23 2019 +0000

    Bug 17005: Test for checked_in parameter
    
    Test plan:
    prove t/db_dependent/api/v1/checkouts.t
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 321b1c1f3c52a05e049c2b45d761cbb00e0724d4
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Mon Apr 1 07:56:39 2019 +0000

    Bug 17005: Add checked_in checkouts to REST API response
    
    This patch implements parameter 'checked_in' on checkouts endpoint to
    enable getting circulation history.
    
    Test plan:
    1) Apply the patch and restart plack
    2) Use your favorite REST API tester and play with /checkouts endpoint:
        - use it without checked_in parameter
        - use checked_in=1 for getting returned checkouts
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cf383c914875b3615db5e89ad6a5a21af059a4f8
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Oct 3 15:04:35 2019 +0200

    Bug 18309: Add missing fields in biblio framework
    
    018 - [Reserved for other International Standard Numbers]
    033 - Other System Persistent Record Identifier
    183 - Coded Data Field: Type of Carrier
    203 - Content Form and Media Type
    231 - Digital File Characteristics
    283 - Carrier Type
    338 - Funding Information Note
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0f8de2fa9f774e66cdce9926878e64f2e20406eb
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 14:58:24 2019 +0200

    Bug 18309: Fix INSERT sql query in unimarc_framework_DEFAULT.sql
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1b7698365e08c8d4682f732f9972fdaedbed62da
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Oct 2 14:17:23 2019 +0200

    Bug 18309: Add UNIMARC field 214 and its subfields
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d636ceb7c831ec7d9de04423941314cfe158e729
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Thu Mar 23 11:24:30 2017 +0100

    Bug 18309: UNIMARC update from IFLA - biblio UNIMARC complet (en)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5794323c1a74c7d98aead2e7d466c21495296cce
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 16:21:44 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (STU)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5e958e4c190d39c4355fd219a211b5e69e52d65b
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 16:20:17 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (SCO)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 565bfc6fd0f74903d4b7c1ce0c2b4c1e60434494
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 16:19:56 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (SAUT)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0fac4e5fafac19fcec6704cbdae7af53deeeffdf
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 16:19:29 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (FA)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 216c7db298afc02598029aae04cb8e4a48d7c1ce
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 16:19:03 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (CO_UNI_TI)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b639381bd9e44c9630dc66dc3f581f669733bdff
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 16:18:14 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (AUTTIT)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 33894d78bb6f13767d5fcd7dd2bd793a0f0afadf
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 16:17:01 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (TM)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2a87fe1656cb4d36e247ad661c81cc17a3f566c5
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 16:15:51 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (SNG)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 192c408ce005fe4eec6fb9b9daf18625e3a36567
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 16:14:30 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (SNC)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c1524822f0d769d2732d37645a9fd21c4a4cf0e1
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 15:51:55 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (SAUTTIT)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 72877f873362626c77f85d83f7d4ff19d9791ff2
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 15:49:19 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (PA)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2ead835ba36226561fe956b224b9d55ccdcd71a6
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 15:47:57 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (NP)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d067e75658b41d75f5f1c045055b90a392888fd
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 15:46:25 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (FAM)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5593b697aab2925088da59ba0f1817adffcbfb90
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 15:43:36 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (GENRE/FORM)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 03dae8d6c2c4177f9c0f0d0bdf68c5c2e6395af5
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 15:37:16 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (FAM)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e4a59974245dba3bd50bf946dedd77a153118f59
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 15:29:46 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (WORK)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52111f742b6027f2e5f090f6557a612226b7b130
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 15:28:13 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (TU)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8084a62402f1b683f2695f2008d158a59db94bea
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 15:16:58 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (PUB)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3423e9f015bf9e034597a99baab2af85419dd525
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 15:14:29 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (PERS)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c08b0706c548ad55699552fd4874770481cb6daa
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 15:00:59 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (NTWORK)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd7732e29523bd582504affb845ad93f372a6d26
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 14:55:34 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (NTEXP)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5e0c1cfaaa58677abb68f1dd61391264af9e2d88
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 14:45:55 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (EXP)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9c299ee9131862cb3ab8bebc4796c9015461e3fa
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 14:35:49 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (CO)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5cfe1ba7ba7940b20303edacb16026aa2c0b504f
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 14:33:33 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (CLASS)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 98fc2807a5c1b80476e8a635d2164f00f1176a44
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Mon Sep 30 14:30:19 2019 +0200

    Bug 18309: UNIMARC update from IFLA - authority (fr) (default framework)
    
    Signed-off-by: Sonia BOUIS <sonia.bouis@univ-lyon3.fr>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ea59b648f19b8567db4ff944d5ea80f0ec23b891
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 26 16:23:49 2019 -0300

    Bug 23677: Unit tests
    
    This patch introduces tests for the GET /biblios/{biblio_id} endpoint.
    It tries to cover all the use cases.
    
    To test:
    - Apply this patchset
    - Run:
      $ kshell
     k$ prove t/db_dependent/api/v1/biblios.t
    => SUCCESS: Tests pass!
    - Use Postman (or your favourite tool) to test the API
    => SUCCESS: Works as expected!
    - Sign off :-D
    
    Signed-off-by: Arthur Suzuki <arthur.suzuki@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f67e23c2c2c71b8378ee6612ca28e7d6ecb71f93
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 26 16:23:41 2019 -0300

    Bug 23677: Controller method and dependencies tweak
    
    Signed-off-by: Arthur Suzuki <arthur.suzuki@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ac8d9f77a0f3511cc7155e5dbf170bbebfd467a7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 26 16:22:54 2019 -0300

    Bug 23677: Schema fix
    
    Signed-off-by: Arthur Suzuki <arthur.suzuki@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4fb59c87ed30fe9d9a0eb541e37e01e35411969b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 26 16:22:34 2019 -0300

    Bug 23677: OpenAPI spec for GET /biblios/{biblio_id}
    
    Signed-off-by: Arthur Suzuki <arthur.suzuki@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b604e9c4fcfd62e9920dfded310e2f3f2af9a840
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Feb 8 10:37:50 2019 +0000

    Bug 22294: Check return of as_isbn10 before calling methods on it
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d66432cafd2da2f856facbb8aca83938507827ba
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Mar 20 17:37:56 2019 +0000

    Bug 22540: (QA follow-up) fixes
    
    borrowernumber is not an accessor for C4::SIP::ILS::Patron, access is
    via hashref
    
    Add ability to specify the pickup location using a command line
    parameter
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: frederik chenier <frederik.chenier@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d5d9f9d5aa407eb141403e0e81f0d2f961a817f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Mar 19 11:22:03 2019 -0400

    Bug 22540: Add ability to place holds using SIP CLI emulator
    
    Test Plan:
    1) Place a hold using the following arguments:
       sip_cli_emulator.pl -a <address> -p <port> -su <sip_user> -sp <sip_password> -l <location_code> --patron <cardnumber> --item <barcode> -m hold
    2) Note the hold was placed in Koha
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: frederik chenier <frederik.chenier@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 38a7e5e724decb54b59ced337dc81bf1131059ba
Author: Magnus Enger <magnus@libriotech.no>
Date:   Mon Sep 30 10:03:13 2019 +0200

    Bug 23400: Add --status to koha-indexer
    
    koha-zebra has a nice, informative --status switch, koha-indexer
    does not. This patch adds it.
    
    To test:
    - Run "sudo koha-indexer --status kohadev" - you get an error:
      "Error: invalid option switch (--status)"
    - Apply this patch
    - If you are on e.g. kohadevbox you need to copy koha-indexer to
      where it is actually run from:
      sudo cp debian/scripts/koha-indexer /usr/sbin/koha-indexer
    - Run "sudo koha-indexer --status kohadev" again and you should
      get a nice status telling if the indexer is running or not
    - Toggle the indexer on and off with koha-indexer --start/--stop
      and verify the status is telling the truth about the state of
      the indexer
    - Run "sudo koha-indexer --help" and check there is a description
      of the --status option
    - Have a look at debian/docs/koha-indexer.xml and verify there is
      an adequate description of the --status option.
    - Run "prove -v xt/verify-debian-docbook.t" to check the structure
      of the man page in DocBook format.
    
    PS: I tried to generate a manpage from the DocBook as described at
    https://wiki.koha-community.org/wiki/Testing_man_pages
    but the output did not look good for any of our DocBook files.
    Not sure why.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 21412affb48998e315b84ec7d20feca00be11b9d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 8 14:18:54 2019 +0100

    Bug 21245: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0ae7c6a343577cb1cbecffdc202bcca222041d83
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue May 7 11:59:32 2019 +0100

    Bug 21245: Move 'Last patron' button into 'breadcrumb' bar
    
    This patch moved the 'Last patron' button introduced in bug 20312 inline
    with the breadcrumb bar from floating above it.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95c43ebe7206ee68711f5bc7d7b24b6a81d7ec81
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Oct 8 14:05:49 2019 +0200

    Bug 23101: (follow-up) use NoSort class in datatable
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 172a4836bf4cf142db2a49a24b0e56a5f0952d72
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 8 14:13:59 2019 +0100

    Bug 20334: DBRev 19.06.00.036
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1145b7406cbd1ba3bc850d4d6c5268372abee073
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Oct 28 23:57:46 2018 +0000

    Bug 20334: Move new system preference into right spot in alphabet
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9355a035fb202efb54925aebe59737e1e7888eda
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Mon Oct 22 15:50:07 2018 +0200

    Bug 20334: Improve syspref description and set more sensible defaults
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da16f6bc9185f8ae166d46c8e35f3565e41d6bc0
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Fri Mar 2 18:16:39 2018 +0100

    Bug 20334: Option for escaping slashes in search queries
    
    Add "QueryRegexEscapeOption" system preference to provide option to escape
    Elasticsearch regexp delimiters (/) within queries, or alternativly to
    unescape escaped slashes (\/) while escaping unescaped slashes, in
    effect making "\/" the new regexp delimiter.
    
    How to test:
    1) Run tests in ./t/Koha/SearchEngine/ElasticSearch/QueryBuilder.t
    2) All tests should succeed
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    Signed-off-by: Maksim Sen <maksim.sen@inlibro.com>
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3ab36c2c935d8cdef5158147d659590b4015b53e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Dec 4 14:58:35 2018 +0000

    Bug 15422: Consider partial copies needed as whole numbers
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c47e4736f2a9356eac26dca980ecbcbb509b8f97
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Nov 29 02:07:18 2018 +0000

    Bug 15422: Correct calculation of holds ratio report
    
    See comment 1 for a detailed explanation of current calculations and
    needed calculations
    
    Also removes an unnecessary variable
    
    To test:
     1 - Place 4 holds on a biblio with one item
     2 - go to /cgi-bin/koha/circ/reserveratios.pl (Circulation->Holds
            ratios)
     3 - Run with 'Hold ratio'=3, it says order 1, ok
     4 - Run with HR=4, it says order 1, wrong
     5 - Run with HR=2, it syas order 2, wrong
     6 - Run with HR=.5, it syas order 4, wrong
     7 - Apply patch
     8 - Run with HR=3, order 1, OK
     9 - Run with HR=4, item does not appear (0 to order), OK
    10 - Run with HR=2, order 1, OK
    11 - Run with HR=.5, order 7, OK
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 018bcce2f7e4f58de7177f7985055a34abcdb616
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat May 11 21:08:11 2019 +0000

    Bug 14669: Add search option for managing library to orders search
    
    Currently the order search can't be limited by managing library.
    The patch adds the search option to the order history search form
    and a column for the managing library to the search results table.
    
    To test:
    - Create some baskets with orders
      - Set managing library for some, but also have some without
    - Apply patch
    - prove t/db_dependent/Acquisition.t
    - Go to Aquisition > Orders search tab on top > Advanced search link
    - Search for orders without limiting
      Orders with and without managing library set should show up
    - Limit search to a specific managing library
    - Verify results match expectations
    
    Signed-off-by: Alex Sassmannshausen <alex@komputilo.eu>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1e727da0446ad3814f8519b86120020af2f4099a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Apr 30 13:54:37 2019 -0400

    Bug 22667: Pick default value from framework for cn_source
    
    If the cn_source has a default value defined in the framework it will
    not be used when ordering or receiving serials.
    
    Test plan:
    Set the pref DefaultClassificationSource to Library of congress
    Define a default value=ddc (for Dewey) for the ACQ and default framework
    Receive an order (AcqCreateItem=on ordering) and confirm that Dewey is
    selected by default (the default value from the ACQ framework is used)
    Receive a serial and confirm that Dewey is selected by default
    
    Signed-off-by: Brendan Gallagher <brendan@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f692ad00cbf49b1ff77937e75024b8e3bc8fa9c8
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 3 09:46:46 2019 +0000

    Bug 23320: (follow-up) Remove unused budget_name variable
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 80a5cfd705b80f28c4bf74cc3e8a59bdeff5018e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jul 15 18:01:25 2019 +0000

    Bug 23320: Removed unused close parameter in neworderempty
    
    To test:
     1 - Add to basket
     2 - Note the options on the page
     3 - Add &close=1 to the url
     4 - Note some inputs are disabled
     5 - Save anyway, note it is a regular order
     6 - Add another order to basket
     7 - Save it
     8 - Modify
     9 - Add close to the url again
    10 - Save changes
    11 - No functional change
    12 - Apply patch
    13 - Note close parameter has no effect now
    14 - Confirm you can place and confirm orders as before
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b5a0f5be76a9c1a6a62fac375d15bba25abe7555
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Wed Oct 2 17:34:53 2019 +0000

    Bug 23726: Give class to No Items Available text on OPAC results page
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9fe80a405405d043d2e17779974c1060477b521d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 8 13:59:29 2019 +0100

    Bug 23729: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ca018e8201bb527cc69c8beaaedd7fad780edbb7
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Wed Oct 2 19:01:14 2019 +0000

    Bug 23729: Move CSS from moremember.tt template to staff global CSS
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 182e64b86480bc58fb0f9bd044e7e7e31353bc26
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 7 16:22:19 2019 +0100

    Bug 14862: (follow-up) Add minified version of jQuery 3.4.1
    
    This patch updates the file 'jquery-3.4.1.min.js' so that it is indeed
    minified.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b1fb387acee35ba64f61d59fd332a79d5759e06
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Aug 16 13:51:25 2019 +0000

    Bug 14862: Upgrade jQuery from 1.7 to 3.4.1 in OPAC
    
    This patch upgrades jQuery to 3.4.1, jQuery-UI to 1.12.1, and adds the
    jQuery-migrate plugin to ensure backwards-compatibility with existing
    jQuery plugins and code. An updated of jquery-ui-rtl.css has been
    created by converting the new version of jquery-ui.css.
    
    All jQuery assets are now include the version number in the file name
    just as we now do in the staff client.
    
    Besides updating file names in the templates, there was only one change
    made: opac-results.tt had a typo which has been corrected.
    
    To test, apply the patch and test as many different pages in the OPAC as
    possible, including self-checkout and self checkin. Keep the browser
    console open and watch for JavaScript errors. All JavaScript-driven
    behavior should work correctly. For instance:
    
     - Tabs
     - Datepickers
     - Select all/none operations
     - Cart and lists popups
     - Search result highlighting
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 22aaf8f1f9ade2a37a14ef409388b012224041da
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 7 13:55:38 2019 +0100

    Bug 18421: DBRev 19.06.00.035
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 47e48f3ade4eba7fc12cf39c865b366e092a73f2
Author: Maryse Simard <maryse.simard@inlibro.com>
Date:   Fri Jan 4 09:18:33 2019 -0500

    Bug 18421: (follow-up) Center image in results table
    
    Adds the "thumbnail" class to the image to have it centered.
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4ecc88b25969d3bb663b55de9ba377b9170f9992
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Oct 5 15:14:57 2018 +0000

    Bug 18421: (follow-up) Adding missing filters
    
    This patch adds template filters as prompted by the QA tool.
    
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ef897b41f5b7e5f7f9427d8e55390988bf91d6cd
Author: Charles Farmer <charles.farmer@inLibro.com>
Date:   Wed Aug 8 17:43:27 2018 -0400

    Bug 18421: (follow-up) QA fixes
    
    Use the community's terminology, change coce.js's path, update <script>
    to Asset, remove forbidden patterns
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3c0cdedfb00528e64dc35c98523258d641e312e4
Author: Charles Farmer <charles.farmer@inLibro.com>
Date:   Fri Mar 30 11:58:55 2018 -0400

    Bug 18421: Add Coce to the staff intranet
    
    TEST PLAN:
        1) Apply the patch with git-bz
        2) Run updatedatabase.pl
            2.1) Console output should confirm database modification
        3) Visit the 'Enhanced Content' tab of admin/syspref
            3.1) ressource is /cgi-bin/koha/admin/preferences.pl?tab=enhanced_content
            3.2) You should see that the previous preference, Coce, is now CoceOPAC,
                 and that a new preference was added, CoceIntranet
        4) Activate CoceIntranet
        5) Do a search for a book for which you have a Coce cover
            5.1) The cover image url should now point to a provider you defined in Coce
            5.2) Your Coce log should show a query
        6) Click on the book's name to visit the detail.pl page
            6.1) The book's cover should also be provided by Coce on that page
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Alex Buckley <alexbuckley@catalyst.net.nz>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2cb34d25cc99ab8ec62e561cf6f1658d09f15efd
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Oct 3 13:55:04 2019 +0000

    Bug 23611: (follow-up) Exclude "actions" column from export
    
    This patch adds a missing "noExport" class to ensure that the "actions"
    column isn't included in export and print views.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d8d17dfaa38909e9882732a61b34de29e6e7c722
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Oct 2 15:49:55 2019 +0000

    Bug 23611: (follow-up) Correct ID of table
    
    The DataTable configuration wasn't working on the table showing an
    individual category's authorized values because of a mismatch in the
    table id. This patch corrects it.
    
    To test, apply the patch and view the "Authorized values" page.
    
    The initial list of categories should be displayed as a DataTable. Click
    through to see the values defined for any category. The resulting table
    of values should also be a functioning DataTable.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3046c1f850a5750181afb87e9ed216516b63c5b9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Sep 13 18:42:41 2019 +0000

    Bug 23611: Add export option to authorized values administration
    
    This patch changes the authorized values DataTables configuration to add
    export options.
    
    To test apply the patch and go to Administration -> Authorized values.
    
    Test the "Export" button and confirm that the data is exported correctly
    with each option.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f8e1db67f033031a94d3427718b920e24498ac1b
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Jul 12 13:41:21 2019 +0000

    Bug 23123: Add missing suggestion status to template for translation
    
    This completes suggestion status options in the templates in 2 places
    so all values can be translated and show correctly.
    
    To test:
    - Create 2 suggestions
    - Accept them
    - Create a basket and order those 2 from suggestions
    - Close the basket
    - Receive shipment and receive one of the 2 suggestions
    - Go back to suggestions:
      - Look at the status column in the suggestions table for both
      - Verify that it shows AVAILABLE
      - View both suggestions
      - Verify that the Status: is empty
    - Apply patch
    - Repeat test from above, it should all show nicely now
    
    Signed-off-by: Claudie Trégouët <claudie.tregouet@biblibre.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 131bce2cedc400e4ee139828657e94b7a1ce2f41
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Aug 11 12:17:24 2019 +0200

    Bug 8778: Add Keyword phrase to OPAC advanced search
    
    Adds a new search index to the advanced search in OPAC:
    Keyword phrase
    The new search option displays when the "More options" are
    selected.
    
    To test:
    - Apply patch
    - Go to Advanced search in OPAC
    - Look at the search pull downs
    - Verify everything looks correct
    - Click "More options"
    - Verify the Keyword phrase search option shows
    - Test if it works correctly
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b488527ebeb3b335854f2290aa1c6cf80f464eb0
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Thu Sep 26 11:50:14 2019 +0200

    Bug 23680: Incorrect conversion of Perl boolean to js
    
    A Perl boolean value is on the server side converted
    to a JS string (resulting in the values '0' or '1).
    Since the string '0' is a truthy value in JS this
    incorrectly triggers window.close() on the client
    in many instances, for example when adding a new item.
    
    To test:
    
    1. Go to a bibliographic record in the staff client.
    2. Expand the "New" menu and open "New item" in new tab.
    3. The new tab will immediately close.
    4. Apply the patch.
    5. Perform steps 1-2 again.
    6. The tab should now remain open.
    
    Sponsored-by: Gothenburg University Library
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd18ec355bcd369b4d9b1017caf0851d067cf811
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Aug 11 12:52:18 2019 +0200

    Bug 22884: Show separator between 440 and 490 fields
    
    This adds a ; as separator between 440 and 490 fields used in the
    same record. Currently we loop first 440 and then 490. 490 is displayed
    depending on the indicator.
    
    So after we finish the first loop, we check for existence of 490 on the
    same record now to decide if a separator is needed.
    
    To test:
    - Look at various records using one or multiple 440 and 490 fields
    - Verify the display is correct, especially when both appar on the
      same record in both OPAC and staff
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b090ff49df4dca3a93d5c3a32f91e7924950ec0a
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Jun 17 20:54:51 2019 +0000

    Bug 22884: (follow-up) Remove ending . from 440 in OPAC detail
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: frederik <frederik@inlibro.com>
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3bed943ba2c8150490a6c6cde628ff3857a98613
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat May 11 22:58:45 2019 +0000

    Bug 22884: Remove field ending . from XSLT templates
    
    Currently Koha very inconsistently adds a . at the end when
    outputting MARC fields on the detail views.
    
    This patch removes the few cases where we add in .
    Keeping the end user in mind, I believe it's not needed and
    the added consistency will be nice. ISBD should be added on
    cataloguing or by templates, but we should not mix when possible.
    
    To test:
    Catalog the following fields, if repeatable, add more than one:
    - 020
    - 022
    - 111
    - 242
    - 245
    - 246
    - 250
    - 300
    - 440
    - 490
    - 700/710/711 with $i
    - 700/710/711 ind.2 = 2
    Verify both on staff and OPAC detail pages that there is no
    additional . at the end of the line.
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: frederik <frederik@inlibro.com>
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7c97f5263d474adc11688b9b7773c5b8705d10d3
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jul 30 15:20:27 2019 +0000

    Bug 23389: Add 'All' option to report dropdowns
    
    This patch optionally adds an 'all' option to report dropdowns
    
    Note you will need to use 'LIKE' instead of '=' to allow 'All' to work
    
    To test:
     1 - Write a report:
         SELECT branchname FROM branches WHERE branchcode LIKE <<Branch|branches>>
     2 - Run it
     3 - Select a branch
     4 - You get one branch info
     5 - Note you cannot select all
     6 - Apply patch
     7 - Run report
     8 - No change
     9 - Update report like:
         SELECT branchname FROM branches WHERE branchcode LIKE <<Branch|branches:all>>
    10 - Run report
    11 - Select 'All'
    12 - You get all branches
    13 - Select one branch
    14 - You get one branch
    15 - Test with other authorised categories (itemtypes, YES_NO, etc.)
    16 - Confirm it works as expected
    17 - Prove -v t/db_dependent/Reports/Guided.t
    
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e26ab5d79094e2c420542f8e8781aac347380bda
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Fri Jan 13 15:00:21 2017 +0000

    Bug 17851: Add Elasticsearch config to koha-conf.xml - Add missing entries to koha-install-log
    
    Sponsored-by: Koha-Suomi Oy
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 26c0b237649602ba21763059e05873b5161e7280
Author: Olli-Antti Kivilahti <olli-antti.kivilahti@jns.fi>
Date:   Thu Jan 5 14:13:48 2017 +0200

    Bug 17851: Add elasticsearch config to koha-conf.xml
    
    Missing installer for debian packages.
    
    Sponsored-by: Koha-Suomi Oy
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 42f4249bf1e5087d84606e95d07a24865af1e15e
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Sep 13 12:57:24 2019 +0000

    Bug 23606: Add columns configuration and export options to item types administration
    
    This patch adds column configuration to the table of item types
    in administration. No new defaults for the table are defined.
    
    To test, apply the patch and clear your browser cache if necessary.
    
     - Go to Administration -> Item types.
       - Test that the "Column visibility" button works to show and hide
         columns. The "actions" column should be excluded.
       - Test that export options (Excel, CSV, etc) exclude the "actions"
         column.
     - Go to Administration -> Columns settings and edit the default
       configuration of the item types table. Confirm that these
       changes are reflected in item tyeps administration.
    
    Test with noItemTypeImages on and off.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b97be3671732c68bc5d3b720f1b4e48dd73377d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 7 14:05:17 2019 +0100

    Bug 23039: (RM follow-up) Fix basic_workflow test
    
    This bug altered the markup of the returns page subtly, introducing a
    new div level and as such changing the required xpath expression for the
    checkin submission button in the basic_workflow tests.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a17bf77853a433c71938a1344486932c30d899a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 3 13:21:35 2019 +0000

    Bug 23730: Fix export of reports
    
    To test:
    1 - Run a saved report
    2 - Attempt to export results
    3 - It fails
    4 - Apply patch
    5 - It succeeds
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a3ec118dd9b8b6ff34ab721e81198dafb92c703e
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Oct 3 14:14:47 2019 -0300

    Bug 23710: (follow-up) Add tests for new features in Koha::REST::V!::Holds::add and return error when hold date in future is not allowed and it is passed as parameter
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5a92300abf50fc3b82bd82f746e2c48a569a0b3d
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed Oct 2 11:26:57 2019 -0300

    Bug 23710: (follow-up) Human readable error messages in request.tt, check AllowHoldPolicyOverride and AllowHoldDateInFuture in Koha::REST::V1::Holds.pm
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3567f21ebb2aff72327b4c000df187dbb96275d3
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Tue Oct 1 15:26:55 2019 -0300

    Bug 23710: Use API to place holds for patrons
    
    This patch effectively uses API to place holds for patrons. It adds a listener on submit event of the form in javascript, where it calls holds API.
    
    To test:
    
    1. Place a hold on any biblio for a patron
    SUCCESS => hold is placed or rejected, but no blank page with JSON error is shown.
    2. Place a multi hold for any patron
    SUCCESS => holds are placed or rejected, but no blank page with JSON error is shown.
    3. Sign off
    
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a80c94d96d5d0717d9a73a4d73fd1b7256bb181
Author: Nicolas Legrand <nicolas.legrand@bulac.fr>
Date:   Mon Sep 23 18:55:56 2019 +0200

    Bug 23671: Elasticsearch shouldn't throw exception on an uppercase subfield identifier
    
    Prevent Elasticsearch from throwing an exception when the mappings
    include uppercase subfield identifier.
    
    Though forbidden in MARC21, It doesn't seem to be the case for Unimarc
    or ISO 2709 as a whole. It is also possible to define such a subfield
    identifier in the Koha MARC Framework and in the Elasticsearch
    mappings.
    
    Test plan:
    
    1. add a 995Z subfield identifier in Elasticsearch mappings
    (Administration -> Search engine configuration)
    2. run $KOHA_PATH/misc/search_tools/rebuild_elasticsearch.pl -v -d -b
    3. see it throw: “Invalid MARC field expression: 995Z”
    4. apply patch
    5. rerun $KOHA_PATH/misc/search_tools/rebuild_elasticsearch.pl -v -d -b
    6. sababa
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12d33316918d6e333c670d0cc4a218bda2c964c6
Author: Nicolas Legrand <nicolas.legrand@bulac.fr>
Date:   Mon Sep 23 18:27:32 2019 +0200

    Bug 23670: Load Koha::Exceptions::ElasticSearch module in Koha::SearchEngine::Elasticsearch
    
    Prevent Koha::SearchEngine::Elasticsearch from dying when trying to run
    Koha::Exceptions::Elasticsearch::MARCFieldExprParseError->throw()
    
    Plan test:
    
    1. Go to Administration -> Searchengine configuration, and add a mapping
       for 995Z, whatever the search field (I did it with local-classification),
       save
    2. run $KOHA_PATH/misc/search_tools/rebuild_elasticsearch.pl -v -d -b
    3. see it die asking for Koha::Exceptions::Elasticsearch
    4. apply patch
    5. rerun $KOHA_PATH/misc/search_tools/rebuild_elasticsearch.pl -v -d -b
    6. see it throw: Invalid MARC field expression: 995Z
    
    Signed-off-by: Séverine QUEUNE <severine.queune@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a9d5147dfd26539dc13989d82faa54032ba26600
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 7 12:45:23 2019 +0100

    Bug 23007: DBRev 19.06.00.034
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b5f1297aa93c00b8d2b190a0a71fb5b41343af81
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jun 12 19:54:42 2019 +0000

    Bug 23007: Retain focus on 'barcode' input if transfers don't block circ
    
    To test:
     1 - Apply patches
     2 - Update database
     3 - Confirm TransfersBlockCirc defaults to 'Block'
     4 - Check in an item that needs transfer
     5 - Confirm you must deal with the modal to proceed
     6 - Repeat checking to get 'wrong-transfer-modal'
     7 - Confirm you must deal with it to proceed
     8 - Switch the pref to 'Don't block'
     9 - Find a new item or cancel/fulfill the preceeding transfer
    10 - Check in the item to generate transfer
    11 - Note focus remains on the barcode field and you can continue scanning (or typing if you don't have a scanner)
    12 - Note typing and pressing enter continues without requiring you to deal with modal
    13 - Repeat for wrong transfer modal
    14 - Verify hold and other modals still block continuing circulation
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 541b1fca0b5816dfb16104674e3a15bd75af371e
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jun 27 10:54:26 2019 +0000

    Bug 23007: Add TransfersBlockCirc system preference
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 92b57309ba82c4213e4023e22bc73cebbffcad13
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 7 12:25:24 2019 +0100

    Bug 23039: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9249a1751a505c4e1c384e66d11bb370a664985d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Aug 30 19:56:28 2019 +0000

    Bug 23039: Don't hide the checkin dialogs
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2f54850591f589b6a5750f3cff5df846d3e52ee1
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jul 30 15:16:26 2019 +0000

    Bug 23039: Hold found modal on checkin screen ( circulation.pl ) obscures Check in message info
    
    This patch modifies the checkin process so that any errors or messages
    related to the current checkin are displayed in any hold/transit modal
    which is displayed. This prevents any information from being hidden by
    the modal.
    
    This patch also adds an "information" button to the checkout form which
    the user can click to redisplay the last modal which was dismissed
    (unless confirming the modal reloads the page).
    
    To test, apply the patch and rebuild the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
     - Test the checkin process with various types of items:
       - Item not checked out
       - Item not checked out, on hold
       - Item not checked out, needs to be transferred
       - Item is marked lost, needs to be transferred
       - Item checked out, patron has waiting holds (with
         WaitingNotifyAtCheckin enabled)
       - Item checked out, patron has outstanding fines (with
         FineNotifyAtCheckin enabled)
    
     - Test that the modal redisplay button works in cases where the modal
       is dismissed without triggering a page reload:
       - Hold confirmation -> Ignore
       - Transfer confirmation -> OK
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e909494ac90b2c473815795e9256ecd2f967b223
Author: Dobrica Pavlinušić <dpavlin@rot13.org>
Date:   Wed Oct 2 11:32:17 2019 +0200

    Bug 23589: Discharge notice does not show non-latin characters
    
    It seems that discarge notices never got support for truetype
    fonts, so notices are missing non-latin characters.
    
    Signed-off-by: Theodoros Theodoropoulos <theod@lib.auth.gr>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 43d999cc7c7edc54e3df7482b3ab3607755e4b6d
Author: Dobrica Pavlinušić <dpavlin@rot13.org>
Date:   Thu Oct 3 09:34:17 2019 +0200

    Bug 23723: using exit inside eval to stop sending output to browser doesn't work under plack
    
    When fixing Bug 23589 Theodoros Theodoropoulos noticed that we are sending
    headers and html after pdf output to browser.
    
    Using exit inside eval block doesn't stop plack from generating
    headers and html page after exit since CGI::Compile will catch
    exit but doesn't stop emiting output. Example is:
    
    eval {
            warn "in eval";
            exit;
    };
    warn "after eval";
    
    Under CGI, this would print just "in eval", but under plack we get both lines
    and thus generate additional header and html after we already sent pdf data.
    
    Signed-off-by: Theodoros Theodoropoulos <theod@lib.auth.gr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a4bee10d0b73e12721e65908283a37a675bb44c4
Author: Björn Nylén <bjorn.nylen@ub.lu.se>
Date:   Fri Sep 14 08:19:46 2018 +0200

    Bug 21343: Respect patron language preference in automtic renewals
    
    To test:
    1) Set up different automatic renewal notices for Default and one other language
    2) Make sure you have checkouts due for auto-renewal to patrons with non-Default language pref
    3) Run automatic_renewals.pl . All patrons will get the default-language notice
    4) Apply patch.
    5) Repeat 2)
    6) Run automatic_renewals.pl . Patrons will receive notices according to their language preference.
    
    Sponsored-by: Lund University Library
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5c76ad78a3d5c9d485a7884deb2fe39834fb880c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Oct 7 12:08:36 2019 +0100

    Bug 18084: (RM follow-up) Fix authentication tests
    
    A change to the way we hide/expose the user menu in the opac resulted in
    the authentication selenium tests failing. This was due to the logout
    button being identified as hidden under the new code and as such the
    logout action not being triggered correctly between each login test. The
    was was simply to add an additonal 'click' event called on the menu
    button to put the logout link into the visible viewport.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 43519c0525a07b8f784fd9166eb0db3430e29042
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Oct 4 13:19:18 2019 +0100

    Bug 23612: (RM follow-up) Fix failing tests
    
    Trailing comma's were causing hidden javascript errors during selenium
    tests.
    
    Error was identified by adding a $s->capture($driver) line to the
    relevant selenium test and using the following JS snippet to dump errors
    to the screen.
    
       (function () {
           var ul = null;
           function createErrorList() {
               ul = document.createElement('ul');
               ul.setAttribute('id', 'js_error_list');
               //ul.style.display = 'none';
               document.body.appendChild(ul);
           }
           window.onerror = function(msg){
               if (ul === null)
                   createErrorList();
               var li = document.createElement("li");
               li.appendChild(document.createTextNode(msg));
               ul.appendChild(li);
           };
       })();
    
    Which clearly showed the following error.
    
        ReferenceError: KohaTable is not defined
    
    Removing the trailing comma's introduced in this bug resolved the issue.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1175b9fb8703376d051267446dc9c585442c2201
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Oct 3 14:42:25 2019 +0000

    Bug 20589: (follow-up) Fix tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3de3269d9253395ad1e4c47c515605a78a157943
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 3 14:02:27 2019 +0100

    Bug 20589: (RM follow-up) Fix Koha::SearchField.t
    
    This patch removes the unit test for the weighted_fields method which
    this bug removed.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 214220ed09d26349ab84ecccb29533b2e62ca668
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Wed Oct 2 14:05:25 2019 +0000

    Bug 23711: Fix bad path
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e2ec92a9e6cfe178834d7080cb896f7c179ee13e
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Mon Sep 30 23:23:31 2019 +0000

    Bug 23711: Change icons and remove unused SVG
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f96bf638ea0c40dbca8b1801b578b5f3740a6424
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Mon Sep 30 20:39:54 2019 +0000

    Bug 23711: Icons on staff main page should be font icons
    
    Signed-off-by: Fridolin Somers <fridolin.somers@biblibre.com>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3ddfee352735d94f4939a53de6414e2282253d9f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Sep 6 15:37:43 2019 +0000

    Bug 23543: Adding Withdrawn to the Item Search
    
    This patch adds "Withdrawn" status to the item search form and item
    search results.
    
    To test you should have one or more items in your catalog which have a
    'Withdrawn' status.
    
    Perform an item search and limit to a widthdrawn status. Verify that the
    search returns the correct results and that the withdrawn column in
    search results shows the correct information.
    
    Test the "Export results to CSV" button. The resulting file should
    contain the correct data, including withdrawn status.
    
    Signed-off-by: Joe Sikowitz <joe@flo.org>
    Signed-off-by: David Roberts <david.roberts@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Kelly McElligott <kelly@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5236e897aadc314d7110b0290e96541f83997b46
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 3 10:51:53 2019 +0100

    Bug 18084: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fed5158d66abafbe482a3625fa010c160c82a529
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jun 11 18:29:32 2019 +0000

    Bug 18084: Language selector hidden in user menu on mobile interfaces
    
    This patch updates templates and CSS so that the language-selection menu
    in the header will not be hidden if the browser width is too narrow.
    
    This patch also makes some more general improvements to the responsive
    adaptability of the header elements.
    
    To test, apply the patch and rebuild the OPAC CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    Test the changes by viewing pages in the OPAC and adjusting your browser
    width, paying attention to how elements in the top menu adapt to
    different sizes. Test under varying conditions:
    
     - Logged in/not loggeed user
     - Search history enabled and disabled
     - OpacLangSelectorMode showing menu in header or not
     - opacuserlogin enabled or disabled
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ec5a5d6e72e4dfbc0a439cbaa9ee1b990c258361
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Oct 3 10:49:31 2019 +0100

    Bug 23686: DBRev 19.06.00.032
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da46b4d93345adc55d701a1d64a91bea979e7b0f
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Oct 2 13:51:26 2019 +0000

    Bug 23686: (QA follow-up) Fix updatedatabase and make descriptions consistent
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 059cc81891082910f14cf9586288a8d302de5f7f
Author: Nicolas Legrand <nicolas.legrand@bulac.fr>
Date:   Fri Sep 27 10:14:35 2019 +0200

    Bug 23686: Check onsite checkout when the last checkout was an onsite one
    
    Prevent from checking again and again the onsite checkout box when
    doing onsite checkouts in batches. If preceding checkout was an onsite
    one, the box will be checked.
    
    Test plan:
    
    1. enable  OnSiteCheckouts
    2. make your circulation rules able to checkout onsite
    3. onsite checkout a document
    4. you should return to the checkout page, the box isn't checked
    5. apply patch
    6. updatedatabase.pl
    7. redo steps 3, it should again print a checkout page with an
       unchecked onsite checkout box
    8. enable  OnSiteCheckoutAutoCheck system preference
    9. redo step 3
    10. when returning to the checkout page, the onsite checkout box
        should be already checked
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dca51f46aa127fcce439561656da5606dc72e4f8
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Sep 13 18:10:25 2019 +0000

    Bug 23612: If no columns in a table can be toggled, don't show columns button
    
    This patch makes a change to the JavaScript setup for DataTables button
    controls so that if there are no toggle-able buttons (or there is no
    columns configuration at all) the column selection menu button will not
    appear.
    
    To test, apply the patch and go to Administration -> Columns settings.
    
     - In the Administration section, find the section for the "libraries"
       table.
     - In the "Cannot be toggled" column, check all the checkboxes.
     - Save.
     - Go to Administration -> Libraries.
     - At the top of the table there should be no "Columns" button, only
       "Clear filter" and "Export" buttons.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 660a5b6ebc4eb35bfcca54ef3bde5e00c304c446
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Oct 2 07:41:45 2019 +0000

    Bug 23713: (follow-up) Add missing semicolon
    
    Adds a missing semicolon to one of the lines with translated
    messages.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0dd2d6883d1e98bed92b25c321110b37da739e88
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Oct 1 15:55:19 2019 +0000

    Bug 23713: Subscription add form broken for translations
    
    This patch makes a change to the subscription entry template as a
    workaround to a translation bug which is causing JavaScript errors when
    using translated templates.
    
    To test, apply the patch and update and install the de-DE template:
    
    > cd misc/translator
    > perl translate update de-DE
    > perl translate install de-DE
    
     - Go to Administration -> System preferences and enable the "Deutsch
       (de-DE)" language under I18N/L10N preferences -> language.
     - Switch to the "Deutsch" translation.
     - Go to Zeitschriften (Serials) -> Neues Abonnement (New subscription)
       and open the browser console. There should be no errors.
     - Links which trigger JavaScript events should work correctly:
       "Lieferant suchen," "Nach Datensatz suchen," etc.
    
    Reported-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Thanks-to: Michael Hoffert and Alexander Arlt from koha-de for reporting
     it initially and figuring out the root of the issue
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 491a2e858f4c75d6278626862be01f05ef9682cf
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Oct 2 14:58:55 2019 -0400

    Bug 23722: Document allow_empty_passwords in the example SIP config file
    
    The example SIP config file in Koha is kind of a kitchen sink document where
    all available SIP2 options should be demonstrated.
    The allow_empty_passwords flag should be included in it.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b63b55cda70604041c9f04f5f1e302540bff29eb
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Sep 30 13:37:19 2019 +0000

    Bug 21985: Fix further occurences
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95a2ffc542c2c93dfbc5c09d7c06186a1f58f458
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Mar 14 19:19:45 2019 -0300

    Bug 21985: Trying to fix the next failure
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18f9ed465dc990252a0462f86010b874fdde5d77
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Dec 16 12:28:48 2018 -0300

    Bug 21985: Fix Circulation tests when ES it set, by using build_sample_item
    
    We should use build_sample item (from bug 21971) to create items,
    otherwise we may not have a valid biblioitem and/or MARC record.
    
    Test plan:
    Set SearchEngine to ES
    prove that the tests in Circulation.t now pass
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c66cebf744778dbfc15597079549c161a7836d63
Author: Christophe Croullebois <christophe.croullebois@biblibre.com>
Date:   Thu Aug 29 15:23:01 2019 +0200

    Bug 23252: Adds noEnterSubmit class in ajax context
    
    In cataloging.js $(document).ready adds noEnterSubmit class.
    This does not work in ajax context, it works with $(document).ajaxSuccess.
    
    Test plan :
    1)
    1.1) Verify you have an item subfield linked to items.itemnotes, ie 952$z
    1.2) Verify 952$z exists in ACQ framework
    2)
    2.1) Verify system preference "AcqCreateItem" is on "placing an order"
    2.2) Go to an acquisition basket
    2.3) Click "Add to basket" and "From a new (empty) record"
    2.4) Go to "Item" block
    2.5) Verify that $z has "noEnterSubmit" class
    2.6) Verify that typing enter in $z does not submit the form
    3)
    3.1) Change system preference "AcqCreateItem" to "receiving an order"
    3.2) Go to "Receive shipment"
    3.3) Receive an order
    3.4) Go to "Item" block
    3.5) Verify that $z has "noEnterSubmit" class
    3.6) Verify that typing enter in $z does not submit the form
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c855b1ca287758b535fe5ba885949accac4e474a
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Jul 2 15:57:09 2019 +0200

    Bug 23252: Add missing input_marceditor class in item editor
    
    In serials receive and acquisition order creation from iso2709, the item edition form shows inputs that are missing "input_marceditor" class.
    They are also missing tabindex and id.
    
    The side effect is that those inputs dont get the "noEnterSubmit" class so form is posted if a barcode scanner is used or if enter is used on keyboard.
    
    Test plan :
    1)
    1.1) Verify you have an item subfield linked to items.itemnotes, ie 952$z
    1.2) Verify system preference "AcqCreateItem" is on "placing an order"
    2)
    2.2) Go to cataloguing module and edit an item
    2.3) Verify that $z has an id, tabindex and "input_marceditor" class.
    2.4) Verify that typing enter in $z does not submit the form
    3)
    3.1) Go to a serial with items creation, click on receive
    3.2) Change status to "Arrived"
    3.3) Verify that $z has an id, tabindex and "input_marceditor" class.
    3.4) Verify that typing enter in $z does not submit the form
    4)
    4.1) Go to an acquisition basket
    4.2) Click "Add to basket" and "From a staged file"
    4.3) Click "Add orders" on a staged file
    4.4) Go in tab "Item information"
    4.5) Verify that $z has an id, tabindex and "input_marceditor" class.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0bdd859e2943e0315a9468c8c7d4b4f6b597ea2a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jul 19 14:06:59 2019 +0000

    Bug 23351: Clean up localization template
    
    This patch modifies the template used for translation of item type
    descriptions. It is updated with more consistent Bootstrap grid markup
    and improved handling of adding and removing rows from the DataTable.
    
    To test you should have more than one translation installed.
    
     - Apply the patch and go to Administration -> Item types.
     - Edit an item type.
     - Click the translate link.
     - Add a new translation. The table of translations should be updated
       with your new translation.
     - Test the "Delete" link corresponding to your new entry. It should
       work correctly.
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3227e5ae443a5aefaeed84554ddd7c4f19f1205a
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Mon Sep 30 15:15:35 2019 +0200

    Bug 20589: DBRev 19.06.00.032
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ab54b5458d9cfe2db7b5290a301513355c3fdd3b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Oct 1 09:02:20 2019 +0000

    Bug 20589: Remove expanded_facet variable and fix tests
    
    Thi is a rebase from 14419 to remove an unused variable
    
    Also update tests to expect the new expected result
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 72fcd4c7f2956a374986d5683e52f6bb4c2ff90d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Aug 23 16:45:05 2019 +0000

    Bug 20589: Add option for searching entire record if record stored as array
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d630cd786e86b0ef023a79d7b6fc84be14bfa60
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Mon Jan 14 15:59:55 2019 +0100

    Bug 20589: Exclude boolean fields from search fields
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1b902612af69dadf4c13deb8bc6c59950eb493e3
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Thu Apr 4 15:14:19 2019 +0200

    Bug 20589: fix QueryBuilder tests
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 91947546f7d1baae3e8f5bf297dda3240a968cde
Author: David Gustafsson <david.gustafsson@ub.gu.se>
Date:   Fri Apr 13 15:46:55 2018 +0200

    Bug 20589: Add field boosting and use query_string fields parameter
    
    Generate a list of fields for the query_string query fields parameter,
    with possible boosts, instead of using "_all"-field. Also add "search"
    flag in search_marc_to_field table so that certain mappings can be
    excluded from searches. Add option to include/exclude fields in
    query_string "fields" parameter depending on searching in OPAC or staff
    client. Refactor code to remove all other dependencies on "_all"-field.
    
    How to test:
    1) Reindex authorities and biblios.
    2) Search biblios and try to verify that this works as expected.
    3) Search authorities and try to verify that this works as expected.
    4) Go to "Search engine configuration"
    5) Change some "Boost", "Staff client", and "OPAC" settings and save.
    6) Verify that those settings where saved accordingly.
    7) Click the "Biblios" or "Authorities" tab and change one or more
       "Searchable" settings
    8) Verfiy that those settings where saved accordingly.
    9) Try to verify that these settings has taken effect by peforming
       some biblios and/or authorities searches.
    
    Sponsorded-by: Gothenburg Univesity Library
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6c92612c15b3a62356d09c5719a245e52097afbb
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 1 15:33:42 2019 +0100

    Bug 13193: (RM revert) Make Memcached usage fork safe
    
    This reverts commit f7a5466c52c4821394c5c44e0fc4e9603ef0e6f6. We need
    the new dependancy packaged first.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8dfb0e3a4e4bc6ee9d1b2e550a835f9bc8e64676
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 1 15:18:28 2019 +0100

    Bug 19618: (RM follow-up) Remove accidentally committed file
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f7a5466c52c4821394c5c44e0fc4e9603ef0e6f6
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Mon Sep 16 10:26:01 2019 +0000

    Bug 13193: Make Memcached usage fork safe
    
    When a high enough number of forks try to access for example system
    preferences with Koha::Cache using memcached as backend the results of
    different cache requests get mixed up.
    
    The problem is fixed by using Cache::Memcached::Fast::Safe that is a
    fork safe version of Cache::Memcached::Fast.
    
    Sponsored-by: The National Library of Finland
    Signed-off-by: David Cook <dcook@prosentient.com.au>
    
    Works as described, and solves an insidious difficult to debug
    problem in Koha.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 291bb7bacfdf68e6bc8e99d5c1e258fbcbf2344b
Author: Magnus Enger <magnus@libriotech.no>
Date:   Tue Oct 1 10:54:41 2019 +0200

    Bug 22280: Add a unit test
    
    This patch adds a unit test to t/db_dependent/Illrequests.t, where
    a new node without any next_actions or prev_actions is added to the
    core status graph.
    
    Running the tests show a lot of warnings about "no query in
    themelanguage", but that should not be related to the current bug.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2ceeebd5244d8e05342a905e52c43747b1778c68
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Sep 23 16:49:35 2019 +0100

    Bug 22280: (RM follow-up) Correction to POD
    
    Minor correction to mislabled POD section for private method.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 633800120840384374fef3da091800a6d989e723
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jul 3 15:34:48 2019 -0300

    Bug 22280: Fix typo in _status_graph_union
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 05b9ea8fe5d3bc1d74fb33d18d1b19599d4c4d90
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 1 14:42:19 2019 +0100

    Bug 23566: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit deb4c4b765ba32ae0d407bc2ef3ccd35e7f5c567
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 1 14:41:04 2019 +0100

    Bug 23566: DBRev 19.06.00.031
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4c17151d74347da0f2ecfb9de49168162a2a21b6
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Sep 25 17:10:46 2019 +0000

    Bug 23566: Continue on device - with QR codes
    
    This patch adds the option to show a QR code on the OPAC bibliographic
    detail page. The URL of the page is encoded in the image so that
    scanning it will take the user to that page on their device. The feature
    is controlled by a new system preference, OPACDetailQRCode, which is
    disabled by default.
    
    The QR Code is generated by a JavaScript library, "kjua"
    (https://github.com/lrsjng/kjua), which has been added to the "About"
    page in the staff client.
    
    To test, apply the patch and run the database update. Rebuild the OPAC
    CSS (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
     - In the staff client, go to Administration -> System preferences.
     - Locate the OPACDetailQRCode system preferences under OPAC ->
       Features. It should be disabled.
       - Enable the preference and switch to the OPAC.
     - Locate a title in the catalog and view the detail page.
       - In the sidebar menu there should be a "Send to device" link.
       - Clicking the link should display a QR Code.
       - Scan the code using a QR Code-capable device.
       - The URL should be correct.
     - Disable the system preference and confirm that the "Send to device"
       link no longer appears on the OPAC detail page.
    
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f2b844426782cb08ce8bd9d0b304a358b7548f86
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Sep 30 14:12:35 2019 +0000

    Bug 7074: (QA follow-up) Deal with multiple fields
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 992a68e004772de810eeca0b012e3ab635e08fdf
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Aug 9 14:42:38 2019 +0000

    Bug 7074: Show subtitle, part and number of a record in list of checkins
    
    Shows the subtitle, part and number information from the biblio tables
    as part of the title in the list of checkins (for MARC21: 245$b$n$p).
    
    To test:
    - Apply patch
    - Catalog a record with 245$a$b$n$p filled out
    - Check the item out to any patron
    - Verify that in the list of checkouts the information shows
    - Check out any other items with different 245
    - Verify information is correct
    - In a new tab, return the items
    - Verify that in the list of checkins the information now
      matches the checkouts list
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2fc7027fe4b184ee5652df6534171f67c1374c7e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 1 11:45:13 2019 +0100

    Bug 19618: (RM follow-up) Add missing use statements
    
    The compile test was failing, this patch corrects for some missing use
    statements and updates the dbic classes to include the type mappings
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a68532048ac6edf62ccbfa0c1f5181fc682c1c7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Oct 1 08:12:28 2019 +0100

    Bug 19618: DBRev 19.06.00.030
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d847c22947887880596968cd845e4f684779a60
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Sep 12 16:55:17 2019 +0100

    Bug 19618: (QA follow-up) POD Fix
    
    Sponsored-by: Southeast Kansas Library - SEKLS
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 474eca3dbcabe40eead066c3221d4984b0b890b4
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Sep 5 16:08:14 2019 -0300

    Bug 19618: Add tests
    
    This patch adds tests for new features
    
    To test:
    1) prove t/db_dependent/Koha/Club/Enrollment.t
    2) prove t/db_dependent/Koha/Club/Hold.t
    3) prove t/db_dependent/api/v1/clubs_holds.t
    4) Sign off
    
    Sponsored-by: Southeast Kansas Library - SEKLS
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a902efb83b203f2f99938388acd88f3fc059422a
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Tue Sep 10 03:20:38 2019 -0300

    Bug 19618: Add api endpoint for club holds
    
    This patch adds an endpoint in thi api in /api/v1/clubs/{club_id}/holds whith the verb POST that maps to Koha::REST::V1::Clubs::Holds#add controller.
    Classes for club_holds and club_holds_to_patron_holds new tables where also added.
    
    To test:
    1) Reach SUCCESS.3 test point of previous patch with club that has no enrollments
    2) Click on "Place Hold"
    SUCCESS => an alert should appear that you cannot place hold on a club without patrons
    3) Reach SUCCESS.3 test point of previous patch with club that has enrollments
    4) Click on "Place Hold"
    SUCCESS => holds priority list should appear with holds for every patron in club
    5) Repeat steps 3 and 4.
    SUCCESS => new holds should appear in different order
    6) Sign off
    
    Sponsored-by: Southeast Kansas Library - SEKLS
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7aeec1bfef47ea83ceeb51d552c1f5e537a1b84c
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Sep 5 14:13:27 2019 -0300

    Bug 19618: Add ability to place holds for members of a club in intranet
    
    This patch adds the ability to place a hold for each member of a club in random order.
    
    To test:
    1) apply this patch
    2) create 2 clubs, (club names should have some part in common, and some part different for each other)
    3) in one of them add at least 6 members
    4) enter patron clubs management and click on "Actions" button
    SUCCESS.1 => club with members has a new action called "search to hold"
    5) click on search to hold
    SUCCESS.2 => in the list of bilios there appears an action called "Place hold for <club name>"
    6) click on "Place hold for <club name>"
    SUCCESS.3 => a new window appears where you can select pickup location (defaults to club's library, if any), and the list of members.
    7) go back to the list of bilios in the catalog and click on "Forget <club name>"
    8) click on "Holds" action of any biblio
    SUCCESS.4 => a search box appears with two tabs: Patrons and Clubs
    9) click on Clubs tab and search by the common part of clubs names
    SUCCESS.5 => a list of clubs that matches the search appears. If you click on any of them, the same page as SUCCESS.3 appears.
    10) go back to the search box in SUCCESS.4 and search by the different part of the name.
    SUCCESS.6 => because there is only one club that matches search criteria, the same page as SUCCESS.3 appears;
    11) Sign off
    
    Sponsored-by: Southeast Kansas Library - SEKLS
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1306daa0103a07e6478ec58de34f44045e538dc6
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Sep 5 14:13:36 2019 -0300

    Bug 19618: Add club_holds and club_holds_to_patron_holds tables
    
    This patch adds 2 new tables
    1. club_holds
    2. club_holds_to_patron_holds
    
    They are ment to keep info about hold requests made in name of a club
    
    To test:
    1) apply this patch
    2) perl installer/data/mysql/updatedatabase.pl
    SUCCESS => 2 new tables were created
    
    Sponsored-by: Southeast Kansas Library - SEKLS
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 15b5767aaed52364f9c32afb1df2272f00fca75b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Sep 25 11:58:38 2019 +0000

    Bug 23648: The logged in link (class "loggedinusername") needs data-patroncategory
    
    This patch adds a "data-categorycode" attribte to the logged in link in
    the global header of the OPAC. This will allow access to the patron
    category for use in customization and whatnot.
    
    To test, apply the patch and log in to the OPAC. Use the browser's DOM
    inspector tool to examine the logged-in user's name in the header. It
    should have a "data-categorycode" attribute with the correct value.
    
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2cfc7c4c284aa40f62fe7992a9e2eca51d1f95b4
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Aug 10 21:55:52 2019 +0200

    Bug 23447: Fix capitalization and other minor edits on patron batch edit template
    
    Just some small fixes:
    
    - Category => Patron category (more specific for translation)
    - Attribute => Patron attribute
    - Opac Note => OPAC note
    - Add missing colons (:) after some of the labels
    
    To test:
    - Find an existing cardnumber
    - Go to Tools > Patron batch modification
    - Use cardnumber in input field and continue
    - Verify strings show as noted above
    - Apply patch
    - Repeat and verify strings have changed, everything still works
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e35c3d14b63a49ea16d248b2d4260555e8fcb3f
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Sep 30 14:59:20 2019 +0200

    Bug 23689: (follow-up) Use Library limitations to match other occurrences
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 47c2e215875127b843c9720976f2c94e1cd66662
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 27 14:41:51 2019 +0100

    Bug 23689: Fix terminology for branches limitations on authorized values
    
    This patch corrects the terminology and also updates the tooltip to use
    the current bootstrap tooltip library.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 62ad053894c57ae990a9724cf58beaa4441448c6
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 27 07:23:28 2019 -0400

    Bug 23688: System preference uppercasesurnames broken by typo
    
    In the process of moving this feature from memberentry.pl to Patron.pm, the 's' on uppercasesurnames was dropped, breaking the feature.
    
    Test Plan:
    1) Test uppercasesurnames, note it does not work
    2) Apply this patch
    3) Test uppercasesurnames, note it works now!
    
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d096eeab8a7d23cf460b1ad5f10df746f3d62dda
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu Sep 26 09:08:40 2019 +0200

    Bug 23679: add Unit Test t/db_dependent/Circulation/transferbook.t
    
    I've choosen to add it to db_dependent because we may add other tests
    to cover transferbook() cases that will change DB
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Bin Wen <bin.wen@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3848a3a772e2202ac3339bd241adcef987e48361
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu Sep 26 09:09:15 2019 +0200

    Bug 23679: fix software error when trying to transfer an unknown barcode
    
    When trying to transfer an unknown barcode in
    /cgi-bin/koha/circ/branchtransfers.pl you get the error :
    
    Can't call method "itemnumber" on an undefined value at
    /home/koha/src/C4/Circulation.pm line 319.
    
    This comes from C4::Circulation::transferbook which should stop when
    finding unknown barcode.
    
    Test plan :
    1) Go to /cgi-bin/koha/circ/branchtransfers.pl
    2) Enter a barcode not existing in database
    3) Without patch you get a software error, with patch you get a message
       saying 'No Item with barcode'
    4) Enter a barcode existing in database and check transfer is OK
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Bin Wen <bin.wen@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 740d0bde7860c1d67f1612d5fd3c4a68d0714ef0
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu May 2 16:26:55 2019 +0000

    Bug 22804: OPAC Overdrive JavaScript contains untranslatable strings
    
    This patch moves untranslatable strings out of overdrive.js and into
    opac-bottom.inc where other strings are defined for use in JavaScript
    files.
    
    To test you must have OverDrive integration set up, including
    OverDriveCirculation. Test the various Overdrive integration features:
    
     - Placing holds
     - Cancelling holds
     - Checking out
     - Checking in
    
    These features should work as expected.
    
    Signed-off-by: Jesse Maseto <jesse@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ace678ba6f19821bbdaaa9b31c96db2c2ce5e026
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Sep 30 15:52:02 2019 +0100

    Bug 23624: (RM follow-up) Sponsorship Line
    
    Sponsored-by: Higher Education Libraries of Massachusetts
    Sponsored-by: Fenway Libraries Online
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6c90c6f7d9e0f04ce148b723fc3a4828f03e9079
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Sep 25 10:44:03 2019 -0300

    Bug 23624: (QA follow-up) Test error cases
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f2b27975679e64722f06b175e759801227a313fc
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Sep 20 07:14:34 2019 -0400

    Bug 23624: (QA follow-up) Don't fetch the count unless the query was successful
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bca4453c50d8b5b1d3c7029ded2b522a9a2bf868
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 19 11:13:28 2019 -0300

    Bug 23624: (QA follow-up) Optimize even more
    
    This patch makes counting the results have no memory footprint by
    leveraging on the DB to count the rows.
    
    To test:
    - Without this path, run:
      $ kshell
     k$ prove t/db_dependent/Reports/Guided.t
    => SUCCESS: Tests pass
    - Apply this patch
    - Run:
     k$ prove t/db_dependent/Reports/Guided.t
    => SUCCESS: Tests still pass!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7958e7f3f9b4275cd8da0ed2e04dfbc90d863a60
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 19 10:50:46 2019 -0300

    Bug 23624: Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 79e15278f718768fa082b7b3d7b48e6adde164da
Author: Paul Hoffman <paul@flo.org>
Date:   Tue Sep 17 13:00:03 2019 -0400

    Bug 23624: Count rows in report without (potentially) consuming all memory
    
    C4::Reports::Guided::nb_rows (called by get_prepped_report in reports/guided_reports.pl) uses DBI::fetchall_arrayref to retrieve all rows at once; counts them; and then discards the rows and returns the count.  This has the potential, if the number of rows is very large, to exhaust all available memory.
    
    (Other code in guided_reports.pl has the same potential effect, but because the solution to that is much less straightforward it will be addressed in a separate bug report.)
    
    This patch uses the second ($max_rows) parameter to DBI::fetchall_arrayref to retrieve a smaller number (1,000) of rows at a time, looping until all results have been retrieved.  This will only use as much memory as the maximum amount used by a single call to DBI::fetchall_arrayref.
    
    Test Plan:
    1) Create a report the will generate a huge number of results
    2) Run the report, watch your memory usage spike
    3) Apply this patch
    4) Restart all the things!
    5) Run the report again, note your memory usage is much lower
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8d8d002eecee3ca78bf44c64b20bf2b91ea8a201
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 27 13:13:05 2019 +0100

    Bug 23602: (follow-up) Improve tooltip formatting
    
    This follow-up changes the formatting of the tooltip to add a newline for
    library limit.
    
    To test, apply the patch and go to Administration -> Item types.
    
    In the table of item types, find one with library limitations. Hovering
    over the "# library limitations" test should trigger a Bootstrap-styled
    tooltip showing the library name and code, one per line.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bfb798386057b3d3c8847815931bfe7a7f8a302b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Sep 13 16:13:33 2019 +0000

    Bug 23602: (follow-up) Correct terminology, add tooltip
    
    This follow-up changes the use of "branch" to the Koha standard
    "library." The patch also adds the use of a Bootstrap tooltip for
    showing an item type's library limitations in the main table of item
    types.
    
    To test, apply the patch and go to Administration -> Item types.
    
    In the table of item types, find one with library limitations. Hovering
    over the "# library limitations" test should trigger a Bootstrap-styled
    tooltip showing the library name and code.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ed2390f999121cd210651d81021f090b6aaada23
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri Sep 13 10:55:30 2019 -0300

    Bug 23602: Display branch limitations in itemtype table
    
    This patch adds a column in itemtype table to display branch limitations.
    
    To test:
    1) Open item types admin page.
    CHECK => there is no column for branch limitations, even if you add a limitation in an item type.
    2) Apply this patch
    SUCCESS => A new column appears that displays branch limitations per item type
    3) Sign off
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1001eb3384e7cd9d784d3082d67d2711fd1c20a8
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed Jun 26 02:02:39 2019 -0300

    Bug 23213: Enable minimum payment threshold check in OPAC
    
    This patch enables OPAC to check for the miminum payment threshold per payment method.
    
    If the total amount to pay is less than the threshold, payment for that method is disabled.
    
    To test:
    1) apply dependencies
    2) get 2 payment plugins, one with threshold as https://gitlab.com/thekesolutions/plugins/koha-plugin-pay-via-paypal/uploads/4c66444ff697586dff3d8759c1e5746c/koha-plugin-pay-via-paypal-v1.0.0.kpz and one without threshold as https://github.com/bywatersolutions/koha-plugin-pay-via-paygov/releases/download/v1.0.5/koha-plugin-pay-via-paygov-v1.0.5.kpz
    3) install both plugins
    4) Configure both plugins to work correctly (can be invented data.. we are not interested in the actual payment page, but to test if payment method is allowed)
    5) In plugin with threshold, set minimum threshold to 10
    6) Fetch any user, and create 2 manual invoices, both for the amount of 5
    7) Enter OPAC as user, and go to "my fines" tab
    CHECK => both plugins appear as payment method
    8) Check the checkbox of one of the fines
    SUCCESS => plugin with threshold is now disabled, and has a warning message that says "Minimum amount needed by this service is 10.00"
            => plugin without threshold is enabled
            => if plugin with threshold was selected, "Make payment" button is disabled until an enabled payment method is selected
    9) Check the second checkbox
    SUCCESS => both payment methods are now enabled
    10) Sign off
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e043ba36938e5025a2b39d6f7dc15101da9047d4
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Jun 13 02:57:52 2019 -0300

    Bug 23214: Modify account-table.inc to enable payment of guarantees fines
    
    This patch enables a guarantor to pay guarantees fines in OPAC
    
    To test:
    1. Apply dependencies
    2. On intranet, search for AllowStaffToSetFinesVisibilityForGuarantor preference and set to "Allow"
    3. Enable some payment method
    4. Find a patron with guarantor and edit
    5. Change "Show fines to guarantor" select to "Yes" and save
    6. Create a manual invoice for the patron (guarantee)
    7. Enter OPAC with guarantor user
    8. Go to "your fines" tab
    SUCCESS => Guarantees fines appear, and is selectable to pay
    9. Sign off
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4ca44685bb56c6e172ec5d9ad3dd769fe2eabfa2
Author: Caroline Cyr La Rose <caroline@inlibro.com>
Date:   Tue Sep 17 17:59:21 2019 -0400

    Bug 23631: fr-CA translation of NEW_SUGGESTION notice
    
    This patch provides the fr-CA translation for the NEW_SUGGESTION notice.
    
    Signed-off-by: Bin Wen <bin.wen@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d8187991a40f58ab815fd1e75d6a3671ca72a668
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Sun Sep 22 02:01:23 2019 +0000

    Bug 23683: Course reserves public notes on specific items should allow for HTML
    
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d0a06e365b693de6609998b3d649d9ef4d083880
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Jul 12 12:40:22 2019 +0000

    Bug 23101: Hide action buttons on contracts if user lacks permission
    
    When the user doesn't have superlibrarian, full acq or
    contracts_manage permission, don't show buttons for editing
    and deleting contracts.
    
    To test:
    - Create a vendor with a few contracts
    - Create a staff user with
      - superlibrarian = can view edit/delete contracts
      - full acq perms = same
      - without manage_contracts = can view, but action buttons are gone
    - Make sure the sorting of the contracts table works in all cases
    
    Signed-off-by: Holly Cooper <hc@interleaf.ie>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8171c9d05dc3adf0014a727e304f666606f7f751
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 13 11:26:03 2019 -0300

    Bug 23607: Make /patrons/:patron_id/account staff only
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0aeb5998481a28fb72c8f184bd3f85f7491dc858
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Sep 17 15:41:12 2019 -0400

    Bug 23625: Make new 'required' attributes match the currently used syntax in other templates
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 64148cf4ac6f20787a809b36243672430faa6e8f
Author: Eric Phetteplace <phette23@gmail.com>
Date:   Mon Sep 16 12:53:32 2019 -0700

    Bug 23625: ArticleRequestsMandatoryFields* only affects field labels, does not make inputs required
    
    Test plan:
    
    1. Enable article requests ( syspref: ArticleRequests => Enable, Circ and fine rules ALL/ALL (or a given category/itemtype): Article requests => Yes )
    2. Set one or more fields to require in the ArticleRequestsMandatoryFields, ArticleRequestsMandatoryFieldsItemOnly, and/or ArticleRequestsMandatoryFieldsRecordOnly settings (all these settings are affected in the same manner)
    3. Search for a title and select the "Request Article" button from the OPAC search results
    4. Authenticate as a patron
    5. Neglect to fill out at least one of the mandatory fields
    6. Select the "Place Request" button at the bottom of the form
    7. The form submits despite the empty mandatory fields
    8. Apply patch
    9. Repeat steps 3, 5, & 6
    10 . The form should refuse to submit, show a browser-native message about the missing required fields.
    
    Sponsored-by: California College of the Arts
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4b642386d8983a12c1a79924ae1fac180b10c3d0
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Sep 6 11:13:27 2019 +0000

    Bug 22602: Fix OverDrive circulation when coming from another site
    
    On bug 21078 we caught an error and returned, this makes us skip some variable setting that we need.
    
    This patch moves that code into its own function.
    
    To test:
    0 - Have OverDrive circulation setup and working
    1 - Place a link to your kohadev installation on another site
    2 - Follow that link to the opac
    3 - Note all items show as 'Place hold' even if available copies
    4 - Apply patch
    5 - Repeat 1&2
    6 - Note the items availability shows correctly
    
    Signed-off-by: Elizabeth Quinn <EQuinn@chplnj.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fa97bc90df532720287eaf296c15f7facdaa730d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Sep 20 16:44:53 2019 +0000

    Bug 23651: Add address of restricted page to syspref description
    
    To test:
    1 - Look at the restricted page syspref
    2 - Check that the url is listed
    3 - Add some content to the page
    4 - Save the prefs
    5 - Verify the address listed takes you to the page on the opac
    
    Signed-off-by: Lisette Scheer <lisetteslatah@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit adb232c8f0f4bf8574ca3dce9548196430c57fb0
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed May 31 16:54:32 2017 +0200

    Bug 18710: Wrong subfield modified in batch item modification
    
    In Tools > Batch item modification, one can modify or delete a subfield.
    When deleting a subfield et modifying another, the wrong subfield gets modified.
    
    This is caused by the fact that disabled inputs are not posted in form.
    So for a subfield to delete :
    Input name=field_value is not posted. But input name=subfield is posted with subfield code.
    So these 2 arrays does not have the same size :
        my @subfields = $input->multi_param('subfield');
        my @values    = $input->multi_param('field_value');
    
    For exemple, deleting $2, not changing $u and modidying $v will modify $u with value for $v o_O
    
    This patch correts but setting disabled all inputs of a deleted subfield : field_value, tag, subfield and mandatory. Like it was not present in the form.
    
    Test plan :
    - Go to Tools > Batch item modification
    - Enter a barcode and submit
    - Lets say there are subfields : $2 (not mandatory), $u and $v
    - Check the subfield $2 to be deleted
    => $2 input is disabled
    - Enter a text in $v
    - Submit the form
    => Without patch, the text for $v gets into $u
    => With patch, the text for $v gets into $v
    - Check the subfield $2 is well deleted
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8766689d34c63416f38a8248367483c573c5036e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 16 17:22:17 2019 -0300

    Bug 23627: Reduce Koha::Biblio->get_coins noise if no 245
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 148f35963d5eae1f9eabc0c7cb0b69cd7056b020
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 27 12:53:46 2019 +0100

    Bug 23272: (RM followup) Fix edit action
    
    This bug introduced a regression whereby if an authorized value has no
    branch limitations then the authorized value cannot be edited once it
    has been created. The edit page would display an error and not load.
    
    This is the second case of a simple ternary correcting the issue, but
    the logic of returning 'undef' from 'get_branch_limits' being called
    into question.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d79fd755e4c19c70aa5df49783d6615a6f20041f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 27 10:35:07 2019 +0100

    Bug 23321: (RM follow-up) Accounts vs. Accounting
    
    The QA follow-up converting 'Accounts' to 'Accounting' missed some cases
    and ended up breaking the perferences screen.  This follow-up corrects
    that.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 06bd256019f519124676719db976d4f6e8258131
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 24 11:39:17 2019 -0300

    Bug 23517: (follow-up) AddReserve expects a priority parameter
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fca3a267c61b3db9d16f01b0c46d03dbfc6dad63
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Sep 24 08:21:13 2019 +0100

    Bug 23526: (RM follow-up) Fix failing test
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87302a1abfe9d44bf302ee9ce83ec0639ea4f849
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Sep 23 10:25:13 2019 +0000

    Bug 22744: Changes for opac and remove JS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ff21f979081b3c20d313129a7b4da671bf0fd635
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jun 13 10:56:34 2019 +0000

    Bug 22744: Remove the 'do not notify' buttons
    
    These checkboxes are simply a way to clear the prefs before editing. We are not saving
    a lot of click, and we are confusing people, this patch simply removes them
    
    To test:
    1 - Edit a patron's messaging preferences
    2 - Think too hard about the 'Do not notify' boxes
    3 - Feel confused
    4 - Apply this patch
    5 - Edit a patron's messaging preferences
    6 - Confirm it feels better
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c64c67b0de96d8317613294f3aa57b47ad72fda6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 16 10:32:48 2019 -0300

    Bug 23517: (follow-up) More test cases
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit df360c40498badaaed821d33170a782e4c9d4db9
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Sep 4 14:06:45 2019 -0300

    Bug 23517: (follow-up) Tidy tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 222b7b37f7780b9f8b357e02e2c2262eed7dbec3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 3 16:39:40 2019 -0300

    Bug 23517: Add the controller method for holds priorities handling
    
    This patch implements the PUT /holds/:hold_id/priority endpoint
    To test:
    - Apply this patches
    - Run:
      $ kshell
     k$ prove t/db_dependent/api/v1/holds.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c9e3060f318004e70582079186ceaad42d37d649
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 3 16:39:08 2019 -0300

    Bug 23517: Add a spec for PUT /holds/{hold_id}/priority
    
    This patch adds the OpenAPI spec for the endpoint, and tests for the
    desired behaviour.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dc6ebfadb8f4a15101be1357a3139dac882e6d14
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Sep 23 11:48:54 2019 +0100

    Bug 23321: DBRev 19.06.00.029
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7ee71c09c1e74cecb33d86359235b8725d8c7305
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 20 15:56:45 2019 -0300

    Bug 23321: (QA follow-up) Accounts vs. Accounting
    
    The UI uses 'Accounting' in several places (patron details tab, admin
    page section name, breadcrumbs, etc). Use the same name on the sysprefs.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6eb3c86cbd7db10eb568d2b4bb59739acdd7eb78
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 20 15:50:14 2019 -0300

    Bug 23321: Add Koha::Object(s) info to the schema
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8457fb1cf99754b5783fc2351ca1468aea68100d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 20 15:30:29 2019 -0300

    Bug 23321: (QA follow-up) Add missing TT filters
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 306fcf6bce7ac26b498d1b2fda93760ae447dc97
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 20 15:26:08 2019 -0300

    Bug 23321: (QA follow-up) Booleans
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9aefd5845af2d927bf4c000c2334f7945070a388
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 20 15:06:38 2019 -0300

    Bug 23321: (QA follow-up) Make atomic update idempotent
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f24597d2a0d3459310d529b94738e5e621c32f3b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 13 17:04:00 2019 +0100

    Bug 23321: (follow-up) Add test for Koha::Account change
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1d42b5fbff3f43fb9bf326d06bf772ae3a44b02f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 13 17:03:02 2019 +0100

    Bug 23321: (follow-up) Correction to exception logic
    
    This patch reduces the noisy warning of uninitialised variables
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit db66a57f2bc77fed009fbf56ca6e5a3593adb0ed
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 13 16:28:38 2019 +0100

    Bug 23321: (follow-up) Add cash register to admin-menu
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 57a93704c00dadb389defffdd64400fa00e1a283
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jul 19 09:20:49 2019 +0100

    Bug 23321: (follow-up) Require cash registers for payments
    
    This follow-up catches the case where no cash registers have been
    defined for the current branch and as such payments cannot be processed.
    
    Test plan:
    1) Ensure you have 'UseCashRegisters' set to 'Do'
    2) Attempt to make a payment for a fee whilst logged into a branch that
       has not yet had cash registers configured.
    3) Note that you are shown a warning and cannot proceed.
    4) Signoff
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1a740fda1ea9d2f9be828481e075d4105701f275
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Sep 17 12:24:27 2019 +0100

    Bug 23321: Add cash register support to paycollect
    
    This patch ties in the cash registers system to the paycollect payment
    pages in the staff client.
    
    Test plan:
    1) Add some manual fees to a test patron
    2) Select some fees to pay off
    3) Note the addition of a select box for selecting your cash register
       upon payment.
    4) Set a branch default cash register for the current branch
    5) Repeat step 3 and note that the pre-selected cash register is the one
       set in step 4.
    6) Unset the branch default cash register for the current branch
    7) Repeat step 3 and note that there is no cash register pre-selected
    8) Set 'UseCashRegisters' to 'Do not'
    9) Repeat step 3 and note that there is no longer an option to select a
       cash register
    10) Signoff
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6461dc1a179451a34492c39178df9cbf6704f9d1
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Sep 17 12:24:18 2019 +0100

    Bug 23321: Allow setting of branch default
    
    This adds the ability to set a cash register as the default selected
    option when making payments at a particular branch.
    
    1) Note the addition of a 'Make branch default' button in each row of
       the table under 'Manage cash registers'
    2) Click the button and note that the button has changed.
    3) Click on an alternative cash register for the same branch and note
       that the default has been switched to the new register.
    4) Click the 'unset' button on the default branch and note that there is
       no longer a default register for this branch.
    5) Signoff
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b72c3c068c47efd02dd18505e6c677cf518fa4d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Sep 17 12:24:01 2019 +0100

    Bug 23321: Koha::Library additions
    
    This patch adds the relationship accessor for Cash::Registers to the
    Koha::Library class and include the relevant tests.
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4360c56621597cf09966679c90487b3978cfaf1b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Sep 17 12:23:49 2019 +0100

    Bug 23321: Add cash register management
    
    Add in administrative interfaces to allow the management of cash
    registers.
    
    Test plan:
    1) Enable the use of cash registers by setting 'UseCashRegisters' to
       'Do'
    2) Check that the 'Accounts > Manage cash registers' option now appears
       in the 'Administration' area.
    3) Click through to 'Manage cash registers' and note the message
       suggesting you add your first register
    4) Add you're first cash register
    5) Note that the message has now been replaced by a table of cash
       registers including the one you have added in the previous step.
    6) Edit the cash register created in step 4 and note that the table
       reflects the changes
    7) Signoff
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9247a33f869879b195a825d7213d9d7d2b348931
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jul 17 14:03:30 2019 +0100

    Bug 23321: Add cash register permission
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4563877e3545812a028c223344b92d68d7e9a6a2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jul 18 08:02:31 2019 +0100

    Bug 23321: Add cash register preference
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd56dce7afdfb125d65ebc268ec2343053731ec5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jul 16 15:16:18 2019 +0100

    Bug 23321: Add cash_registers table
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ac89be111a96c8b0fabfa7b5f98fb3daf7d366ee
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jul 16 17:11:26 2019 +0100

    Bug 23321: DBIC Classes
    
    Sponsored-by: PTFS Europe
    Sponsored-by: Cheshire Libraries Shared Services
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 98e4b5c04a1f89fb168fbc6e7dc40f374cb40ad1
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Wed Sep 4 02:10:21 2019 +0000

    Bug 23537: Overdrive won't show complete results at all times
    
    To test:
    
    On an overdrive enabled OPAC (tough sell, I know)
    
        Do a search for something you know has magazines, the collection I
        was looking at had "knit" as one
    
        Without this patch, the results will show "(many) items found in
        overdrive collection" but only show a small number of them.
    
        With the patch, the number of results should match the number
        shown/paginated.
    
        A site that has this fix applied, is
        https://tracy.bywatersolutions.com/cgi-bin/koha/opac-overdrive-search.pl?q=knit
    
        Before this patch, the number of results was 44, but there were only
        8 shown. Now we see all 44
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3f7d15b7f6baec1d6313c7ea5d81961289cac169
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Sep 23 11:03:02 2019 +0100

    Bug 23623: (RM follow-up) Minor JS Tidy
    
    Apply 'Break lines on chained methods' to the new JS code introduced in
    this patchset to prevent really long lines.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd9f723b18f871c7d540732276d33bad98177697
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Sep 17 19:03:14 2019 +0000

    Bug 23623: (follow-up) Add missing filters
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 92af7a31a350d4a4e2f9537f326b5a3e1e09b7b7
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Sep 17 18:59:26 2019 +0000

    Bug 23623: (follow-up) Add missing comma in ajax call definition
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ab4fa77eb0d7aeb1030d11eded7a4f6680494706
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 16 15:56:36 2019 -0300

    Bug 23623: Remove the svc/patron/show* scripts
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9af7d4f3a3033fbd62f01c60442f3163dc43b95c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 16 15:57:12 2019 -0300

    Bug 23623: Use the new API for changing privacy settings (guarantors)
    
    This patchset makes opac-memberentry.pl use the API instead of the old
    svc scripts for ajax calls, for setting privacy configuration in the
    OPAC.
    
    To test:
    1) Disable OPACPrivacy
    2) Enable AllowPatronToSetCheckoutsVisibilityForGuarantor
    3) Enable AllowPatronToSetFinesVisibilityForGuarantor
    4) Have a known patron be the guarantee of someone (so things display)
    5) Log into the OPAC, go to the 'your personal details' tab
    6) Change 'Allow your guarantor to view your current checkouts?' and
    click the 'Update' button.
    => SUCCESS: Operation succeeds
    7) Reload the tab
    => SUCCESS: The page reflects the expected changes (i.e. the API did it
            right)
    8) Repeat 6 and 7 with the 'Allow your guarantor to view your current
    fines?' option
    => SUCCESS: It works as well
    - Sign off :-D
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e04654052eadac2868fcf7e911705d22f6af1b9c
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 16 15:06:09 2019 -0300

    Bug 23584: Add the controller method and tests
    
    This patchset adds endpoints for the patrons to change their privacy
    settings regarding their guarantors.
    
    The following endpoints are added:
    
      PUT /public/patrons/:patron_id/guarantors/can_see_charges
      PUT /public/patrons/:patron_id/guarantors/can_see_checkouts
    
    They can only be used by the patron themselves with valid sessions. And
    enforce the AllowPatronToSetCheckoutsVisibilityForGuarantor and
    AllowPatronToSetFinesVisibilityForGuarantor system preferences when
    required.
    
    All this is covered by unit tests.
    
    To test:
    1) Run:
      $ kshell
     k$ prove t/db_dependent/api/v1/patrons.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c415476a37463540e702a5070a192ce413e834f1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Sep 16 15:05:38 2019 -0300

    Bug 23584: Add spec for PUT /public/patron/:patron_id/guarantors
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ea38aabd08d526214f3d3505e4377a1eda0488fe
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 19 15:44:59 2019 -0300

    Bug 22837: (follow-up) Fix POD
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e59b52032d0a159d5f86d8ab5864213cd9f51d0e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 19 15:41:02 2019 -0300

    Bug 22837: (follow-up) Fix some tests
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5f8e09bbaa6d1f05b4dfec0060a9d8b80b2e7975
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 3 13:13:07 2019 +0100

    Bug 22837: Update callers to use new signature
    
    Test plan:
    Run t/db_dependent/Circulation.t, t/db_dependent/Koha/Account.t,
    t/db_dependent/Koha/Account/Lines.t and
    t/db_dependent/api/v1/patrons_accounts.t and all should pass.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 22b18cc96d2a04f72ccbe1ea001648eab887f19e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 3 12:59:16 2019 +0100

    Bug 22837: Update apply to accept an arrayref
    
    This patch update the signature of Koha::Account::Line->apply to accept
    an arrayref of debits to apply against a credit instead of requireing a
    Koha::Objects set.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 16aa7d1c8afe249318767a8a023f7dbddb6843ea
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Sep 10 14:04:43 2019 +0000

    Bug 23526: Don't use encoded question mark in shib_login_url
    
    To test:
    1 - Enable shib
    2 - Do a search
    3 - Try to login from search
    4 - Get an error
    5 - Apply patch
    6 - Retry
    
    Note: You do have to fully configure shibboleth, you can simply enable it in koha-conf.xml and check the URLs.
    Signed-off-by: Matthias Meusburger <matthias.meusburger@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2ae6e95a40b4da7f77f241cbe941662ff773db44
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 17 15:08:06 2019 -0300

    Bug 23425: (QA follow-up) Keep it generic
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d3b46df3f3ca1ae04bd9574b29cfe291aff48f5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Aug 4 10:47:02 2019 -0500

    Bug 23425: Display the MARCXML error in the Metadata::Invalid exception message
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 921cf9b35297c8ea57cc5482385f040c2734a027
Author: Katrin Fischer <katrin.fischer@bsz-bw.de>
Date:   Fri Sep 13 12:18:09 2019 +0000

    Bug 23605: Fix terminology for branches limitations on patron category admin page
    
    Fix branches to library.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 36c734e68438b40401d0eee8ae823ae05da7ce79
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Sep 17 14:54:03 2019 +0100

    Bug 21390: Send registration verification emails immediately
    
    Sponsored by: Goethe-Institut
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 957d583d2efce66e31fe05f229fda91c58324bc2
Author: Chris Cormack <chrisc@catalyst.net.nz>
Date:   Wed Sep 4 21:43:13 2019 +0000

    Bug 21390: Send registration verification emails immediately
    
    To test
    1/ Enable self registration
    2/ Register, notice message is queued in the table but not sent
    3/ Apply patch
    4/ Register again, notice message is queued, but immediately sent
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 44049ad57e1928f2870abed15e4659f8357c2f19
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Nov 16 14:51:48 2018 +0000

    Bug 21852: Add more columns and column configuration to overdues report
    
    This patch adds some new columns to the overdue report: Patron category,
    item home library, item holding library, item type. Adding these columns
    makes available columns better match the available filter fields in the
    sidebar form.
    
    Column configuration is added to this DataTable, with the new columns
    defined as hidden by default in order to preserve current functionality.
    
    This patch also fixes a bug where the home and holding branch template
    variable names didn't match what was being used in the template for
    pre-selecting the searched-for value in the sidebar filter menu.
    
    To test, apply the patch and go to Circulation -> Overdues.
    
     - The list of overdues should look correct, with no new columns shown.
     - Test the column visibility button, showing the columns which are
       hidden by default. Confirm that the data in these columns displays
       correctly.
     - Update the default configuration for this table in Administration
       -> Configure columns. Confirm that your changes are applied to the
       overdues report.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e7a84dacfec76325819e39c5ef0dacf5ff1ffdea
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 17 10:45:05 2019 -0300

    Bug 20691: (QA follow-up) Fix self-reg
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 410e9bc0e88007cdff850afed83ee55a240a7517
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Sep 11 14:33:45 2019 -0300

    Bug 23597: Add missing reserved query parameters to GET /holds
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 075261645e1650629038c9a09e8d9e387bcc5474
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Sep 9 16:58:04 2019 +0000

    Bug 23575: Template error causes item search to be submitted multiple times
    
    This patch corrects the item search template so that the submit handler
    is not nested inside an unrelated loop. The change should have no
    outward effect on the behavior of the item search other than making it
    faster.
    
    To observe the bug in action, open your browser's developer tools and
    click the "Network" tab. Filter the output to only "XHR" and perform an
    item search. You should see multiple requests.
    
    To test, apply the patch and perform an item search. It should behave
    normally.
    
    Check the browser's "Network" monitor again to verify that only one
    request is being sent.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 766814ffa3c4592b9b7dcde83873ef12e796ae68
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Sep 13 07:36:25 2019 +0000

    Bug 22037: (QA follow-up) Correct misleading comment
    
    Comment needs to be corrected, and now applies to the whole code
    paragraph following it.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a5e519d70c168bb44cfea2d8a4490fad9049ab8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Aug 22 09:25:54 2019 -0400

    Bug 22037: (QA follow-up) Implement use of CHARGES_GUARANTEES
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2e91d33381cb29da30bfe16f022f1d07fe2b327f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Dec 20 19:39:34 2018 -0300

    Bug 22037: Block SIP checkout if guarantees have debt
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9515677afa2d6823016b3351fddbc45930c21667
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 13 11:19:28 2019 +0100

    Bug 23272: (RM followup) Fix failing tests
    
    This bug introduced a regression whereby if any authorized value has no
    branch limitations then the authorized value administration page would
    fail to display at all.
    
    A simple ternary corrects the issue, but I'm now wondering about the
    logic of returning 'undef' from 'get_branch_limits'.. perhaps an empty
    (or full) resultset might be a better option to prevent us from
    requireing ternaries before calling chained methods on such objects.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ce223ed30e4c4308d6585ae13c1da64d356cf7e0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 13 08:09:15 2019 +0100

    Bug 6759: DBRev 19.06.00.028
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 81568e3e8a835f2c544812cdb53f7dda99333764
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 12 15:16:04 2019 -0300

    Bug 6759: (QA follow-up) Unit tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 129223040f722a25c944e9b6438d8a337e4dd6e3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 24 11:15:33 2019 +0100

    Bug 6759: Update existing accountlines for 'A'
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 839c095b5461db3818df3ed8589c075e01a9d471
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 24 11:08:49 2019 +0100

    Bug 6759: Split account creation and renewal charges
    
    Test plan:
    1. Enable charging for patron enrolement
    2. Add a new patron where the category is charged for
    3. Note the charge of type 'Account management fee'
    4. Renew the patron
    5. Note the next charge of type 'Account management fee'
    6. Apply patch
    7. Repeat steps 1-6 and note the first charge will be of type 'Account
    creation fee' and the second of type 'Account renewal fee'
    8. Bonus points, enable 'FeeOnChangePatronCategory' and check that when
    changing a patron from a free category to a charged one that a new
    'Account renewal fee' is charged.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a8bc7fcc5d88dc5ed5d279fae3029c4a9ecbca5
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 5 16:24:17 2019 -0300

    Bug 23272: Adapt controller and tests
    
    This patch adapts the controller script for handling authorised values,
    and the tests to reflect the method names changes.
    
    To test:
    - Verify you can add/delete/edit authorised values with/without branch
    limitations, as usual
    => SUCCESS: All works as usual!
    - Run:
      $ kshell
     k$ prove t/db_dependent/AuthorisedValues.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95ab03b73ab2a1f021be119dabfaf826b3192d01
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 5 16:23:52 2019 -0300

    Bug 23272: Make Koha::AuthorisedValue use Koha::Object::Limit::Library
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 55f56c09ddfac59967d21ad0a37e7c7686439642
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 13 07:51:53 2019 +0100

    Bug 15497: (RM follow-up) Fix for new itemtype case
    
    When creating an entirely new itemtype the script would fail upon
    attempting to lookup existing itemtype branch limits. This patch adds a
    ternary to prevent the failure.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 072a901d35844e99db65c1069b52f4f8b5ad6e5a
Author: David Bourgault <dav.bour@gmail.com>
Date:   Wed Aug 7 18:01:58 2019 +0000

    Bug 21058: Added HTML class to showRDAtag264
    
    Adds the HTML class "rda264" to the span generated by the XSLT function
    showRDAtag264.
    
    To test, same as previous, using a notice with a 264 tag. Both patches
    only apply to MARC21.
    
    I was unsure how to name the class, so I've chose the simplest, most
    explicit name.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b65fc8e176f600894a98be526922f05e9d4f000d
Author: David Bourgault <dav.bour@gmail.com>
Date:   Wed Aug 7 16:42:30 2019 +0000

    Bug 21058: Added HTML classes in MARC21slim2_Detail.xsl
    
    This is a very small patch. I've simply added the following classes to
    their respective spans in the detail XSLs for both interfaces.
    
    - in_note (773$n)
    - preceeding_entry_note (780$n)
    - succeeding_entry_note (785$n)
    
    To test:
    
    1. Apply patch
    2. Open details page of notice with a 773$n, 780$n or 785$n field
    3. Inspect element. The class should be visible.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2694e53b204128b5ba2eddf9af24a59bc37a982e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 10 11:42:31 2019 -0300

    Bug 23580: Add C4::Context->yaml_preference
    
    This patch adds a new methods to be used on YAML-based sysprefs. The
    idea is that we would use it instead of handling the YAML decoding
    in-place everywhere we use YAML syprefs.
    
    Ideally, we could even move pipe separated values sysprefs into YAML,
    etc.
    
    To test:
    - Apply this patches
    - Run:
      $ kshell
     k$ prove t/Context.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8ecee99a020ed1bbac31b5f0d3ef4b3cba269041
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 10 11:42:02 2019 -0300

    Bug 23580: Unit tests
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e9e6537fae1dd921a95f55394ff2b463be8c834a
Author: Lari Taskula <larit@student.uef.fi>
Date:   Mon Jun 27 16:03:49 2016 +0300

    Bug 16825: Add API route for getting an item
    
    GET /api/v1/items/{item_id} Gets one Item
    
    This patch adds route to get one item from koha.items table.
    
    To test:
    1. Apply patch
    2. Open a browser tab on Koha staff and log in (to create CGISESSID
       cookie).
    3. Send GET request to http://yourlibrary/api/v1/items/YYY
       where YYY is an existing itemnumber.
    4. Make sure the returned data is correct.
    5. Run unit tests in t/db_dependent/api/v1/items.t
    
    Sponsored-by: Koha-Suomi Oy
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 13f83dc6e3dc5aed5651cedda78eb13e63e8a227
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Sep 12 16:32:37 2019 +0100

    Bug 15497: DBRev 19.06.00.027
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b12a56c1867682e91ec2be21689ef090ae41ff20
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 12 11:50:40 2019 -0300

    Bug 15497: (QA follow-up) Fix call in search_with_localization
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0c6bb77333b461242c283cb0cc91be9cd49a1c5f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Sep 12 16:27:19 2019 +0100

    Bug 15497: (QA follow-up) Use the methods from bug 23281 instead
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3fca44b65dfb4bc03b17df41101db52ddb52da39
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Sep 12 16:27:00 2019 +0100

    Bug 15497: Limit itemtypes by branch in additem.pl
    
    This patch adds a select multiple when you add/edit an itemtype, creates functions to return itemtypes by library, and filters the options of itemtype select in additem
    
    To test:
    1) Apply this patch set
    2) perl installer/data/mysql/updatedatabase.pl
    3) In koha administration => item types, edit "Books" itemtype
    CHECK => there is now a select multiple whith libraries at the bottom
    4) select centerville and save
    5) set centerville as current libary
    6) search for any biblio in the catalog
    7) click on "edit items"
    CHECK => book item type is present
    8) set any other libary as current library
    SUCCESS => book item type is not present
    9) Sign off
    
    Sponsored-by: Northeast Kansas Library System
    Sponsored-by: Southeast Kansas Library System
    Sponsored-by: Central Kansas Library System
    Signed-off-by: Jessica Zairo <jzairo@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ff85c6812e58869f804316ef3121988be5332718
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Sep 12 16:26:32 2019 +0100

    Bug 15497: Modify schemas
    
    Sponsored-by: Northeast Kansas Library System
    Sponsored-by: Southeast Kansas Library System
    Sponsored-by: Central Kansas Library System
    Signed-off-by: Jessica Zairo <jzairo@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a38522a1b807cb2d6c54849df7d0144c82ef7c9
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Jul 4 01:30:17 2019 -0300

    Bug 15497: Add itemtypes_branches table and atomic update
    
    Sponsored-by: Northeast Kansas Library System
    Sponsored-by: Southeast Kansas Library System
    Sponsored-by: Central Kansas Library System
    Signed-off-by: Jessica Zairo <jzairo@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a07e7ddb8b778fafc921564c36ea2e167c43929b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 12 11:38:14 2019 -0300

    Bug 23599: Avoid exploding in search_with_library_limits when no library is passed
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 92b16c8e5f8f3e149c6d53fdb0f8aa9d36133299
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Sep 12 11:37:34 2019 -0300

    Bug 23599: Regression tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 16399fd2363ff4bacd2ab4ffe042d211a10e071d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Sep 11 08:57:42 2019 +0100

    Bug 20691: DBRev 19.06.00.026
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 81b2e7f4cbe7f1d2d178ef80048deac196ed80ac
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 10 15:09:20 2019 -0300

    Bug 20691: (QA follow-up) API-related fixes
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7f8375f009e6d926ec9965ad2cbd8be1f35dd194
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Sep 10 15:01:34 2019 -0300

    Bug 20691: (QA follow-up) Fix atomic update
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 27a165363261741ecf5c10187a572f1278be0a17
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu May 23 00:15:47 2019 -0300

    Bug 20691: (follow-up) Fix qa fails
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5583a0a42c193b4992b3550e4d26bae0ae2630e7
Author: Kyle M Hall <kyle@bywatetsolutions.com>
Date:   Wed May 22 03:20:13 2019 -0300

    Bug 20691: Implement fines view
    
    This patch implements the logic to show guarantee's fines with guarantor user.
    
    To test:
    1) Apply (if not already done) steps 1 to 5 of previous patch
    2) Apply this patch
    3) Set OPACFinesTab and AllowStaffToSetFinesVisibilityForGuarantor preference to "Allow"
    4) Find a guarantee and in accounting create a manual invoice
    5) Enter OPAC with guarantor user
    CHECK => In summary there is no "Relatives fines" tab
    6) On intranet edit guarantee and set "Show fines to guarantors" to "Yes" and save
    7) Reload guarantor's OPAC
    SUCCESS => You see a "Relatives fines" tab with guarantee's fines information
    8) Sign off
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1ad03f5509ea287c7402c64577595a9c8cd60dfb
Author: Kyle M Hall <kyle@bywatetsolutions.com>
Date:   Wed May 22 02:41:24 2019 -0300

    Bug 20691: Add ability to turn feature on and off
    
    This patch adds two preferences
    1. AllowPatronToSetFinesVisibilityForGuarantor: Allow/Don't allow patrons to choose their own privacy settings for showing the patron's fines to the patron's guarantor
    2. AllowStaffToSetFinesVisibilityForGuarantor: Allow/Don't allow staff to set the ability for a patron's fines to be viewed by linked patrons in the OPAC
    
    Also adds a tinyint, non nullable, default to 0 column in borrower and deletedborrower named privacy_guarantor_fines.
    1. privacy_guarantor_fines = 0 => don't allow guarantor to see guarantee's fines
    2. privacy_guarantor_fines = 1 => allow guarantor to see guarantee's fines
    
    To test:
    1) git reset --hard master
    2) apply patches (including dependencies)
    3) perl installer/data/mysql/updatedatabase.pl
    4) dbic
    5) restart_all
    6) in intranet search for AllowPatronToSetFinesVisibilityForGuarantor and AllowStaffToSetFinesVisibilityForGuarantor preferences
    SUCCESS => both preferences should be present
    7) search for a patron with guarantor
    SUCCESS => in details tab, in "Library use" section you should see a row labeled "Show fines to guarantor"
    8) edit
    CHECK => in Guarantor information there is no "Show fines to guarantor" select
    9) set AllowStaffToSetFinesVisibilityForGuarantor preference to "Allow"
    10) return to patron with guarantor and edit
    SUCCESS => in Guarantor information section there is a "Show fines to guarantor" select
    11) change "Show fines to guarantor" select to "Yes" and save
    SUCCESS => Value is saved
    12) go to details tab
    SUCCESS => in "Library use" section you see a row labeled "Show fines to guarantor" with value "Yes"
    13) set OPACPrivacy preference to "Allow"
    14) open 2 opacs, one with a patron that has a guarantor and another that hasn't and go to "your privacy" tab.
    CHECK => in both opacs you should not see a "Allow your guarantor to view your current fines?" select
    15) in intranet set AllowPatronToSetFinesVisibilityForGuarantor to "Allow"
    16) refresh both opacs
    SUCCESS => in Patron that has guarantor you see a "Allow your guarantor to view your current fines?" select
            => in Patron without guarantor you don't see a "Allow your guarantor to view your current fines?" select
    17) in Patron with guarantor change value of select and save
    SUCCESS => Value is saved
    18) in intranet set OPACPrivacy preference to "Don't allow" and AllowPatronToSetFinesVisibilityForGuarantor to "Don't allow"
    19) got to "your personal details" in both opacs
    CHECK => in both opacs you should not see no Privacy section with a "Allow your guarantor to view your current fines?" select
    20) in intranet set AllowPatronToSetFinesVisibilityForGuarantor to "Allow"
    21) refresh both opacs
    SUCCESS => in Patron that has guarantor you see a "Allow your guarantor to view your current fines?" select in a Privacy section
            => in Patron without guarantor there is no Privacy section
    22) in Patron with guarantor change value of select and update
    SUCCESS => Value is saved
    23) Sign off
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9519c92f736c7acacafc19a4fb91b663c186294e
Author: Kyle M Hall <kyle@bywatetsolutions.com>
Date:   Tue May 1 13:03:32 2018 -0400

    Bug 20691: Database update
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b26c2a18630538ee515f8e383293efd2c2928c70
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu Aug 8 08:51:14 2019 +0200

    Bug 23004: Unit test
    
    Run prove t/db_dependent/Koha/SearchEngine/Elasticsearch/QueryBuilder.t
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 949e36c7b8a11cd185025a4c9e102f0e26205009
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed May 29 08:15:08 2019 +0200

    Bug 23004: Missing authtype filter in auth_finder.pl
    
    In cataloguing, the use of tag editor opens authorities finder with a limit on specific authorities type.
    This limit is missing with Elasticsearch.
    
    This patch adds in query a "filter" on "term" which is the most performant way because there must be no ranking computed on this part.
    
    Test plan :
    1) Use Elasticsearch
    2) Create an autority of type author (NP in UNIMARC) with heading "Tolkien"
    3) Create an autority of type subject-author (SAUT in UNIMARC) with heading "Tolkien"
    4) Create a biblio record
    5) Use tag editor on a author field (700 in UNIMARC)
    6) Seach for "Tolkien" in $a
    without patch : you see the 2 authorities in results
    with patch : you see only the correct authority in results (NP in UNIMARC)
    7) Check search in authorities-home.pl is still OK
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a7d5a4cc82ad7a1402eb0d11fd6d9613cadfa13a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Sep 10 09:38:39 2019 +0100

    Bug 22996: DBRev 19.06.00.25
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 237b86006bc7880ffcf8427e2fdc1c71797d4abc
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue May 28 14:14:02 2019 +0000

    Bug 22996: Move barcode separators to a preference
    
    This patch makes batchMod.pl and inventory.pl pick the barcode
    separators from a new pref BarcodeSeparators (instead of hardcoding
    these separators differently).
    A few other code locations may be potential candidates for such a change
    too.
    
    Test plan:
    Test inventory with a few variations of BarcodeSeparators.
    Test Batch item modification similarly.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b9c236ecb8534b4682939440feff86a4275658fe
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Tue May 28 14:47:35 2019 +0000

    Bug 22996: Add new preference BarcodeSeparators
    
    The pref value is used within a regex character class like [pref].
    This means that we should precede hyphen with a backslash; the pipe char
    or dot does not need escaping.
    
    Test plan:
    Run new install or upgrade.
    Check pref value.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3cb66af150171abf44868f8b0bdca8f70132e4f0
Author: Martha Fuerst <mfuerst@hmcpl.org>
Date:   Wed Aug 8 12:51:39 2018 -0400

    Bug 21180: Allow Talking Tech outbound script to limit based on patron home library branchcode
    
    A library system has requested the ability to limit which patrons are sent to Itivia for phone notices.
    
    Test Plan:
    1) Enable phone notices for two patrons with overdues
    2) Run the misc/cronjobs/thirdparty/TalkingTech_itiva_outbound.pl with the new --patron-branchcode option
    3) Note only the patron whose homebranch you specified is in the output file
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Christopher Brannon <cbrannon@cdalibrary.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77e809ee50358498a9214df60cf3ed9e85240a7a
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Aug 11 12:25:14 2019 +0200

    Bug 22627: Rename tab on my summary page
    
    This completes the first patch by also changing the
    tab on the OPAC summary page from "Fines" to "Charges".
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cb1d0d4e91072406f82c9da4dba4c0170b27b601
Author: Hayley Pelham <hayleymapley@catalyst.net.nz>
Date:   Mon May 27 14:38:52 2019 +1200

    Bug 22627: Renames OPAC fines tab to 'your charges' to be more inclusive
    
    Brought up on Bug 21578, the 'your fines' tab in the OPAC would be
    better named as 'your charges' as not all charges are fines, some are
    credits etc.
    
    To test:
    1) In the OPAC, click on the user's name and note that the tab that was called your fines is now called your charges.
    2) When you click on the tab, the title says Your charges, the breadcrumb says Your
    charges, and the table title is Your charges.
    
    Sponsored-by: Catalyst IT.
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a2bfe50a49e7c4c718fc2773e739c257f9071995
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Aug 30 15:10:12 2019 +0000

    Bug 23512: (follow-up) Markup comments and corrections
    
    This patch adds comments to the template to highlight the markup
    structure. It also corrects some minor markup errors.
    
    This patch should have no effect on the interface or functionality.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 654b6df5aa344a12fd7982261a6cdb5bec42f884
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Aug 26 18:01:03 2019 +0000

    Bug 23512: Reindent notices and slips page (letter.tt)
    
    This patch re-indents the template for notices and slips. It
    makes only whitespace changes. It should have no effect on the behavior
    of the page.
    
    To test, go to Tools -> Notices & slips.
    
    Test every aspect of the notice creation and edit process. At each step
    the page should work correctly.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit be1159df49cb8a43dbc57e2ce6ba71da1ea296be
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Sep 9 11:27:50 2019 +0100

    Bug 23464: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e4e5f96ffb2bfdc269f46f15e9cfeed1b96ea5b7
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Aug 22 18:55:21 2019 +0000

    Bug 23464: (follow-up) QA fixes
    
    This patch corrects two issues raised during testing:
    
     - Move JavaScript out of template check for IntranetUserJS so that
       SpineLabelAutoPrint behavior works correctly.
     - Add "close" button to pop-up window for cases when the barcode was
       not found.
    
    Also changed:
    
    - Added "required" attribute to barcode input on quick spine
      label printing page so that submitting an empty form will not work.
    
    - Tweaked CSS slightly to fix alignment of spine label form and submit
      button. (You must rebuild the staff client CSS:
     https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client)
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit efd4121941fb129adc57bca35483cd3334884820
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Aug 14 21:50:00 2019 +0000

    Bug 23464: Update the process of quick spine label printing
    
    This patch makes changes to the way quick spine label printing works,
    either from the bibliographic details page or the Quick spine label
    creator page.
    
    To test, apply the patch and go to Tools -> Quick spine label creator.
    
     - Type or scan a barcode. Submitting the form should trigger a popup
       window with the spine label print page. The "print" button should
       be centered at the bottom of the window in a footer-like container.
       - If you have SpineLabelAutoPrint enabled, the print dialog should
         appear automatically.
       - After printing, the pop-up window should close and and focus should
         be returned to the barcode field.
    
    Enable the SpineLabelShowPrintOnBibDetails system preference. View the
    bibliographic details page for a record in the catalog.
    
     - In the holdings table, a "Spine label" column should appear as the
       second-to-last column. The column should contain "Print label"
       Bootstrap-style buttons.
     - Clicking a "Print label" button should trigger a pop-up window with
       the spine label print page. The behavior of the window should be the
       same as above.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 180e708efe6e23de2c2d63bae7d96a529eff28fe
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Sep 9 11:23:19 2019 +0100

    Bug 23492: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 24ee72bf29301d88ea8eaba0c3315936f5bff9b4
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Aug 22 14:57:20 2019 +0000

    Bug 23492: OPAC search facet header should not be a link at larger browser widths
    
    This patch adds some JavaScript-driven "breakpoints" to the OPAC so that
    on the search results page the "Refine your search" heading has
    different behaviors depending on whether facets are being displayed as a
    sidebar.
    
    To test, apply the patch and regenerate the OPAC SCSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    Go to the OPAC and resize your browser to be greater than ~ 800px wide.
    
     - Perform a catalog search which will return several results.
     - In the left-hand sidebar of the search results page, the "Refine your
       search" heading should not be styled like a link. Hovering over it
       with the mouse should not change the cursor to the pointing-hand.
     - Narrow your browser window until the sidebar collapses.
       - The "Refine your search" heading should now be styled as a link,
         with a right-arrow icon before it.
       - Clicking it should expand the facets. The icon should change to a
         down-arrow.
     - Widen your browser window and test again.
    
     - Perform the same tests when starting with a narrow browser window.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3640130d1fbc49ddc2cc4baef53a4c4d7fea76bf
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 17 07:36:17 2019 +0000

    Bug 22929: Allow SCI/SCO logins independent of GDPR_Policy
    
    This patch makes Auth skip the GDPR policy check when get_template_and_user
    is called for sci/sco (self checkin, checkout).
    I do not really like the change in this form but the nature of self checkin
    and checkout kind of dictate it (double hack).
    I wanted to add a test but since that asks for mocking CGI, checkauth, etc.
    the time needed for that is just too much for this simple change.
    
    Test plan:
    Enable GDPR_Policy and self checkin/checkout.
    Verify that using patrons without consent is not blocking sci/sco.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cb432e7f522f2f052d561dad3b36bc97ca7868a4
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Sep 6 15:51:26 2019 -0300

    Bug 23404: (QA follow-up) Minor fix
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e98af5828a56b52426ae7aa12d1c85e4f9fb41d2
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Jul 31 10:59:37 2019 +0200

    Bug 23404: Change UT calls
    
    Run prove t/db_dependent/Circulation/TooMany.t
    Tests are OK
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9e1fa801d6f1ff718d8689c855483b8b9c735a9f
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Jul 31 15:56:22 2019 +0200

    Bug 23404: fix Circulation::TooMany error on itemtype when at biblio level
    
    Circulation::TooMany gets itemtype from $item var beeing a Koha::Item unblessed.
    When itemtype is at biblio level, calling $item->{'itemtype'} is wrong.
    
    Test plan :
    1) On a catalog with itemtype at item level : pref item-level_itypes=1
    2) Create a biblio record with itemtype BOOK
    3) Create an item on this biblio record with itemtype BOOK
    4) Delete all issuing rules
    5) Create a issuing rule with itemtype BOOK, any catagorie, any branch
    6) Check-out the item
    7) => Checkout is allowed
    8) Check-in item
    9) Change itemtype at biblio level : pref item-level_itypes=0
    10) Check-out the item
    11) => Checkout is not allowed
        You see message "No circulation rule is defined for this patron and itemtype combination"
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 445b0cb8b595136afdebaee2db3bc768b42b445b
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Jul 31 11:21:14 2019 +0200

    Bug 23404: add UT to show bug
    
    Run prove t/db_dependent/Circulation/TooMany.t
    It fails on :
        #   Failed test 'We are only allowed one, and we have one (itemtype on biblioitem)'
        #   at t/db_dependent/Circulation/TooMany.t line 547.
        #     Structures begin differing at:
        #          $got->{reason} = 'NO_RULE_DEFINED'
        #     $expected->{reason} = 'TOO_MANY_CHECKOUTS'
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 811bee9bce57e67fd22562b3bb62397335b4eeb5
Author: Caroline Cyr La Rose <caroline@inlibro.com>
Date:   Fri Aug 16 14:28:59 2019 -0400

    Bug 23353: ACQ framework makes fr-CA web installer explode
    
    This patch removes the standalone ACQ framework SQL file in the fr-CA
    directory and adds the ACQ framework creation SQL in the default
    framework file, as it is in other languages.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 49e30bc67d91f300df2efd9b7a2cf0526221fb96
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 6 13:24:10 2019 +0100

    Bug 23539: (RM follow-up) Update DBIC classes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2bbd811027172af1adb68f9904071951056ecbda
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Sep 6 09:47:19 2019 +0000

    Bug 16111: (QA follow-up) Few additional corrections
    
    [1] Refining the regex on the format parameter in opac-search.pl
    [2] Adding a colon to dc:identifier. The Dublin Core specs gives me this
        example:
        Identifier="ISBN:0385424728"
    [3] Replacing last occurrence of rss2 in the rss template
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 062c3f9ab2e25b64dad1d4356a976a1416204c05
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Sep 6 09:02:38 2019 +0000

    Bug 16111: (QA follow-up) Changes related to partial revert
    
    When reverting the &amp; change, we need to go back to html filter for
    query_cgi and limit_cgi. In this patch I only replaced it where it is
    needed. The template contains more references to SEARCH_RESULT.query_cgi
    and SEARCH_RESULT.limit_cgi which are useless, since searchResults does
    not return these hash keys at all.
    
    This patch fixes one occurrence where SEARCH_RESULT was copied outside
    the loop that defines the template variable.
    
    Obviously, the code for RSS still needs more attention.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fafd719dd34aeb4e96377f4404a53df589138efd
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Mon Aug 19 01:51:04 2019 +0000

    Bug 16111: Further fixes to the RSS to make feed work
    
    - fixed links per the WC3 spec
    - fixed a problem in the ATOM link
    
    To test:
    do a search, click the RSS icon - it shows xml in most browsers but wont
    do RSS type things.
    Apply this patch, restart the things
    refresh the page, it should do RSS things (i.e. firefox should render it
            as a nice looking thing, rather than raw XML.)
    
    noting that there are a couple of validation errors still, but they
    don't seem to be show stopping and moreover I wasn't sure how to fix them:
    
    Misplaced Item
    Self reference doesn't match document location (this is a "for widest
            compatibility you should fix" kind of thing)
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0e1e5ca31fab861c85c9b6e0d3b788f0208402d4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 19 18:24:56 2019 -0400

    Bug 16111: [CHANGED] Replace link href by link in rss part
    
    Original patch title: Replace & with &amp;
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    
    EDIT:
    Reverting the changes to C4/Search and opac-search.pl.
    This requires a few changes, as supplied in the 5th patch.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4de5d3dd428a23605e6dc49bfc05bfe780f647dc
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 19 16:33:06 2019 -0400

    Bug 16111: Adjust some more filters
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b946e996ff208e71bbfd5cfb7714f9a656065093
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 18 17:31:27 2018 -0300

    Bug 16111: Fix content type for RSS feed
    
    Test plan:
    GET http://catalogue/cgi-bin/koha/opac-search.pl?idx=kw&q=perl&count=50&sort_by=acqdate_dsc&format=rss2
    
    => Without this patch it returns content type text/html
    => With this patch it returns text/xml
    
    GET http://catalogue/cgi-bin/koha/opac-search.pl?idx=kw&q=perl&count=50&sort_by=acqdate_dsc&format=rss
    => Without this patch it does not work
    => With this patch it returns text/xml
    
    Bug 16111: Fix atom support
    Bug 16111: Remove 'rss2' which should be 'rss' or 'atom'
    Bug 16111: Replace <link> with <link href...
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 38322b5a43b37575d4d1c2da1d4b5b0ef3b83bf4
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 6 13:20:14 2019 +0100

    Bug 23539: DBRev 19.06.00.024
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 00c61beff999c12823111fb594bec2c57a5c0d58
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Sep 4 13:48:41 2019 -0400

    Bug 23539: accountlines.accounttype should match authorised_values.authorised_value in size
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aede6896dd6ebc660894bcde117ccd213e2c3de6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Sep 1 15:26:02 2019 -0400

    Bug 23289: Quote new 'rows' MariaDB reserved word
    
    Since MariaDB 10.2.4 rows is a reserved word:
    https://mariadb.com/kb/en/library/mariadb-1024-release-notes/
    
    """
    New reserved word: ROWS. This can no longer be used as an identifier
    without being quoted.
    """
    
    Test plan:
    With MariaDB >= 10.2.4, create a new label template.
    Also, prove t/db_dependent/Labels/t_Template.t
    
    Without this patch you will get the following SQL error: DBD::mysql::st execute failed: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'rows, creator, template_code, page_height,
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 60ce66b6b658bfbe0d9ca459afc673042c7a854f
Author: Mason James <mtj@kohaaloha.com>
Date:   Tue Sep 3 16:02:32 2019 +1200

    Bug 23530: Fix cart showing only hidden items
    
    Items hidden with the OpacHiddenItems system preference
    were still displayed in the OPAC cart and the normal items
    were hidden instead. This patch corrects the display.
    
    To test:
    - prep a test bib with hidden and other items using
      the OpacHiddenItems system preference
    - add bib to cart
    - observe that hidden items are displayed - non-hidden items are hidden
    - apply patch, reload page
    - observe that hidden items are hidden, non-hidden items are displayed
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6b6fe8f88b33e3455ae30526109674bfa4f3d185
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 22 20:33:45 2019 -0500

    Bug 23079: Add tests
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d0040dff9f435be65503e88afe45ce196bce9c4a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 22 20:40:04 2019 -0500

    Bug 23079: Handle invalid timezones when adding/subtracting durations
    
    On Nov 3rd 2019, Brazil will skip from 00:00 to 1:00 (http://www.currenttimeonline.com/dst/dst.do?tz=America/Sao_Paulo), DateTime consider it as an invalid date.
    It is a problem when we are playing with dates without the time part (always 00:00).
    When we instantiate a DateTime (from dt_from_string) we are already handling this issue, and use the floating timezone (since bug 12669).
    
    The problem remains when we generate a DateTime then add or subtract a duration, which will result in an invalid date:
    
    DateTime->new(year => 2019, month => 12, day => 3, time_zone => 'America/Sao_Paulo')->subtract(days => 30);
    
    => Nov 3rd 2019, kaboom.
    
    We should replace all the problematic occurrences of dt_from_string->subtract (or ->add)
    with dt_from_string(undef, undef, 'floating'), to use the floating timezone and avoid the error.
    
    Actually there are not many of them, I have found only 3 that could
    produce real problems.
    
    The other occurrences are:
    - in tests => Not a big deal (for now)
    - called on a datetime, so it will explode if called at midnight
    00:00:00 (and nobody should work at that time).
    
    Test plan:
    0/ Define the timezone to 'America/Sao_Paulo' (in your koha-conf.xml file), restart_all
    1/ Set a patron's expiry date to Dec 3rd 2019, and
    NotifyBorrowerDeparture to 30 (default value)
    2/ See the checkouts page for this user
    => Without this patch you get "Invalid local time for date in time zone:
    America/Sao_Paulo"
    => With this patch apply the page displays correctly
    
    QA will review the 2 other occurrences.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9215ca42d28bec10f55a9c660bb5816045bb9656
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 22 19:29:42 2019 -0500

    Bug 22786: Prevent fund creation for locked budgets
    
    If a budget is locked, there is a "New fund for $budget" link that is
    disabled but clickable.
    We should ensure that the link is not clickable and prevent it at
    controller level (do we need it at module level, ie.
    Koha::Acquisition::Fund->store?)
    
    Test plan:
    - Create a budget, lock it
    - Go to /cgi-bin/koha/admin/aqbudgetperiods.pl
    - Click on the name of the budget you just created
    => The "New > New fund for $budget_name" button should be disabled
    - Click it anyway
    => Without this patch the form to add a new fund is displayed
    => With this patch applied nothing happens
    - Hit /cgi-bin/koha/admin/aqbudgets.pl?op=add_form&amp;budget_period_id=XXX
    With XXX the budget's id
    => Without this patch the form is displayed
    => With this patch applied you get a message:
      "The budget is locked, fund creation is not possible."
    And you are not able to create a new fund
    
    QA notes:
    1. See description
    2. The add_validate op can still be forced, let trust librarians with
    administration permissions for now.
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b94b58aa746188ee3699a2e4bc0a6b24d2dd86c5
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Aug 30 12:25:45 2019 +0000

    Bug 23518: Problem with borrower search autocomplete
    
    This patch fixes a bug introduced by my patch for Bug 23405: Keyboard
    navigation of patron autocomplete results was broken because I
    incorrectly assumed that the autocomplete "select" action was redundant
    because keyboard navigation would trigger the selected link. It doesn't!
    
    This patch adds the "select" action back to the autocomplete
    configuration, explicitly defining a redirect to match the URL which is
    followed if the user uses the mouse to click a result.
    
    To test you should have a patron in your database which has no card
    number. Make sure CircAutocompl is enabled.
    
    - From the circulation home page, type a patron name in the "Check out"
      form and wait for autocomplete search results to display.
    
    - Making a selection from the autocomplete results should work by
      clicking with a mouse OR using the arrow keys and TAB or ENTER.
    
    - Test with patrons with and without card numbers.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 66b6c76d96b172bbd2b9f90640f7701a6ba4530c
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Aug 5 14:25:51 2019 +0000

    Bug 23210: (follow-up) Log in for tags link should trigger modal
    
    This patch modifies the "Log in to add tags" link on the OPAC search
    results page, adding the class which is used elsewhere in the OPAC
    templates for triggering the login modal.
    
    Also: Removed an unnecessary period.
    
    To test, apply the patch and follow the original test plan. Clicking the
    "Log in to add tags" link should trigger the login modal. After logging
    in you should be returned to the page you were on.
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 99d8d2db2c4f44cbb91a069ed3a8dd7894e0218a
Author: Lucas Gass <lucas@bywatersolutions.com>
Date:   Fri Aug 2 22:21:40 2019 +0000

    Bug 23210: login4tags should be a link and included in every search result
    
    TEST PLAN:
    
    1. Make sure TagsEnabled and TagsInputOnList are set to allow.
    2. Don't be logged into the OPAC.
    3. Make a search and notice the 'Log in to add tags' text is not a link
       on the results page.
    4. Apply patch
    5. Refresh OPAC results page
    6. 'Log in to add tags' takes you to the login page.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4148b222b373b262a16a99faa314a47fa3994c0e
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 23 14:36:36 2019 +0000

    Bug 23397: (QA follow-up) Replace mod 2 by last
    
    Looks better: Maps | Books | Continuing Resources
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 36a16efec36b4c4d57231c0f459f76cb2bbaee7d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Aug 23 13:14:57 2019 +0000

    Bug 23397: (follow-up) Split and display itemtypes
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1f40de2931f19cce0ca372151444ea05eb5f8e93
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jul 29 18:12:21 2019 +0000

    Bug 23397: Fix grouping of orders in acqui scripts
    
    Bug 21622 attempted to fix some grouping for strict mode, however, it failed to take into account that single order can have multiple item types.
    
    To recreate:
    1 - Place an order for 4 copies of a title in acq
    2 - Make sure you are creating orders when ordering (AcqCreateItems syspref and/or when creating basket)
    3 - Set three items to one type, and one to another
    4 - Go to Acqui-Home and click 'ordered' for the used budget
    5 - Note the line is duplicated for each itemtype in the order
    6 - Recieve the items and note the same issue on 'Spent'
    7 - Place another order as before so you have the problem in both ordered.pl and spent/pl
    8 - Apply patch
    9 - Note orders are no longer duplicated
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 424cd4ed7f877d8bc7a45c77df0fa1b614efd1b7
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Aug 23 16:41:57 2019 +0000

    Bug 23502: Staff client "revert status" buttons should not depend on SuspendHoldsIntranet preference
    
    This bug corrects the template logic controlling the display of the
    "Revert waiting status" and "Revert transit status" buttons on the staff
    client holds page so that it doesn't depend on having
    SuspendHoldsIntranet enabled.
    
    To test, apply the patch and locate a title which has multiple holds,
    including:
    
      - One waiting hold
      - One in-transit hold
      - At least one pending hold
    
    View the page with the SuspendHoldsIntranet preference both on and off.
    The "Revert transit status" and "Revert waiting status" buttons should
    be displayed either way.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c1664d3bd6bb613d211695ed603ced868de4cafb
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 6 13:16:44 2019 +0100

    Bug 22258: DBRev 19.06.023
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8a99d4adb29a31ddc52b222746c67d70d2636158
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Fri Apr 5 10:29:42 2019 +0300

    Bug 22258: Increase Elasticsearch maximum field count to 10000
    
    Increases maximum field count from the default 1000 to 10000 to accommodate large records and MARC as an array.
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4f42ea51d74325af6282420ef11ba539c784ffd7
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Fri Feb 15 13:32:03 2019 +0200

    Bug 22258: Elasticsearch: Add array as an alternative MARC format
    
    Adds preference ElasticsearchMARCFormat that controls whether MARC records are stored as ISO2709/MARCXML or array. Array is searchable by field and also indexes all subfields in the _all field for searching.
    
    Test plan:
    1. Test that searching and indexing works with the patch without any changes.
    2. Switch to array format and index some records.
    3. Check e.g. the 008 field of a record and verify that the record can be found with the contents enclosed in quotes.
    4. Check that it's possible to search for a specific field/subfield. Search query: marc_data_array.fields.655.subfields.a:Diaries
    5. Check that tests still pass, especially t/Koha/SearchEngine/Elasticsearch.t
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18d8d3b38b367ee0ea10169a0433e4a273252f15
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 6 09:09:18 2019 -0500

    Bug 23265: (bug 12063 follow-up) Remove Koha::Holds from updatedatabase
    
    Test plan:
    Have a DB that fail the 16.12.00.032 update, then apply this patch and
    verify the expiration dates
    
    RM: Please inforce this rule, no use of Koha:: in updatedatabase!
    
    Signed-off-by: Victor Grousset <victor.grousset@biblibre.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1fd224ea65dabd53e9f386af3ee602a87c2bb6dd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Sep 1 11:35:33 2019 -0400

    Bug 23273: Remove debug statement
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 910417e22b31b54e60bd7b98146f68ca7d66d0aa
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Sep 6 10:17:20 2019 +0100

    Bug 23273: (RM follow-up) Correction to filters
    
    My initial RM followup for this patchset added one bad filter which
    resulted in double encoding. This patch corrects that oversight.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 46a9a7c8ef4a20ae8e01f199ba051fbc2c9597c0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Aug 22 15:24:30 2019 +0100

    Bug 23013: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 247dca306407ac9568344a0a37aca3bbcffc2468
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jun 6 16:48:08 2019 +0000

    Bug 23013: Upgrade DataTables in the staff client
    
    This patch upgrades DataTables and makes some style changes to the
    default DataTables toolbar style. DataTables assets are now combined and
    minified using their download customizer, bundling together these
    elements:
    
     - JSZip 2.5.0
     - pdfmake 0.1.36
     - DataTables 1.10.18
     - Buttons 1.5.6
     - Column visibility 1.5.6
     - HTML5 export 1.5.6
     - Print view 1.5.6
     - FixedHeader 3.1.4
    
    DataTables assets have been moved from lib/jquery/plugins to
    lib/datatables. The global header and footer include files are updated
    correspondingly.
    
    This patch removes the custom "four_button" pagination configuration and
    updates pages which used it to use the built-in "full" type instead.
    This is done for the sake of consistency and upgradability. This change
    touches a lot of files.
    
    Table-specific CSS has been moved from staff-global.scss to a new
    include, _tables.scss. A second common include, _mixins.scss has some
    variable definitions used in both files.
    
    Many images have been made obsolete by this change and have been
    removed.
    
    To test, apply the patch and regenerate the staff client CSS. View
    various pages in the staff client with tables:
    
     - Not formatted by DataTables:
       - Reports -> Most circulated items
       - Catalog -> Search results
     - Formatted by DataTables without column configuration
       - Acquisitions -> Vendor search
       - Lists
     - Formatted by DataTables with column configuration
       - Administration -> Libraries
       - Administration -> Item types
       - Reports -> Saved SQL reports
     - Non-standard DataTables configurations:
       - Circulation -> Checkouts
       - Administration -> System preferences
       - Reports -> Lost items
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12f583dd2c580cad046605531c79c1a90bf91436
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Aug 21 08:23:52 2019 +0100

    Bug 14570: (RM follow-up) Add class relatinship to BorrowerRelationship
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 205ab8f50ba3274e6382b114036b9bc0c943c918
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Aug 20 16:15:17 2019 +0100

    Bug 14570: DBRev 19.06.00.022
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 949b5b37110d5510b39bfe43921f581ed8439cce
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Aug 20 15:55:45 2019 +0100

    Bug 14570: (RM follow-up) Consistent button styling
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77d197c361a71f7090add40651630a1d99b17058
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Aug 19 10:32:06 2019 -0300

    Bug 14570: Add about.pl entry for wrong relationship data
    
    This patch adds a check and an entry to the about.pl, for bad
    relationship data. The checks are:
    
    - 'relationship' containing '_bad_data' (generated by the atomicupdate
      on undef relationships.
    - 'relationship' values that are not in the borrowerRelationship
    syspref.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d09444c735c9879f7aebe8139f0a921a1076940b
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Aug 19 10:31:41 2019 -0300

    Bug 14570: (QA follow-up) Call Koha::Patron->find in scalar context
    
    This patch prevents opac/opac-memberentry.pl from exploding.
    
    To test:
    - Login with a known user in the OPAC
    - Open the opac/opac-memberentry.pl page
    => FAIL: It explodes
    - Apply this patch
    - Restart all the things just in case:
      $ restart_all
    - Reload the page
    => SUCCESS: Things work!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ee178f42ded6c3c0342e9ed478b070117a8b9776
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Aug 19 07:22:50 2019 -0300

    Bug 14570: Handle missing 'relationship' in atomicupdate (bad data)
    
    This patch adds two steps to the upgrade process:
    - Handle the pathologic case in which there's a guarantorid and no
    'relationship'.
    - Performs a cleanup on the relevant columns when the guarantor data
    contains a guarantorid, and is then migrated into the
    borrower_relationships table. The original code left the information
    in the borrowers table, so no clear separation between guarantors as
    patrons and the virtual ones.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3bff8a17eaf96c10b1b30babd0271f0eb2bc4fc0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Aug 16 14:43:42 2019 -0300

    Bug 14570: (QA follow-up) Fix tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b4b95b97263f858f6dd19e71c26e0c5ba841e607
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Aug 12 17:14:22 2019 -0300

    Bug 14570: (QA follow-up) Consistency displaying the list of guarantors
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3ab5d3b1253f255c8d06988e4a54054c811c19d3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Aug 12 16:43:14 2019 -0300

    Bug 14570: Remove wrong parameter in add_guarantor call
    
    This patch just removes an unused parameter.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 540136bb470ec66bff45881e97f51897bee731d8
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Aug 12 16:13:25 2019 -0300

    Bug 14570: Add error handling to Koha::Patron::Relationship->store
    
    This patch adds checks on the values for the 'relationship'. This is
    done to avoid future problems when migrating relationships from the
    plain text syspref into (why not) a proper table. And to preserve
    consistency.
    
    There's also catching on possible broken constraints and throwing a new
    exception
    
    Tests are added for both the new exceptions and the changes to
    Koha::Patron::Relationship.
    
    To test:
    - Apply this patches
    - Run:
      $ kshell
     k$ prove t/Koha/Exceptions.t \
              t/db_dependent/Koha/Patron.t \
              t/db_dependent/Koha/Patron/Relationship.t
    => SUCCESS: Tests pass!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit abb801ebbc986b40573ecfb3d7ce3093dd67f803
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Aug 13 13:28:26 2019 -0300

    Bug 14570: Add a UNIQUE constraint on guarantor_id+guarantee_id
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d2a082647caf2f163bd9a895145a3994172f797
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Aug 12 14:21:07 2019 -0400

    Bug 14570: (QA follow-up) Fix issues in Guarantor context
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f827064badfa261d6123752ec4aebd8c4378677e
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Aug 12 14:14:39 2019 -0400

    Bug 14570: (QA follow-up) Fix issues in Guarantee context
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 200352183824011c5435cd12368944c3a678e889
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri May 17 08:15:08 2019 -0400

    Bug 14570: Update schema files [Do Not Push]
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e591e9cb6c5e7711ff9811ebf0cfc9e8c5449a5
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed Jul 3 14:36:00 2019 -0300

    Bug 14570: (follow-up) Fix patron type when "add child" button is pressed
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a17245a52e1b11dfef9808a1a88731c63814efb9
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Tue May 21 19:08:39 2019 -0500

    Bug 14570: (QA follow-up) fix sample borrowers, remove guarantorid)
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 89bd7872e357e029daee685b078170781ef42ba3
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Tue May 21 00:07:47 2019 -0300

    Bug 14570: (follow-up) Fix tests
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 53b3ebe9d0b359ac88671ed489afc49ab65d2520
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri May 17 21:38:37 2019 -0300

    Bug 14570: (follow-up) fix qa FAIL tests
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c8ff1e4701854ab74b6f85fd4ff02592f8205bf6
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri May 17 21:10:02 2019 -0300

    Bug 14570: (follow-up) fix table name in j2a.pl
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 109334102fbb29c60fa9a7a762c5e68f4b2ce0be
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon May 2 15:00:39 2016 +0000

    Bug 14570: Make it possible to add multiple guarantors to a record
    
    This patch adds the ability to set an unlimited number of guarantors
    for a given patron. As before, each guarantor may be linked to another
    Koha patron, and all the behavior that applies to a given guarantor
    remains the same.
    
    Test Plan:
     1) Apply this patch
     2) Run updatedatabase.pl
     3) Find some patrons with guarantors, verify the still have their guarantor
     4) Test adding and removing guarantors on a patron record, both Koha users and not
     5) Verify the "Add child" button works
     6) Verify NoIssuesChargeGuarantees still works
     7) Verify tools/cleanborrowers.pl will not delete a guarantor
     8) Verify the guarantors are displayed on moremember.pl
     9) Verify the guarantor is removed by members/update-child.pl
    10) Verify the guarantor is removed by misc/cronjobs/j2a.pl
    11) Verify import patrons converts guarantor_id, relationship, contactfirstname,
      and contactsurname into a guarantor
    12) prove t/Patron.t
    13) prove t/db_dependent/Circulation.t
    14) prove t/db_dependent/Circulation/NoIssuesChargeGuarantees.t
    15) prove t/db_dependent/Items.t
    16) prove t/db_dependent/Koha/Patrons.t
    17) prove t/db_dependent/Members.t
    18) prove t/db_dependent/Patron/Relationships.t
    
    Signed-off-by: Kim Peine <kmpeine@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a5828bc7dccdfbc574b30a7f39c822d4a4cab8fe
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Aug 20 15:59:06 2019 +0100

    Bug 23273: (RM follow-up) Add missing filters
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f4e00328bc50470996e3e68069ab5be0f720dd73
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Mon Dec 10 12:57:50 2018 +0000

    Bug 20254: Add tests for transport ingest
    
    Add test framework for Koha::Edifact::Transport
    Add specific test that ingest does not duplicate
    an existing filename
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a07cd5e865cd17fb70fa332ad2e5490ef178b659
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Mon Dec 10 12:52:13 2018 +0000

    Bug 20254: Set correct member in working_directory
    
    Koha::Edifact::Transport working_directory was setting the
    wrong member name correct that
    method is only used in testing
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8b98403cbed7ada5d30d00256ede2d2cd96ab269
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Wed Jan 24 09:20:12 2018 +0000

    Bug 20254: Do not ingest files with duplicate filenames
    
    If the supplier delivers the same file twice we are
    unable to rename it on the second occurence causing us to download
    and process it infinitely.
    
    Check that downloaded filenames are unique against those
    on file and reject processing if a duplicate.
    
    This patch delays this check to the ingest stage so that the
    same code is processed irrespective of transport
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b8f382b82172b70166db48d572f767b06a4834ef
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 19 18:09:58 2019 -0400

    Bug 23273: Fix CSV export for overdues
    
    We should construct the URI parameters string manually to avoid
    filtering problems.
    We cannot send the full query_string to the template and expect that the
    string will be escaped correctly.
    
    Test plan:
    - go to overdues.pl
    - construct a search limiting by date due and library
    - note number of overdues in results
    - click "Download file of displayed overdues"
    => note that downloaded file contains just those in your search
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2e85ac9949ba6ccbe7470ae2caf446c05e0b941
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jul 15 18:29:45 2019 +0000

    Bug 23294: Show actual price when ordering
    
    To test:
    1 - Have a basket
    2 - Add an order
    3 - Modify the order, note you cannot see the unitprice/Actual cost
    4 - Apply patch
    5 - Note it is there
    6 - Add to IntranetUserCSS:
        .ordering_unitprice{ display:none; }
    7 - Reload
    8 - Note it is hidden
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d4468c5f33f03cbd616527a558c1b67670089642
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Aug 12 10:43:35 2019 -0300

    Bug 11677: Use zebra not-onloan-count index for availability limit
    
    This uses the work from bug 18098 to use the count of not-onloan items to
    determine availability.
    
    It keeps the allrecords,AlwaysMatches='' portion of the query so it still catches
    records with the tested indexed missing.
    These shouldn't exist except in the case of missing data, but kept for future use as well as
    it has no negative impact and minimizes the change made.
    
    Note that availability in this sense means not check out and not lost. Transfers, holds, and not for loan statuses
    should probably have indexes built in the same way as bug 18098 (there are related FIXMEs in the code)
    
    This updates the export_records file used for testing - adding three records with a not-onloan-count (999$x) of 1,
    but marking the item on the third record lost to prevent its return
    
    To test:
       1 - make sure SearchEngine pref is set to 'Zebra'
       2 - Do a search on the OPAC that returns some records
       3 - Find a record in those results with more than one 1 item, and checkout 1 leaving 1 (or more) available
       4 - Find another record with only 1 item, check that item out
       5 - Limit opac search to available items - both records disappear
       6 - Apply patch
       7 - Restart all the things
       8 - Repeat search
       9 - First record should show, but no second
      10 - Mark other items of first record as lost, return items on second record
      11 - Repeat search, first record should not be in results, second should
      12 - prove -v t/db_dependent/Search.t
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e31cddf8b0fca3f4847c093d52aa911cd502749e
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 8 15:23:09 2019 -0300

    Bug 23281: Cleanup Koha::Patron::Attribute::Types->search
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 90b48c2c48e2056a93b2619b94518769e6cefc9f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 8 14:15:48 2019 -0300

    Bug 23281: Implement ->search_with_library_limits in Koha::Patron::Attribute::Types
    
    This patch makes Koha::Patron::Attribute::Types inherit from
    Koha::Objects::Limit::Library so it now has the
    ->search_with_library_limits method.
    
    Tests are adjusted so it is clear that there is no behaviour change
    compared to the (previsouly) called ->search
    
    To test:
    - Run:
     k$ prove t/db_dependent/Koha/Patron/Attribute/Types.t
    => SUCCESS: Tests pass!
    - Apply this patch
    - Run:
     k$ prove t/db_dependent/Koha/Patron/Attribute/Types.t
    => SUCCESS: Tests still pass!
    - Sign off :-D
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ae4e992dfb2251d6a7cd9268a5171a814162b293
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 8 14:13:12 2019 -0300

    Bug 23281: Add Koha::Objects::Limit::Library
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f1f66d73006e0de49dad36ff969ad974d4bd0fce
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Aug 12 18:08:37 2019 +0000

    Bug 23448: (follow-up) Add comments on markup structure
    
    This patch adds comments to the markup in order to highlight the
    structure of the page.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ee9587f983fafa4c47e809c301b4f3698be9215c
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Aug 12 17:57:55 2019 +0000

    Bug 23448: Clean up subscription detail template
    
    This patch makes a number of corrections to the subscription detail
    page: Re-indented consistently with four spaces. Removed invalid
    attributes. Added missing </div>.
    
    To test, apply the patch and go to Serials. Search for a subscription
    and view the details page.
    
    The page should look correct. Validating the source should return no
    errors.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b90019f8ad956915baa13873284eeb344ffd58f
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Aug 13 18:26:57 2019 +0000

    Bug 23458: (follow-up) Add comments to markup
    
    This patch adds a few comments to the markup in order to highlight the
    structure of the page.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b349fa10017e1dc397aeb32502296c7fd7e3c741
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Aug 13 15:47:08 2019 +0000

    Bug 23458: Clean up holds template in the staff client
    
    This patch reindents reserve/request.tt to use four spaces and
    to eliminate tabs, following coding guidelines. Trailing white space has
    been removed.
    
    To test, apply the patch and use your preferred method for checking the
    differences between files while ignoring whitespace. I use diff with the
    "-w" flag, but I'm no diffctator.
    
    Test the process of placing a hold in the staff client: A single hold,
    multiple holds, etc. Everything should work correctly.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 388f5fa0ffef6a1a5720cb1a94f2f9eb7b6dcf8a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Aug 13 15:54:30 2019 +0000

    Bug 17057: (follow-up) Replace onsubmit attributes
    
    This patch removes the "onsubmit" attribute from the place hold form.
    
    To test, apply the patch and test placing a hold:
    
    Begin the process of placing a hold on a single title. On the
    place hold screen, uncheck the "Hold next available item" checkbox and
    click the "Place hold" button.
    
    You should be get an alert saying "Please select an item to place a
    hold." Select an item and click the "Place hold" button again. The hold
    should be placed.
    
    This patch affects the form validation for placing multiple holds, but I
    don't think the JavaScript ever has a chance to run: The template blocks
    the user from placing multiple holds if one of the titles has no items.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 54d7fe5250eefac32520f520469d5882c0a67628
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Aug 13 14:51:10 2019 +0000

    Bug 17057: Remove event attributes from holds template
    
    My orginal patch for this bug contained a lot of changes made obsolete
    by Bug 19469, which created holds_table.inc.
    
    This new version makes one minor change only to request.tt, adding a
    class name and removing an onclick attribute.
    
    To test, apply the patch and place an item-level hold on a title.
    
    Start the process of placing another hold on that item. On the "place
    hold" screen, in the table of items, you should see a "Cancel hold" link
    for the item you previously placed on hold.
    
     - Click the "Cancel hold" link
       - Clicking "Cancel" in the confirmation dialog should cancel the
         operation.
       - Clicking "OK" should cancel the hold.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 51c716cfe1d15d29136b4f05717bb820ffed4df6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Aug 19 09:49:34 2019 +0100

    Bug 11529: (RM follow-up) Add note to run misc/batchRebuildBiblioTables.pl
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8c1d54dab1818ba212704442a37902e7a9ef089d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Aug 7 12:39:51 2019 +0000

    Bug 23437: Use authorities for tracing series
    
    To test:
    1 - Set UseAuthoritiesForTracing to use
    2 - Find some records with an 800 or 830 series entry
    3 - View the record in staff and opac, note the series link does a search for title and author
    4 - Apply patch
    5 - restart all the things
    6 - View the records, note the links now use the authority number
    
    Signed-off-by: Ron Houk <RHouk@ottumwapubliclibrary.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95fe32e224af1c4ac9deb7d1b5dbe668053f8a47
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jul 18 13:08:18 2019 +0000

    Bug 23338: Allow specifying order level replacement price when adding to basket from file
    
    To test:
     0 - Clear MarcFieldsToOrder and MarcItemFieldsToOrder preferences
     1 - Have a budget/fund/vendor in acquisitions
     2 - Create or find a basket for vendor
     3 - Add to basket from a file or staged batch (can use any record)
     4 - Note there is no option for replacement price
     5 - Add the order
     6 - Replacement price is 0 - you must modify order or set upon receiving
     7 - Apply patch
     8 - Repeat
     9 - Disable matchign check during add to basket
    10 - Note you can specify a replacement price
    11 - Do so
    12 - Note it is saved in order
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e4f25e088305d9dd299bbfaa33b6140137c2f01
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Aug 16 13:47:49 2019 +0100

    Bug 23445: (RM follow-up) Missing filter
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b48e2d5e7a41511dccadb01808e1ece259c5f0b9
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 16 06:03:55 2019 +0000

    Bug 23324: (QA follow-up) Typo and remove unneeded use statement
    
    Two typos in POD typo for routine name.
    Remove "use Business::ISBN" from Normalize.pm.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5104d1eae67db94bebb05b2e9f1817685649b224
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Aug 9 10:47:17 2019 +0000

    Bug 23324: (QA follow-up) Use existing NormalizeISBN function
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3d15819443bd114a5e61a7a9ee947a3307d39b8f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jul 16 13:11:06 2019 +0000

    Bug 23324: Add an ISBN normalization routine
    
    To test:
    1 - Set SearchEngine to ElasticSearch
    2 - Stage the sample file (import it if it doesn't already exist in your catalog and then stage again)
    3 - Set matching rule to ISBN
    4 - No matches found
    5 - Apply patch
    6 - Apply no matchign rule
    7 - Change the ISBN matching rule to use ISBN normalizer
    8 - Apply matching rule for ISBN
    9 - It matches!
    
    Signed-off-by: Ron Houk <rhouk@ottumwapubliclibrary.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1aae63606caeb389a40bd644b1f9e30917325573
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Aug 16 12:17:42 2019 +0100

    Bug 23445: (RM follow-up) Add warning for unexpected lengthunit
    
    Discussions on this bug highlighted worries about behind the scenes
    fallbacks to 'days' as a lengthunit should the lengthunit be set to an
    unrecognised value. This patch adds a warning to the about page for any
    such occurrences so librarians may be made aware of and resolve the issue.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 16789351efd1f7dca88ed0797208ba5723922b62
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Aug 9 15:49:34 2019 +0000

    Bug 23445: Make loan period unit translatable fixing editing issue
    
    In the circulation rules, the loan period displayed in the table
    of circulation rules is not translatable, always displaying in English.
    This causes an issue when editing a circ rule with unit hours in any
    other language than English.
    When editing these rules, instead of hours, days will be preselected.
    
    To test:
    - Before applying the patch:
    - Install a translation
    - Activate and switch to the tranlation
    - Create a circulation rule using 'hours' as the unit
    - Edit the circulation rule
    - Verify that instead of 'hours' 'days' will be selected in the pull-down
    - Apply patch
    - Update po files (kshell, cd misc/translator, perl translate update <langcode>)
    - Edit po file <langcode-staff..., search for Hours and translate line,
      make sure to also remove fuzzy, and that your translation matches the
      pull down values for your language
    - Reinstall translation
    - Repeat circ rule edit test
    - Verify the unit now shows up with your translation and editing works
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2071fa4aca27f6748f32fd62037a203df2347141
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Apr 29 01:25:46 2019 +0000

    Bug 22799: Avoiding batch item modification case sensitivity when entering barcodes
    
    Note: this fixes the bug that is present right now where batch item
    modification barcode matching is case sensitive, but if Koha barcodes
    ever do become case sensitive, this patch will need to be removed.
    
    To test:
    1) Make/use an item with a barcode with letters in it. For testing
    purposes, I'll be using an item with the barcode 'abcde'.
    2) Go to Tools -> Batch item modification and enter this barcode in the
    barcode list text input field, but change the case of one or some
    letters. (i.e. enter the barcode in the field as 'abCDE')
    3) Click Continue
    4) Notice that the next page shows an error 'the following barcodes were
    not found', but the item still shows underneath (was correctly fetched from database).
    5) Create a text file and put the changed-case barcode in it (i.e. put
    the barcode 'abCDE' in the text file)
    6) Go back to batch item modification and upload the
    text file as a barcode file
    7) Notice same error as in Step 4
    8) Apply patch and refresh page
    9) Run through steps 1 to 6. There should no longer be an error and the
    barcodes should be found as expected.
    
    Sponsored-by: South Taranaki District Council
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Kyle Hall <kyle@bywatersolutions.com>
    Signed-off-by: Donna Bachowski <donna@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 669864f4b0cb16fc9a8566bffdeb42d7875fd8aa
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Thu May 2 14:20:45 2019 +0200

    Bug 22830: correct for loop in value_builder/unimarc_field_4XX.pl value_builder
    
    In value_builder/unimarc_field_4XX.pl value_builder gets search results
    and runs a for loog with $i index. This loop is limiter with number of
    results par page, it should also be limited by number of results if
    lower that number of results par page.
    
    Same in cataloguing/value_builder/marc21_linking_section.pl.
    
    Test plan :
    1) configure framework to use value builder
    2) use value builder
    3) perform a search with number of results lower than number of results
       per page
    4) check number of records diplayed is OK
    5) perform a search with number of results upper than number of results
       per page and check number of results is OK
    6) you see number of results par page records and pagination link
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d5152dfcdf9ba63fd04d0dc15f34c851e5c85836
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Aug 9 16:02:54 2019 +0000

    Bug 23446: Fix display issue in serials navigation
    
    The serial navigation shows a little stangely on the
    serial subscription detail page and other pages that show
    information about a specific subscription with one of the menu items
    having a different display height than the other items.
    
    To test:
    - Go to the serials module
    - Add or search for an existing subscription
    - Go to the subscription detail page
    - Verify the display issue in the navigation on the left
    - Apply patch
    - Check again from different pages in the serials module
    - Verify display is improved
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a57aea15a7f86e71bdfb6d6540aed18b2702b226
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Aug 15 13:46:35 2019 +0000

    Bug 23455: Patron card printing from Patron lists is broken
    
    This patch makes a few corrections to the process of printing patron
    cards from the patron lists page. These changes are necessitated by Bug
    20650: Changes to the markup in patroncards/print.tt were not reflected
    in the JavaScript in patron_lists/lists.tt.
    
    Also fixed: A missing quotation mark, a missing semicolon, and
    incorrect template variable filter.
    
    To test, apply the patch and go to Tools -> Patron lists.
    
     - Click the "Actions" menu corresponding to a patron list.
     - Select "Print patron cards."
     - In the "Print patron cards" modal, click the "Export" button.
     - The modal should reload with a link to download a patron card PDF.
       The link should work correctly.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a9c730244768ea355004e821d5be35dc2e617840
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Aug 4 12:48:07 2019 -0500

    Bug 23242: Fix insert of Z3950 servers with strict SQL modes
    
    If strict SQL modes are set, the insertion of a new Z3950 server can
    fail.
    
    DBIx::Class::Storage::DBI::_dbh_execute(): Incorrect integer value: ''
    for column 'checked' at row 1 at
    /home/vagrant/kohaclone/admin/z3950servers.pl line 82
    
    Using Koha::Z3950Servers fixes the issue (handled from
    Koha::Object->store)
    
    Test plan:
    - Turn the strict SQL modes on (config strict_sql_modes)
    - Create a new Z3950 server filling only the mandatory fields.
    => Without this patch you will get the failure, with this patch applied
    the server will be inserted sucessfully
    - Delete it
    => No regression should be found
    - Search for servers
    => No regression should be found (the search is a start-with, LIKE "$pattern%")
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f9572dd1acd9f39229d8cd864050a536b9c2815d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 5 09:04:25 2019 -0500

    Bug 23253: Fix OpacNavRight for self reg by email
    
    The code expects to display OpacNavRight content at the bottom of the
    login form when a user just registered.
    
    Test plan:
    - Turn PatronSelfRegistrationVerifyByEmail on
    - Register a patron
    - Confirm by clicking on the link you received by email (or see the
    message_queue table)
    => The OpacNavRight content should be displayed
    
    QA Note: This code smells, the code in the pl should not be needed.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ee7ba48bfe9d3f43bbc1bb88f62bf12854e5a838
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 5 09:02:15 2019 -0500

    Bug 23253: (bug 22318 follow-up) Fix OpacNavRight even if opacuserlogin is off
    
    There are other occurrences of OpavNavRight that bug 22318 forgot to
    adjust to use the news system instead of the syspref.
    
    Test plan:
    - turn off opacuserlogin
    - create a news for OpacNavRight
    - go to the opac main page
    => Confirm that the OpacNavRight content is displayed correctly.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c5f73575ab07e75b45e5e9495820b602225c75f5
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 5 08:40:12 2019 -0500

    Bug 23428: (bug 23151 follow-up) Fix self registration with a verification email
    
    DBIx::Class::Row::store_column(): No such column 'changed_fields' on
    Koha::Schema::Result::Borrower at /home/vagrant/kohaclone/Koha/Object.pm
    line 75
    
    Test plan:
    - Turn PatronSelfRegistrationVerifyByEmail on
    - Register a new account
    - Click on the link (see the message_queue table)
    => Without this patch you get the error
    => With this patch you will see the login form
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 347dc9589aa75edb1c64c21e5d057373dfd3ed84
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Aug 15 09:16:02 2019 +0100

    Bug 23309: DBRev 19.06.00.021
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 144e753da65cafa3c4291eec701222784ec0893f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 7 20:16:00 2019 -0500

    Bug 23309: Use Koha::MarcSubfieldStructures to create to subfields
    
    It will fix the insert of new subfields with SQL strict modes
    
    DBD::mysql::st execute failed: Incorrect integer value: '' for column
    'hidden' at row 1 [for Statement "
    
    Test plan:
    - Turn the config strict_sql_modes ON
    - Add a new subfield to a field
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0a0a8d874d9a46b0c53b9ce4691e36f5dc04e68e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Aug 7 20:08:22 2019 -0500

    Bug 23309: Update DB
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b35c152ed806d7f2f1d13962871b63ca634124ee
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Aug 14 13:36:57 2019 +0100

    Bug 20292: Add sponsor details
    
    Sponsored-by: Uintah Library System
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8437e95faad4a2ad8622067b3ad1a5e00a5084fc
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Apr 18 07:21:09 2019 +0000

    Bug 16284: Use new method to determine serials in check previous checkouts
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 838831b1f7b0799136f49638af4a4bd4faccae15
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Apr 18 07:19:34 2019 +0000

    Bug 16284: Add Koha::Biblio->is_serial method
    
    Test plan:
    prove t/db_dependent/Koha/Biblio.t
    
    Should return green
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b5ea03f04fecbacd072f7587c72d7dca4e758d90
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Tue Apr 16 10:59:43 2019 +0000

    Bug 16284: Add test
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bfe89a6aaebde8c42e2f352beaee503f315c1785
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Jun 22 11:26:53 2017 +0200

    Bug 16284: Check only item for previous checkout if biblio is serial
    
    Test plan:
    1) Set 'CheckPrevCheckout' system preference to 'Do'
    2) Make a checkout with item from serial record (942$s is 1 on default
        settings)
    3) Return that checkout
    4) Try to check it out again, you should see an alert, that the patron
    has thi item checked out previously
    5) Try to checkout another item from same bibliographic record, you
    sholud not see the alert and item should be checked out
    6) prove t/db_dependent/Patron/Borrower_PrevCheckout.t
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e66ccaa3a7743378f906612562889a9476bf6802
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Aug 9 10:17:41 2019 +0000

    Bug 16219: (QA follow-up) Tiny regex change
    
    The parameter <<>> does not work. There should be text inside.
    The construction .*? does not look good completely.
    Replacing it by the stricter [^>]+ So, no greater than's and at least one.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52587b4319d5d22436733f296021648d846f6359
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jul 19 19:42:37 2019 +0000

    Bug 16219: (follow-up) Nicer message if params missing and note that they are not combined
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 72197a9574d8b27651a390b9f177a537e1bf994c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Sep 5 11:15:01 2018 +0000

    Bug 16219: Add 'params' parameter to runreport.pl
    
    To test:
     1 - Apply patch
     2 - Write a report that takes no variables
     3 - Run this using runreport.pl
        perl misc/cronjobs/runreport.pl 1
     4 - Confirm results as expected
     5 - Write a report that takes one or more variables
     6 - Run using runreport.pl, but pass no params
     7 - You should get a SQL error
     8 - Now run passing the correct number of params
        perl misc/cronjobs/runreport.pl --param first --param=2nd 2
     9 - Verify results as expected
    10 - call runreport with no parameters
        perl misc/cronjobs/runreport.pl
    11 - Verify documentation is correct and helpful
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 06e28c3ac5b708ce01ea1265fa993c1f85e98645
Author: Emmi Takkinen <emmi.takkinen@outlook.com>
Date:   Wed Jul 10 09:25:43 2019 +0300

    Bug 22272: Calendar: When entering date ranges grey out dates in the past from the start date
    
    In "Calendar" tool it's possible to pick dates before start
    date as end date.
    
    This patch sets end date calendars "minDate" as picked start day
    to grey out past dates. Also reindents datepicker code for
    better readability.
    
    Test plan:
    - Apply this patch
    - Set start date from first calendar
    - Set end date from second calendar
    => Dates before start date are greyed out
    
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5c2daf28a5b027187f0e4c29111ed03b1525a33e
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Tue Jul 9 13:51:31 2019 +0000

    Bug 13552: (follow-up) Add debar option to batch patron modification
    
    As per test feedback I've changed wording from debarrment to restriction
    
    Added insertion into the borrower_debarments table and removal from
    borrower_debarments table (and borrowers.debarred and
    borrowers.debarredcomment) when either 'Restriction
    expiration' or 'Restriction comment' are ticket to be disabled/deleted.
    
    Test plan (please follow this instead of following test plan in the
    first patch):
    
    1. Go to Tools > Batch patron modification
    
    2. Input the cardnumbers of several (undebarred/unrestricted) patrons
    and submit
    
    3. Notice there is no input for setting Restriction expiration date or
    Restriction comment
    
    Also notice in the list of matching borrowers at the top of the page
    there is no display of the 'Restriction expiration' or 'Restriction
    comment' values for the patron
    
    4. Apply patch
    
    5. Restart memcached and plack
    
    6. Refresh the page notice 'Restriction expiration' (a date picker
    input) and 'Restriction comment'are now input options
    
    Also notice in the table at the top of the page 'Restriction
    expiration' and 'Restriction comment' are shown on the far right of the table (you may need
    to scroll to see this)
    
    7. Pick a date in the 'Restriction expired' datepicker and write in text into
    the 'Restriction comment' field and submit
    
    8. Notice in the next loaded page the selected patrons have the
    'Restriction expiration' and 'Restriction comment' values you entered
    
    9. Query the borrower_debarments database table and check that the new
    debarments are added to this table
    
    10. Go back to the Batch patron modification page and re-input the same
    cardnumbers
    
    11. Write text into the 'Restriction comment' field and don't pick a
    'Restriction expiration' value and submit
    
    12. Notice in the next loaded page the selected patrons have the
    'Restriction expiration' value of 9999-12-31 and 'Restriction comment'
    value you just entered
    
    13. Query the borrowers table and notice the borrowers.debarred value
    for the modified patrons is '9999-12-31' and the
    borrower.debarredcomment is what you inputted in step 11
    
    14. Query the borrower_debarments table and notice the expiration value
    is NULL and the comment value is set to what you entered in step 11
    
    Also note the addition of the new debarment has not removed the existing
    debarment on the patrons
    
    15. Click on the cardnumber link of one of the patrons and notice the red
    text on their patron account page informing you they are restricted
    until the date you set
    
    16. In the Koha home directory enter Koha shell:
    sudo koha-shell <instancename>
    
    17. Run: prove xt
    
    18. All tests should pass
    
    19. Repeat step 10 and tick the checkbox beside the 'Restriction
    expiration' field and submit
    
    20. In the next loaded screen notice the 'Restricted expiration'and
    'Restricted comment' are empty
    
    Check the borrower_debarments table and notice all restrictions for the
    patron are removed.
    
    Check the borrowers table and notice the debarred and debarredcomment
    fields are empty for the patrons
    
    21. Repeat steps 10 and 11 to make a new restriction
    
    22. Repeat step 19 and this time check the 'Restriction comment' field
    and submit and observe that also clears the restriction in the next
    loaded page, in the borrower_debarments and borrowers table
    
    23. Sign off
    
    Sponsored-By: Brimbank Library, Australia
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c6775396c588d507b2a9ebb43b22eb9fbb92fec9
Author: Alex Buckley <alexbuckley@catalyst.net.nz>
Date:   Tue Jul 9 06:02:01 2019 +0000

    Bug 13552: Add debar option to batch patron modification
    
    Test plan:
    1. Go to Tools > Batch patron modification
    
    2. Input the cardnumbers of several (undebarred/unrestricted) patrons and submit
    
    3. Notice there is no input for setting a debarred until (restriction
    expiration) date or debar comment
    
    Also notice in the list of matching borrowers at the top of the page
    there is no display of the debarred or debarredcomment values for the
    patron
    
    4. Apply patch
    
    5. Restart memcached and plack
    
    6. Refresh the page notice 'Debarred till' (a date picker input) and
    'Debarred comment' are now input options
    
    Also notice in the table at the top of the page  'Debarred till' and
    'Debarred comment' are shown on the far right of the table (you may need
    to scroll to see this)
    
    7. Pick a date in the 'Debarred till' datepicker and write in text into
    the 'Debarred comment' field and submit
    
    8. Notice in the next loaded page the selected patrons have the
    'Debarred till' and 'Debarred comment' values you entered
    
    9. Click on the cardnumber link of one of the patrons and notice the red
    text on their patron account page informing you they are restricted
    until the date you set
    
    10. In the Koha home directory enter Koha shell:
    sudo koha-shell <instancename>
    
    11. Run: prove xt
    
    12. Confirm all tests pass
    
    13. Sign off
    
    Sponsored-By: Brimbank Library, Australia
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 023cfa76bac099d5b7a14c05577e150b1eff0a32
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Mar 25 08:20:51 2019 -0400

    Bug 20954: (QA follow-up) Rename syspref-overrides to syspref_overrides to maintain existing convention
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9cbaec2a94aaef2d946a6d1dea57af5f9ff4e22c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 15 13:03:43 2018 +0000

    Bug 20954: Add ability to set syspref overrides in SIP as we can in apache
    
    We should be able to set system preference overrides for SIP in a
    similar manner that we do in Apache. It would be great if we could
    specify those overrides on both a config level, and login level basis.
    
    Test Plan:
     1) Apply this patch
     2) Start your SIP server
     3) Enable the syspref AllFinesNeedOverride
     4) Find or create a patron with a small fine ( less than noissuescharge )
     5) Attempt to check out an item to the patron, it should fail
     6) Add the global syspref override from the bottom of the example SIP config file
     7) Restart your SIP server
     8) Attempt to check out an item to the patron again, this time it should work
     9) Now, add the login level syspref override section as it appears in
        the eaxmple SIP config file. Make sure to add it to the login you are using
    10) Attempt to check out another item to the patron, this time is should
        again fail
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c13de8ca6566c7ad7f6702e6372192765176becd
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jul 31 11:43:11 2019 +0000

    Bug 23390: (follow-up) Quote aliases
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 187b3c553918ae5d737c445762783e9b7fa5580f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jul 30 15:40:54 2019 +0000

    Bug 23390: (QA follow-up) Don't redeclare variable
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 90d85eaeb9cd64b7d46078daef727e38d18cf5e1
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Sat Jul 27 13:07:18 2019 +0000

    Bug 23390: Introduce placeholder syntax for report column names
    
    This patch adds the ability to rename columns in MySQL reports using a syntax:
    [[column|alias]]
    
    To test:
     1 - Write a report like:
         SELECT cardnumber FROM borrowers WHERE cardnumber LIKE '%9'
     2 - Run report
     3 - Note you can batch modify the patrons
     4 - Update report:
         SELECT cardnumber AS library_barcode FROM borrowers WHERE cardnumber LIKE '%9'
     5 - Run report
     6 - Note batch options are no longer present
     7 - Apply patch
     8 - Run report, no change
     9 - Update report like:
         SELECT [[cardnumber|library_barcode]] FROM borrowers WHERE cardnumber LIKE '%9'
    10 - Run report
    11 - Batch options work!
    12 - Update report like:
        SELECT cardnumber FROM borrowers WHERE cardnumber LIKE '%9'
    13 - Verify batch options still work
    14 - Set report 'public'
    15 - Verify report can be run via JSON URLs:
         http://kohadev.mydnsname.org:8080/cgi-bin/koha/svc/report?id=1
         http://kohadev.mydnsname.org:8081/cgi-bin/koha/svc/report?id=1
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0a66d33d8c5d778e3a0961cb5953e2432d9ccb65
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jul 29 12:57:21 2019 +0000

    Bug 23385: (follow-up) Update link
    
    This follow-up adds a dummy href attribute to the link for showing and
    hiding the default values form so that it behaves more like a link.
    
    I removed "click to" from the link text and added Font Awesome icons
    common to "show/hide" links.
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9258d385baa94a00f671dea6315c7738a8f38026
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jul 26 14:48:51 2019 +0000

    Bug 23385: Hide 'Default values' fields by default
    
    To test:
    1 - Go to Tools->Import patrons
    2 - Choose a file
    3 - Scroll a long way to submit
    4 - Apply patch
    5 - Choose a file
    6 - Can submit easily
    7 - Click to expand and enter default fields
    8 - Confirm can still submit and that values entered are used
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9f11eef934dcda7cd76176b1a6431d77840b755e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Aug 13 11:42:46 2019 +0100

    Bug 23438: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2fade168c81bc05d24164780cbddc100302dd71f
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Aug 7 15:33:52 2019 +0200

    Bug 23438: Use Font Awesome icons in intranet search results browser
    
    In intranet after a search you see a results browser top left of biblio record details.
    
    Actually this uses text for links next and previous with a character for the arrows.
    I propose to use Font Awesome icons arrows.
    
    In fact the translated text is often too large for those buttons.
    For example "Previous" is "Préédant" in french and it causes the next and previous buttons to display on two lines.
    Using icons is more compact and easy to use.
    
    This patch also adds the list icon to back to results link and changes for a minimal text "Results".
    
    1) Go to intranet
    2) Perform a search with a few results
    3) Click on first record
    4) Check browser displays well
    5) Click on next icon, check you go to next search result
    6) Click on revious icon, check you go to previous search result
    7) Click on "Results", you come back to search results
    8) Clik on "Last" and click on last record
    9) Check browser displays well
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b400309ae54a70021fb8bc1414939bbf173551a0
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Aug 9 09:05:08 2019 +0000

    Bug 23413: (QA follow-up) Fix terminology
    
    Changed the POD of the new method to use holds.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2931eaba10980e0fde0addecc9e70be7d47ca77a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Aug 1 18:11:19 2019 +0000

    Bug 23413: Add a holds method to Koha::Items
    
    To test;
    1 - prove -v t/db_dependent/Koha/Items.t
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0548bfcd67ab8e0445ff7f0f52d3c7c10b98ed1b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Aug 1 11:44:39 2019 +0000

    Bug 23408: Move relatives-issues-table to an include
    
    TO test:
    1 - Find and adult patron
    2 - Add a child account
    3 - Check out some things to the child
    4 - View the adults account, click 'Relatives checkouts'
    5 - Observe table is oddly formatted
    6 - View on both the 'Check out' and 'Details' tabs
    7 - Apply patch
    8 - Tables are displayed correctly
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2782a039aa7883107c74ab6e446aa51b9f555683
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jul 15 17:46:36 2019 +0000

    Bug 23319: Implement blocking errors for neworderbiblio and basket.pl
    
    To test:
    1 - Hit neworderbiblio with a query and no vendor
        http://localhost:8081/cgi-bin/koha/acqui/neworderbiblio.pl?q=cat
        Or, add to basket from existing record with a search
        Refresh the page (url has no parameters)
    2 - Get an internal server error
    3 - Add bookseller
        http://localhost:8081/cgi-bin/koha/acqui/neworderbiblio.pl?q=cat&booksellerid=1
    4 - Click 'Order' on a result
    5 - Internal server error
    6 - Apply patch
    7 - Repeat 1-4, you get 'Vendor not found' or 'Basket not found'
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b9ab00515902e05a1598597d2e3a334c357c5a13
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Aug 9 11:43:42 2019 +0000

    Bug 23441: Export should not include the 'actions' column in Z3950 results.
    
    This patch adds the "noExport" class to the table header for the Z39.50
    search results "Actions" column. This class prevents the column from
    being included in DataTables export operations.
    
    To test, apply the patch and perform a Z39.50 search from Cataloging. On
    the search results page, click the "Export or print" button. Choose one
    of the export options and verify that in the resulting data there is no
    "Actions" column.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a8ddf55667f60a3cdc23ef0b6272921bc975bc73
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Wed Aug 7 10:57:01 2019 +0200

    Bug 23436: add a label for duplicate backend
    
    Reproduce issue:
     - Enable "EnableAdvancedCatalogingEditor" preference
     - Go to cataloguing and click on advanced editor
     - Click on the down arrow in "Save to catalog" menu
     - You should see an undefined named save backend
    
    Test patch:
     - Enable "EnableAdvancedCatalogingEditor" preference
     - Go to cataloguing and click on advanced editor to save preference to
       the cookie
     - Click on the down arrow in "Save to catalog" menu
     - You should see a "Duplicate" named backend
    
    Test Bug 16232 for no regression:
     - Search for a biblio in catalog
     - Click in "Edit record"
     - Advanced editor should appear.
       SUCCESS => browser url ends with #duplicate/{original biblionumber}
               => Title above toolbar is "Editing duplicate record of
                  #{original biblionumber}"
     - Save
       SUCCESS => browser url ends with #catalog/{new biblionumber}
               => Title above toolbar is "Editing catalog record #{new
    biblionumber}"
    
    More test:
     - Search for a biblio in catalog
     - Click on "Edit record"
     - Advanced editor should appear
     - Click on the down arrow in "Save to catalog" menu and click on
       Duplicate,
     - Record should be saved as a new one (same behavior)
    
    Signed-off-by: cori <corilynn.arnold@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cec6f46b47ae9625222f35014f6693ba7bb365e8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 5 10:54:57 2019 -0500

    Bug 22142: Do not revert data if 'unchanged' was set
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 52885ff55b1cac4b09129cc504bb23d169b22c13
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jun 13 14:20:25 2019 +0000

    Bug 22142: Highlight the issue
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 78c2800bc833759302bf68e1dc3a4fed26a5163e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Aug 12 14:37:23 2019 +0100

    Bug 23416: DBRev 19.06.00.020
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d559e89596cef1848c5eaef5554a1fc49d899f88
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Aug 8 13:37:58 2019 +0000

    Bug 23416: (QA follow-up) Add IGNORE to updatedatabase SQL statement
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a64c8cd1a4b2c237b3abf777480d7fc8733986d3
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Aug 2 13:22:37 2019 +0000

    Bug 23416: Add PreserveSerialNotes system preference
    
    Bug 11492 intended to pass routinglists forward. It also passed forward serial notes.
    This may or not me desired behvaiour, to avoid changing functionality twice I add a syspref
    to control this behaviour.
    
    To test:
     1 - Have or create a subscription in the serials module
     2 - Recieve an issue, making sure ot ad a note
     3 - Go to receive again, note the note from the last serial is set for the expected issue
     4 - Apply patch
     5 - Update database, restart all the things
     6 - Receive the issue leaving the note in place
     7 - Note the next expected issue has the note
     8 - Find the syspref PreserveSerialNotes
     9 - Confirm it defaulted to Do
    10 - Set it to 'Do not'
    11 - Receive the expected serial leavign the note
    12 - Note the newly generated expected serial has no note
    13 - prove -v t/db_dependent/Serials.t
    
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e1b79db3e52c8041c5fd18fd0ee250bf7636bd4e
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Aug 6 13:25:24 2019 +0000

    Bug 23434: Hold confirmation dialog problem if HoldsAutoFill is enabled
    
    This patch corrects a problem with hold confirmation dialogs on the
    checkin page when the HoldsAutoFill system preference is enabled and the
    item being checked in has a hold at another library.
    
    The confirmation dialog is converted to a modal to match other
    confirmation information.
    
    As part of this process two whole sections of the template have been
    removed because they were redundant.
    
    To test, apply the patch and test the following circumstances both with
    HoldsAutoFill enabled AND disabled:
    
     - A hold for a patron at your library
     - A hold for a patron not at your library
       - With HoldsAutoFill ON, both the "OK" and "Print slip and confirm"
         buttons should dismiss the modal without reloading the page.
     - A hold which is already marked 'Waiting'
     - An item which needs to be transferred
     - An item which has already been transferred
    
    In all cases the confirmation modal should appear with correct
    information.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 133090902f01d0b5af83091850dda75d13925506
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Aug 12 14:29:58 2019 +0100

    Bug 23307: (RM follow-up) Fix breaking change to columns_settings.inc
    
    The changes to columns_settings.inc in bug 23307 inadvertantly change
    the return from an updated jQuery datatable object to a plain jQuery
    object and as such broke a number of tables in Koha.  This patch simply
    reverts the change whilst continuing to allow the new functionality to
    work as expeced.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dfb7af91af64b2d47eb0aa2cf44e8caa7613a00b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jul 12 14:13:50 2019 +0000

    Bug 23307: Add columns configuration to cataloguing/z3950_search.tt
    
    This patch adds columns configuration to the DataTable which displays
    Z39.50 search results in the cataloging module.
    
    The Z39.50 results screen has its own server-side paging system, so I
    added some code to copy the page number information ("Page 2 / 6") to
    the DataTable toolbar for a more consistent appearance. The wording of
    that information has also been modified for consistency's sake.
    
    To test, apply the patch and restart Plack (or restart_all on
    kohadevbox)
    
     - Go to Cataloging -> New from Z39.50/SRU.
     - Perform a Z39.50 search which will return multiple pages of results.
     - Confirm that the DataTable controls work correctly: Search, columns
       show/hide, export.
     - Confirm that the page number information is correct as you navigate
       through pages of results.
    
     - Go to Administration -> Columns settings.
     - Confirm that the columns configuration settings for the z3950_search
       table in the "Cataloging" section works correctly. Changes made here
       should be reflected in the table of Z39.50 search results.
    
     - Test other tables which use columns configuration to confirm that the
       changes made in this patch doesn't disrupt their behavior. Test that
       any custom columns configuration are applied. For example:
    
       - Administration -> Libraries
       - Reports -> Saved reports
       - Circulation -> Holds queue
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ecde51a1f938981b0749fa13ea2cd52a701d8302
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jul 8 18:27:52 2019 +0000

    Bug 22209: Move stock rotation stage and item forms into modals
    
    This patch makes a number of interface changes to the Stock Rotation
    management interface:
    
     - "Add stage" and "Add items" forms are now triggered by clicking new
       buttons in the toolbar.
     - "Manage stages" and "Manage items" menu items have been added to a
       sidebar menu to be displayed when stages or items are being managed.
     - JavaScript has been added to move focus to the first form field in
       the modal when it is displayed. The "autofocus" attribute is not
       sufficent here because the modal is hidden by default.
     - Add messages to be shown when there are no items or stages to be
       displayed.
     - Correct "selected" attributes to use XHTML-style: selected="selected"
      (https://wiki.koha-community.org/wiki/Coding_Guidelines#HTML_Templates)
    
    To test, apply the patch and go to Tools -> Stock rotation.
    
     - Create a rota if you don't already have one.
       - Manage stages for your rota.
         - If your rota has no stages you should see a message along with an
           "Add stage" button. The button should trigger the "Add stage"
           modal.
         - Test the "Add stage" button in the toolbar. It should trigger a
           modal dialog containing the form for adding a new stage. The
           cursor focus should automatically be on the "library" field.
         - Submitting the form should correctly add the stage.
         - Verify that there is a new menu in the sidebar, "Manage stages"
           and "Manage items."
       - Manage items for your rota.
         - If your rota has no items you should see a message along with an
           "Add items" button. The button should trigger the "Add items"
           modal.
         - Test the "Add items" button in the toolbar. It should trigger a
           modal dialog containing the form for adding new items. The cursor
           focus should automatically be on the "barcode" field.
         - Submitting either a barcode or a file of barcodes should work
           correctly.
         - Verify that the new menu items are shown in the sidebar.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d48c2496514ef9ee3db67aa8d1785dfcd7fb7e68
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Aug 8 15:30:14 2019 +0100

    Bug 23228: DBRev 19.06.00.019
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fb021cbfe452e710da79bcc8f328b07b413f0aea
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Aug 8 15:13:33 2019 +0100

    Bug 23228: (QA follow-up) Add required filters
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e6b768bea43600e75bb0352c8d1068527d0d1a05
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Aug 8 14:57:25 2019 +0100

    Bug 23228: (QA follow-up) Fix the DB update
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1bc1642b945e8565d62f636155c2dc2a64e2c7ef
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 27 12:12:46 2019 -0400

    Bug 23228: Add option to automatically display payment receipt for printing after making a payment
    
    Some libraries would like an auto-popup after making a payment so librarians don't have
    to navigate to the accounts page, locate the new payment, then click the print button.
    
    Test Plan:
    1) Apply this patch
    2) Run updatedatabase.pl
    3) Make a payment, note no difference in behavior
    4) Enable the new syspref FinePaymentAutoPopup
    5) Make a payment, note the popup for the payment receipt
    
    Signed-off-by: Lisette Scheer <lisettes@latahlibrary.org>
    Rescued-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d952abd83758fe115269914fad78ae99c8006f9e
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jul 30 13:48:02 2019 +0000

    Bug 23399: (follow-up) Markup comments and corrections
    
    This patch adds comments to the template to highlight the markup
    structure. It also corrects some minor markup errors.
    
    This patch should have no effect on the interface or functionality.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 01c28613d1bd8059b600b7a097f8971b9cc68e21
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jul 30 13:12:18 2019 +0000

    Bug 23399: Reindent returns.tt
    
    This patch reindents circulation/returns.tt to use four spaces,
    following coding guidelines.
    
    To test, apply the patch and use your preferred method for checking the
    differences between files while ignoring whitespace. I use diff with the
    "-w" flag, but each must take their own journey.
    
    Test the checkin process to confirm that everything still works
    correctly.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3b6e8d1e19695cecf5aa8094bd4771b1cb95f21c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Aug 8 13:09:13 2019 +0100

    Bug 23286: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3ef47e7876201d759e7d4676fd4d03711f6c6349
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Apr 10 11:30:47 2019 +0000

    Bug 23286: Improve style of hold confirmation modal
    
    This patch makes minor changes to the hold confirmation modal in the
    check-in template and adds some additional style. The goal is to make
    the information a little more readable.
    
    To test, apply the patch and rebuild the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    Check in items with the following hold statuses:
    
     - On hold for a patron at your library
     - On hold for a patron at another library
     - On hold and already marked 'Waiting'
    
    Confirm that the hold confirmation modal is clear and well-styled.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ce1b79d55d421d6d173d644ee7061ebb5b93919a
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jul 16 12:08:47 2019 +0000

    Bug 23322: Correct case for boolean in ES search
    
    I did not include tests only because this is a very small reasonable change and routine has no tests.
    It does not affect behaviour, it only touches syntax lightly.
    
    To test:
      0 - Set SearchEngine to ElasticSearch
      1 - Import the example record (a version is included in sample data in devbox/testing docker so you can skip)
      2 - Stage the attached example record
      3 - Match using 'ISBN' rule
      4 - No matches found
      5 - Apply patch
      6 - Restart all the things
      7 - Reapply matching with no rule
      8 - Reapply with ISBN matcing
      9 - It matches!
     10 - Set SearchEngine to Zebra
     11 - Reapply matching with no rule
     12 - Reapply with ISBN matching
     13 - Matching works as before in Zebra
    
    Signed-off-by: Ron Houk <rhouk@ottumwapubliclibrary.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d71b263a89839e3b2f9aa7166dba2657a2aecf14
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Mon Aug 5 22:39:37 2019 +0000

    Bug 23431: Don't nullify DOB if it's hidden by sysprefs
    
    To test:
    
    Turn on  OPACPatronDetails
    put dateofbirth in PatronSelfModificationBorrowerUnwantedField
    Have a patron with a set date of birth
    Attempt any modification on that patron through the OPAC
    The date of birth will be one of the fields changed for that borrower
    when you check it in the staff intranet.
    
    Apply this patch, repeat the above.
    Date of birth will not be one of the changed fields.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 82a0f5913974155bd79f82cf2075936de7b0c431
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jul 31 16:01:39 2019 +0000

    Bug 23405: Circulation autocomplete for patron lookup broken if cardnumber is empty
    
    This patch modifies the JavaScript behind the patron search
    results autocomplete widget which is displayed when typing in the search
    header's "Check out" tab.
    
    The script is modified to use the patron's borrowernumber instead of
    cardnumber when redirecting to the checkout page.
    
    Instead of copying the patron's card number into the search form and
    triggering a submit, the autocomplete output uses direct links to each
    result.
    
    To better handle patrons with no card number, the output is modified to
    show card number with parentheses only if card number is present.
    
    To test you should have a patron in your database which has no card
    number. Make sure CircAutocompl is enabled.
    
    - From the circulation home page, type a patron name in the "Check out"
      form and wait for autocomplete search results to display.
    
    - Patrons with a card number should be listed in the format: Surname,
      First name (Card number) Address.
    
    - Patrons without a card number should be listed as: Surname, First
      name Address.
    
    - Clicking on either kind of result should link you the checkout screen
      for that patron.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Ian Walls <ian@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 75168e4ae5bad0806f96a39ce38f5f3f04e96c51
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Aug 6 09:44:40 2019 -0500

    Bug 22741: Add a test
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e5c05344c0c182703965f77060e6595226047eea
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jun 20 16:00:59 2019 +0100

    Bug 22741: Make updated_on timezone aware in Koha::Patron
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 107804fb872eea2cb9e21d6f54e747ba047c9c9e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Aug 5 18:34:55 2019 +0100

    Bug 11529: (RM follow-up) Add WHILE to directive list
    
    The QA tools don't current recognise the WHILE directive used in this
    template update. This patch adds the keyword to the list of recognised
    directives and thus allows through unfiltered variables during QA runs.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cce433ba4c796c96bbd7f68bf7c0546ca8fed695
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Aug 5 12:12:02 2019 -0500

    Bug 11529: Prevent too many spaces/break lines in the title tag
    
    Caught by t/db_dependent/www/batch.t
    
    Before this patch:
    """
    <title>Koha &rsaquo; Catalog &rsaquo;
    
        Details for
        Bleak House /
    
    </title>
    """
    
    After this patch:
    """
    <title>Koha &rsaquo; Catalog &rsaquo;
    
        Details for Bleak House /
    
    </title>
    """
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 762a03fca1e7b5b0c37a4a0715a1dc2d84b9200a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Aug 5 17:23:45 2019 +0100

    Bug 11529: (RM follow-up) Fix missing comma in query
    
    Looks like we introduced an error during a rebase somewhere on bug
    11529. This patch siply replaces a missng comma in the SQL query for
    C4::HoldsQueue::GetHoldsQueueItems.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cf0f57b437f64f96f4a0cadb14d7ba71cafc0f25
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jul 18 15:42:22 2019 +0000

    Bug 23339: (follow-up) Markup comments and corrections
    
    This patch adds comments to the template to highlight the markup
    structure. It also removes the obsolete "type" attribute from the
    <script> tag.
    
    This patch should have no effect on the interface or functionality.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c2cfb45d3d74023a711ce127b71df8c3cc88218a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jul 18 14:58:45 2019 +0000

    Bug 23339: Reindent addbooks.tt
    
    This patch reindents cataloguing/addbooks.tt to use four spaces,
    following coding guidelines.
    
    To test, apply the patch and use your preferred method for checking the
    differences between files while ignoring whitespace. I use diff with the
    "-w" flag, but you should look into your own heart for the
    right solution.
    
    Go to Cataloging. Test that the initial page and search results view
    look correct and work correctly.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a6fb4e4f2af100c867da3434756a82f65c04b971
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jul 30 13:52:05 2019 +0000

    Bug 23237: Fix POD and typos
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8c517d2f2860c08263f44dfde8d3cadea418694e
Author: Frédéric Demians <f.demians@tamil.fr>
Date:   Sat Jun 29 08:55:34 2019 +0200

    Bug 23237: Plugin allow [% INCLUDE %] from template
    
    From a plugin template it is useful to be able to include other templates with
    [% INCLUDE %] directives. But TT module is used by Koha with absolute paths.
    Relative paths are forbidden for security reasons. A new param [% PLUGIN_DIR %]
    allow plugin templates to know where to find plugin home directory.
    
    How to test:
    
    1. Install kitchen-sink plugin.
    
    2. Find tool-step1.tt file, and add this at the begining of the file:
       [% INCLUDE "$PLUGIN_DIR/header.tt" %]
       It ask to include a template header.tt which doesn't exit.
    
    3. Run kitchen-sink plugin tool. You must have this error message:
    
       Template process failed: file error - _path to plugin
       directory_/Koha/Plugin/Com/ByWaterSolutions/KitchenSink/header.tt: not found
    
       quod erat demonstrandum
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 43b0ef8f535bb1bd8341997d25675741b2ad0776
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jul 18 13:05:48 2019 +0000

    Bug 23328: Some check-in messages should be dismissable
    
    There are several cases where the check-in process displays a modal
    asking for confirmation. There are several cases where confirming or
    dismissing the modal unnecessarily reloads the page. In cases where no
    server-side action is necessary, the modal should be dismissed without
    submitting a form.
    
    To test, apply the patch and go to Circulation -> Check in
    
    With AutomaticItemReturn enabled and AllowReturnToBranch set to "any
    library,"
    
     - Check in an item which belongs at another library and is not already
       in-transit. In the confirmation modal which appears, clicking the
       "OK" button should close the modal without reloading the page.
     - Check in another item from anther branch. In the confirmation modal
       clicking the "Print slip" button should trigger a pop-up window for
       printing a slip but the modal should be dismissed without reloading
       the page.
     - Check in an item which is already in-transit to another branch. In
       the confirmation modal, clicking either the "OK" or "Print transfer
       slip" buttons should dismiss the modal without reloading the page.
       - Clicking the "Cancel transfer" button should work as before: The
         page reloads and the transfer is canceled.
    
    With AutomaticItemReturn disabled,
    
     - Check in an item belonging to another library. The confirmation modal
       should ask you whether you want to "Transfer now?" Clicking "No"
       should dismiss the modal without reloading the page. The other
       options should reload the page and initiate the transfer.
    
    With AllowReturnToBranch set to "only the library the item is from,"
    
     - Check in an item belonging to another library. You should see a
       "Cannot check in" modal. Clicking the "OK" button should close the
       modal without reloading the page.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2905ff0bf87ba0fd71c2fb3bc54bf368fc9d95ce
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jul 26 16:50:23 2019 +0200

    Bug 23386: Add language of original in advanced search
    
    In advanced search there is a language limit (UNIMARC 101$a), add language of original (UNIMARC 101$c).
    
    This patch adds a TT BLOCK to avoid copy the code.
    
    Test plan:
    1) Create some records with language and language of original
    2) Go to advanced search page
    3) Check limit on language is OK
    4) Check limit on language of the original is OK
    5) Check using both is OK
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7af08918892b7763c551f70e0de30a8202ab14f2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Aug 5 14:51:12 2019 +0100

    Bug 23099: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a89a203c1c85841a09b49771adbd77eeb76180c2
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jun 11 18:13:08 2019 +0000

    Bug 23099: OPAC Search result sorting "go" button flashes on page load
    
    There are a few places in the OPAC where we hide the submit button on a
    sorting form because the form auto-submits when the selection changes.
    These should be hidden using CSS instead of JS to prevent the temporary
    appearance of the submit button while the page loads.
    
    To test, apply the patch and rebuild the OPAC CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    Test OPAC search results and OPAC checkout history. On both pages you
    should not see a "Go" button next to the <select> input for changing the
    sort order.
    
    Disable JavaScript in your browser and test those pages again. The "Go"
    button should appear.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fe55839893828071967bd84a3041904bb75ac0d0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Aug 5 14:49:49 2019 +0100

    Bug 11529: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7883eb0692b15fdc453437cc595bf1903fa4540b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Aug 5 14:36:55 2019 +0100

    Bug 11529: DBRev 19.06.00.018
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 66655602b7038a4d7ae45e6d3b8bb98cf78cb0c4
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jul 26 15:45:51 2019 +0000

    Bug 11529: (QA follow-up) Copy existing subtitle mappings and warn others
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b1ed49baa49927768dc004d1d56684651bb6d79
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Thu May 2 15:34:47 2019 +0300

    Bug 11529: (follow-up) Fix QA issues
    
    - Remove SplitKohaField
    - Avoid using Stash in templates
    - Improved display of part fields
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4cf5fcf10b85e22aeacc2578a39b173951132143
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Apr 26 07:33:31 2019 +0000

    Bug 11529: (follow-up) Fix link on hold request page
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a1a05db1b638803135df535cd9f40180523e5f0e
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Tue Apr 23 11:15:31 2019 +0300

    Bug 11529: Add templates for biblio title display. Unify display.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1543134b346fd0c6eab26b3023ca6cf764a16952
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Thu Apr 18 09:27:44 2019 +0300

    Bug 11529: (follow-up) Remove manage_keywords2koha_mappings permission.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b641ca7aa758f580f950c4529afa1f63c8fed73f
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Fri Apr 12 17:04:52 2019 +0300

    Bug 11529: Remove duplicate column name from select query
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2556b9e523f15765147fe34ed9a2d3d76105bc46
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Fri Apr 12 17:00:39 2019 +0300

    Bug 11529: Replace bibliosubtitle with biblio in all framework sql's.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 26e5873ee505ace671f2c9e1a9c6ec9ee3278c1b
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Fri Apr 12 16:59:39 2019 +0300

    Bug 11529: Update kohafield in default framework only if not already set.
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8c8bbb3198b8809aeaabab4de2e7e6bad957d94b
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Wed Dec 12 14:05:36 2018 +0200

    Bug 11529: DBIx schema changes
    
    Updates to Biblio schema and removal of FieldMapping schema.
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5af98f8fab3b0d9263962bac6b5a1e453ad3e988
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Tue Nov 20 13:23:29 2018 +0200

    Bug 11529: Remove field mapping table and admin page
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ee44dce28562941b8f831bb79a564c1384a8f832
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Mon Nov 19 10:37:08 2018 +0200

    Bug 11529: Clean up subtitle usage
    
    Unify and clean up subtitle usage so that it's always used as a simple array and not the old hash structure.
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0e4f36b653af8425650dc76130cfa25af50429ae
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Thu Nov 8 15:30:12 2018 +0200

    Bug 11529: Simplify and optimize batchRebuildBiblioTables.pl
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4ea26c0a697fcd8e4f88feb9a4f43a8b02c06650
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Mon Nov 5 14:22:27 2018 +0200

    Bug 11529: Use new biblio fields whenever possible
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fabac13052d93465f8d348493930de4daedc708b
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Mon Nov 5 14:22:01 2018 +0200

    Bug 11529: Add new fields to biblio table
    
    Sponsored-by: National Library of Finland
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d82e31ab13d658dae7b1385692064d570752be42
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Aug 5 13:29:10 2019 +0100

    Bug 22610: DBRev 19.06.017
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fe0561ee41d2dd1d2d860b8e95e62a47a249b2de
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu May 9 06:57:12 2019 -0400

    Bug 22610: (QA follow-up) Make upgrade query more accurate
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3326ce607d6f82741634c0793f2367f2ff26e29c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jul 19 12:27:33 2019 +0100

    Bug 22610: (QA follow-up) Add unit tests for FeePayment
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12db9990b568bd8a0735626961a255399bc72f8c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu May 9 09:37:01 2019 +0100

    Bug 22610: (follow-up) Correction to accounts tests
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0afc62c43afaef50f74183faf591892789a9bfc0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed May 8 12:53:15 2019 +0100

    Bug 22610: (follow-up) Catch non-standard SIP codes
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0a14f4009daca33d88115ee5ca5498457c866cc4
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 24 14:22:35 2019 +0100

    Bug 22610: Update SIP2 to use payment_type
    
    The SIP2 interface has long used a set of accounttypes to denote payment
    types. Now we have an authorised list of payment_types and a
    payment_type field in accountlines this patch alters the logic to use
    it.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4cb858190edaef92461ebb22145606723d98a05e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 24 14:20:49 2019 +0100

    Bug 22610: Update SIP payment accounttypes
    
    This DB update updates the Pay00, Pay01 and Pay02 accounttypes to all
    be 'Pay' and adds the corresponding payment_types into the
    authorised_values
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3352d75bfeea1dd5d9d6e025b6884a190044003c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 28 12:53:20 2019 +0000

    Bug 14549: POD and variable cleanup
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 36ee00ed952ed9081eeeca5e98fe006fbaa12db6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 28 12:37:25 2019 +0000

    Bug 14549: Check patrons reserves for any holds on a bib when checking out an item
    
    MoveReserve uses CheckReserves to see if the current patron has any holds
    on the title they are checking out, however, CheckReserves doesn't return
    all holds on a biblio, it returns holds on the item from the holdsqueue
    if they exist
    
    This can create a condition where we check holds on an item, find we have it planned for
    another borrower, confirm checkout to the current borrower, but don't fill their hold
    
    To test:
      1) Find record
      2) place record level holds for 2 different patrons (record level)
      3) Run holds queue builder, check the queue to confirm an item was selected for patron 1
         Circulation->Holds queue->Library="All"
      4) Check out the item queued for patron with priority 1 to the second patron
      5) You should be asked to confirm, do so
      6) Note the item checks out, but both holds remain
      7) Apply patch
      8) Check in the item
      9) Don't confirm the hold
     10) Check the holds on the record and the holds queue
     11) Patron 1 should be priority 1 with an item selected from the holds queue
     12) Checkout to patron 2 as before
     13) Note the hold for patron 2 is filled this time
     14) Prove -v t/db_dependent/Reserves.t
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 33bd28fb856d496370f7132171aa479c77b28af8
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 28 12:36:16 2019 +0000

    Bug 14549: Unit tests
    
    To test:
    1 - Apply just this patch
    2 - prove -v t/db_dependent/Reserves.t
    3 - Failure
    4 - Apply second patch
    5 - prove -v t/db_dependent/Reserves.t
    6 - Success!
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3eadb87fd86b2331d4ea58aa86f1810bbf952c89
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Aug 5 11:36:40 2019 +0100

    Bug 23396: DBRev 19.06.00.016
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5e4e26dd0f7516bd3dca4758bbc3c72e4b9723d5
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Aug 2 15:53:01 2019 -0300

    Bug 23396: (QA follow-up) Add atomic update
    
    New installs before the fix won't have the table populated, this patch
    adds a fix for that, including the shortcut added by bug 17178.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 484b8245af189edcaba64f191981cd5374237125
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jul 30 13:37:28 2019 +0000

    Bug 23396: Add keyboard_shortcuts.sql to C4/Installer.pm
    
    To test:
    1 - Back up your DB if you want to save it
    2 - sudo koha-mysql kohadev
        DROP database koha_kohadev;
        CREATE database koha_kohadev;
    3 - http://localhost:8081
    4 - Go through the web installer
    5 - Enable AdvancedCatalogingEditor
    6 - Try to load it, fails with JS console error: insert_copyright is not defined
    7 - Apply patch
    8 - Repeat
    9 - This time editor loads
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0f5d14f70792d5406857a81c415bc3f58cbd8b96
Author: Bernardo González Kriegel <gonzalez@di.unc.edu.ar>
Date:   Sun May 5 15:12:15 2019 -0300

    Bug 10492: Translation problems with TT directives in po files
    
    This patch implements the replacement of TTvariables
    '[%...%]' with normal placeholders '%s' for text
    inside HTML tags (eg. img, meta, input)
    
    The replacement is done in two files:
    * xgettext.pl, used on create/update, so TTvars are not
    found on the text to translate (msgid)
    * tmpl_proccess3.pl, used on install time, so the correct
    translation is found (msgstr) and the right TTvar is put on
    the translated text.
    
    To test:
    Before applying the patch
    1) Update your favorite language
       cd misc/traslator
       perl translate update xx-YY
    
    2) Build a list (ini.txt) of 'msgid' to do a comparison
       msgcat --no-wrap --use-first po/xx-YY-*po -o - | egrep "^msgid" | sort > ini.txt
    
    3) Apply the patch
    
    4) Update your favorite language, again
       cd misc/traslator
       perl translate update xx-YY
    
    5) Build a final list (end.txt) of 'msgid' to do a comparison
       msgcat --no-wrap --use-first po/xx-YY-*po -o - | egrep "^msgid" | sort > end.txt
    
    6) Compare both files, you must find (most) TTvars replaced by '%s'
       diff ini.txt end.txt
    
       for example:
       < msgid "Translate item type [% itemtype.itemtype | html %]"
       > msgid "Translate item type %s"
    
       < msgid "Holds on this item: [% item_loo.item_holds | html %] / Total holds on this record: [% item_loo.holds | html -%]"
       > msgid "Holds on this item: %s / Total holds on this record: %s"
    
       < msgid "tag_anchor_[% innerloo.tag | html %]_[% innerloo.index | html %][% innerloo.random | html %]"
       > msgid "tag_anchor_%s_%s%s"
    
       < msgid "[% innerloo.tag_lib | html %] - Click to Expand this Tag"
       > msgid "%s - Click to Expand this Tag"
    
    7) Translate one of the examples, with more than one variable if
    possible, for example this text in xx-YY-staff-prog.po
       > msgid "Holds on this item: %s / Total holds on this record: %s"
    Check it's not marked as 'fuzzy'
    
    8) Apply the translation
       perl translate install xx-YY
    
    9) Check the translated string has all variables in the right order
       edit koha-tmpl/intranet-tmpl/prog/es-ES/modules/tools/batchMod-edit.tt
       around line '187', first '[% item_loo.item_holds | html %]', then
       '[% item_loo.holds | html -%]' on this case,
       or use another example
    
    If approved this patch can be backported to current stable
    versions.
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 88ff22bb5a5d535893cf238ae784bb62a5b7d676
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jul 31 12:38:16 2019 +0000

    Bug 21518: Material type "three-dimensional artifact" displays as "visual material"
    
    This patch makes a few corrections to the staff client MARC21 XSLT so
    that the correct material type icons are displayed for pictures and
    realia. The more-specific material type handling has been adapted from
    the corresponding XSL files in the OPAC.
    
    To test you must have default XSLT enabled and the DisplayIconsXSLT and
    DisplayOPACiconsXSLT system preferences enabled.
    
     - Apply the patch and locate records with "type of record" specified in
       the leader as 'g', 'k', and 'r'.
    
       A sample MARC file will be attached to the bug report with one of
       each type of record. Import the records and search your catalog for
       "Bug_21518."
    
     - View the records in search results and their detail pages, both in
       the OPAC and the staff client. In all cases the correct material type
       icon should be displayed.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0c4112a200bfdcdbdba4ce7870aeced1f960cfd9
Author: Colin Campbell <colin.campbell@ptfs-europe.com>
Date:   Tue Jul 2 10:58:41 2019 +0100

    Bug 23251: Correct formatting of IMD data ending in apostrophe
    
    IMD text data may end in an apostrophe (e.g. dreamin' )
    This was causing the segment to be incorrectly formatted
    as only the last character was checked, not the preceding
    character to check whether it was quoted
    
    add a test for this specific occurence
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fea1d135be0f7e9ee55ae27f510861fe4c159307
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 19 09:55:41 2019 +0000

    Bug 23345: Rename include-indexes to exclude-indexes in koha-dump
    
    Trivial edit. The usage statement is wrong.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b52a17dade474530103f1b05a2efd39de9879c31
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jun 27 13:24:36 2019 +0000

    Bug 23226: Remove type attribute from script tags: Cataloging
    
    This patch removes the "type" attribute from <script> tags one
    cataloging and one authorities template.
    
    To test, apply the patch and confirm that examples of affected pages
    work properly without any JavaScript errors in the browser console:
    
     - Cataloging -> Cataloging home page
     - Cataloging -> Cataloging home page -> Search results
     - Authorities -> New authority -> New from Z39.50/SRU
    
    Validating the HTML source of any of these pages should return no errors
    related to the "type" attribute.
    
    Signed-off-by: frederik chenier <frederik.chenier@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f292b4ff29a0aa1a109c3f1af9c2f5412dd1a5e8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jul 26 16:21:58 2019 +0100

    Bug 22524: DBRev 19.06.00.015
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5d27fb71cbd91fdf196b6568a590f2eef54d7cd1
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Mon Apr 29 11:03:22 2019 +0300

    Bug 22524: Fix date/time-last-modified search with Elasticsearch
    
    Avoid using slash in the field name since it would need to be escaped. Fix conversion of dtlm and any existing mapping.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2293e6597c69d55ce5916b7a31029f13d65d4fea
Author: Ere Maijala <ere.maijala@helsinki.fi>
Date:   Tue Apr 16 16:26:40 2019 +0300

    Bug 22524: Fix publication date and year search with Elasticsearch
    
    Also fixes the mappings.yaml to use correct field name (left over issue from bug 19575), so reset mappings and reindex before testing.
    
    Test plan:
    1. Reset mappings and reindex biblios.
    2. Check that tests in t/db_dependent/Koha/SearchEngine/Elasticsearch/QueryBuilder.t pass.
    3. Try that all of the following year range type work in publication date search and year limit in advanced search:
    yyyy
    yyyy-yyyy
    -yyyy
    yyyy-
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b2a9b5872c72ee6b0f17d32e20c8e59231f03f3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 29 10:55:17 2019 -0500

    Bug 23217: Remove SQL error when batch patron mod and not attribute selected
    
    On the batch patron modification tool, if no patron attribute is selected then
    an UPDATE query will be executed anyway. Indeed the form will send a
    an empty "patron_attributes" parameter. We need to handle it.
    
    Test plan:
    Go to the patron modification tool
    Enter a cardnumber
    Change a field (like city)
    Do not change anything in the patron's attributes
    Save
    => Without this patch a SQL error is generated:
    
    DBD::mysql::st execute failed: Cannot add or update a child row: a foreign key constraint fails (`koha_kohadev`.`borrower_attributes`, CONSTRAINT `borrower_attributes_ibfk_2` FOREIGN KEY (`code`) REFERENCES `borrower_attribute_types` (`code`) ON DELETE CASCADE ON UPDATE CASCADE) [for Statement "INSERT INTO borrower_attributes SET attribute = ?, code = ?, borrowernumber = ?" with ParamValues: 0=undef, 1="", 2="51"] at /home/vagrant/kohaclone/C4/Members/Attributes.pm line 287.
    
    => With this patch applied you will not see it
    
    You should also test that you can modify patron's attributes ;)
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fbeb22802f41f8daf99498303146d1916c851507
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Thu Apr 25 15:34:36 2019 +0000

    Bug 21716: Escape publisher in item search
    
    To prevent endless processing errors.
    
    To test:
    
    * create a biblio with a publisher with a backslash - i.e. 260$b with
    graham\lineham
    * do an item search that will include that title in the results
    * wait forever, because it won't work.
    * apply this patch
    * repeat steps, notice that you
        a. get results
        b. your result is listed with it's correct publisher
    * rejoice
    
    Signed-off-by: Hayley Mapley <hayleymapley@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c1fe033a116c23192a8ed5ba31924f1f4e032812
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jul 26 16:13:20 2019 +0100

    Bug 11573: DBRev 19.06.00.014
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 41fa881ba07bb3ad1f8cccef253ed5c9d439f387
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jul 26 12:31:39 2019 +0000

    Bug 11573: (QA follow-up) Correct spelling typo
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 70d7226f9efbbb8633cb054fbc02e0a055aaf917
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jul 26 12:52:44 2019 +0100

    Bug 11573: (follow-up) Handle daily rental in db update
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 81137a17f22bb5352b9f73364ba17369fa7afd58
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jun 4 11:37:13 2019 +0100

    Bug 11573: (follow-up) Correction to accountype search on opac-user.pl
    
    With the update of accountype from 'Rent' to four distinct accountypes
    we need to update the search here to catch all four types of charge.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e75758b18a6dd71cf5298533351f602db0d4ec48
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 24 10:35:22 2019 +0100

    Bug 11573: Update of unit tests
    
    This patch updates the unit tests to reflect the changes to the core
    routines.  The relevant changes are the removal of a hard coded
    'description' and the splitting up of the 'Rent' accounttype into
    'RENT', 'RENT_RENEW', 'RENT_DAILY' and 'RENT_DAILY_RENEW'.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 21d6cd9ef02b21126d43eb7cc9c34e5efb47c730
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Apr 24 09:05:33 2019 +0100

    Bug 11573: Update existing accountlines for 'Rent'
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 859217c1f5c8513bc0bdb8d31b7421e86ad3b355
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Apr 23 18:05:05 2019 +0100

    Bug 11573: Make rental accountlines translatable
    
    To test:
    
    1. Set up an item type with a rental charge
    2. Issue an item with that item type
    3. Check fines, a charge of type 'Rent' will be visible with a
    description of 'Rental'.
    4. Renew the item
    5. Check fines, a charge of type 'Rent' will be visible with a
    description of 'Renewal of Rental Item TITLE BARCODE' where TITLE and
    BARCODE are the items title and barcode.
    5. Apply the patch
    6. Repeat steps 1-4, charge descriptions should now be empty and charge
    types should display 'Rental fee' and 'Renewal of rental item'.
    7. Repeat steps 1-6 for an item type with a daily rental charge and note
    the charge types are now 'Daily rental fee' and 'Renewal of daily rental
    item'
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a72d8dbb0ff3aa6f56aafcca2c3a0c820b5325f6
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Jun 6 17:05:24 2019 +0200

    Bug 22249: Mana - Move comment process in a dedicated sub
    
    Test plan:
      - Go to a subscription's detail page,
      - click on "Report mistake" => "New comment",
      - check Koha logs file,
      - you can see the following warning:
        Can't locate object method "find" via package "Koha::Resource_comments"
      - Apply this patch,
      - same test again,
      - no wraning
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b43602ee7d2cf5407b987224be8554251a9f80f6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jul 15 15:06:14 2019 +0100

    Bug 23316: (follow-up) for bug 22521 to fix GetFine
    
    We changed the way we classify fines with bug 22521 but missed one
    instance.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b5e03a8e2bef33a405d3bcaf88c4abd3a019c3c9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jun 25 16:47:42 2019 +0000

    Bug 23206: Batch patron modification from reports which return cardnumber
    
    This patch adds an option to submit patron card numbers from report
    results to the batch patron modification tool.
    
    As with a report which returns biblionumbers or itemnumbers, a button
    appears at the top of report results which triggers a menu of batch
    operation options.
    
    To test, apply the patch and create a report which includes patron card
    number in the results.
    
     - Run the report and confirm that under the "Batch operations" button
       a batch patron modification menu item appears.
       - Confirm that selecting this option sends the correct patrons to the
         batch patron modification tool.
     - Test also with a report which returns both patron cardnumber and
       biblionumber or itemnumber.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: George <george@nekls.org>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 68f128939b940f167fc14c3060a52da16b13a253
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Jul 25 17:50:57 2019 +0000

    Bug 23363: (QA follow-up) Fix indentation
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit be4c4f8040ba9485f1cc72937ae77027568c0779
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Tue Jul 23 10:22:20 2019 -0500

    Bug 23363: Fix Internal Server Error when clicking on shipment cost invoice link
    
    To test:
    
    On the fund detail page, have some shipment costs associated with a fund
    
    an example would be cgi-bin/koha/acqui/spent.pl?fund=<your fund>&fund_code=<your
    code>
    
    Click the link for the fund, without this patch it will give an internal
    server error.
    
    With this patch, the shipment invoice will be loaded.
    Signed-off-by: Jason DeShaw <JDeShaw@fargolibrary.org>
    Signed-off-by: Laurel Moran <lmoran@sdlawlibrary.org>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95b6f56026c0381ffdd49a25bba9b5c170e141dc
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 28 11:04:21 2019 -0400

    Bug 23229: (QA follow-up) Fix indentation
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f79da166ae7f910648266b98d89f19f4307d10ea
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Fri Jun 28 10:24:32 2019 +0100

    Bug 23229: Only load ILL table JS when needed
    
    This patch prevents the JS associated with the ILL table from loading
    unless we're actually displaying the table. This has the knock on effect
    of not causing the "get all ILL requests" API request to fire when
    loading any ILL page.
    
    Test plan:
    
    - Go to "ILL requests" page
    - TEST: Observe that the table loads all ILL requests
    - Go to the "New ILL request" page for any installed backend
    - TEST: Check the browser dev tools "Network" panel, observe that the
    /api/v1/illrequests?embed=metadata,patron,capabilities,library,status_alias,comments,requested_partners
    request is not made.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b5588958981a24c25536afff0b2091506bf7f92b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jul 9 13:51:24 2019 +0000

    Bug 23078: (follow-up) Update self checkout help page
    
    This patch takes care of some preference instances I missed in the self
    checkout module's help page. It also removes some obsolete lines from
    Auth.pm.
    
    To test, apply the patch and re-test based on the previous test plan.
    Also test in the self-checkout module by logging into self checkout and
    clicking the "Help" link in the upper right of the screen.
    
    The settings of the following preferences should be shown correctly:
    
     - OpacFavicon
     - OPACUserCSS
    
    Signed-off-by: frederik chenier <frederik.chenier@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a222fa2afd367257b7e0c9815a92521883128d4
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jun 7 12:52:45 2019 +0000

    Bug 23078: Use Koha.Preference in OPAC global header include
    
    This patch updates the OPAC's doc-head-close.inc so that it uses
    'Koha.Preference' syntax to output system preference data. The patch
    removes handling of two preferences from Auth.pm which which are covered
    by this template change.
    
    This patch also makes some minor changes to consolidate multiple
    template checks for "bidi"
    
    To test, apply the patch and test the affected OPAC system preferences:
    
     - OpacFavicon
     - opaclayoutstylesheet
     - OPACUserCSS
     - OPACBaseURL
    
    Confirm that changes made to these preferences are reflected in the
    OPAC.
    
    Signed-off-by: frederik <frederik@inlibro.com>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2c600bf439173c8a7a8ecd41a6433cd1199de078
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jul 5 17:28:06 2019 +0000

    Bug 23278: Reopen last panel upon "Save and continue" in notices
    
    This patch modifies the Notices edit process so that if the user chooses
    the "Save and continue" option the page reloads with the same panel open
    which they were previously editing in.
    
    To test, apply the patch and go to Tools -> Notices and Slips.
    
     - Open a notice for editing.
     - Expand one of the sections.
     - Choose "Save and continue" from the button menu in the toolbar.
       - When the page reloads, the section you expanded should be open
         again.
     - Test each section and test with no sections expanded.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b76aa551049edcb1575d8a4cce917cbc0eb8fa24
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jul 12 13:41:30 2019 +0000

    Bug 23304: (follow-up) Add markup structure comments
    
    This patch adds comments to the template to highlight the markup
    structure. It also removes the obsolete "type" attribute from the
    <script> tag.
    
    This patch should have no effect on the interface or functionality.
    
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 377006ebe5a0e87a6f7517f0cb347a958c95a997
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jul 11 18:59:21 2019 +0000

    Bug 23304: Reindent cataloguing/z3950_search.tt
    
    This patch reindents cataloguing/z3950_search.tt to use four spaces and
    to eliminate tabs, following coding guidelines. Trailing white space has
    been removed, and some minor markup errors have been corrected for
    validity.
    
    To test, apply the patch and use your preferred method for checking the
    differences between files while ignoring whitespace. I use diff with the
    "-w" flag, but I'm not giving orders, you do you.
    
    Go to Cataloging -> New from Z39.50/SRU. Test that the search form and
    results look correct and work correctly.
    
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a130131960b8da7e86445c5469618efae9ff8e56
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jul 8 16:06:38 2019 +0000

    Bug 23279: In news management interface, sort news by publication date descending
    
    This patch makes a few changes to the configuration of the DataTable
    showing news items in the staff client. It adds a default sort on
    "Publication date," descending; It updates the way non-sortable columns
    are configured; It modifies sorting on the title and content columns so
    that articles are ignored.
    
    To test, apply the patch and go to Tools -> News.
    
     - When the page loads the table of news items should sort by default on
       publication date, descending.
     - There should be no sorting indicator on the first and last columns.
     - When sorting the "Title" or "News" columns, articles "A," "An," and
       "The" should be ignored.
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: frederik chenier <frederik.chenier@inlibro.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d7e6ae38e431c4d6397c057b0696e03f5a67ce14
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sat Jul 13 14:23:19 2019 +0200

    Bug 22021: Improve item status display when placing holds in staff
    
    This patch is a bit of a clean-up to bring the item status display
    more in line with the display on the detail page:
    
    - show descrpition of authorised value for not for loan instead of hardcoded text
    - Show description of authorised value for lost instead of hardcoded text
      This is also a translatability fix, as the text came from the .pl
    - Show description of authorised value damaged instead of hardcoded text
    - Make sequence of status match display on details page:
      lost - damaged - not for loan
    
    To test:
    - On a record with multiple items
      - Add different status to the items
        damaged, lost, not for loan
      - Make sure you have items with one status and multiple status at the same time
    - Look at how the status display on the detail page
    - Place a hold, compare display
    - Apply patch
    - Repeat
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bc188a9a54e28bd4fa2568dab5e85cf296fa87ab
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jul 19 10:49:00 2019 +0000

    Bug 23218: (QA follow-up) Remove dummy value
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ea0127b7fa53335f3e9d3f0170fbc92b2ffd9e3c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 29 10:18:29 2019 -0500

    Bug 23218: Fix shift in patron's attributes in batch patron modification
    
    When the "new" button is clicked without selecting a patron's attribute, the update will have unexpected behaviors.
    
    There is indeed a difference in the number of patron's attributes and the number of values.
    
    Test plan:
    Go to the batch patron modification
    Enter a cardnumber
    At the bottom of the page, click "new" without selecting an attribute
    On the second line select one, and a value (different than an empty
    string)
    Save
    => The attribute will be updated with an empty string
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 84855d75c1ddc770bf33b952b8f319ad1655a869
Author: Pasi Kallinen <pasi.kallinen@koha-suomi.fi>
Date:   Thu Jun 27 14:03:02 2019 +0300

    Bug 23048: Hide non-pickup branches from hold modification select
    
    When modifying holds in staff client via reserve/request.pl or
    the holds-tab in members/moremember.pl, the pickup library dropdown
    lists libraries not marked for pickup. Hide those branches,
    unless the branch is marked as a pick-up branch for already
    existing hold.
    
    The reason for showing a non-pickup branch for the holds created
    before the branch was marked as non-pickup: If the non-pickup branch
    wasn't shown, the branch in those holds would get set to the first
    branch in the select if the hold was modified.
    
    Test plan:
    1) Create a hold for a patron, to be picked up from a certain branch.
    2) Edit the branch and another branch so they are no longer
       pickup locations.
    3) Go to members/moremember.pl for that patron, check the Holds-tab
       Pickup library -drop down. It lists both of the non-pickup branches.
    4) Go to reserve/request.pl for that biblio. The hold-table
       Pickup library -drop down lists both of the non-pickup branches.
    5) Apply patch.
    6) Repeat 3 & 4, drop down no longer lists the non-pickup branch, but
       should still list the branch where the hold was marked to be picked
       from.
    
    Signed-off-by: Pasi Kallinen <pasi.kallinen@koha-suomi.fi>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3cfd78788fe1bda05894a08c22f69ce1baa9482c
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jul 16 18:05:23 2019 +0000

    Bug 23145: Confirming transfer during checkin clears the table of previously checked-in items
    
    This patch corrects the checkin template so that checking in an item
    with an existing transfer does not clear the page of previous checkouts.
    
    To test, apply the patch and check in some items.
    
     - After each checkin the returned item should appear in the table of
       checkouts.
     - Check in an item which belongs to another branch. You will be asked
       to confirm that the items requires a transfer. When the page reloads
       you should see the same previous checkins in the table.
     - Check in that same item again. You will be again asked to confirm.
    
       Before this page, confirming the transfer would reload the page and
       clear the list of checkins. Now the page should reload and the table
       of checkins should still show the previously checked-in items.
    
    Test all the actions when checking in an item which is already in
    transit: OK, Print transfer slip, and Cancel transfer.
    
    Signed-off-by: George Williams <george@nekls.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 29ecb5b6c29e48cb6964029567bd2b7cc8b6e7ac
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jul 16 18:13:57 2019 +0000

    Bug 20607: (QA follow-up) Test corrections
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d8830da219f110aabd28fb65bd03bc882b847173
Author: Alex Arnaud <alex.arnaud@gmail.com>
Date:   Tue Apr 24 13:10:38 2018 +0000

    Bug 20607: Make Koha::SearchEngine::Elasticsearch::reset_elasticsearch_mappings take weight into account
    
    Test plan:
      - apply this patch,
      - edit admin/searchengine/elasticsearch/mappings.yaml
        to add weight for some fields,
      - go to admin > search engine configuration,
      - reset your mappings (add ?op=reset&i_know_what_i_am_doing=1 to url),
      - check that weights you've added are set
    
    Signed-off-by: Nicolas Legrand <nicolas.legrand@bulac.fr>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cca82cc6d04a7070688fe7a3d7d55cf385ae2502
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jul 19 10:07:17 2019 +0100

    Bug 23151: DBRev 19.06.00.013
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f9d39508d67818c62797ab4f0d8d656272510085
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 19 08:04:45 2019 +0000

    Bug 23151: (QA follow-up) Remove debug leftover
    
    Removes: Running... Running... Ran
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4f90d7ecc7d07551c2115ed0c564dc918735d428
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 28 10:15:40 2019 -0400

    Bug 23151: (QA follow-up) Fix atomic update
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5c5a261e4ed9880723ce782a2c85677d2e1d0e05
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jun 19 16:31:17 2019 +0000

    Bug 23151: (follow-up) tweaked tests
    
    This forces the tests to use the new changed_fields
    field.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 286ffd5f2f255e77aac1099f31b9c418827d842e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 18 22:54:27 2019 -0500

    Bug 23151: Add tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 30fd4eb1a59fd480406261f30daa40692f16bc10
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jun 19 16:29:59 2019 +0000

    Bug 23151: Tweak to use the new database structure
    
    This will use changed_fields to know whether a
    borrower field is actually modified.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1af2698b84e21c11f80ed5c080430596ee712709
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jun 19 16:32:10 2019 +0000

    Bug 23151: Schema changes
    
    It is best to regenerate these from scratch.
    On a kohadevbox:
    $ misc/devel/update_dbix_class_files.pl --db_name=koha_kohadev --db_user=koha_kohadev --db_passwd=password
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d102165f8de3b808e2f555df2c97e8864b5445aa
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jun 19 16:28:44 2019 +0000

    Bug 23151: Modifiy database structure
    
    This modifies a fresh install structure, and provides
    an atomic update.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5759d06747e356a60b3fac82b5ff03184a946f80
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Mar 5 16:09:07 2019 -0300

    Bug 21316: Handle control fields in the ACQ frameworks
    
    Test plan:
    - Turn UseACQFrameworkForBiblioRecords on
    - Add 003@ to the ACQ framework
    - Create an order from an existing record
    => The 003 value will be displayed!
    
    It fixes the following error:
    Control fields (generally, just tags below 010) do not have subfields,
    use data() at /home/vagrant/kohaclone/acqui/neworderempty.pl line 293.
    
    Signed-off-by: Christian Stelzenmüller <christian.stelzenmueller@bsz-bw.de>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 02c9246def1f19bdc8310c562ddaf5172cf0b3ad
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jul 15 13:11:13 2019 +0000

    Bug 23315: (follow-up) Add configuration to enable CodeMirror
    
    This patch adds the "syntax" parameter to the corrected system
    preferences so that the textareas will be displayed as CodeMirror
    editors.
    
    To test, apply the patch and test the affected system preferences:
    
    Circulation -> SelfCheckHelpMessage
    Staff client -> IntranetmainUserblock
    Staff client -> IntranetCirculationHomeHTML
    Staff client -> IntranetReportsHomeHTML
    Staff client -> StaffLoginInstructions
    
    With UseWYSIWYGinSystemPreferences disabled, the preferences should be
    displayed as CodeMirror editors. With  UseWYSIWYGinSystemPreferences
    enabled they should be WYSIWYG editors.
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 63c23a9eacbe6ba5d61d8f47c5f74a46050338ad
Author: Chris Cormack <chrisc@catalyst.net.nz>
Date:   Mon Jul 15 14:28:16 2019 +1200

    Bug 23315: Some systempreferences can not be edited
    
    To test
    1/ Go to systempreferences
    2/ Notice that SelfCheckHelpMessage IntranetmainUserblock
    IntranetCirculationHomeHTML IntranetReportsHomeHTML
    StaffLoginInstructions are not editable
    3/ Apply patch, refresh page
    4/ Now they can be edited
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 80cbb81224e78c535daa14cf67fec2e945385e9f
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jun 11 07:46:57 2019 -0400

    Bug 23057: (QA follow-up) Remove new AddReturn message ReturnOfLostItemBlocked, use existing pattern from returns.pl
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Matha Fuerst <mfuerst@hmcpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 17f5547b3492bbf31a5e63ce0568c4bc31100421
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 6 12:42:46 2019 -0400

    Bug 23057: Update do_checkin
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Matha Fuerst <mfuerst@hmcpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77116bbed68332d46f96663ad47512ae98342d89
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 6 10:37:11 2019 -0400

    Bug 23057: Unit tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Matha Fuerst <mfuerst@hmcpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 97af85525f8a828551ff30d1522308f9efe2be54
Author: David Cook <dcook@prosentient.com.au>
Date:   Thu Jun 6 10:31:13 2019 +1000

    Bug 23057: If checked_in_ok is set and item is not checked out, alert flag is supressed for *any* reason
    
    This patch fixes a bug from Bug 15221 and hopefully also makes it so that the alert flag
    is suppressed when checked_in_ok is set and an item is not checked out.
    
    To test:
    
    0) Create patron in web interface with a cardnumber and userid of "staff" with a password
    that matches the account in SIPconfig.xml. Also set their branch to CPL
    (also matching SIPconfig.xml).
    1) Create an item with a barcode of 'test'
    2) Choose a patron to check out to and record their borrowernumber
    
    In one terminal:
    3) cd to your git directory (e.g. /home/koha/koha)
    4) perl ./C4/SIP/SIPServer.pm ~/koha-dev/etc/SIPconfig.xml
    
    In another terminal:
    5) cd to your git directory (e.g. /home/koha/koha)
    6) perl ./misc/sip_cli_emulator.pl -l CPL -su staff -sp <password> --port=6001 --address=localhost --item test -m checkin --patron <borrowernumber>
    NOTE: You need to replace <borrowernumber> with the borrowernumber from Step 2, and <password> with the password from Step 0.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Matha Fuerst <mfuerst@hmcpl.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ce17dc90a196cc54803a6ca7fc94b0c1d31bc15a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jul 12 14:55:09 2019 +0100

    Bug 18930: (RM follow-up) Restore primary key find
    
    The find method in RefundLostItemFeeRules had been overloaded to only
    support a hash being passed, however find can be called with a bare
    array of primary key values (i.e. id in this case).  TestBuilder relies
    on this functionality and started to fail; This patch simply restores
    the original behaviour for when a single value (or array of values) is
    passed.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d4d02fbe292ab36bb966300eb0c078c3467496e5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jul 15 13:55:36 2019 +0100

    Bug 23192: (RM follow-up) Add missing filters to waiting_holds.inc
    
    Added a missing `html` filter to the 'tab' input which was added as part
    of bug 23192
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 849275341067b25bcb193c64b1ae14814bc3104d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jul 12 14:08:56 2019 +0100

    Bug 18930: (RM follow-up) Drop refund_lost_item_fee_rules
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b2c34bde8bf7bd3ed7ab7167d6f0944759fb56df
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jul 11 10:16:35 2019 +0000

    Bug 23299: Switch address1 and streetnumber for German address format on opac-memberentry
    
    Test plan:
    Toggle value of pref AddressFormat and verify change on opac-memberentry.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 44a19e2d465ed26f190ba1e73f4e6e8d56548fd2
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Jul 12 06:15:38 2019 +0000

    Bug 23219: (QA follow-up) Change wording of test slightly
    
    We no longer delete, but cancel the holds when deleting a patron.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04745be7e2887ae2e1205d311841f20bd55edcf4
Author: Emmi Takkinen <emmi.takkinen@outlook.com>
Date:   Tue Jul 9 09:24:30 2019 +0300

    Bug 23219: (QA Follow up) Cancel patrons holds when patron delete
    
    Adds test for patrons holds cancelation when patron is deleted.
    
    Test plan:
    Run t/db_dependent/Koha/Patrons.t
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 07af7b228f5513405e14281a9b082374c1c13519
Author: Emmi Takkinen <emmi.takkinen@outlook.com>
Date:   Tue Jul 2 11:05:36 2019 +0300

    Bug 23219: Cancel patrons holds when patron delete
    
    Currently deleting a patron deletes all their holds and leaves
    no record to the "old_reserves" table.
    
     Steps to reproduce:
    - Create a patron
    - Add holds for patron
    - Holds are recorded to "reserves" table
    - Delete patron
    - Confirm delete
    =>Patron and all holds are deleted and no record of holds is
    left in "old_reserves" table
    
    This patch displays alert text notifying user that deleting patron
    cancels all their holds. Holds are cancelled instead of deleting them.
    This patch also writes stringified datetime to holds cancel log instead
    of whole datetime object.
    
    To test:
    - Apply this patch
    - Create a patron
    - Add holds for patron
    - Holds are recorded to "reserves" table
    - Delete patron
    - Alert text of holds is displayed
    - Confirm patron delete
    => Patron is deleted, their holds are cancelled and moved to
    "old_reserves" table
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Arthur Bousquet <arthur.bousquet@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bb3a0e5dbc16b4249b3eacae98a26d3479a76f5a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Apr 25 11:45:58 2019 +0000

    Bug 22768: Global search form keyboard navigation broken
    
    Bug 22045 made changes to the global staff client JavaScript which
    broken keyboard navigation for the most common forms in the resident
    search form("Check out, Check in, Renew, Search). This patch
    reimplements the tab selection code on the basic MARC editor page so
    that the keyboard shortcut behavior can be restored.
    
    To test, apply the patch go to Cataloging.
    
     - Search for an existing record and edit it in the basic MARC editor.
       - Test that the numbered tabs (0-9) at the top work correctly.
     - Select a tab other than 0 and choose Save -> Save and continue
       editing. When the page reloads you should be returned to the tab you
       were on when you saved.
     - Go to the Circulation home page. Test the keyboard shortcuts for
       switching tabs in header area:
    
       - Alt-u (Check out)
       - Alt-r (Check in)
       - Alt-w (Renew)
       - Alt-q (Search)
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 08a86c233576323f3d347a43690124c6fc8a0073
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jul 15 12:37:42 2019 +0100

    Bug 22709: (RM follow-up) AddBiblio returns a list not a scalar
    
    AddBiblio was being called in scalar context in
    Biblio_and_Items_plugin_hooks.t and this was leading to difficult to
    reproduce test failures. If the tests was run after any other test that
    also called AddBiblio then it would fail, but if it was run as the first
    test it would pass. This is due to a fluke in processing which meant the
    the final return value of the list (itemnumber) happened to match a
    biblionumber.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d7fec3af88d0ba6c2ae3246df47ee5ce29ebf78c
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Jun 11 14:31:48 2019 +0000

    Bug 11642: change / to and in related tools menu
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e29b5775f4c378e93f5a4b06f90b50f14a6c1e1
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jun 10 13:30:56 2019 +0000

    Bug 11642: (follow-up) Improve Batch patron deletion and anonymization GUI to make consequences clearer
    
    This patch makes some template changes to try to make this interface
    more consistent with other areas of Koha and to make warnings more
    clear.
    
    I have also changed the phrase "deletion/anonymization" to "deletion and
    anonymization."
    
    To test, apply the patch and test the patron deletion and anonymization
    process and confirm that the interface is clear and works well.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f897ff77c8774b1ad942665fc18b7a012312240f
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu Jun 6 15:16:35 2019 +0000

    Bug 11642: Add confirmation and tooltips to batch deletion tool
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 17a71b990076efd04c15de6b3165c33fffe037a3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun Apr 28 20:55:02 2019 -0400

    Bug 21027: Fix checkout statistics if 1+ of the fields is not defined
    
    TEST
    
    - Use a patron who hasn't checked out items before
    - Set  StatisticsFields to itype|ccode
    - Check out some items without location
    - Verify that statistics stable shows the correct number of checkouts
    - Check out one item with a location or just change one of your checked out items
    - Verify the total is still correct
    - Change  StatisticsFields to location|itype|ccode
    - Verify the total has changed now - it's only 1 (the one with a location)
    
    Apply the patch and try again
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f829221f818c1f7b7779f4bd74f633206deda2e1
Author: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
Date:   Fri Jul 12 15:37:26 2019 +0100

    Bug 23308: Change html to filter to $raw
    
    This patch changes the erroneous html filter to $raw
    
    Test plan:
    - Apply patch
    - Enter some HTML into the OpacMaintenanceNotice syspref
    - View the OPAC front page
    => TEST: Observe that the notice displays correctly and the HTML is not
    escaped
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: frederik chenier <frederik.chenier@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 68eeefa07edfd7f45546b9ad5eb72627502fc5e0
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Apr 17 06:02:59 2019 +0000

    Bug 22721: Remove frameworkcode parameter in GetMarcFromKohaField calls
    
    Test plan:
    Run tests, at least:
        t/db_dependent/Biblio.t
        t/db_dependent/Biblio/TransformHtmlToMarc.t
        t/db_dependent/Charset.t
        t/db_dependent/Circulation/GetTopIssues.t
        t/db_dependent/Filter_MARC_ViewPolicy.t
        t/db_dependent/ImportBatch.t
        t/db_dependent/Items.t
        t/db_dependent/Items/AutomaticItemModificationByAge.t
        t/db_dependent/Items/GetItemsForInventory.t
        t/db_dependent/Koha/Filter/EmbedItemsAvailability.t
        t/db_dependent/Serials.t
        t/db_dependent/XISBN.t
        t/db_dependent/FrameworkPlugin.t
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc53c88ad4bda3810a1f4c0a7582fec8b3a10383
Author: Pasi Kallinen <pasi.kallinen@joensuu.fi>
Date:   Fri Mar 9 11:05:52 2018 +0200

    Bug 20364: Show languages from MARC21 field 041 in intranet
    
    Show the language names coded in field 041, in intranet search
    results and in detail view.
    
    Test plan:
    1) Apply patch
    2) Do a search, and check the results look correct
    3) Check some biblio detail pages that they look correct
    4) Add some 041 subfields (a, b, d, h, j) in any combinations
    5) Repeat 2 and 3
    
    Signed-off-by: Pasi Kallinen <pasi.kallinen@joensuu.fi>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a43cf374aefe2052c3c241be4455a903429bd8c2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jul 11 16:18:51 2019 +0100

    Bug 23259: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 59bbcb1d37361cd8e675fa48492cec3b4659edcf
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jul 3 18:30:38 2019 +0000

    Bug 23259: Remove reset-fonts-grids.css
    
    This patch removes the CSS file reset-fonts-grids.css which was required
    when the staff client templates used YUI grids. Now that all staff
    client templates have been converted to Bootstrap grid markup the file
    can be deleted.
    
    Because the YUI CSS also did set some baseline properties for different
    tags the global SCSS file is modified in this patch in order to keep
    things looking consistent. Most of these updates change font-size
    declarations to preserve the previous appearance.
    
    Some styling has been added to (non Bootstrap-classed) <input> and
    <button> tags in order to keep button style consistent.
    
    Removed from staff-global.scss: YUI-specific CSS which has been made
    obsolete by the template conversions.
    
    To test, apply the patch and rebuild the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    Clear your browser cache if necessary.
    
    Browse through various pages of thes staff client to confirm that the
    changes work well.
    
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 414ab9b166a0f4d18138f6129ccb73a7806976cf
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jun 24 18:48:29 2019 +0000

    Bug 23197: Add more batch operation options to SQL report results
    
    This patch extends the feature which allows the user to send item
    numbers from a page of report results to batch item modification. For
    biblionumbers: Batch record modification, batch record deletion, and
    add to list are now available. For item numbers: batch item deletion is
    added.
    
    A new menu button is added for these options at the top of report
    results, removing the button from the item number column header.
    Corresponding CSS has been removed.
    
    To test, apply the patch and create a report which includes both
    biblionumber and itemnumber columns in the results.
    
     - Run the report and confirm that a new "Batch operations" button
       appears at the top of the results. Test each option:
       - Batch record modification
       - Batch record deletion
       - Add to list
       - Batch item modification
       - Batch item deletion
    
    In each case the correct set of parameters should be passed to the batch
    operations. Test with reports which return only biblionumbers, only
    itemnumbers, and neither.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f41533c49d487406621ee651d992e44b89e7e14a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jun 26 14:57:18 2019 +0000

    Bug 23094: Use Bootstrap-style pagination on staged MARC records page
    
    This patch makes markup changes in order to make the pagination links on
    the staged MARC records page consistent with the links on the catalog
    search results page.
    
    To test properly you should have enough staged marc record batches that
    there are multiple pages to list.
    
    Go to Tools -> Manage staged MARC records. Test that the pagination
    links look consistent with the catalog search results page and that they
    work correctly.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4068484650cb76d0fa3d801a4a5f49bd65cffb0b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jun 26 17:52:52 2019 +0000

    Bug 23221: (follow-up) Add comments on markup structure
    
    This patch adds a few comments to the markup in order to highlight the
    structure of the page.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cd66074205b571d1db6acbb57d8d8554d3d4fe85
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jun 26 14:29:24 2019 +0000

    Bug 23221: Reindent tools/manage-marc-import.tt
    
    This patch reformats the template for the Manage staged MARC records
    page. It makes only whitespace changes. It should have no effect on the
    behavior of the page.
    
    In addition to re-indentation, some lines have been broken up. These
    should be the only changes highlighted when using diff while ignoring
    whitespace.
    
    To test, apply the patch and view the Manage staged MARC records page.
    The page should look correct and work correctly:
    
     - Paging through results
     - Viewing batches
     - Cleaning batches
     - Deleting batches
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b59dc761d77d8d1af8f1e2afb58b51f5252ed506
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu May 16 08:49:22 2019 +0100

    Bug 19919: Unit Tests
    
    This patch adds unit tests for the addition of a patron accessor to the
    Koha::Account::Line object.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0f54a1f8c654e911c9e6254762586e3eeb786528
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri May 3 15:44:35 2019 +0100

    Bug 19919: Stop using paidfor altogether
    
    This patch removed references to setting and getting the items.paidfor
    field. Where it was used for display, in moredetail.pl, we replace it
    with a query on the accountlines.
    
    Test plan:
    1) Apply patch
    2) Pay off a LOST item
    3) Check for the associated display of 'Paidfor?:' on the itemdetails
    page
    4) Writeoff a LOST item
    5) Check that a 'Paidfor?:' is not displayed on the itemdetails page.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 92bf8082c372d4cf055336da7539bf214847249f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jul 11 16:29:48 2019 +0100

    Bug 22563: DBRev 19.06.00.012
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9b4da7594f7422a244c0dc0b6ef6dff85f083a40
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 5 14:55:34 2019 -0300

    Bug 22563: (follow-up) Fix tests in Koha/Account.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6f356cecc35fa3b1b2a730703fa2d7fbeaddf0d7
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jul 5 14:47:09 2019 -0300

    Bug 22563: Typo in query (manualinvoice)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dd63cb6b8ee5b3324c8902b7f189b22a03b0a335
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 17 15:01:11 2019 +0100

    Bug 22563: (QA follow-up) Correction to DB update
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c437f84a65237a1b4eabbb2b5c1b8f661649a1d0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Sat Jun 15 07:17:46 2019 +0100

    Bug 22563: (QA follow-up) Catch LOST maninvoice cases
    
    One could add a manual invoice of type LOST but we would not associate
    it with an issue_id. This patch tries to catch such cases and
    extrapolate an issue_id to add to the accountline.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 40c0ebb21955a237686504aef1aad43563bbf107
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jun 14 20:05:27 2019 +0100

    Bug 22563: (QA follow-up) Use issue_id in chargelostitem
    
    C4::Accounts::chargelostitem contained a FIXME which asked if an item
    should be charged for it lost, returned and then lost again. We add
    handling for that case here.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2c76ac420bf8270f98f076bda2aa823b2b00847
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Apr 18 12:53:42 2019 +0100

    Bug 22563: (follow-up) Clean up remaing L, LR and CR cases in the database
    
    Test plan:
    1) Confirm that after the DB update there are no L, LR or CR
    accountlines present.
    2) Read the db update and confirm is makes sense.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f4f608faa6fa94f02de284118830e90042406474
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Apr 18 15:47:24 2019 +0100

    Bug 22563: (follow-up) Corrections for overdue tests
    
    Updates to unit tests to reflect the accounttype changes and introduction of
    status usage for _FixOverduesOnReturn.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit de29f6b4a202b454b090e20b499b01b39b2fc2f7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Apr 18 08:45:54 2019 +0100

    Bug 22563: (follow-up) Items LOST should not be RETURNED
    
    Up until now we marked lost items as returned in the accountlines, now
    we have the oportunity to mark these distinctly with an appropriate
    status we should.
    
    Test Plan
    1) Find an overdue with fines
    2) Ensure you are not forgiving fines when an item is marked as lost
    3) Mark the item as lost
    4) Confirm the Fine is given a status of 'Lost'
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e1e0cb67d06a49760808797ce30434c0fa2d0432
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Mar 27 14:56:52 2019 +0000

    Bug 22563: (follow-up) Corrections for tests
    
    Updates to unit tests to reflect the accounttype changes and
    introduction of status usage.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b954dce9dd2c25c8659aec78154a127b468999fd
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 22 16:28:52 2019 +0000

    Bug 22563: Update lost handling to use accountline.status
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e3c5892f52d3d59d9aa03667d990110e3587ca6b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Mar 22 15:25:16 2019 +0000

    Bug 22563: Be more descriptive with accountypes
    
    Convert 'L' to 'LOST' to become more descriptive in it's use.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6ec92845c7458bfe8fdc8071138aba4d4bb8418c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jul 11 16:24:16 2019 +0100

    Bug 18930: DBRev 19.06.00.011
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2ba0d3e6271eb0e311f90994c2c64f43fbe23a37
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Jul 3 22:04:19 2019 +0000

    Bug 18930: (QA follow-up) Remove debug code
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 282f5d288df62d18fad47d7674a20e39483e03c2
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Tue May 7 00:19:31 2019 -0300

    Bug 18930: (follow-up) Change variable used in refund select for default options
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9dbaefddb8ab2cf13805ae5bc7b1038091a740cb
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon May 6 23:14:04 2019 -0300

    Bug 18930: (follow-up) Amend search parameter in Koha::RefundLostItemFeeRules->_default_rule
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ace2651aa7f516e0dbfdcdaaffec815df4bb2f16
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Mon May 6 23:11:09 2019 -0300

    Bug 18930: (follow-up) Amend Koha::RefundLostItemFeeRules->find
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 780b377db2cb3c693e7f94ff8d9eccc4e8711a85
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Mar 6 10:41:17 2019 -0300

    Bug 18930: (follow-up) Make DB update idempotent
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5512f945059d1369e75c1952b5cb40b56fca0e80
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Oct 25 10:16:20 2018 -0300

    Bug 18930: Do not insert '*' in circulation_rules
    
    We must insert NULL instead, otherwise the FK constraint will fail
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd63fe7d126986b1ab72d70ec2b35e05ef7cddea
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jul 12 10:55:08 2017 -0400

    Bug 18930: Move lost item refund rules to circulation_rules table
    
    This patch will move the list item refund rules from a dedicated table to the circulation_rules table.
    
    Test Plan:
    1) Apply this patch
    2) Run updatedatabase.pl
    3) Verify lost item refund rules remain unchanged
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fcc22df8ff277ac7041d5eb72e83821fb1ef1f37
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jul 1 11:45:14 2019 +0000

    Bug 13597: Make staff client Amazon no image results match OPAC
    
    The point is to make staff client HTML for missing Amazon cover
    images more equivalent to that of the OPAC
    
    To test:
    1 - Enable Amazon images everywhere
    2 - Search on the staff and OPAC to get some results without
        Amazon covers (missing ISBNs and bad ISBNs)
    3 - Note OPAC missing images are like:
    <span class="no-image">No cover image available</span>
    4 - Note staff client are like:
    <img src="https://images-na.ssl-images-amazon.com/images/G/01/x-site/icons/no-img-sm.gif" alt="" class="thumbnail" />
    5 - The staff links do not lend themselves to easy CSS hiding/styling
    6 - Apply patch
    7 - Repeat
    8 - Note increased consistency
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e269d6e6e6c9d1e3e11ae43a7773f3026f4d801a
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed May 31 16:24:51 2017 +0200

    Bug 18707: Background jobs post disabled inputs
    
    For example, in Tools > Batch item modification input of deleted subfields are disabled.
    This form is posted using background job via JS code.
    Looks like this JS code converts a POST form into a GET URL, including inputs that are disabled :
    
    koha-tmpl/intranet-tmpl/prog/js/background-job-progressbar.js
    function submitBackgroundJob(f) {
    ...
    $(':input', f).each(function() {
    ...
    
    This patch add a :enabled to selector
    
    Test plan :
    <to define>
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd5686b156ceb10958cab728b7695aa2b39b9933
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jun 10 18:54:30 2019 +0000

    Bug 12537: Don't retrieve XISBN results for the same biblionumber
    
    For a biblio with multiple ISBNS we sometimes get our own record back when
    check XISBN, we should test for this
    
    To test:
    1 - Edit a record in the catalogue, add two isbns:
         0521240670
         0521284198
    2 - Enable ThingISBN and FRBRizeEditions and OPACFRBRizeEditions
    3 - View the record in staff and OPAC
    4 - You should see editions tab pointing to the same record
    5 - Apply patch
    6 - Reload the record details, you should no longer see editions tab
    7 - Add the second ISBN to another record
    8 - Reload details for original record, you shoudl see editions linking to the record with second ISBN
    9 - prove -v t/db_dependent/XISBN.t
    
    NOTE: Current tests don't work under elasticsearch, but the code does, tests should be rewritten on another bug
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Bouzid Fergani <bouzid.fergani@inlibro.com>
    Signed-off-by: Arthur Bousquet <arthur.bousquet@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f45516e73ab6ac8c2240f206bd11a88e4935359c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jun 24 11:54:56 2019 +0000

    Bug 23192: Correct tab input on waiting_holds.inc
    
    To test:
     1 - Place 2 holds
     2 - Confirm the holds
     3 - In the db change the expiration date:
    UPDATE reserves SET expirationdate = '2019-01-01';
     4 - Go to Home->Circulation->Holds awaiting pickup
     5 - View your holds on the 'Holds waiting over' tab
     6 - Inspect the cancel button for one of the holds, note tab = "holdswaiting"
     7 - Apply patch
     8 - Refresh the page
     9 - Inspect the buttton, note tab = "holdsover"
    10 - Cancel the hold
    11 - Note you return to the holds over tab
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 076d5be767d0b6667ce8aab0ae7b56116e48d48f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jul 4 12:57:17 2019 +0000

    Bug 23266: Add to cart fires twice on shelf page
    
    Remove some duplicate functionality between opac-bottom and opac-shelves.
    
    Test plan:
    [1] Before this patch, add to cart from a shelf page. Observe that the
        basket count is incremented with 2.
    [2] After this patch, it should be incremented with 1.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f447658f850bca5ebcdb6f29a5572c1c1707f942
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jun 25 11:44:12 2019 +0000

    Bug 23194: Fix other occurences
    
    Throughout staff client and course reserves we also show the field with HTML filter, maybe we shouldn't?
    
    The items lost report also included the note as a title element on title and barcode links, I removed this
    as the note displays in that table
    
    To test:
     1 - Add a link to publicnotes for an item
    <a href="www.google.com">Cats!</a>
     2 - View opac details, confirm the note is a link
     3 - Same for staff side
     4 - Add item to a course reserve
        UseCourseReserves  preference must be set to 'Use'
        From the course reserves module you will need to add a course (and possibly a department first)
        Adding should be intuitive
     5 - Confirm note is a link in course details on staff and opac
     6 - Perform a batch checkout, confirm the itemnote shows as a link
         You will need to enable the system preference:  BatchCheckouts and add a patron category to:  BatchCheckoutsValidCategories
         Then a link should be available from checkout for a patron in that category
     7 - Mark the item as lost
     8 - Go to Reports->Items lost
     9 - Confirm the note is a URL and that title and barcode links don't show the note
    10 - Click the barcode to go to moredetails for the item - in this case note should display as editable text, not a link
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: frederik chenier <frederik.chenier@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3f40c32cbbc63dbc5f00d127edfeaa0732f4ab23
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jun 25 11:39:54 2019 +0000

    Bug 23194: Allow HTML in item public notes to be processed on OPAC details
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: frederik chenier <frederik.chenier@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d88709ec2d45df6f2a8e90ae7a94f9724b7e8e7e
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jun 27 13:38:50 2019 +0000

    Bug 23227: Remove type attribute from script tags: Reports
    
    This patch removes the "type" attribute from <script> tags in two
    reports templates.
    
    To test, apply the patch and confirm that examples of affected pages
    work properly without any JavaScript errors in the browser console:
    
     - Reports -> Dictionary
       - Delete
       - Specifying a date range for a date column
     - Reports -> Items lost
       - Report results
         -> Datatables functionality
         -> Selection tools for export
    
    Validating the HTML source of any of these pages should return no errors
    related to the "type" attribute.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: frederik chenier <frederik.chenier@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0658d84732cadb3bec44126d9efbd12a87547228
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 21 18:25:39 2019 +0000

    Bug 22957: Remove type attribute from script tags: Staff client includes 1/2
    
    This patch removes the "type" attribute from <script> tags in several
    staff client include files. Also removed: Obsolete "//<![CDATA[ //]]>"
    markers.
    
    This patch also makes minor indentation changes, so diff using the "-w"
    flag.
    
    To test, apply the patch and confirm that examples of affected pages
    work properly without any JavaScript errors in the browser console:
    
     - Acquisitions -> Vendor (uses acuisitions-toolbar.inc)
     - Acquisitions -> Vendor -> Add to basket -> From a new (empty) record
       (uses additem.js.inc)
     - Catalog -> Search results -> Bibliographic detail view. (uses
       browser-strings.inc, catalog-strings.inc, datatables.inc, and
       format_price.inc )
     - Tools -> Label creator -> Manage -> Label batches -> Export batch
       (uses greybox.inc)
    
    Validating the HTML source of any of these pages should return no errors
    related to the "type" attribute.
    
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 178a805a5d3055dd17050111c1227a9d5cef1b96
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jun 26 12:39:59 2019 +0000

    Bug 22951: (follow-up) Fix indentation
    
    This patch fixes indentation related to the markup corrections in the
    previous patch. It contains no textual changes.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: frederik chenier <frederik.chenier@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e0991ae2358224a15b6880c96b8472a3cd814b1b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed Jun 26 12:43:36 2019 +0000

    Bug 22951: Markup error in OPAC holds template
    
    This patch makes minor markup changes to the OPAC holds template in
    order to fix validation errors.
    
    To test, apply the patch and go through the process of placing a
    hold in the OPAC. Test various aspects of the process, including cases
    where the hold is blocked and an error message is displayed (for
    instance, when there are no items to be placed on hold).
    
    The page should work correctly and validating the source should
    return no relevant errors.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Frederik Chenier <frederik.chenier@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5c5d158b1bc37c63196be9ae405e4a2563315dbc
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Jun 27 20:45:27 2019 -0400

    Bug 21000: Force case sensitivity on Getopt::Long
    
    Before patch: -D and -d are mistaken for --debug
    
        $ sudo DEB_BUILD_OPTIONS=nocheck ./debian/build-git-snapshot -r ~/debian -v 19.06~git --autoversion -d -D="stretch"
        Option d does not take an argument
        git status --porcelain -unormal
        git rev-parse --short=8 HEAD
        dch --force-distribution -D "squeeze-dev" -v "19.06~git+20190627205913.466f99e4-1" "Building git snapshot."
        dch warning: Recognised distributions are:
        experimental, unstable, testing, stable, oldstable, oldoldstable,
        {bullseye,buster,stretch,jessie,wheezy}-proposed-updates,
        {testing,stable,oldstable,oldoldstable}-proposed-updates,
        {bullseye,buster,stretch,jessie,wheezy}-security,
        {testing,stable,oldstable,oldoldstable}}-security, jessie-backports, stretch-backports and UNRELEASED.
        Using your request anyway.
    
    NOTE: squeeze-dev in the first dch line and warning about Option d.
    
    Apply patch: -D and -d are differentiated correctly.
        $ sudo DEB_BUILD_OPTIONS=nocheck ./debian/build-git-snapshot -r ~/debian -v 19.06~git --autoversion -d -D="stretch"
        git status --porcelain -unormal
        git rev-parse --short=8 HEAD
        dch --force-distribution -D "stretch" -v "19.06~git+20190627210316.b3f919a7-1" "Building git snapshot."
        dch warning: Previous package version was Debian native whilst new version is not
        dch -r "Building git snapshot."
    
    NOTE: No more 'Option d' error, and "stretch" in the first dch line.
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d4f41cc8aafbb9854b20d1de7115a81e1eb73b9c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu May 30 14:15:52 2019 -0400

    Bug 23018: Refunding a lost item fee may trigger error if any fee has been written off related to that item
    
    If a lost item fee is written off, it creates a writeoff with the same itemnumber but the amount column is a negative number.
    
    Now, when the lost item is returned, it calls _FixAccountForLostAndReturned which searchs for all accountlines with an account type of 'L' or 'W'.
    
    Then, if the *first* of those lines has an outstanding balance, a credit is created and *all* the lines found are passed to $credit->apply. The apply method then calls is_debit on each line and when it hits the writeoff, it throws an exception ( Koha::Exceptions::Account::IsNotDebit ).
    
    When this happens, the credit is creating but not applied the the outstanding lost item fee, and the librarian is presented with an error page.
    
    It seems like the solution is to only fetch the first result since it seems like that is the only one we should be operating on.
    
    Test Plan:
    1) Create a lost item with a fee
    2) Create a manual debit using the barcode of the item
    3) Write off that manual debit
    4) Check in the item, note the error
    5) Apply this patch
    6) Repeat steps 1-3
    7) Check in the item, no error!
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 67f86868155725b3fec29d38a54e8c161dd72c78
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jul 31 16:13:20 2017 +0000

    Bug 19012: Note additional columns that are required during patron import
    
    This adds surname and cardnumber to the list of required columns on the
    import tool screen and help page
    
    To test:
    Read the updated notes, verify it is true and understandable
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d25f3e84374ec8d7c85f8ed805102f67c0a73d77
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jul 12 11:45:25 2019 +0100

    Bug 22709: (RM follow-up) Clean up plugin tests
    
    The plugin tests were failing due to failed rollbacks and run order.
    This patch moves them into their own directory and adds a reset test to
    restore the original state of the plugin system after the tests have
    run.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 54c5ec977c8c1c84f3023a12a6a8192d9ac9a1dc
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jul 9 11:21:29 2019 +0100

    Bug 22709: (RM follow-up) Enable plugin in tests
    
    Now that we clean up properly in t/db_dependent/Plugins.t when we reload
    the Koha::Plugin::Test plugin we must also enable it for the tests to
    function.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 428d0e61125b9d3ec6816bff48477e771a2eb0fd
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jul 9 08:26:15 2019 +0100

    Bug 23284: Remove test duplication
    
    A duplicate test was introduced during rebaseing work on bug 21073
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 803e209e37086029d553778561088b45c36cb4cf
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jul 8 18:33:16 2019 +0100

    Bug 22709: (RM follow-up) Add rollback to plugin test
    
    Rollback for InstallPlugins
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 481d34613183300bff31f7f6a66abe8aa893e07a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jul 8 17:41:16 2019 +0100

    Bug 23280: Silence warning
    
    Corrects a typo in t/db_dependent/selenium/patrons_search.t introduced
    by bug 22781.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 22c99262ec5512cf7d2658e6f98f8bf64df57d12
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jul 8 12:16:25 2019 +0100

    Bug 23230: (RM follow-up) Add rollback to plugin test
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 611b60ea9657efbe5f6c1da53d4b6a6d2d5f6a01
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Jul 2 05:05:20 2019 +0000

    Bug 23199: (follow-up) Fix tab/space issues
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e53bed5375638c8d7baaefb04cd77843dbe8e8a3
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Jul 2 05:01:55 2019 +0000

    Bug 23199: Added tests for Koha::Patron
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fa390ca232a0979c6786a0e00eca8d458f644f3e
Author: Arthur Suzuki <arthur.suzuki@biblibre.com>
Date:   Tue Jun 25 11:17:24 2019 +0200

    Bug 23199: Koha::Patron->store must check 'uppercasesurname' syspref
    
    Test plan:
    1/ set uppercasesurname to 'Do'
    2/ register a new patron using the REST API with lowercase surname
    3/ verify the surname is not saved in uppercase
    4/ apply patch
    5/ repeat 2
    6/ verify the surname now is saved to uppercase
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9796f5adb39b3cb56bf82837cd57d14e513e8cae
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jul 2 10:58:53 2019 +0000

    Bug 23077: Fix import of cardnumber 0
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cc60770c4eed3ab8144acd2382e2894f7b63fb37
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 7 12:19:28 2019 +0000

    Bug 23077: Don't fill cardnumber with empty string
    
    To test:
    1 - Apply unit test patch only
    2 - prove the tests, they fail
    3 - Attempt to import the attached sample file
    4 - First patron may be imported, second will give error (or both will error)
    5 - If only one error, import agian, now both have error
    6 - Apply this patch
    7 - Prove tests, they pass!
    8 - Import the sample file
    9 - It succeeds!
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 51bfa2ce28fc2eed7b5d0361fe4585afd96e3e20
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 7 12:18:55 2019 +0000

    Bug 23077: Unit tests
    
    prove -v t/db_dependent/Koha/Patrons/Import.t
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4f7f55e5fcb8c9b0a608a79228e303de05ff0328
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Apr 24 01:22:06 2019 +0000

    Bug 21181: Make cancel_expired_reserves.pl Cancel all holds not waiting if ExpireReservesMaxPickupDelay not set
    
    To test:
    0 - Make sure ExpireReservesMaxPickupDelay is set to 'Don't allow'
    1 - Place a hold for a patron
    2 - Check in at another library to set it in transit
    3 - Update expirationdate of hold to be in the past
        UPDATE reserves SET expirationdate='1999-12-31'
    4 - Run cancel_expired_holds.pl
    5 - Hold is not canceled
    6 - Apply patch
    7 - Run again
    8 - Hold is cancelled
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ab417c290a06640153f725e361b56bf6c598c386
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Apr 24 01:21:56 2019 +0000

    Bug 21181: Unit tests
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e559e59635e387ce53a894a67e4323e4984a15f
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jul 5 06:07:25 2019 +0000

    Bug 23248: (QA follow-up) Consolidate 404s
    
    Merging two conditions: biblionumber is empty or biblionumber cannot be
    found. This make the strange int($biblionumber) unneeded.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c3f0732eb72dfb3c4c6000a8602424772bd46b61
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 1 15:52:02 2019 -0300

    Bug 23248: Avoid opac-ISBDdetail.pl breaking on invalid biblionumber
    
    This patch makes opac-ISBDdetail.pl redirect to a 404 page (as it
    should) in the event of a bad biblionumber passed.
    
    To test:
    - Open your browser on a known record detail page (OPAC)
    - Switch to the ISBD view
    => SUCCESS: It shows
    - Alter the biblionumber on the URL into an obviously non-existent
    biblionumber (e.g. very high value)
    => FAIL: Internal errors are shown
    - Apply this patch
    - Reload the bad biblionumber ISBD view
    => SUCCESS: Browser is redirected to the 404 page as it should
    - Sign off :-=> FAIL: Internal errors are shown
    - Apply this patch
    - Reload the bad biblionumber ISBD view
    => SUCCESS: Browser is redirected to the 404 page as it should
    - Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e4ee3636304d06a0492fee6a1fcd9e4c65a17be6
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 19 20:08:04 2019 -0500

    Bug 23083: Fix course reserve item editing if one of the value is set to UNCHANGED
    
    Test plan:
    0: Do not apply the patches
    1: Create an item with itype, ccode, location, and holding branch set
    2: Create a course
    3: Add item to course, changing the values for itype, ccode, and location
    4: Click Edit for that item on course-details.pl
    5: Assign new values for itype, ccode, and location but leave the holding library dropdown set to LEAVE UNCHANGED
    6: Hit Save
    7: Back on course-details.pl, observe that the item is still showing the values set in step 3
    8: Apply this patch
    9: Repeat 4 to 6
    10: Back on course-details.pl, observe that the item is now showing the correct values
    11: Edit the course reserve again, setting new values for itype, ccode, and location and setting the holding library dropdown to whatever the holding library for the item is currently
    12: hit save
    13: On course-details.pl, see that the change actually happened, the item is now showing the values set in step 9
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 44469cf4c3e9fa690b2247324b1922fdde207f9f
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 19 20:12:14 2019 -0500

    Bug 23083: Add tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0f83de166938e01ad596257f0a88389d80a47bab
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Nov 9 11:58:10 2018 -0300

    Bug 21801: (follow-up) Use ->account
    
    This patch is a minor refactoring, that reuses the $account object we
    already get from $patron, instead of creating new ones all over the
    place. Code gets simpler to read too.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9bdd6a0990e337eed6b05dd660e589adf4baab5d
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Nov 9 11:33:59 2018 -0300

    Bug 21801: Make paycollect.pl pass library_id when calling ->pay
    
    This patch makes paycollect store the branchcode of the current library
    when payments are done.
    
    - Try all the possible options, specially selecting things to pay for (not
    using the individual buttons).
    - Check on the DB, that the  accountlines for the patron you're playin
    with have the branchcode stored correctly in all cases:
      $ sudo koha-mysql kohadev
      > SELECT * FROM accountlines WHERE borrowernumber=<the_bn>;
    => SUCCESS: Things are as expected
    - SIgn off :-D
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a71fd8357c9e2de751ee845a2a234229ce40a785
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jul 3 08:18:35 2019 -0400

    Bug 22709: (follow-up) Move new test file into a Plugins subdirectory
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 31e0ec34bae4b7f8598ffce4908e2ccb3b8627e1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jul 2 10:07:27 2019 -0300

    Bug 22709: (follow-up) Mock enable_plugins config entry
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 79917ad0bf269148ec470591a9a44bc015efb74a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jun 21 17:10:23 2019 -0300

    Bug 22709: Add after biblio/item action hooks
    
    This patch introduces after-action hooks for
    - C4::Biblio::{Add|Mod|Del}Biblio
    - C4::Items::{Add|Mod|Del}Biblio
    
    After the action has taken place, a call to a helper method is done,
    which loops through all plugins implementing the hooks, and calls the
    plugin method. The related object is passed, along with an 'action'
    string specifying the action that took place, and the object id (which
    is specially important for the 'Del' case).
    
    To test:
    - Apply this patchset
    - Run:
      $ kshell
     k$ prove t/db_dependent/Biblio_and_Items_plugin_hooks.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d766b6926bc104bd10050f1f49d4414dc9555475
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jun 21 17:09:56 2019 -0300

    Bug 22709: Unit tests
    
    This patch introduces tests for new plugin hooks added to
    C4::Biblio::{Add|Mod|Del}Biblio and C4::Items::{Add|Mod|Del}Item.
    
    They are tested together as for creating an item you need to first create
    a biblio and tests looks basically the same.
    
    The testing strategy is
    - Make sure the plugin is passed the right params
    - Throw an exception at plugin-level, to be trapped by the C4::Biblio
    and C4::Items lib, and converted into a warning. So we test for the
    warning.
    - Also, the fact that C4::Biblio and C4::Items warns, means the
    exception was cought, and then Koha won't break on faulty plugins or
    fatal errors from plugins.
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9638caf87234524e447fe5ab028ac4946726e823
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jul 2 12:29:08 2019 +0000

    Bug 22999: (follow-up) Indentation updates
    
    The markup changes require indentation updates. This patch contains
    indentation changes only.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit de1ad9e651ae7cb1c64829ef14ace3b5a6ca4641
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jun 28 16:27:16 2019 +0000

    Bug 22999: Switch two-column templates to Bootstrap grid: Circulation
    
    This patch modifies the circulation page template to use the Bootstrap
    grid instead of YUI.
    
    To test, apply the patch and view the checkout page, confirming that
    it looks correct at various browser widths:
    
     - Check out (no patron)
     - Check out -> Patron search
       - Results
       - No results
     - Check out -> Patron selected
       - Can check out
         - Checkout blocked (renewal confirmation, item on hold, etc)
       - Can't check out (expired, restricted)
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a6866afa343e3b53ad77a36552e19404ac7afab
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Jul 4 00:29:01 2019 +0000

    Bug 23250: Just use an @ in the password
    
    Rather than try to use -y and symbols, since
    older versions of pwgen don't have the -y,
    Purposefully just shorten the generated
    password to 15 characters and put @ on the end.
    This avoids nasty shell globbing, fixes the
    MySQL requiring a symbol by default in the
    newer versions.
    
    While @ at the end is less secure, the
    password portion providing security is
    still 15 characters long.
    
    Before patch, password should have potentially
    multiple ugly symbols in it.
    After patch, when creating an instance, the
    password will have an @ at the end of it.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cbf605539ad90e18a0325b1d06e43b8b71b655e9
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jul 2 16:10:10 2019 +0000

    Bug 23255: Correct HomeOrHoldingBranch descriptions
    
    To test:
    1 - Apply patch
    2 - View 'HomeOrHoldingBranch' system preference
    3 - Confirm the options make sense
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0ff83a8f2c42dd47a296f7f3cd3d127d9d3ef6fa
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Jul 3 20:56:56 2019 +0000

    Bug 14419: (QA follow-up) Restore the link styling
    
    Test plan:
    Look at Show more/less links in facets, in opac and staff client
    --> without this patch they are pure text, no styling, no hand cursor
    --> with this patch it is link, but continues to work as before
    
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 14e6375637590b644b39ca19c0f118dda7815cc1
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jul 2 11:58:49 2019 +0000

    Bug 14419: Expanding facets (Show more) performs a new search
    
    This patch removes the constraint of only passing 5 facets to the template unless the list is expanded, in fact, it removes the 'expanded' attribute from Search.pm
    Now that all facets are passed to page it adds a 'show more' link at the bottom of lists and allows user to expand or collapse any facet set without reloading page.
    
    Updated tests included.
    
    To test:
    1  - Perform an OPAC search that returns more than 5 of any given facet type
    2  - Click the "Show more" link on the facets and see that the search is reloaded
    3  - Apply patch
    4  - Repeat search
    5  - Note that you can click "Show more" without reloading page
    6  - Test that page load is not greatly affected
    7  - Ensure that all facet links function normally
    8  - Ensure that facets are the same a prior to patch
    9  - Repeat for staff client
    10 - Prove t/Search.t
    
    NOTE: This patch makes it much easier to see that there is an existing issue with marking the "active" facet.  Ending punctuation seems to confuse the matcher.
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 288cc505557fdcb167737f1894cee581526b4741
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jul 3 02:35:16 2019 +0000

    Bug 23230: (follow-up) Fix broken tests
    
    Before patch, the new tests don't run.
    After patch, they do.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 90acef7a9b860e70631ff243c21b435a7d081a16
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 1 11:42:51 2019 -0300

    Bug 23230: Make _version_compare OO context aware
    
    On using _version_compare in plugins development, it would be nice if it
    was able to be called as an object method. This way we don't need to
    fully qualify it like this:
    
        Koha::Plugins::Base::_version_compare
    
    and we can do
    
        $self->_version_compare
    
    instead.
    
    This patch implements this behavior change. It is backwards compatible
    so plugins using the 'old way' don't break.
    
    To test:
    - Apply the unit tests patch
    - Run:
      $ kshell
     k$ prove t/db_dependent/Plugins.t
    => FAIL: Tests fail
    - Apply this patch
    - Run:
     k$ prove t/db_dependent/Plugins.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2ff5f9fb633e6f3786b093d2a2f202a66db7b3d0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jul 1 11:33:41 2019 -0300

    Bug 23230: Unit tests
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b171c1645ae08321c2747d1059bf15fd02f84935
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jul 2 17:08:10 2019 +0100

    Bug 20959: (RM follow-up) Fix selenium test
    
    The basic_workflow test started to fail with this bug as the xpath for
    the checking button changed. I have updated the test to reflect the
    change.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e466ce63ab92e79e76457c47007b588a4c03f30b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon May 13 16:22:49 2019 +0000

    Bug 22897: Switch two-column templates to Bootstrap grid: ILL requests
    
    This patch modifies the ILL requests template to use the Bootstrap grid
    instead of YUI.
    
    To test, apply the patch and look at the ILL requests template. Confirm
    that it looks correct at various browser widths.
    
    Signed-off-by: Andrew Isherwood <andrew.isherwood@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8901d289cf1d4cd8f8904712e58c2224a5388c28
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jul 2 09:19:28 2019 +0100

    Bug 20959: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f748443822a27bc26649f4e1f1a8f0f35d8edd92
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jun 27 18:11:51 2019 +0000

    Bug 20959: Style checkin form more like the checkout form, with collapsed settings panel
    
    This patch modifies the structure of the checkin form so that settings
    (Specify return date, book drop mode, forgive overdue charges) are in a
    collapsed panel when inactive. The style of the barcode field and the
    mode notification messages has been changed to reduce the vertical
    motion of the form when selecting options.
    
    Some class names have been changed in circulation.tt and circulation.js
    to make them appropriate for use on both forms.
    
    To test, apply the patch and rebuild the staff client CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    Clear your browser cache if necessary.
    
     - View the checkin page. The "checkin settings" panel should be
       collapsed by default.
     - Confirm that the settings panel collapses and expands as it should.
     - Confirm that selecting "Forgive overdue charges" or "Book drop mode"
       trigger the display of the correct message and that the style of the
       barcode field is changed.
     - Confirm that after submitting a barcode for check-in, the
       settings panel stays open and your selected settings are still
       selected.
     - Confirm that specifying a due date and selecting "remember" shows
       a new message with the selected date.
       - Confirm that unchecking "remember" hides the message.
       - Confirm that date settings are remembered and the correct message
         displayed (or not) during check-in.
     - Test with CircSidebar enabled and disabled.
    
    Signed-off-by: Arthur Bousquet <arthur.bousquet@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 20342b376fd0d8cdedd70e8d35f5e8a619727037
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed Jun 26 16:15:43 2019 -0300

    Bug 23222: Update plugins-home.tt with new ENABLE/DISABLE flag name
    
    At some point of history, the flag to indicate if a plugin was enabled/disabled was called "enabled", now it's called "is_enabled"
    
    To test:
    1) get a fresh master copy
    2) Enable plugins
    3) Install any plugin
    CHECK => plugin appears as disabled
          => If you try to enable it, it just appears as disabled just the same
    4) Apply this patch
    5) Reload page
    SUCCESS => plugin appears as enabled
            => enable / disable action works again
    6) Sign off
    
    Signed-off-by: Frédéric Demians <f.demians@tamil.fr>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e75dc18424ba5905b79dd2c92e91ba2c8f4ecfed
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 5 18:40:54 2019 -0500

    Bug 23058: Prevent XSS vulnerabiliies when 'tag' is passed to opac-search
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 162ea12db99e3ad2face427548a1f4e6f469ef77
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jun 28 15:27:27 2019 +0000

    Bug 17003: (QA follow-up) Fix the number of tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0619aab9971c7f4d4859620abbac7ad2bfe93364
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Fri Mar 29 07:53:27 2019 +0000

    Bug 17003: (follow-up) Update definitions according to voted RFC
    
    Test plan:
    1) Have some patrons with checkouts, some renewable and some not
    renewable
    2) Use your favorite API tester and access GET
    http://koha.url/api/v1/checkouts/{checkout_id}/allows_renewal
    3) Check the response is OK according to voted RFC:
    https://wiki.koha-community.org/wiki/Checkouts_endpoint_RFC#Checkout_renewability_2
    4) prove t/db_dependent/api/v1/checkouts.t
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0404ecec4b619ebe14ac262332870004bb88878c
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Thu Feb 21 02:30:00 2019 +0000

    Bug 17003: Adapt to OpenAPI
    
    Test plan:
    prove t/db_dependent/api/v1/checkouts.t
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 563458f20e413388d11cf92ea36d2867f488416f
Author: Lari Taskula <larit@student.uef.fi>
Date:   Mon Aug 22 17:35:44 2016 +0300

    Bug 17003: Add API route to get checkout's renewability
    
    Signed-off-by: Johanna Raisa <johanna.raisa@gmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 29da30e1d458a0fa75444933ba441eb7906f53fa
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jul 1 16:06:42 2019 +0100

    Bug 17492: (RM follow-up) Use more specific method name
    
    Changed the method introduced into Koha::Patron from is_category_valid
    to the more specific is_valid_age to clarify it's intent to future
    developers.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5dec7bee96b9459f2f57773666de71090d945c66
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 28 15:15:06 2019 +0000

    Bug 17492: (QA follow-up) Correct template variable
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 094df0ed14f97b9ecd10a8934442dbbb670e0ab3
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Jun 26 18:31:44 2019 +0000

    Bug 17492: (follow-up) Add missing filters
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e30f09af910425f5d496efd0dd6ca8f7de468fb0
Author: Radek Šiman <rbit@rbit.cz>
Date:   Mon Oct 24 03:41:02 2016 +0200

    Bug 17492: Add a warning about age being of-limits and a button to update it
    
    This patch adds a warning if a patron's age is out of limits if an assigned category.
    It also adds a button allowing to change the category.
    
    Test plan:
    1) Apply patch
    2) Create a patron and assign him a category having age limits set
    3) Change patron's age to be older/younger than category's limits
    4) At "Check out" and "Details" tabs you should see a warning with a
    button allowing to change the category, eg.:
     - http://prntscr.com/cz7ch3
     - http://prntscr.com/cz7em4
     - http://prntscr.com/cz7dj1
    5) Set a valid category according to patron's age
    6) Warning should disappear
    7) Perform similar test again, but instead of changing the age change
    the limits of a category
    8) During tests verify "Change category" button everytime opens "Modify
    patron" page:
      http://prntscr.com/cz7g5q
    9) Ensure that left-side panel is always on its expected place
    10) Remove patron's date of birth and test that all categories are
    allowed now
    11) Run automated tests: prove t/db_dependent/Koha/Patron.t
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 98914ed6bb265959356406b9a9bc569919df6125
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jul 1 15:17:38 2019 +0100

    Bug 18928: DBRev 19.06.00.010
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d0c2138c8c71309cdeb5011f0a5e1263ff202cef
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 28 14:50:26 2019 +0000

    Bug 18928: (QA follow-up) Remove DBIC files and reference to DefaultCircRule
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fa1cb9d648c879449dc2fd9120848d015dc64079
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 11 10:05:24 2019 -0500

    Bug 18928: (bug 22847 follow-up) Display correctly the values (not the propagated ones)
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 64a2583c48cbcf25222a946ac6376f3be3bd4667
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 6 12:10:58 2019 -0500

    Bug 18928: Remove '(not set)'
    
    The "(not set)" part must be removed IMO, I am not sure I understand its goal.
    Now that we have 1 entry per rule (and not 1 DB row for the whole "Default
    checkout, hold and return policy for Centerville" table), it will be harder
    to handle it correctly. Not impossible, but if not really needed I would prefer
    to just remove it. If a rule is not set, the cell is empty or the dropdown list
    displays the option "Not set", which seems to correct the problem.
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8bcffcd1d0dd3ca72770d8fd129dea3b10ae1894
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 3 17:39:28 2019 -0400

    Bug 18928: (bug 22847 follow-up) Display correctly the values (not the propagated ones)
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d52ec38cef9c655cd15bce2c16653f12e239fb05
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 3 16:47:59 2019 -0400

    Bug 18928: (bug 22679 follow-up) Do not remove all rules along with the issuing rule
    
    We actually want to remove maxissueqty, maxonsiteissueqty and max_holds (for now)
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 86f37b1eb3a3376f475e69d351f0b0983b2b482a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 29 11:14:27 2019 -0400

    Bug 18928: Use get_effective_rule in GetBranchItemRule
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 54791a5c4639d8d5380077b38ddf9a1c0c47f253
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Apr 29 11:03:13 2019 -0400

    Bug 18928: DBIC schema update
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e749afc938615f273d2966aed31fe387d8d36b64
Author: Josef Moravec <josef.moravec@gmail.com>
Date:   Wed Apr 24 21:11:29 2019 +0000

    Bug 18928: (follow-up) Unset max_holds rule if needed
    
    Test plan:
    1) Set all values in Default checkout, hold and return policy section on
    circulation rules admin page, try for all libraries and for one specific
    library. Save.
    2) Click on unset and confitm
    --> without patch, the Maximum total holds allowed value remains
    --> with patch the unset removex Maximum holds value too
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2cb9fdaffe507bbe3f90565fa8228802b3c4918
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Mar 6 09:51:28 2019 -0300

    Bug 18928: (follow-up) Make DB update idempotent
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f261dc4df6f1b55ce42a57987776fe4b6631d3cd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Feb 21 17:27:57 2019 -0300

    Bug 18928: Update new occurrences
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ecc70a68be5f4737b5c5c96305ff302cd8553ed0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 24 19:40:24 2018 -0300

    Bug 18928: Add missing filters
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 676f03dd7dc50ae855df7a85a81d899f2b3074b3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Oct 24 19:32:48 2018 -0300

    Bug 18928: Add DB structure changes
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dc94b4d05b4a28e9eee75439e2f53dd0d62176fa
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Jul 11 11:10:01 2017 -0400

    Bug 18928: Move holdallowed, hold_fulfillment_policy, returnbranch to circulation_rules
    
    Test Plan:
    1) Apply dependancies
    2) Apply this patch set
    3) Run updatedatabase.pl
    4) Ensure holdallowed and hold_fulfillment_policy rules behavior remains unchanged
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f927d801121f9d7b291516649cf3b55be49b8e3d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 7 10:14:36 2019 +0000

    Bug 23045: Return record along with errors
    
    We don't seem to directly handle the errors in most cases, let's always return the record
    
    To test:
    1 - Add some blank lines to editor, previous patch is okay with this
    2 - Add a line with just 'e' or some other incomplete field
    3 - Try to save
    4 - Note JS leader error
    5 - Apply this patch
    6 - No errors
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 545f38d13c210e4cb173e67d2578d825a9ffeb47
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jun 4 14:25:53 2019 +0000

    Bug 23045: TextMarc errors on blank lines
    
    Since bug 16251 we use TextMarc to get some record fields, however, it throws an error when
    processing blank lines.
    
    We should just pass on these rather then erroring
    
    To test:
    1 - Define a new macro that delete more fields than it adds
      delete 245
    2 - Run it
    3 - Note an error in JS console, and helpers will not load
    4 - Apply patch
    5 - Reload, try again
    6 - No error
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f317d384f657bb8341a1a641343e18ed9598240d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jun 28 14:01:04 2019 -0500

    Bug 23225: Do not hide a biblio if there is no item
    
    This patch fixes a 404 redirect from the OPAC ISBD view if the
    bibliographic record does not have item attached.
    
    Signed-off-by: Luis F. Lopez <lflfalagan@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f5d3dec2e4ddfa20006cd9f81e28616b36230685
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri Jun 28 14:00:53 2019 -0500

    Bug 23225: Add a test
    
    Signed-off-by: Luis F. Lopez <lflfalagan@gmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit bb80b2d38b9861e7e81b76608cc097654b27fcb4
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jun 28 16:41:58 2019 +0100

    Bug 17178: DBRev 19.06.00.009
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 04f508452c151a530988c98717aa4a96e6d89398
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jun 28 16:33:29 2019 +0100

    Bug 17178: (RM follow-up) Use latest version of library
    
    This patch just updates us to the latest version of the jQuery library
    introduced in this patchset.
    
    Thankyou goes out to Josef Moravec who has already contributed a
    language translation upstream for Czech (and the reason I pulled in this
    updated library at this time)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ad52ccd1be0ff9a23fdd31c24b5bab38b20b244e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jun 28 15:52:37 2019 +0100

    Bug 17178: (QA follow-up) Make DB update idempotent
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9e91662ac7bab81a6d3267d2e891c1ef5508a741
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed May 8 23:41:43 2019 -0300

    Bug 17178: Add virtual keyboard to advanced cataloguing editor
    
    This patch adds Mottie keyboard (https://github.com/Mottie/Keyboard) to advanced editor.
    
    To test:
    1) Apply patches
    2) perl install/data/mysql/updatedatabase.pl
    3) Enable EnableAdvancedCatalogingEditor system preference
    4) Go to cataloguing and to Advanced editor
    5) Click on Keyboard shortcuts
    SUCCESS => the keyboard shortcut "Ctrl-K" should be displayed, with "Toggle keyboard" as description
    6) press Ctrl-K
    SUCCESS => a virtual keyboard should be displayed, and a new toolbar button labeled "Keyboard layout" should appear.
            => when you press a letter on both the physical and virtual keyboard, they should be added to the editor.
    7) Click on "Keyboard layout"
    SUCCESS => a modal should appear, where you can filter and select keyboard layouts.
            => when you select a layout, it should be reflected on the keyboard.
            => when you close the modal without selecting a layout, it should keep using the previous layout.
    8) Sign off
    
    Sponsored-by: Round Rock Public Library
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 00b71e8ea3deb717a343a266888744939d23187b
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Tue May 14 02:57:07 2019 -0300

    Bug 17178: Add shortcut to keyboard_shortcut table
    
    This patch adds Ctrl-K shortcut to toggle virtual keyboard shortcut
    
    Sponsored-by: Round Rock Public Library
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fc39e24eb502c1f724e8c5aa8b7264db901be278
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jun 24 17:16:07 2019 +0000

    Bug 23196: (follow-up) Add comments to highlight structure
    
    This follow-up adds a few comments to the markup in order to highlight
    and clarify the the HTML structure.
    
    To test, apply the patch and perform a diff against master using the
    '-w' flag:
    
    git diff -w origin/master
    
    You should only see the addition of HTML comments.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1693c2e01d6eb001a35caf3bb31b9d057c2136fe
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jun 24 17:09:36 2019 +0000

    Bug 23196: Reindent tools/batch_record_modification.tt
    
    This patch re-indents the template for batch record modifications. It
    makes only whitespace changes. It should have no effect on the behavior
    of the page.
    
    To test, apply the patch and perform a diff against master using the
    '-w' flag:
    
    git diff -w origin/master
    
    There should be no changes reported.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f50afc1fc0b9044c21564b45f44687993ebc07e3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jun 21 14:07:49 2019 +0000

    Bug 23183: Reindent cataloging.js
    
    This patch makes some very minor corrections to indentation in
    cataloging.js, a JavaScript file used by the bibliographic and item
    records editors.
    
    To test, apply the patch and perform a diff against master using the
    '-w' flag:
    
    git diff -w origin/master
    
    There should be no changes reported.
    
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Bin Wen <bin.wen@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d5fd85da18e7e3c548cc9d56689b09fd34615aed
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jun 24 10:28:00 2019 -0300

    Bug 23193: Make set_password.pl use Koha::Script
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18767d62a873570637d199586bbeca4200e67d1c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jun 28 14:31:03 2019 +0100

    Bug 22128: Add Rudolf Byker to contributors
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 787b86f9d4d3aa83502f9b2afdc98d9ff6761b8e
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Tue Jun 11 13:39:48 2019 +0000

    Bug 22128: Removed outdated comment
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e9bb407f62a208d42aefb03d16decd87bae228e7
Author: Rudolf Byker <rudolfbyker@gmail.com>
Date:   Fri May 24 13:25:45 2019 -0500

    Bug 22128: Use DROP USER IF EXISTS instead of GRANT USAGE before DROP USAGE
    
    MySQL 5.7 is old, and the latest versions fail on "GRANT USAGE" if the
    user does not exist. "DROP USER IF EXISTS" has been with us since 5.7,
    so all users should have it by now. This patch fixes the issue.
    
    To test:
    
    Try to koha_remove a site, and if it works with no errors, all good!
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4dcf416dc9547fd28e6ed846d08d6bbecb144552
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jun 26 12:49:14 2019 +0000

    Bug 23220: Prevent form submission before redirect
    
    To test:
     1 - Check in an item to generate a transfer (form another library, no floating)
     2 - Check it in again, click 'Cancel transfer'
     3 - It may or may not work
     4 - To highlight the issue edit return.tt to add the delay line as below:
            $('.cancel-transfer').on("click",function(e){
                    delay(5000);
                    window.location.href='/cgi-bin/koha/circ/returns.pl?itemnumber=[% itemnumber | html %]&amp;canceltransfer=1'
            });
     5 - Check in the item repeatedly, click 'Cancel transfer'
     6 - View the item in the staff or opac and verify it remains in transit
     7 - Undo changes above, apply patch
     8 - Test 'Cancel transfer', note it works
     9 - Add the delay back in, confirm it still works
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 466f99e44230968aeb51598e50f65d212941c5b4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 25 17:43:41 2019 -0500

    Bug 23211: Prevent SIP/Transaction.t to fail randomly
    
    The checkout failed because patron's category is the one used for statistics (category_type=X).
    
    To recreate the failure:
    modified: t/db_dependent/SIP/Transaction.t
    @ Transaction.t:37 @ subtest fill_holds_at_checkout => sub {
         plan tests => 6;
    
    -    my $category = $builder->build({ source => 'Category' });
    +    my $category = $builder->build({ source => 'Category', value => { category_type => 'X' }});
         my $branch   = $builder->build({ source => 'Branch' });
         my $borrower = $builder->build({ source => 'Borrower', value =>{
             branchcode => $branch->{branchcode},
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6c773a891704ee94c0e8159048c3c1aec62986d3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jun 25 09:21:44 2019 +0100

    Bug 23191: (follow-up) Improve output
    
    This patch adds a check of what plugins installed before the script run
    and outputs only those plugins that have been installed for the first
    time or upgraded during this run.
    
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6538de6397a337f1f1181a3197994a7fff0410d8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 24 13:30:54 2019 +0100

    Bug 23191: Add commandline script to install plugins
    
    This adds an initial skeliton script to enable plugin installation at
    the commandline.
    
    Signed-off-by: Alex Arnaud <alex.arnaud@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e639400225e2d04823eee7a00e490d87f8d60401
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 24 12:39:15 2019 -0500

    Bug 23126: Add tests
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2455286da42b73fa3efc29ac1a51ca81a0017a8e
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Fri Jun 21 01:25:02 2019 +0000

    Bug 23126: Remove more unnecessary linebreak processing from serial collection
    
    This should have no visible effect on the templates as the
    information the grep changes is not used in the template.
    
    It's also strange, that these lines existed, as
    GetSubscriptionsFromBiblionumber contained the same changes.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Arthur Bousquet <arthur.bousquet@inlibro.com>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 316eda1036fd08f9c78578b27e85fd79c6895237
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Tue Jun 18 08:06:10 2019 +0200

    Bug 23126: Display multi-line entries in subscrpitions correctly
    
    There are several notes and other fields in a subscription that
    can be entered as multi-line input with breaks. We should display
    them as they were entered with keeping the line breaks intact.
    
    To test:
    - Add a subscription
      - Add comments including line breaks in internal and OPAC note
      - Check the manual history checkbox
    - Go to the subscription detail page, tab 'Planning'
    - Use the 'Edit history' link to edit the history
    - Enter content with line breaks in all the input fields where
      it's possible
    - Go to the OPAC detail page for your subscription record
    - Go to tab 'Subscriptions' > More details > Brief history
    - Verify the line breaks show there as <br>
    - Apply patch
    - Relaod page, verify all information displays correctly now
    - Go back to the detail page, subscription tab - verify same there
    - Go back to the subscription detail page in staff
      - Check editing the history works as expected
      - Verify information on all tabs displays correctly
      - Receive a serial issue - verify note on top displays right
      - Go to the serial collection page of the subscription - same there
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2351693b61db83e0405157fd75951abee8df0116
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Jun 19 12:07:58 2019 +0200

    Bug 23156: Add pagination to checkouts in ILS-DI GetPatronInfo service
    
    When patrons have a lot of checkouts, GetPatronInfo can take a lot of
    time. This patch introduces two new parameters to allow pagination of
    this list of checkouts
    
    Also, fix a warning in C4::ILSDI::Services::GetPatronInfo
    
    Test plan:
    1. Go to /cgi-bin/koha/ilsdi.pl?service=GetPatronInfo&patron_id=X&show_loans=1
       where X is a borrowernumber of a patron who has several checkouts
       Verify that all checkouts are listed
    2. Add '&loans_per_page=1&loans_page=1' to the URL. Verify that you have
       now only one checkout listed, and that there is a new element
       <total_loans> which contain the total number of checkouts
    3. Increase the page number in the URL until you have seen all checkouts
    4. prove t/db_dependent/ILSDI_Services.t
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6b6dc7bc791853d4dafb7f9ab02d3767c926ff08
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 21 11:02:43 2019 +0000

    Bug 23179: Add 'edit subfields' button to framework management
    
    To test:
    1) Go to Administration > MARC bibliographic framework
    2) On a line click Actions > MARC structure
    3) Note the dropdowns for each tag are: Edit, Subfields, Delete
    4) Apply patch
    5) Reload and note dropdowns are: Edit tag, View subfields, Edit subfields, Delete
    6) Confirm options do what is selected
    
    Signed-off-by: Bin Wen <bin.wen@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7bc7cd4676632c835a16341191e07a5e7e13054a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jun 11 16:46:27 2019 +0000

    Bug 23096: Add floating toolbar to OPAC lists
    
    This patch makes the list contents table's toolbar "stick" to the top of
    the screen when scrolling. Minor markup changes have been made to enable
    this change.
    
    To test, apply the patch and open a list in the OPAC which has multiple
    titles on it. Confirm that the toolbar sticks to the top of the screen
    when you scroll down.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 35093039df3b42ae33c746385669ba13deb38c7d
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Tue Jun 25 12:40:57 2019 +0000

    Bug 22566: (QA follow-up) Fix pod complaint
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b3795df8012545af4134d7402e9609e2d89f7be9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jun 18 14:29:02 2019 +0100

    Bug 22566: Add 'branch' key to GetPreparedLetter
    
    The branch key was missing from the subsitution call to
    GetPreparedLetter.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4e4f0b637c66ca04a07473c347cc741d456c20c5
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jun 18 14:24:27 2019 +0100

    Bug 22566: Clarify intent of reports and add warnings
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7e226ba3c018a890c823f10365dbe2b3d1d22d23
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jun 18 13:38:43 2019 +0100

    Bug 22566: Rename 'report_email' to 'report_by_branch'
    
    To clarify the intention of this routine, lets rename it
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2b392a6db231c8069d57be88ebf4f2960af199fa
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jun 18 12:57:07 2019 +0100

    Bug 22566: Accept 'all' in the branch params
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4f3413f0d2688017f6a35b43d0d1d4a9d7295c5a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jun 7 12:50:32 2019 +0100

    Bug 22566: Fix some more issues
    
    1) Fix warning for undefined value in sprintf when no items have the
    indemand flag set.
    2) Corrections to report_full for bad ternary in string construction
    3) Perldoc corrections
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b62473d192abaf9371bffb0ec4d73267a0070447
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Mar 22 13:23:35 2019 -0400

    Bug 22566: Fix some problems
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 35fe9cf40bb1472799db0f7596d33f1bd184fb9b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 21 14:45:06 2019 +0000

    Bug 22949: Markup error in OPAC course reserves template
    
    This patch adds a missing "=" in opac-course-reserves.tt in order to
    quiet errors returned by the HTML validator.
    
    To reproduce the problem you should have one or more course reserves
    available in the OPAC. Go to the course reserves page. Run the page
    through the W3C validation service: https://validator.w3.org. Either by
    pasting in the URL for the search results (if web accessible) or by
    viewing source, copying, and pasting into "Validate by Direct Input."
    
    This patch addresses these errors:
    
     - 'Quote " in attribute name. Probable cause: Matching quote missing
        somewhere earlier.'
     - 'Attribute class"inst_surname" not allowed on element span at this
        point.'
    
    To test, apply the patch and try again to reproduce the validation
    errors. Those errors should no longer be present. There should be no
    visible change to the page.
    
    Signed-off-by: Frederik Chenier <frederik@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8947d5939fb33efd0887a6f443d392b9df17e2aa
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 24 09:58:00 2019 -0500

    Bug 23082: Fatal error editing a restricted patron
    
    In members/memberentry.pl we have to explicitely remove the template's
    params that are not patron's attributes.
    
    Certainly caused by
      commit 1bb6cec902088d07c7a43addc4b4adb5b0bf3d4f
      Bug 20287: Fix update of patrons, clean the data before ->store
    
    Test plan:
    Create a restriction for a patron
    Edit patron's details
    Remove the restriction
    => Without this patch you get "No property remove_debarment for
    Koha::Patron"
    => With this patch applied the restriction is removed
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2c5e9bed7de83d01be755475b96a3cf439e0126c
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 13 06:34:38 2019 -0400

    Bug 23116: AllowHoldPolicyOverride allows a librarian to almost place a hold on an item already on hold
    
    A library appears to be able to place a second item level hold on an item a patron already has on hold if
    A) AllowHoldPolicyOverride is enabled
    and
    B) the circ rule allow for multple item level holds.
    
    Once the patron submits the hold requests though, the hold does not get stored in the database.
    
    Because allowing two item level holds for the same item makes no sense, we should not allow
    this attempt to take place, even if AllowHoldPolicyOverride is enabled.
    
    Test Plan:
     1) Enable AllowHoldPolicyOverride
     2) Set up circ rules to allow for multiple item level holds on one record
     3) Place an item level hold on a record
     4) Note you can force placing a second item hold on that reocrd
     5) Attempt to do so, it will not actually work
     6) Apply this patch
     7) Note you can no longer place another item level hold for the same item
       you just placed an item-level hold on
     8) Note you can still force holds that contravene the circ rules for
       any and all other reasons
     9) Test with record level holds
    10) Test by placing multiple holds from search results
    
    Signed-off-by: Martha Fuerst <mfurest@hmcpl.org>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Simple fix for a regression. Works as expected.
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 90bd9763bd0cf49df722955008af0c59d79edfe0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jun 25 16:19:43 2019 +0100

    Bug 5287: (RM follow-up) Make tests basket compatible
    
    The selenium tests for addtobasket/removefrombasket started to fail
    after the introduction of bug 5287. It turns out that a selenium click
    handler will trigger a scroll event if the element you're trying to
    click isn't in the view port. Unfortunately it scrolls the viewport just
    enough for the element to come on screen but that also triggers the
    floating toolbar in this case which ends up floating directly over the
    element we want to 'click' and so the click rightfully fails as the
    element is not 'clickable'.
    
    This patch works around the issue by setting the window size to being a
    HD screen in portrait orientation and therefore negates the need for
    scrolling to put the elements in within the viewport.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7047b45cb44adf12189e9180ef27fe8e63efa23
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 24 18:24:47 2019 +0100

    Bug 23109: (RM follow-up) Correction to typo in DBRev
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8bf6f4dc5ad2aad0a5dd59c4fb7f70fd6b0f069e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 24 18:22:08 2019 +0100

    Bug 23152: (RM follow-up) Correct pluralisation of Koha::Libraries
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b5ad077342faed74de34c3f185379ddf1b8ff4ad
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 24 17:12:44 2019 +0100

    Bug 23109: DBRev 19.06.00.008
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a19bd0e0267e9173a8c766c565ef67ecd1babcb7
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Jun 20 16:42:22 2019 +0000

    Bug 23109: (follow-up) fix typo in upgrade script
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit dc0e8002fa6219cd49a5cc457191ef7855163c28
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Jun 17 21:50:01 2019 +0000

    Bug 23109: Improve description of staffaccess permission
    
    Changes:
    Allow staff members to modify permissions for other staff members
    To:
    Allow staff members to modify permissions and passwords for other staff members.
    
    As suggested by Andre on the initial bug report.
    
    To test:
    - Go to any patron account and check More > permissions
    - Veriy the description is shown as noted above
    - Apply patch and run database update
    - Reload the page and verify the description has changed
    - Run the following SQL and verify the description in the
      database table matches as well:
    
    SELECT * FROM userflags where flag = "staffaccess";
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9f4c2306ebc42e107603f6f8bf393a20d1013458
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 24 10:37:54 2019 -0500

    Bug 23158: Make the assignment statement more readable
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12ef157d757431520d63ab154b9572a855acf317
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Jun 19 13:42:16 2019 +0200

    Bug 23158: keep on-site checkout info when using itemBarcodeFallbackSearch
    
    When using preference itemBarcodeFallbackSearch one can enter a search term instead of a barcode in checkout form.
    If on-site is selected this should be transmitted to itemBarcodeFallbackSearch form.
    
    Test plan :
    1) Enable system preferences "itemBarcodeFallbackSearch" and "OnSiteCheckouts"
    2) Disable system preference "ConsiderOnSiteCheckoutsAsNormalCheckouts"
    3) Go to a patron circulation page
    4) Check "On-site checkout" in "Checkout settings"
    5) Enter a barcode in checkout form and click on "Check out"
    6) You see the checkout in table with red "(On-site checkout)"
    7) Check "On-site checkout" in "Checkout settings"
    8) Enter the title of a record in in checkout form and click on "Check out"
    9) Click on "Checkout" on a line
    10) You see the checkout in table with red "(On-site checkout)"
    
    Signed-off-by: Arthur Bousquet <arthur.bousquet@inlibro.com>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e17cff4d5aea108010850ff4a6bada80ba6ef055
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 24 17:07:04 2019 +0100

    Bug 5287: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit aa8abb916f8aa19c109abdd7841560abc01db239
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Sat Jun 8 17:57:17 2019 +0000

    Bug 5287: (QA follow-up) update deprecated button
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c5ca160e3b79b7ad1cbc4cfc1c2c7db30d2686ff
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jun 11 12:16:10 2019 +0000

    Bug 5287: Add floating toolbar to search results in OPAC
    
    This patch adds the "hc-sticky" JavaScript library to the OPAC and uses
    it to make the search results toolbar "stick" to the top of the page as
    the user scrolls down.
    
    This patch also moves search results pagination into the toolbar so that
    pagination links are available. Font Awesome icons are added to the
    pagination include to replace arrow HTML entities.
    
    To test, apply the patch and rebuild the OPAC CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
     - Perform a catalog search in the OPAC which will return multiple pages
       of results. Confirm that the toolbar "sticks" and that all controls
       in the toolbar work correctly.
     - Test at various browser widths to confirm that it adapt well to
       various sizes.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a87f5a01502b5df08f5e7b61650be6ea7dbafa30
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 24 16:56:56 2019 +0100

    Bug 23152: (RM follow-up) Add handling for Koha::Plugin::Methods
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a60a6f40c3e25753c7474c4ff20f28e71353c351
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 18 21:42:07 2019 -0500

    Bug 23152: Implement koha_object[s]_class when needed
    
    A simple use case is the ->get_from_storage (useful when writing tests)
    
    Test plan:
    Apply only the first patch and notice the test failures
    Apply the second patch and confirm the the tests are returning green
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b6dc26e93d9d0170c9980291a0f217adcc429e6a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 18 21:39:45 2019 -0500

    Bug 23152: Add tests
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 088522032f33b6a5931cbea1b928537e7fe33fd0
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Jun 19 11:10:14 2019 +0200

    Bug 23154: Add pagination to /api/v1/checkouts
    
    Allow to use _page and _per_page query parameters for
    /api/v1/checkouts
    Also fix a timezone problem in t/db_dependent/api/v1/checkouts.t
    
    Test plan:
    1. With your favorite REST tester tool, or directly in the browser,
       fetch http://koha/api/v1/checkouts and check that you have results
    2. Fetch /api/v1/checkouts?_per_page=1&_page=1 and check that only the
       first result is returned. Check that response contains headers
       X-Total-Count and Link
    3. Fetch /api/v1/checkouts?_per_page=1&_page=2 and check that only the
       second result is returned. Check that response contains headers
       X-Total-Count and Link
    4. prove t/db_dependent/api/v1/checkouts.t
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1020fe5b1f95a606d445acb4ac16c0c30586e71d
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Wed Jun 19 14:06:28 2019 +0000

    Bug 23159: Add comments to addbiblio.tt
    
    This patch adds code comments to the template to clarify indenting over
    the page boundary.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7147fcde03f7ba1ac13e485adcac587f2dde85c
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Jun 18 15:32:24 2019 +0000

    Bug 23159: Reindent addbiblio.tt
    
    This patch corrects whitespace in the basic MARC editor template,
    addbiblio.tt: Tabs converted to spaces, indentation corrected. Some
    comments have been added in the markup to clarify the page structure.
    
    To test, apply the patch and open the basic MARC editor. Confirm that
    everything works correctly, including:
    
     - Showing/hiding subfields
     - Re-ordering subfields
     - Removing tags and subfields
     - Cloning tags and subfields
     - Plugin links
    
    Use the "-w" flag when using diff to examine the patch. The only changes
    should be places where single lines were broken up and where comments
    were added.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d52f58682cbae7f903a0459f3ec282a65a8ae1f6
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jun 19 12:30:28 2019 -0300

    Bug 23146: (QA follow-up) Make sure we use the absolute path
    
    When making a request using any tool (like cUrl or Postman) you get a
    'Basic authentication disabled' error (if it is actually disabled) or an
    'invalid password' error if it is disabled. This is because the
    comparisson of the path we do passes on oauth.t but fails on external
    tools. This is probably related to our stack including Apache URL
    mappings and then in the plack.psgi file. The safest way is to just ask
    Mojo::URL the absolute path to be sure.
    
    To test:
    - Having the rest of the patches applied and plack restarted, run: [1]
      $ curl -X POST -H 'Authorization: Basic ZGQ2NjlmNGUtZmI1NS00Y2YzLWE4ZmYtYmFiYzJiNDIwNWY1OmM0ZDJmYmYzLWYwOWMtNGJkZi1iNWE4LTgxMDJmNjcwYTI1Mw' -i 'http://kohadev.myDNSname.org:8081/api/v1/oauth/token' --data grant_type=client_credentials
    => FAIL: It fails saying Basic auth is disabled
    - Run:
      $ kshell
     k$ prove t/db_dependent/api/v1/oauth.t
    => SUCCESS: Tests pass
    - Apply this patch
    - Replicate your curl/postman test
    => SUCCESS: It now works as expected
    - Run:
     k$ prove t/db_dependent/api/v1/oauth.t
    => SUCCESS: Tests still pass!
    - Sign off :-D
    
    [1] You need to generate a client_id and client_secret, and encode them
    using: encode_base64url( "$client_id:$client_secret" );
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 23065fe0d8e09be78d1234a3a5bebf322da34925
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jun 18 16:09:01 2019 -0300

    Bug 23146: Add support for Basic auth on the OAuth2 token endpoint
    
    The original implementation only contemplated the option to pass the
    client_id and client_secret on the request body. It is very common that
    clients expect to be able to pass them as a Basic authorization header:
    
    Authorization: Basic encode_base64(client_id:client_secret)
    
    This patch introduces support for this, by:
    - Adding a check for the presence of the Authorization header in the
    OAuth token request handling code and making that case extract the
    client_id and client_secret from the header instead of the original
    implementation. No behaviour changes.
    - The Auth#under sub is changed so it doesn't go through the
    authenticate_api_request chain step, as it would be in conflict with
    general Basic authentication.
    - Original tests are generalized so they are run in both ways, with the
    same expected results.
    
    To test:
    - Apply the unit tests patch
    - Run:
      $ kshell
     k$ prove t/db_dependent/api/v1/oauth.t
    => FAIL: Tests fail because the current API doesn't support the feature
    - Apply this patch
    - Run:
     k$ prove t/db_dependent/api/v1/oauth.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Sponsored-by: ByWater Solutions
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f04747c89c8a318e3ee7c49cadc859f1fe7bb5b3
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jun 18 16:08:54 2019 -0300

    Bug 23146: Unit tests
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 535925e23f58d654ddd3a1da62d6bf2572aca0a2
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 24 15:42:04 2019 +0100

    Bug 22935: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 33b70b798d4cc2bc6d6db43a40d006dd8c1109b8
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri May 17 15:03:24 2019 +0000

    Bug 22935: Improve style of Bootstrap pagination
    
    This patch makes some updates to the staff client CSS and adds Font
    Awesome icons to the Bootstrap pagination include.
    
    To test, apply the patch and rebuild the staff client CSS.
    
    Perform a search in the staff client which will return multiple pages of
    results. Check that the pagination links look good.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Bin Wen <bin.wen@inlibro.com>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 14af35852edf33f05883184cc451662438114c12
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Nov 30 12:23:43 2018 -0500

    Bug 20292: Filter/censor info sent via SIP
    
    Some libraries would like to limit the amount of personal information a SIP server sends
    to arbitrary parties on a per-login basis.
    
    Test Plan:
    1) Add a new key/value pair to one of your existing login stanzas in your SIP config file
       For example: hide_fields="BD,BE,BF,PB"
    2) Restart SIP
    3) Send a SIP message that would normally return those fields ( in this example, a Patron Information Request )
    4) Note the response has had those fields removed
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Christopher Davis <tubaclarinet@protonmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0141b797d7f495bbcea350c14e3b6aae635ce7cf
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 24 15:07:53 2019 +0100

    Bug 22509: (RM follow-up) Add use of Koha::Script base class
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0b783783706f88d04225c0a42759798ae14c9755
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat May 11 18:58:20 2019 -0500

    Bug 22509: Clarify with an example the usage of --unless-exists
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit da12cf7551dd1bd533b7cbcf5a679ea58f6a0f4e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat May 11 18:53:25 2019 -0500

    Bug 22509: Add more POD and fix --where
    
    We should not need the "WHERE" keyword to have the same behavior as
    existing script (rebuild_zebra.pl)
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7f3c98478ab63e834d7787c1ce6ab06e46d44395
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 10 07:55:49 2019 -0500

    Bug 22509: Fix POD error
    
    1. "Apparent command =item not preceded by blank line"
    2. Display the options for help
    3. Do not run if no --field passed
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e8a4f97e95c8206c2cc60ba81d953ae1c4c12963
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Apr 4 23:02:09 2019 -0300

    Bug 22509: Add the --unless-exists option to the script
    
    It will avoid to create the fields several times if it is not needed.
    
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e54e887b58d7daa0309d16923cce4419aee6314b
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Mar 13 11:23:13 2019 -0300

    Bug 22509: Add new script to add MARC fields with date formatted stringsto bib records
    
    Say you want to add, into a new MARC fields, the following string:
      2/2019/Mar-03/13
    Depending on today's date.
    
    Test plan:
    Use the script after with the different options (see --help option for the list)
    
    Sponsored-by: Orex Digital
    Signed-off-by: Hugo Agud <hagud@orex.es>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 982fd9fecbe6777805d2d0d3f977f10c522b86c5
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu May 9 14:14:25 2019 -0400

    Bug 22862: (QA follow-up) Make regexes match
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 115f4f2045a6c695d1eed47cd401b7759630ac4d
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 7 14:53:29 2019 -0400

    Bug 22862: Normalize SMS messaging numbers before validating them
    
    Librarians often copy and paste patron data, including phone numbers. SMS phone numbers are now being validated to conform to the E.164 specification. It would be nice to try to normalize that data by stripping non-numeric data from the paste (i.e. dashes, parens, etc ).
    
    Test Plan:
    1) Apply this patch
    2) On the staff side, Attempt to enter invalid characters the SMS number field
    3) Note you cannot enter invalid characters
    4) Attempt to paste a phone number with invalid characters
    5) Note those characters are removed on paste
    6) Repeat these steps on the OPAC
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cc9d167af6081009bd3c41c7dd91f90c76c6ca1b
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 24 14:59:04 2019 +0100

    Bug 22888: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a1083587b235ac0d85e85a625944179e2c087785
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu May 9 16:55:00 2019 +0000

    Bug 22888: Use DataTables for Koha news table filtering
    
    This patch modifies the Koha news page so that filtering the table of
    news is done using DataTables' built-in search functionality. This
    allows for the table to be filtered without requiring a reload of the
    page.
    
    The patch also moves the table filter into a sidebar form and adds a
    keyword field. A minor change has been made to the global CSS to improve
    the display of the form in the sidebar.
    
    To test, apply the patch and rebuild the staff client CSS.
    
     - Go to Tools -> News.
     - Test the various table filter options: keyword, display location, and
       library. Confirm that all work as expected.
       - Changes to the keyword search text should be reflected in the
         search field at the top of the table, and vice versa.
     - Changes to the sidebar filter should trigger the correct state of the
       "Clear filter" button at the top of the news table (enabled or
       disabled).
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a6d732f563bfcd19691decbb9968dc1f4b25c07c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 9 12:27:15 2019 -0500

    Bug 21588: Add expand/collapse all links to the "Acquisition details" subscriptions
    
    In order to make the view cleaner, a librarian may need to expand or
    collapse all the orders at once.
    
    Test plan:
    - Create a subscription
    - Create several orders from this subscription (quantity > 1)
    - Receive partially the orders
    - Go to the subscription detail page, "Acquisition details" tab
    => Notice the 2 new links "Expand all" and "Collapse all"
    Make sure they work as expected.
    
    Also note that a bug has been fixed, when the page is loaded the tree is
    now expanded.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3599e57bf67a1357c13903fbf07f07cb2c94e756
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Dec 18 15:41:33 2017 +0000

    Bug 15704: Split up Zebra indexing of RDA 264 information
    
    To test:
    1 - Add a record with a unique publisher "Supercalifragilistic" in the
    264 b field
    2 - Search for the value
    3 - Record not found
    4 - Apply patch (may need ot copy the .xml file into koha install)
    5 - Reindex all the things
    6 - Search for the value
    7 - Success!
    
    Signed-off-by: Felicia Martin <felicia.martin@dncr.nh.gov>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4dc64b4b124abf4bd2437004879e083972e20492
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 24 14:48:27 2019 +0100

    Bug 23034: (RM follow-up) Consistent coding style
    
    We had a mix of q||, q{} and '' in this one script. This followup just
    makes them all conform to our standard style of q{}.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0df3fc3dae575ceb16b85de6c201f5e82d01059c
Author: Joonas Kylmälä <joonas.kylmala@helsinki.fi>
Date:   Mon Jun 3 14:58:34 2019 +0000

    Bug 23034: Remove uninitialized value warning in Mana KB settings
    
    This gets rid of the warning "Use of uninitialized value $auto_share
    in string ne at [...]" by initializing the variable with empty string.
    
    Test plan:
    1) Go to page cgi-bin/koha/admin/share_content.pl and unselect "Auto
       subscription sharing". Click "Save".
    2) Check plack-error.log and notice the warning "Use of uninitialized
       value $auto_share [...]"
    3) Apply the patch and repeat the previous steps but now this time the
       warning is gone in plack-error.log.
    4) Make sure the AutoShareWithMana syspref with and without the patch
       is in unselected state after clicking "Save".
    
    Sponsored-by: The National Library of Finland
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 286f151009f778d6d4d0890b1a8bead1a6e62bde
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Jun 17 23:20:41 2019 +0200

    Bug 23098: Reword success message of KOC upload process
    
    When uploading KOC files the processing of transactions needs
    to happen in a separate second step. This is why the success
    message "Your file was processed" was found to be misleading.
    
    This patch changes it to the wording suggested by Benjamin
    Daeuber in the original bug report. Thx!
    
    To test:
    - Create a KOC file either manually or by downloading it
      from the plugin
    - Upload the KOC file into Koha using Circulation >
      Upload offline circulation file (.koc)
    - Verify the new message is clear and has no typos :)
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ed7b3760965ec5a52783efe64bcba13b45b3725a
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue Jun 11 15:31:45 2019 +0200

    Bug 22944: remove obsolete unit test
    
    Test 'AnonymiseIssueHistory should not return any error if success' is obsolete,
    previous statement will explode if something went wrong.
    
    Test plan :
    Run t/db_dependent/Koha/Patrons.t
    
    Signed-off-by: Arthur Bousquet <arthur.bousquet@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 66975364b672ea5f362d49f6e5fca8c9a0e8326c
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue May 21 11:55:40 2019 +0200

    Bug 22944: avoid AnonymousPatron in search_patrons_to_anonymise
    
    In Koha::Patrons::search_patrons_to_anonymise() old issues already affected to the anonymous patron should be avoided. It is useless and can impact performance.
    
    It is already working if AnymousPatron is not defined or 0 because of :
      'old_issues.borrowernumber' => { 'not' => undef }
    
    In theory the anymous patron should have privacy=0 but in case its not it should be explicitly avoided.
    
    Test plan :
    Run t/db_dependent/Koha/Patrons.t
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 48e5713e6ff78d7aad7eff9e239ec8779d62655c
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Tue May 21 11:17:11 2019 +0200

    Bug 22944: change unit tests
    
    Add a dedicated UT and correct a test return value
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f1bb6178e5bfe990da747c9d5b0e7a4f04148a55
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 24 14:24:26 2019 +0100

    Bug 23115: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c3ced5d89320f85774d945957b2b4e68d0336016
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 21 16:20:28 2019 +0000

    Bug 23115: (QA follow-up) Address QA tools complaints
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit efc21e6f47801503e55e3ba709a48c3f426f90ac
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 21 16:18:15 2019 +0000

    Bug 23115: (follow-up) Move switches to a TT block
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 49275f27d43990746b4af5c6335d4fe7f38de7b4
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jun 13 11:42:02 2019 +0100

    Bug 23115: Tweak display of totals on 'Fines and charges' page
    
    This patch tweaks the display of totals on the OPAC 'Fines and charges'
    page to clarify between the totals before and after applying credits.
    
    Test Plan:
    1) Add some debts and credits to a patrons account
    2) Look at the 'Fines and charges' page before applying the patch
    3) Look at the 'Fines and charges' page after applying the patch
    4) Varify the new layout is an improvment or not
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7c5e7ca9c47ac6c8a8b7d89da46e7354d8fea69d
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jun 13 10:02:35 2019 +0100

    Bug 23106: Tweak display of totals on payment page
    
    This patch tweaks the display of totals on the fines payments page to
    clarify between the totals before and after applying credits.
    
    Test Plan:
    1) Add some debts and credits to a patrons account
    2) Look at the pay page before applying the patch
    3) Look at the pay page after applying the patch
    4) Verify the new layout is an improvment or not
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d08e776cf1e25ffa407bb3a5d668c1b140be6ec2
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Mon Jun 17 17:57:46 2019 +0000

    Bug 22571: (follow up) fix Donald cut-&-paste error
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c59586aebe1d8eab56d3cd32b5156fc1a61f11ec
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun May 5 12:41:46 2019 -0500

    Bug 22571: Handle control fields in MMT for conditionals
    
    Control fields are not handled correctly by Koha::SimpleMARC when
    comparaison (with or without regex) is done.
    
    Which means we did not support something like:
    Do something if control field 008 equals or matches "a string"
    
    Test plan:
    Create a new MARC modification template and a new action, like:
    Add new field 100$a with value "foo bar" if 008 (or any other control
    fields) matches (or equals) a regex
    Then use the record mofication tool and confirm that the new field is
    create if the regex matches 008 of the bib record
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f6009342a95575dc6b1157c953f5e6e8c249b6d0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sun May 5 12:41:43 2019 -0500

    Bug 22571: Add tests
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 206498dc5585fbd555181a1b241d5049632870df
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Fri Jun 14 10:43:15 2019 +0200

    Bug 22617: Fix checkout notes typo in manage_checkout_notes permission usage
    
    When logged into the staff client with an account with full circulate permissions (and therefore including the manage_checkout_notes permission) an error occurs when clicking on the Checkout notes pending link.  The account is logged out automatically with the message:  "Error: you do not have permission to view this page.  Log in as a different user".
    The same error occurs for both the link on the home page dashboard and from the Circulation module button.  Works as expected if Superlibrarian permission is set.
    
    This is just a typo in perl script : circulation instead of circulate
    
    Test plan :
    1) Set preference "AllowCheckoutNotes" to "Allow"
    2) Create a user with only permissions "catalogue" and "circulate > manage_checkout_notes"
    3) Loggin with this user
    4) Go to "Circulation" home page
    5) Click on "Checkout notes"
    6) You should be allowed to access
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 49e0384f10f659e337fac1b08e6bdd2c163151ae
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed Jun 19 07:04:25 2019 +0200

    Bug 23153: In framework management action subfields must not go directly to edition
    
    Since 18.11, when viewing a framework field clicking on Actions >
    Subfields goes to subfields edition instead of subfields table view.
    
    This is because link contains op=add_form.
    This is is also missing /cgi-bin/koha/admin.
    
    Test plan :
    1) Go to Administration > MARC bibliographic framework
    2) On a line click Actions > MARC structure
    3) On a line click Actions > Subfields
    4) You see subfields table
    5) Click on Edit subfields
    6) You see subfields edition tabs
    
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 12a9dfb6593c4d5ccc6936b85c82479c12337309
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon Jun 17 20:07:29 2019 -0500

    Bug 15814: Add missing filters
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7a80483a1358a7bc3e516a8fbc92d34b6559dcac
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed May 29 21:28:23 2019 -0500

    Bug 15814: Handle correctly MMTA edit button
    
    The MARC modification template action edit buton does not correctly
    handle variable escaping.
    Assigning a JS variable containing the JSON representation of the
    hashref will make the processing much more easier.
    
    Test plan:
    Create a MARC Modification Template with several actions.
    In the description you should use the following characters, to try to
    break this patch: \ ' " \n \r
    (not sure what we handled \n and \r)
    Then edit the action, modify and save again.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6dc8306b58bc1207f396d2df919a3daf4712e8e5
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Thu Jun 20 12:37:27 2019 +0000

    Bug 23150: (follow-up) Make gdpr_proc_consent mandatory for create
    
    When updating (patron modification), the field should not be required.
    
    Test plan:
    Check patron modification on opac.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3b14f7d636fea4425b2f6eab922be9aa2a9eed1d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 19 14:49:15 2019 -0500

    Bug 23150: Do not consider gdpr_proc_consent a mandatory field
    
    It introduced a regression in the patron's self modification feature.
    Patron's details are no longer modificable, the screen displays
    "You have not filled out all required fields. Please fill in all missing
    fields and resubmit."
    
    Test plan:
    - Set GDPR_Policy to either Enforced or Permissive
    - Set PatronSelfRegistrationBorrowerMandatoryField to empty
    - Set OPACPatronDetails to Allow
    - Log into the OPAC
    - Accept the GDPR screen
    - Go to opac-memberentry.pl, change something, submit modification
    request
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 48259267f6830b2e388b2a91268117645bda80f3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 21 12:39:09 2019 +0000

    Bug 22946: Markup error in OPAC search results around selection links
    
    This patch makes minor corrections to the template for OPAC search
    results. These corrections fix errors returned by the HTML validator.
    
    To reproduce the problem, make sure holds and/or tags are enabled in the
    OPAC. Perform a search in the OPAC which will return multiple results.
    Run the page through the W3C validation service:
    https://validator.w3.org. Either by pasting in the URL for the search
    results (if web accessible) or by viewing source, copying, and pasting
    into "Validate by Direct Input."
    
    This patch addresses one specific error:
    
     - "Element div not allowed as child of element span in this context."
    
    To test, apply the patch and try again to reproduce the validation
    errors. Those errors should no longer be present. There should be no
    visible change to the search results view.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d018953ca1947649c35df8670a385a942c80c134
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Jun 17 21:35:19 2019 +0000

    Bug 23097: Fix regression on overdues report and link patrons to moremember
    
    The link from the patron name in the circulation > overdues report
    shouldn't point to the reserves tab, as this report is about checkouts.
    
    The patch restores the behaviour as it was in 17.11.
    
    To test:
    - Make sure you have a patron account with overdue items
    - If you don't have one, check out an item with specified due date in the
      past
    - Go to Circulation > Overdues
    - Veriy the overdue shows
    - Click on the patron name that is linked
    - Verify you go to the checkouts tab in patron account with holds tab selected
    - Apply patch
    - Reload Overdues report
    - Verify the link now leads to the Details tab with the checkouts tab in front
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3bf26cfb934cb699839aabb136df09ea97c030bb
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jun 19 07:00:01 2019 -0400

    Bug 23103: (QA follow-up) Return undef implicitly
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2a2e4a8d52c2098dd183e6714b03aed5b6a84bb
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Wed Jun 12 15:08:08 2019 -0400

    Bug 23103: Cannot checkin items lost by deleted patrons with fines attached
    
    Test Plan:
    1) Checkout an item to a patron
    2) Ensure the item has a replacement cost (or itemtype has default)
    3) Ensure patrons are charged when items lost
    4) Mark the item lost
    5) Confirm patron has a fine
    6) Write off the fine
    7) Delete the patron
    8) Check in the item
    9) Note the internal server error
    10) Apply this patch
    11) Repeat steps 1-8
    12) Note there is no internal server error!
    13) prove t/db_dependent/Circulation.t
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 90d4e3a672e8778e30058fe691f83d94b6d379ce
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jun 21 12:28:48 2019 +0100

    Bug 23177: (RM follow-up) Further test clarifications
    
    This patch makes a few minor improvements to Circulation.t
    1) Adds a name to some of the scoped blocks by converting them to
       subtests.
    2) Adds output messages to some tests where they were missing.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c7a707d60b187fa2c18c4bacd3a6b472de25da98
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jun 21 09:15:18 2019 +0000

    Bug 23177: (QA follow-up) Remove subtest txn_begin and rollback
    
    This resolves:
    DBIx::Class::Storage::txn_rollback(): A txn_rollback in nested transaction is ineffective! (depth 1)
    Removing unneeded subtest txn's. We should probably add them everywhere or
    just at global level.
    
    Test plan:
    With all three patches applied, run Circulation.t a few times.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 95a303c8f351bdd926136b5e9110ba9957df52f1
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jun 21 09:03:27 2019 +0000

    Bug 23177: (QA follow-up) Move rollback to the end
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 568d3f82cba2aef475e71624c7eaec2054d234ef
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jun 21 09:00:27 2019 +0000

    Bug 23177: (QA follow-up) Move three subs from the middle to the top in Circulation.t
    
    Removed trailing comma for last sub too.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2af415a866d5ce46c6c243dfc6380b002e323db6
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jun 17 17:58:56 2019 +0000

    Bug 23140: Fix typo in branchcode parameters for print slip
    
    To test:
    1 - Have [% branch.branchcode %] in your TRANSFERSLIP
    2 - Checkin an item from another branch (with AutomaticItemReturn = do )
    3 - Inspect the button in the browser to see the typo
    4 - Click 'Print slip'
    5 - Note the branchcode is not populated
    6 - Clear the transfer
    7 - Apply patch
    8 - Repeat
    9 - Note typo is fixed and slip correctly populated
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1b24cf26de54a31699b26174a25dfff509651ecc
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri Jun 21 07:08:39 2019 +0000

    Bug 13640: (QA follow-up) Allow NULL values for default_branch_item_rules.holdallowed
    
    If a rule has not been defined for an itemtype or you submit a biblio level
    hold, you cannot filter on holdallowed<>0.
    
    Test plan:
    Test with a biblio level hold. Have two items; one item should be blocked
    with a policy.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0fd6250ae198dddf09071912e3eb87f7e0702bfd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 13 09:57:52 2019 -0500

    Bug 13640: Do not display unreserveable items on the Holds to pull screen
    
    We should only display the items that meet the hold policies
    
    Test plan:
    It would be good to have a huge list of holds displayed on the "Holds to
    pull" and confirm that the display is now correct.
    
    One of the possible test plan has been let in a comment on the bug
    report:
    Bib Record A has 2 items:
    
    Item Record X (can be placed on hold)
    Item Record Y (cannot be placed on hold)
    
    If you place a bib-level hold on Bib Record A, both Item Record X and
    Item Record Y show up as available items in the Holds To Pull List.
    
    With this patch applied you must not see Y
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f56bba9297087eaeaeefb2aba546c9f107bfad6e
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Mon Jun 10 14:36:49 2019 -0400

    Bug 23090: Add some special characters
    
    TEST PLAN
    ---------
    
    $ sudo mysql -u root
    > CREATE USER 'bug23090_test1'@'localhost' IDENTIFIED BY 'badpassword';
    [Magical MySQL Error]
    > CREATE USER 'bug23090_test1'@'localhost' IDENTIFIED BY 'GoodP@ssw0rd';
    [Should be okay]
    > DROP USER 'bug23090_test1'@'localhost';
    > QUIT
    $ sudo koha-create --create-db fail23090
    [Magical MySQL Error]
    [Apply this patch and put it (debian/scripts/koha-create) into place in
    /usr/sbin/koha-create]
    $ sudo koha-create --create-db pass23090
    
    (Clean up and databases made)
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5aaae31a78db533e998044d9f0bc16f7dfda06b1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jun 17 12:16:53 2019 -0300

    Bug 9834: (QA follow-up) API Corrections
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5be6c78e6e78bfa34877e5732b61c2f881245edd
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu Jun 20 12:03:30 2019 -0300

    Bug 23168: Enable plugins using plain SQL
    
    To test:
    - On a clean 18.11.x, install a plugin [1]
    - Run:
      $ sudo koha-mysql kohadev
      > SELECT * FROM plugin_data;
    => SUCCESS: Notice there's a __INSTALLED_VERSION__ line for your plugin
    - Checkout latest master, restart all the things
    - Run:
      $ updatedatabase
    => FAIL: It fails on 18.12.00.069 because the plugin_methods table doesn't exist
    - Run:
      $ sudo koha-mysql kohadev
      > SELECT * FROM plugin_data;
    => FAIL: No __ENABLED__ line for your plugin
    - Apply the patch
    - Run:
      $ updatedatabase
    => SUCCESS: Update passes the 18.12.00.069 step correctly
    - Run:
      $ sudo koha-mysql kohadev
      > SELECT * FROM plugin_data;
    => SUCCESS: There's an __ENABLED__ line for your plugin
    - Sign off :-D
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c67ce9cc9b492e2eaaaaf951a555e59d3cba69fd
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jun 20 09:46:50 2019 +0100

    Bug 23130: Add David Nind to contributors
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 42b1e5e8805027b0c4bc9830c1cc2f45a6f46374
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jun 20 09:44:26 2019 +0100

    Bug 22966: Add Petter von Krogh to contributors
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b976bad50a03ca4d4fa369e2c5371ec35dfb0d5f
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Mon Jun 17 16:28:22 2019 +0200

    Bug 23132: Fix encoding issues in facets with show more link
    
    When one uses characters like Ã, ç ... the first searcshow up correctly but when you refine your search with "Show more", the encoding becomes bad and so, results of the search too.
    
    Test plan :
    
    Without the patch:
    - check if you have your SysPref SearchEngine with Elasticsearch as value,
    - put your SysPref FacetMaxCount at 10,
    - search in the catalog "a" and then in Refine your search click on show more (just to see how it works),
    - then search with special characters like "é", ç" ... and make the same test, the research should be wrong when you click on show more and the page is realoaded.
    
    Then apply the patch:
    - and make the same with a classic reasearch, then with special characters,
    - verify that when you click on show more the page isn't realoded and the reasearch is correct.
    - same with show less
    - and finnaly, add some facets and test show more/less
    
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 054094835d586e06e0d116c02deb310030b30f09
Author: David Nind <david@davidnind.com>
Date:   Sat Jun 15 01:43:39 2019 +0000

    Bug 23130: Fix alternative mana server URL in etc/koha-conf.xml
    
    If the alternative mana KB server URL in etc/koha-conf.xml is used it
    causes an error message like 'malformed JSON string, neither tag,
    array, object, number, string or atom, at character offset 0 (before
    "<html>\r\n<head><tit...") at /usr/share/perl5/JSON.pm line 171.' when
    submitting an account creation request, and the account creation
    request fails.
    
    This patch updates the alternative mana KB server URL in
    etc/koha-conf.xml from http://mana-test.koha-community.org to
    https://mana-test.koha-community.org (the URL should start with https
    instead of http). If the updated URL is used the account creation
    request succeeds without causing any error messages.
    
    To test:
    1) Add <mana_config>http://mana-test.koha-community.org</mana_config> to
       /etc/koha/sites/<instancename>/koha-conf.xml (see etc/koha-conf.xml
       in the Koha code repository for an example of where to add this;
       <instancename> if using koha-testing-docker is kohadev).
    2) Clear memcached and restart services so that the changes to your Koha
       instance configuration are recognised (if using koha-testing-docker
       run flush_memcached and then restart_all).
    3) From the staff client home page go to Koha administration >
       Additional parameters > Share content with Mana KB.
    4) Enable content sharing: change 'Use Mana KB for sharing content' to
       Yes and press Save.
    5) Enter your first name, last name and email address in the Configure
       Mana KB section of the page and then click on 'Send to Mana KB'.
    6) An error message is displayed, this may be something like:
       'malformed JSON string, neither tag, array, object, number, string
       or atom, at character offset 0 (before "<html>\r\n<head><tit...") at
       /usr/share/perl5/JSON.pm line 171.'
    7) Change the mana server URL to https://mana-test.koha-community.org
       (see step 1), and repeat steps 2, 3 and 5.
    8) Instead of an error message you should get 'You successfully created
       your Mana KB account. Check your mailbox and follow instructions.'
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8bf07f36085741443962a5637c1afdb7c0822d19
Author: Julian Maurice <julian.maurice@biblibre.com>
Date:   Wed Jun 19 14:22:00 2019 +0200

    Bug 23144: (QA follow-up) Fix another POD error in svc/barcode
    
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5168edaf1e7742b28d256e3b5c8530da410d142c
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jun 17 19:20:55 2019 +0000

    Bug 23144: Replace missing =cut in svc/header
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Julian Maurice <julian.maurice@biblibre.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ef92de033d37b0a5d10ff4f309e71e9dd9e38039
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Wed Jun 19 15:38:20 2019 -0300

    Bug 21073: (QA follow-up) Fix plugin-related tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b40cc9d7ac3e78fc948ca79ba0c537e4cf6c5618
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Mon Jun 10 16:49:36 2019 +0000

    Bug 22851: Style navigation links in serials modules like same links in other modules
    
    This patch makes minor markup changes to the serials sidebar menu
    include so that links are displayed in a style consistent with similar
    menus in other areas of the staff client.
    
    This patch contains whitespace changes, so please use the "-w" flag when
    viewing the diff.
    
    To test, apply the patch and go to the Serials module. The links in the
    sidebar menu should be displayed in the same style as the corresponding
    menu on the Acquisitions home page.
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 313a92324ab892179ca774742e336dc156b30a4a
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jun 14 14:59:34 2019 +0000

    Bug 23122: When searching callnumber in simple search, search option is not retained
    
    This patch copies some code and markup from the staff client where call
    number phrase searches are correctly handled. A check for
    'ms_callnumcommaphr' is copied from search_indexes.inc. Handling of
    commas and dashes is copied from search.pl.
    
    To test, apply the patch and make sure the
    OpacAddMastheadLibraryPulldown system preference is enabled.
    
     - From the OPAC main page, select "Call number" from the search pull
       down at the top of the page.
     - Perform any search (it need not return results).
     - Verify that the search option retains the "Call number" selection.
     - Repeat the test with and without the OPACNumbersPreferPhrase system
       preference enabled.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 34fc14772643a9c9e2868785dbb424a36d26be61
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Thu Jun 6 12:24:41 2019 +0000

    Bug 23061: Add column/print/export feature on checkout history page
    
    This patch adds columns configuration and export features to the
    checkout history page.
    
    This patch also removes some inline CSS: "overflow:hidden" from both the
    checkout and holds history pages. This was breaking the table controls
    tooltips, and didn't appear to me to be necessary.
    
    To test, apply the patch and restart Plack (or restart_all on
    kohadevbox).
    
     - Open a patron's checkout history page in the staff client.
     - The table of checkouts should have controls at the top.
       for columns configuration and export/print.
     - These controls should work correctly.
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ce8169fc214f68f46c30dbd7ea3fbd3950a68bc7
Author: Petter von Krogh <petter@libriotech.no>
Date:   Wed May 22 15:38:21 2019 +0000

    Bug 22966: Add Norwegian library and patron names for installer
    
     THe Norwegian installer had reused english smaple atrons and libraries,
     this patch fixes this.
    
     test plan:
     empty database
     install norwegian translation
     run the web-installer and choose norwegian language
     select sample libraries and patrons
     make sure there are no errors
    
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    I trust Petter with Norwegian names, so I didn't spell check them :)
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e6e6867ed67d794d334933a13575734c72d0c58f
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jun 19 13:07:23 2019 +0100

    Bug 22653: DBRev 19.06.00.007
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 453b7b354f78513cdbdd6a0897f53b3b89b168b9
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Jun 17 21:12:25 2019 +0000

    Bug 22653: Remove unimplemented RotationPreventTransfers system preference
    
    This removes the RotationPreventTransfers system preference
    from updated and new installations.
    
    To test:
    - Verify you have the RotationPreventTransfers pref
    - Apply patch and run database update
    - Verify the preference no longer exists in your system
      - in the sys pref editor
      - in your database:
    
    SELECT * from systempreferences WHERE variable = "RotationPreventTransfers";
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a2d38d7c301eeb31226a6549b429fe80f34d8283
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Tue Jun 18 16:36:42 2019 -0300

    Bug 21073: (QA follow-up) Fix typo in class name
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 60ba3e8c639bf4ade1b3d837250468b979da4728
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu May 16 00:09:38 2019 -0300

    Bug 22835: (follow-up) Remove comented code
    
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c3cc7c06b39f1a47238dc50175de07668e5c2668
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Fri May 3 00:15:12 2019 -0300

    Bug 22835: (follow-up) Remove unwanted warn
    
    Signed-off-by: Arthur Suzuki <arthur.suzuki@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 688967e6eaab4c1f5670cbef254cb4a7101c4e18
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Thu Apr 25 02:13:37 2019 -0300

    Bug 22835: Serve plugin static files through API
    
    This patch serves static files declared within plugins.
    
    To declare static files the plugin must implement the method 'static_routes' which retrieves the spec of static file routes to add to the API.
    
    Once those routes are added to the API, the become available through the /api/v1/contrib/<api_namespace>/static/<path>/<to>/<file>/<filename> endpoint.
    
    To test:
    1) Install bug-22835-plugin.kpz
    2) Point your browser to /api/v1/contrib/kitchensink/static/static_files/mm.gif
    CHECK => No file is served
    3) Apply this patch
    4) restart_all
    5) Repeat step 2.
    SUCCESS => File is served!
    6) Sign off
    
    Sponsored-by: Theke Solutions
    Signed-off-by: Arthur Suzuki <arthur.suzuki@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0cca2795cdae643a6a94b95ad7879c363006cfed
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 2 15:51:30 2019 -0300

    Bug 22834: Add Koha::Plugins::Base->bundle_path
    
    This patch adds a 'bundle_path' method that return the base path for
    assets included in the plugin. The idea is that it will be used for
    calculation of the absolute path in the filesystem for static content.
    
    To test:
    - Apply the unit tests patch
    - Run:
      $ kshell
     k$ prove t/db_dependent/Plugins.t
    => FAIL: The method is not implemented
    - Apply this patch
    - Run:
     k$ prove t/db_dependent/Plugins.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Signed-off-by: Arthur Suzuki <arthur.suzuki@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4adb1791c66a3577d32f10c417e4953a86f5769f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 2 15:51:17 2019 -0300

    Bug 22834: Add tests for Koha::Plugins::Base->bundle_path
    
    Signed-off-by: Arthur Suzuki <arthur.suzuki@biblibre.com>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c13eb384b3db124611bbe1c8d49df3017bfe86f9
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jun 18 17:23:15 2019 +0100

    Bug 21073: DBRev 19.06.00.006
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3175eebdfcb9a8bd0c7fa3cfd456e928c081976f
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jun 17 08:18:48 2019 -0300

    Bug 21073: (QA follow-up) Avoid unnecessary unless/else construct
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0bdb41bf1a7aaec3cbcde969527113b59b72144a
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jun 17 08:17:43 2019 -0300

    Bug 21073: (QA follow-up) Don't call -> twice!
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 493292b36c1513a90415d144ec72c10e36ff7968
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jun 17 08:07:03 2019 -0300

    Bug 21073: (QA follow-up) Simplify logic
    
    This patch simplifies the logic inside GetPlugins so:
    - It uses Koha::Plugins::Methods instead of plain SQL
    - It doesn't do more DB calls than needed, by filtering on method in the
      initial query to Koha::Plugins::Methods.
    
    It also relies on the (newly introduced) ->is_enabled method in
    Koha::Plugins::Base, for better readability.
    
    To test:
    - Run the tests and notice no behaviour changes are introduced.
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 22aa6ecd478c1c5a08eecb2780f5c0b1b7589b99
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Mon Jun 17 08:06:23 2019 -0300

    Bug 21073: (QA follow-up) Add ->is_enabled and tests
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 81186ea2696dd23f37e539cc25b73e6355ffddc0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jun 14 16:51:07 2019 -0300

    Bug 21073: (QA follow-up) Only public subs should be considered
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f380a06cb99c99f74c3475a3b93f18ca9883a8b1
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Fri Jun 14 16:38:15 2019 -0300

    Bug 21073: (follow-up) Add Class::Inspector to PerlDependencies
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 50bdd416e68e76c573932b01ea97e4b241171d87
Author: Agustín Moyano <agustinmoyano@theke.io>
Date:   Wed May 15 20:49:08 2019 -0300

    Bug 21073: (follow-up) QA fixes after rebase
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a080ffdf76bf3056f0c422d632f87bb2b8a92d92
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 2 13:15:49 2019 -0300

    Bug 21073: Restore filtering by metadata
    
    This patch restores filtering the plugins by metadata. That got lost on
    rebase at some point. Regression tests are added on a prior patch.
    
    To test:
    - Have the 'regression tests for GetPlugins' patch applied
    - Run:
      $ kshell
     k$ prove t/db_dependent/Plugins.t
    => FAIL: Tests fail!
    - Apply this patch
    - Run:
     k$ prove t/db_dependent/Plugins.t
    => SUCCESS: Tests pass!
    - Sign off :-D
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e42b571269dfb737ec7184f67ff95b7a6ff3a692
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 2 14:00:52 2019 -0300

    Bug 21073: Regression tests for GetPlugins
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b4088b93a4fc26b442d43eafad98025ca11441d0
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 2 12:12:10 2019 -0300

    Bug 21073: (QA follow-up) Remove unused libraries
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 96c0c7d0bd7326809de4929e52b6c98c525e8cff
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 2 12:14:50 2019 -0300

    Bug 21073: (QA follow-up) Restore check on template
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3f16d3b8e5d9f5deed2705d2de684b2e5850e210
Author: Tomás Cohen Arazi <tomascohen@theke.io>
Date:   Thu May 2 11:42:18 2019 -0300

    Bug 21073: (QA follow-up) Atomic update shouldn't fail if plugins are disabled
    
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2270ab4056972b669ab24189979924a0243fa282
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Apr 22 09:58:18 2019 -0400

    Bug 21073: Upgrade the kitchen sink plugin to get rid of warnings
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9d81b1dd7ad1bb2957630e1ec40d636d8839bb16
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jul 13 12:40:52 2018 -0400

    Bug 21073: Improve plugin performance
    
    Right now, to check if a plugin is functional and what methods it exposes we load the module and test for a given method at run time. This is highly inefficient. It makes far more sense to do this at install time and store the data in the db. I believe we should store a table of methods that each plugin exposes and check that instead. Then, at install time we can test that a) the plugin can be loaded and b) add the available methods to the plugin_methods table.
    
    Test Plan:
    1) Apply this patch
    2) Restart all the things
    3) Run updatedatabase.pl
    4) Verify you can use existing plugins
    5) Verify you can install new plugins
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1ed59cbe5565ca493702691d3a8811f4ebc4da17
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Fri Jul 13 08:55:32 2018 -0400

    Bug 21073: Add new table, schema and classes
    
    Signed-off-by: Agustin Moyano <agustinmoyano@theke.io>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Kyle M Hall <kyle@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6dd40712c1c20af3408c50546d9b97560082ce2c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Jun 14 12:33:08 2019 +0100

    Bug 22210: (QA follow-up) Tiny gramatical correction
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a7513c0dc69f3a9bff55c77495389cb73be50965
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu May 16 18:07:12 2019 +0200

    Bug 22210: Mana config - Replace firstname and lastname with name
    
    I've applied a patch on Mana test server. If you want to
    test with your own Mana instance, do the folowing:
      - checkout bug/22210 branch from
        http://git.biblibre.com/biblibre/koha-mana.git
      - run these sql queries on Mana database (we need an update DB method
        i think):
        - ALTER TABLE librarian ADD COLUMN name VARCHAR(50) AFTER email
        - UPDATE librarian SET name = (SELECT CONCAT(firstname, ' ',
          lastname))
        - ALTER TABLE librarian DROP COLUMN firstname
        - ALTER TABLE librarian DROP COLUMN lastname
    
    Test plan
      - set mana_config to "https://mana-test.koha-community.org",
      - go to admin > Share content with Mana KB,
      - set "Use Mana KB for sharing content" to yes,
      - save,
      - in the 2nd fieldset, enter a name and email,
      - click on send to Mana KB,
      - check that you got a token,
      - you should receive an email (Mana KB registration)
      - check the name is correct
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7b0dbb136310028e756f22b73745dbd9c542a271
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 14 12:02:25 2019 +0000

    Bug 23120: Pass necessary inputs through when transferring item automatically
    
    To test:
     1 - Find an item in you system
     2 - Have syspref  AutomaticItemReturn = Do
     3 - Check in the item at a branch that is not its homebranch
     4 - Click 'Print slip' on the modal popup
     5 - Error!
     6 - Apply patch
     7 - Check the item in at its homebranch (to clear transfers)
     8 - Check it in at another branch again
     9 - Print slip
    10 - Success!
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1efe0d4606f844c28e2524d0341779381fc4980b
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 21 12:07:10 2019 +0000

    Bug 22945: Markup error in OPAC search results around lists display
    
    This patch makes minor corrections to the template for OPAC search
    results. These corrections fix errors returned by the HTML validator.
    
    To reproduce the problem, perform a search in the OPAC which will return
    results which are on one or more lists. Run the page through the W3C
    validation service: https://validator.w3.org. Either by pasting in the
    URL for the search results (if web accessible) or by viewing source,
    copying, and pasting into "Validate by Direct Input."
    
    This patch addresses two specific errors:
    
     - "Text not allowed in element ul in this context."
     - "Stray end tag span."
    
    To test, apply the patch and try again to reproduce the validation
    errors. Those errors should no longer be present. There should be no
    visible change to the search results view.
    
    Signed-off-by: Lucas Gass <lucas@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit cc26fefeebc7ad5af08a087d6dd57c1eb9a6d5b4
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Mon Jun 17 14:59:03 2019 +0000

    Bug 22783: (follow up) not SET for anonymous BLOCK
    
    Fixed syntax.
    http://www.template-toolkit.org/docs/manual/Directives.html#section_BLOCK
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b86766a3e2148582a2c191e168ad4a65e5d8d0be
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Fri Apr 26 14:52:39 2019 +0100

    Bug 22783: Make 'OPAC News' string translatable
    
    The idea was to use an anonymous block
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 42a26a758079830758a51845b4526e681b75d434
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Thu Jun 13 19:27:00 2019 +0000

    Bug 17526: Change grep to deal with malformed sortfield
    
    Giving sortfield a malformed value when viewing lists results in
    Internal Server Error.
    
    eg.
    http://localhost:8080/cgi-bin/koha/opac-shelves.pl?op=view&shelfnumber=1&sortfield=title(
    
    Note the trailing (
    
    Before Patch: kaboom
    apply patch
    restart
    After Patch: No kaboom
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6a75f99200f6659d09e46ce9e11c5ded11020d89
Author: Mark Tompsett <mtompset@hotmail.com>
Date:   Mon Jun 17 13:54:39 2019 +0000

    Bug 23104: (follow-up) fix display for 0/Unlimited
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5b7e563f4e923bb5cf9f6b1f6ecef3bdc8b77f52
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jun 13 11:28:40 2019 -0500

    Bug 23104: Add tests for maxonsiteissueqty
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8c8e36cf7abf51113654c5e1c0497f918a1cd56c
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 12 09:12:27 2019 -0500

    Bug 23104: (bug 18925 follow-up): Fix null/empty behavior, again
    
    Not kidding, it's again, and will certainly appear more.
    The problem is that we should have a NULL value in DB to make things
    more readable and logical. Now we need a quick fix.
    
    Test plan:
    Set "Current checkouts allowed" to unlimited (empty string)
    Try to check an item out
    => Without this patch we are blocked with a "too many" message
    => With this patch applied the correct behavior is back!
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1521a5567ea17c8adf5339249251bb275b5109de
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 12 09:12:23 2019 -0500

    Bug 23104: Add tests
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a45eb6082bb99973b6c56600acdcbf41529ac2f3
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 17 16:53:17 2019 +0100

    Revert "Bug 23075: Better error handling in Mana config"
    
    This reverts commit adb30fb8a0347ab6ff391238a8bd1ce4b6931fcd.
    
    We missed some cases that means this handling was throwing out perfectly
    accepable requests.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a3cf29c5f714b5888718885f5a0cf2576a6cb5be
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 17 08:30:13 2019 +0100

    Bug 10215: (RM follow-up) Rebuid DBIC classes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e865b181b3a2448b23c5cca60c2c25063ca4a8fe
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 17 08:26:44 2019 +0100

    Bug 9834: (RM follow-up) Rebuild DBIC classes
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 62ae7ac7275329f6396d656a216ffc95b4f9494a
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jun 13 11:06:29 2019 -0500

    Bug 23117: Shortcut additem.pl on nonexistent biblionumber
    
    To prevent additem.pl to crash when called with a nonexistent
    biblionumber we are here implementing the blocking_error.inc trick to
    display a friendly message instead.
    
    Can't call method "fields" on an undefined value at
    /home/vagrant/kohaclone/cataloguing/additem.pl line 736.
    
    Test plan:
    hit
    /cataloguing/additem.pl?biblionumber=
    /cataloguing/additem.pl?biblionumber=424242
    You will get a friendly "Bibliographic record not found." message,
    instead of a 500
    
    Signed-off-by: Bin Wen <bin.wen@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 001d433b427731a6efd55208ac3169107c830730
Author: Fridolin Somers <fridolin.somers@biblibre.com>
Date:   Wed May 29 15:20:41 2019 +0200

    Bug 21534: Always compute wildcards
    
    You get no results when searching with an hyphen + with * in query string (or with preference QueryAutoTruncate) :
    ie /cgi-bin/koha/opac-search.pl?q=saints-anges*
    
    Looks like query-string by default does not compute wildcards, see analyze_wildcard in :
    https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html
    
    Test plan :
    1) Use Elasticsearch
    2) Create a record with "saints-anges"
    3) Search for "saints-anges" => you get results
    4) Search for "saints-anges*" => you get results
    5) Search for "saints-ang*" => you get results
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Arthur Bousquet <arthur.bousquet@inlibro.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d2dc504ec1d87b74ea424d27462a214e7027385c
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Sat Jun 15 07:58:29 2019 +0100

    Bug 9834: DBRev 19.06.00.005
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fd5d274d3a351e70ed2008dccaf9b40905910390
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jun 6 14:50:05 2019 -0500

    Bug 9834: Preserve biblio level hold preference on reverting waiting status
    
    When the waiting status of a hold is revert we want to preserve the
    level hold preference of the user.
    
    Test plan:
    Place a hold at biblio level
    Confirm the hold
    Revert the waiting hold
    
    => The hold must still be considered as a biblio level hold ("next
    available item")
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3820d708a6e3b0a4920f96937fbfdcfaf5ee4d92
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jun 6 14:49:43 2019 -0500

    Bug 9834: Add tests
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1171a20d05db2d7c66f9294863146becc938d6c3
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu Jun 6 14:49:18 2019 -0500

    Bug 9834: Add DB changes
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 0e8a95b4bdcde76646ad3a45a2022d82e6da277e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Sat Jun 15 07:55:35 2019 +0100

    Bug 22358: (RM follow-up) Typo fix
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a72feaa40cbcf34f8f77ecac58ca6b269e9b95c9
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 14 17:40:52 2019 +0000

    Bug 22358: (QA follow-up) Clear up phrasing
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 5438355b1d016b2699ea2efc5367eaa8d807496d
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Thu Jun 6 12:00:22 2019 +0200

    Bug 22358: fix POD header and typo
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c6540d1b72d45b2682860fc50716b0d74e3f5e2c
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Wed Mar 13 15:14:31 2019 +0100

    Bug 22358: Add POD to Koha::SharedContent
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 77716188757d11e2a9fa79788ce99982e3c39839
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Jun 5 19:11:59 2019 -0500

    Bug 23022: Remove the SQl mode NO_AUTO_CREATE_USER
    
    To make our sql mode list compatible with MySQL 8.0.11
    
    NO_AUTO_CREATE_USER has been removed in MySQL 8.0.11
    https://dev.mysql.com/doc/relnotes/mysql/8.0/en/news-8-0-11.html
    
    I do not think we needed it.
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit adb30fb8a0347ab6ff391238a8bd1ce4b6931fcd
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 8 13:57:05 2019 -0500

    Bug 23075: Better error handling in Mana config
    
    Currently, if you input an incorrect mana service URL in your config
    (http rather than https for example) the error message you are given is
    the direct output of a failed json parse.  We should be able to catch
    such failures and display a more meaningful error to the end user.
    
    This patch makes it display a more friendly message.
    
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4452273669c98bcbaf409dc653d01d5596ca415a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Sat Jun 15 07:50:43 2019 +0100

    Bug 22770: DBRev 19.06.00.004
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit eba980b3519263856c725cd42d4ff151d7822205
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Jun 2 10:48:00 2019 +0200

    Bug 22770: Fix typo in German language description of el
    
    Fixes:
    Griechisch (Moern [1453- ] ==> Griechisch (Modern 1453-)
    
    To test:
    - Install de-DE language and activate it
    - Check the language pull down on advanced search has the typo
    - Apply patch and run database update
    - Check advanced search again
    - Verify the description now shows correctly
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f8db499f4a9c71e7a2ffef0fadaecddb938330d4
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 8 14:45:33 2019 -0500

    Bug 22941: Do not return 500 if sortfield contain parenthesis
    
    Test plan:
    Hit /virtualshelves/shelves.pl?op=view&shelfnumber=1&sortfield=author(
    
    You must not get:
    Unmatched ( in regex; marked by <-- HERE in m/^author( <-- HERE $/ at /home/vagrant/kohaclone/virtualshelves/shelves.pl line 236
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ef0c31f735cf68a3b004c706e274ede4bb883940
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jun 12 12:39:29 2019 +0000

    Bug 23053: [follow-up] Same changes for UNIMARC
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 510cf514a342cb9062d1c51cdf1d41b6772ad90a
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jun 13 13:08:58 2019 +0100

    Bug 21662: (RM follow-up) Final followup corrections to history
    
    Minor update to ensure we're using commit dates and not author dates
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2a3454b4b28596c7b49224a75d02ec97a7b815a7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jun 13 13:05:32 2019 +0100

    Bug 22585: Add Justin Rittenhouse to contributors
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ad9338e419ee04c38f5e7fdc918ce1a4d177cee0
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Wed Apr 3 21:47:09 2019 +0200

    Bug 22633: Link barcodes in hold summary in patron account to moredetail page
    
    Bug 21070 links the barcode on holds to the item on moredetail.pl.
    This patch makes the same change to the hold lists in the staff
    patron account.
    
    To test:
    - Create some holds, have at least
      - one item level hold
      - one hold waiting for pick-up
    - Take a look at the details and checkouts tabs
      in the patron account on staff side
    - Verify that the barcodes link to the record detail page
    - Apply patch
    - Verify the barcodes now link to the moredetail page
    
    Signed-off-by: Axel Amghar <axel.amghar@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b2be5b0c65ddf992e451e5b8c12cf0994038186e
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Sat Jun 8 13:29:24 2019 -0500

    Bug 23065: Rename "New subscription" button when default to current serial
    
    To make it explicite that the "New subscription" button will create a
    subscription based on the current serial it is now labeled "New
    subscription for this serial"
    
    Test plan:
    1 - Go to Serials module in Koha
    2 - Click 'New subscription'
    3 - You get a blank form
    4 - Fill it out, save it
    5 - You are viewing the subscription you created
    => The button is now labeled "New subscription for this serial"
    
    Signed-off-by: Michal Denar <black23@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 93c9b5d553261acda55f1f29f8687c5f4c276e04
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue Mar 5 18:56:55 2019 +0000

    Bug 7890: Highlight required field in MARC editor
    
    This patch modifies the basic MARC editor so that required fields have
    the standard "Required" label on them instead of a small red asterisk.
    
    To test, apply the patch and create a new record in the basic MARC
    editor. Tags which are marked mandatory in your selected MARC
    bibliographic framework should be labeled "Required."
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 15dcde21fe9b34d287844aab75426e6387c7b4cf
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jun 10 13:42:18 2019 +0000

    Bug 22585: (follow-up) Fix additional occurences
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a3e047f638ac7e6095d56c064f0e6cb8038a8524
Author: Justin Rittenhouse <jrittenh@nd.edu>
Date:   Fri May 31 16:37:11 2019 +0000

    Bug 22585: remove double-escape for CAS URL
    
    The return URL that is part of the link to CAS login is double-escaped on the staff login page.
    
    It appears that this is the same issue as bug 21973 but in the staff intranet template.  I have attached an identical patch for the intranet auth.tt file.
    
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 7d7c8c12e70295f4dd15a3435235c81539c333f5
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu Jun 16 11:08:59 2016 +0000

    Bug 16750: Redirect from selectbranchprinter.pl to additem.pl causes software error
    
    How to reproduce:
    1) Edit and save an item in the items editor
    2) You should be redirected back to the items editor, note that the
    biblionumber is passed in the url
    3) Choose "set library" from the upper right hand pulldown on the page
    4) Choose a different library, click submit
    5) You should get the error message:
    Software error:
    
    Can't call method "fields" on an undefined value at
    /home/vagrant/kohaclone/cataloguing/additem.pl line 736.
    
    Test Plan:
    1) Apply this patch
    2) Follow plan above
    3) No software error should occur at step 5
    
    Signed-off-by: Marc Véron <veron@veron.ch>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ac41566cddb737c19282bc577cf31882f168384b
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Mon Jun 10 13:34:18 2019 +0000

    Bug 14794: (follow-up) Add tooltip to filter box
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 07d6e9f142a588f26c52582d9b5d99b714fa1fd7
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Fri Jun 7 14:53:16 2019 +0000

    Bug 14794: Display JS tooltip whenever dateofbirth is being searched
    
    This updates the code that adds a tooltip for the correct date format
    to display after the initial search
    
    To test:
    1 - Do a patron search, choosing date of birth as the search field
    2 - Note on choosing that field you get a tooltip defining the format
    3 - Do a search
    4 - Note tooltip is gone, but date fo birth is still selected as the field to search
    5 - Apply patch, reload
    6 - Note tooltip shows after initial search and until field is changed
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3de89b98ce373818c4b6f5a0a90b8786996e6cfe
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 11 10:44:25 2019 -0500

    Bug 23095: Correctly display circulation rules (0 vs undef)
    
    From the following commit:
      commit d1303ca834dd0b08fc1d44476cfbbb8b729b6165
      Bug 18925: (follow-up) Fix null/empty behavior
    
    The global test must have been adjusted as well to catch empty strings.
    
    Actually we are expecting the plugin to return undef but the template variable contains an empty string.
    
    So the test should only be [% IF var != '' %] instead of [% IF var.defined && var != '' %]
    but I prefer to keep it as it for now.
    
    Test plan:
    In the section "Default checkout, hold policy by patron category"
    Set total checkouts = blank
        total on-site checkouts = blank
        total holds = 0
    Save
    => Without this patch the line will not appear
    => With this patch applied there must be "unlimited, unlimited, 0"
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Tomas Cohen Arazi <tomascohen@theke.io>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 18f2074f8df8598527ae8e126c4efc7f3be000e0
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Tue Jun 11 09:24:28 2019 -0500

    Bug 23093: (bug 22318 follow-up) Use placeholders in query moving OpacNavRight
    
    Placeholders must be used (!) in all SQL queries.
    
    Test plan:
    1/ % git checkout 0c95e22afe13349b60d134217fce6718bfa9727f # commit before bug 22318
    2/ Edit the pref OpacNavRight with something with "
      just a " and more '
    3/ git checkout master
    4/ restart_all
    5/ run updatedatabase.pl
    => Boom and the content of the pref has been lost
    6/ Repeat 1 to 3
    7/ Apply this patch
    8/ run updatedatabase.pl
    => The pref has been correctly moved to opac_news
    
    Signed-off-by: Mark Tompsett <mtompset@hotmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 39e4c6c5d791853985773e4032357372f77d7587
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon Mar 11 08:33:13 2019 +0000

    Bug 13094: Make it easy to hide 'Cancel all' button on holds over report
    
    This patch makes some small modifications to the 'Holds awaiting pickup'
    report:
    
    - Fixes typo sypref
    - Fixes 'Home branch' to 'Home library'
    - Adds a span to easily hide the cancel all button with CSS
    
    To test:
    - Make sure you have a hold appearing on the awaiting pickup list
      second tab: Holds waiting over...
    - Verify the 'cancel all' button on top shows
    - Verify syspref and Home library changes mentioned above
    - Add #holdsover-cancel-all { display:none; } to IntrentUserCSS
    - Verify that the button and the text have vanished
    
    Note: If the text doesn't display next to the button, try toggling
          the TransferWhenCancelAllWaitingHolds system preference.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 60e24be115539daedc4172099eec9cc5dd5bc813
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Mon Mar 25 13:55:43 2019 -0400

    Bug 18344: Add unit tests
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e702ff89f77e50b1bcef1cdc1548627957251df0
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue Mar 28 11:05:28 2017 +0000

    Bug 18344: Allow overdue fines cap at replacement price, and cap by amount to work together
    
    There is no reason that a library shouldn't be able to use the monetary
    fines cap and the replacement price cap at the same time. The code is
    written in such a way that they already work harmoniously. We have
    librarians who wish to use both so they can set a high cap of $10.00 but
    also use the replacement price cap so that a $20.00 book would only get
    a fine of $10.00, but a $5.00 paperback will only get a fine of $5.00
    
    Test Plan:
    1) Apply this patch
    2) Create a rule with a fines cap of $10, *and* a cap at replacement price, and a daily fine of $1
    3) Create two items, one with a replacement price of $5 and one with a
       replacement price of $15
    4) Check out these items to a patron, backdate the checkouts so they are
       already overdue by a couple months
    5) Check the items in ( make sure calc fine at checkin is enabled for
        you )
    6) Note the one item has a fine of $5 and the other has a fine of $10!
    
    Signed-off-by: David Kuhn <techservspec@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2e8a6a4b097f7ed7bb33efe819693752abba33cb
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Wed Jun 5 13:55:10 2019 +0000

    Bug 23053: Add phrase index to authority Local-Number
    
    To test:
     1 - Define a matching rule for authorities on field 001 index Local-Number
     2 - In koha-conf.xml raise the zebra_loglevels
         <zebra_loglevels>none,fatal,warn,request,info</zebra_loglevels>
     3 - Export some authorities using the tools->export data
     4 - Import those authorities
     5 - Note no matches found
     6 - View the zebra output log, you should see lots of error 114
     7 - Apply patch
     8 - Copy the indexdefs files to the installed versions
     9 - Reapply matchign rules to staged files
    10 - Matches should now be found
    11 - Logs should not have errors
    
    Signed-off-by: Claire Gravely <claire.gravely@bsz-bw.de>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 82dcb5cf546c881af0003c272d9326e12fb5f1ce
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Fri Jun 7 12:10:01 2019 +0000

    Bug 23076: Include OpacUserJS on OPAC maintenance page
    
    This patch coverts the syntax for embedding OpacUserJS in the global
    include file so that it uses 'Koha.Preference' syntax. This makes the
    data available in templates, like the OPAC maintenance page, to which
    the preference data has not been explicitly provided.
    
    To reproduce: Add some JavaScript to the OPACUserJS system preference
    which will let you know it's working. For instance:
    
    alert("OPACUserJS!");
    
    Turn on the OPAC maintenance message using the OpacMaintenance system
    preference. Navigate to the OPAC. You should see the system maintenance
    page but you should not see an alert.
    
    To test, apply the patch and reload the OPAC page. Your alert should
    show.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: David Nind <david@davidnind.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 88cfa94ea4fbbc4c264695bc77a1c72cee0aefda
Author: Pasi Kallinen <pasi.kallinen@koha-suomi.fi>
Date:   Fri Jun 7 09:44:32 2019 +0300

    Bug 23074: Holds table sort does not understand dateformat
    
    Holds table does not sort correctly when the dateformat is eg. DD.MM.YYYY.
    
    Test plan:
    1) Create multiple holds for a patron with different hold creation
       and expiration dates, with different years, months and days.
    2) Change the dateformat to DD.MM.YYYY.
    3) Resort the holds table (in circ/circulation or members/moremember)
       by the hold date or expiration date.
       The table sorts the date by the day number.
    4) Apply patch
    5) Redo 3 - the table now sorts correctly.
    
    Signed-off-by: Pasi Kallinen <pasi.kallinen@koha-suomi.fi>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Arthur Bousquet <arthur.bousquet@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8427b684148944b9306fd4786c75c53527037024
Author: Alex Arnaud <alex.arnaud@biblibre.com>
Date:   Fri Jun 7 10:18:05 2019 +0200

    Bug 22915: fix Mana URL in etc/koha-conf.xml
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e90086fe78dcf6d2aad590f30cb81f255f4104d7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jun 6 17:27:42 2019 +0100

    Revert "Bug 22867: (QA follow-up) Build items.json for UniqueItemFields"
    
    This reverts commit b97acab4d368ccbced7d99b21fdf371f8c51f1ba which
    should have really been attached to bug 22844 and the dependancies
    reversed.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 33660ea283a007b668d9f230994be1869b0ac629
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jun 6 16:07:39 2019 +0100

    Bug 22867: DBRev 19.06.00.003
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a268487d4e52fea538b9bbe6d2f0efad2fda50a1
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Mon May 13 08:39:05 2019 -0500

    Bug 22867: Update the syspref's description in sysprefs.sql
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b97acab4d368ccbced7d99b21fdf371f8c51f1ba
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Fri May 10 08:49:26 2019 +0000

    Bug 22867: (QA follow-up) Build items.json for UniqueItemFields
    
    Adding items.json, built from latest kohastructure.sql.
    Control UniqueItemFields with this source file.
    And add StatisticsFields.
    
    Test plan:
    Go to Preferences, play with UniqueItemFields.
    Adjust StatisticsFields and look at patron record, statistics tab.
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8c3890462750eb2b874da8afbd0e4899b11e3c42
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed May 8 13:21:24 2019 +0000

    Bug 22867: UniqueItemFields preference value should be pipe-delimited
    
    This patch updates the UniqueItemFields system preference so that it
    contains pipe-delimited data instead of space-delimited data. This makes
    it consistent with other system preferences which contain lists of
    database column names, and enables the selection process provided by Bug
    22844.
    
    This patch includes a database update to convert space-delimited values
    in UniqueItemFields to pipe-delimited.
    
    To test you should have two or more space-delimited items table columns
    saved in the UniqueItemFields system preference. Apply the patch and run
    the database update.
    
     - Go to Administration -> System preferences -> Acquisitions and
       confirm that the value of UniqueItemFields is now pipe-delimited.
     - Set the AcqCreateItem system preference to "placing an order."
     - Go to Acquisitions -> Vendor -> Basket -> Add to basket -> From a new
       (empty) record.
       - Fill out the item add form, including those fields specified in
         UniqueItemFields.
       - Click the "Add multiple items" button and specify one or more
         items.
       - Click "Add" and verify that in the table of items added, the fields
         specified in UniqueItemFields were not duplicated.
       - Edit one or more of those items and add duplicate values to one or
         more of the fields specified in UniqueItemFields.
       - Click "Save" and confirm that you are presented with an error
         highlighting the duplicated data.
       - Correct the data to remove the duplicates and click "Save" again.
         It should save correctly.
    
      - Set the AcqCreateItem system preference to "receiving an order."
      - Repeat the test above during the process of receiving an order.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f3358e97c8a1f9edf1c4de6dea46f70366237699
Author: Pasi Kallinen <pasi.kallinen@koha-suomi.fi>
Date:   Wed May 29 09:20:43 2019 +0300

    Bug 22910: Do not copy unique patron attributes to duplicated patron
    
    When creating a new patron by duplicating another, all of the patron
    attributes are also copied into the form. Some of those value may be
    unique, so don't copy those.
    
    1) Create patron attribute types, one with "unique identifier", one without.
    2) Create or a patron so it has values in both of those attributes.
    3) Duplicate the patron
    4) The edit form should retain the values from the "original" patron.
    5) Apply patch.
    6) Duplicate the patron - this time the attributes with unique values
       are cleared.
    
    Signed-off-by: Pasi Kallinen <pasi.kallinen@koha-suomi.fi>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 65de22a6ef928bd6074e9a4d6a1e1351d0e1de9b
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Thu Sep 27 19:49:27 2018 +0200

    Bug 20986: (follow-up) Avoid br tags, but allow for line breaks to be added easily with CSS
    
    This patch removes the br tags from the XSLT in favor of some more
    spans and classes.
    
    This will allow to add the line breaks with one line of CSS:
    span.holdings_note_data { display:block; }
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c23276324c4da519130f35cb7c471402965b3e1b
Author: Joy Nelson <joy@bywatersolutions.com>
Date:   Fri Jun 22 15:22:40 2018 -0700

    Bug 20986: Add 867 and 868 holdings display
    
    Add line breaks in the 866 Holdings display in the OPAC details and Staff details page.  Add 867 and 868 textual holdings with line breaks in the OPAC and Staff details display.
    
    Signed-off-by: Ed Veal <eveal@mckinneytexas.org>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 6d046c2e3d301a7e1d37b376b49a0db516e67bda
Author: Liz Rea <wizzyrea@gmail.com>
Date:   Thu May 9 02:02:55 2019 +0000

    Bug 8558: (QA follow-up) a little more text clean up
    
    You can take or leave it, honestly, I just thought
    we could be a little more explicit about what we were overwriting.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e4d1318550af78f76b7a43757bbdc4c5bddb4d5f
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Mon Apr 29 03:30:30 2019 +0000

    Bug 8558: Improve confirmation message for importing frameworks
    
    This patch updates the confirmation message from:
    "Do you really want to import the framework fields and subfields? This
    will overwrite the current configuration. For safety reasons please use
    the export option to make a backup"
    to:
    "Are you sure you want to import the [% frameworkcode %]
    framework structure? This will overwrite the current configuration. For
    safety reasons, it is recommended to use the export option to make a
    backup first."
    
    To test:
    1) Go to Administration -> MARC bibliographic frameworks
    2) Export one of the frameworks
    3) Create a new test framework
    4) Import the new test framework structure using the exported file
    5) Upon clicking Confirm, confirm the message is improved and makes
    sense.
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit c3346b50bd00778c2e8364b40a7dd7a891c713b4
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu Jun 6 15:32:14 2019 +0100

    Bug 10215: DBRev 19.06.00.002
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 117061d88420231d709515f4702446e60f7de4b6
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jun 5 12:58:20 2019 +0100

    Bug 10215: (follow-up) Fix the failing test
    
    We now handle NULL values at the database end and do not expect empty
    strings.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9713e13893c9f2d2b12cea29b23b72a25170462e
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Wed Jun 5 12:54:30 2019 +0100

    Bug 10215: (follow-up) Correct existing data
    
    This patch adds the correction of data ('' => NULL) during the DB
    update.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 8592474c3fe6af408c7265a50bd1776a76942397
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 7 12:49:03 2013 -0400

    Bug 10215: Increase the size of opacnote and librariannote for table subscriptionhistory
    
    We have librarians that are regularly hitting the maximum number of
    characters for the note fields in subscription history. They would like
    to be able to store at least 1000 characters here. Converting the
    varchar(150) to text should do it.
    
    Test Plan:
    1) Apply this patch
    2) Run updatedatabase.pl
    3) Add public and private notes to a subscription history entry
       where each note is greater than 150 characters.
    4) Save and view the notes, the notes should not be truncated.
    
    Rescued-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Owen Leonard <oleonard@myacpl.org>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 703ec1e2f24345146c997398b9c0cc492016455d
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Thu May 30 09:36:31 2019 -0500

    Bug 22919: Fix insert of authorities_normal_marc21.sql with strict SQL modes
    
    If strict SQL modes are set, the insert of authorities_normal_marc21.sql
    will fail.
    
    Test plan:
    DELETE FROM auth_subfield_structure;
    DELETE FROM auth_tag_structure;
    DELETE FROM auth_types;
    SET sql_mode = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION';
    source /home/vagrant/kohaclone/installer/data/mysql/en/marcflavour/marc21/mandatory/authorities_normal_marc21.sql
    
    You should not see any errors.
    Without this patch you see:
    ERROR 1366 (22007) at line 280 in file:
    '/home/vagrant/kohaclone/installer/data/mysql/en/marcflavour/marc21/mandatory/authorities_normal_marc21.sql':
    Incorrect integer value: ' for column 'linkid' at row 148
    '
    
    Signed-off-by: nabila <lovenabila@gmail.com>
    Signed-off-by: Nick Clemens <nick@bywatersolutions.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 3f93acbc6c0344151da794a73476de1f91000502
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Jun 2 08:58:50 2019 +0000

    Bug 22958: Fix help link on the SMS providers page
    
    The help link on the SMS providers page didn't link to the
    according chapter in the manual.
    
    To test:
    - Enter Email in SMSSendDriver system preference to
      make the configuration page appear
    - Go to Administration > SMS cellular providers
    - Click on the help link
    - Verify it leads to the manual start page
    - Apply patch
    - Repeat and verify the link now leads to the correct
      section in the manual
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e825751cda6a920aa2455908970a3f8e85c1a4e8
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Fri May 31 11:41:22 2019 -0500

    Bug 23027: Make Suggestions.t pass even if no biblio in DB
    
    There are biblionumbers 1 and 2 hardcoded
    
    Test plan:
    MariaDB [koha_kohadev]> delete from biblioitems; delete from items; delete from biblio;
    % prove t/db_dependent/Suggestions.t
    Must return green with this patch applied
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f417c15e499745a7cd35fd1c8c5ae79888857199
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Tue May 28 07:54:58 2019 -0400

    Bug 22982: (QA follow-up) Add behavior to Koha::Account::Line::apply and unit test
    
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 986629b29f8651a99f877444c69dec2838f513d8
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu May 23 14:14:06 2019 -0400

    Bug 22982: Add unit tests
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 20dde4cc4acf35ba9f5edc76c5271198217994e6
Author: Kyle M Hall <kyle@bywatersolutions.com>
Date:   Thu May 23 11:27:23 2019 -0400

    Bug 22982: Paying lost fee does not always remove lost item from checkouts
    
    Depending on how a lost fee is paid, it may or may not be removed from the
    patrons current checkouts. The current expected behavior is for the lost
    item to be removed from the patrons checkouts when the lost fee is paid in
    full.
    
    This is due to the subroutine for handling of lost fees being included in
    the 'pay specific lines' code but not in the 'pay by amount' code.
    
    Test Plan:
    1) Apply this patch
    2) prove t/db_dependent/Koha/Account.t
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 72d4b10bf4abcfc36a9f3bac263ad182b6512088
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 3 17:32:10 2019 +0100

    Bug 23037: Add Henry Bolshaw to contributors
    
    We missed Henry from the release notes and about page.. sorry Henry!
    
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Not really tested, just had a look and checked the changes look sane.
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 9a58871503caa1b48e4e5c3cc0f565fa583f3e9d
Author: Nazlı Çetin <nazli@devinim.com.tr>
Date:   Tue Nov 27 15:24:38 2018 +0000

    Bug 21887: (For OPAC) 856 link problem in XSLT result lists and detail page
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4903cee9e937c970c6d3d15fd78d82189d8705eb
Author: Nazlı Çetin <nazli@devinim.com.tr>
Date:   Tue Nov 27 14:15:33 2018 +0000

    Bug 21887: 856 link problem in XSLT result lists and detail page
    
    Signed-off-by: Nazlı Çetin <nazli@devinim.com.tr>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Chris Cormack <chrisc@catalyst.net.nz>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d5a8a424203cd426f7d0bd64597a6ac95536ef9c
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 21 16:59:38 2019 +0000

    Bug 22954: Minor markup error in OPAC messaging template
    
    This patch corrects a minor error in opac-messaging.tt in order to
    quiet errors returned by the HTML validator.
    
    To reproduce the problem you should have the
    EnhancedMessagingPreferencesOPAC  system preference enabled. Log in
    to the OPAC and go to the "your messaging" page. Run the page through
    the W3C validation service: https://validator.w3.org. Either by pasting
    in the URL for the search results (if web accessible) or by viewing
    source, copying, and pasting into "Validate by Direct Input."
    
    This patch addresses this error:
    
     - "Self-closing syntax (/>) used on a non-void HTML element. Ignoring
       the slash and treating as a start tag."
    
    To test, apply the patch and try again to reproduce the validation
    error. The error should no longer be present. There should be no
    visible change to the page.
    
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Arthur Bousquet <arthur.bousquet@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e72a9c91485c6e68819f3bb76d326f0a1a84dcd9
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 21 16:00:18 2019 +0000

    Bug 22952: Markup error in OPAC suggestions template
    
    This patch makes a minor correction to the OPAC suggestions template in
    order to quiet an error returned by the HTML validator.
    
    To reproduce the problem you should have the 'suggestion' system
    preference turned on, and you should be logged in to the OPAC as a user
    who has submitted one or more suggestions. View the "your purchase
    suggestions" page in the OPAC. Run the page through the W3C validation
    service: https://validator.w3.org. Either by pasting in the URL for the
    search results (if web accessible) or by viewing source, copying, and
    pasting into "Validate by Direct Input."
    
    This patch specifically addresses these errors:
    
     - "End tag div seen, but there were open elements."
     - "Unclosed element span."
    
    To test, apply the patch and try again to reproduce the validation
    errors. Those errors should no longer be present. There should be no
    visible change to the page.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Bin Wen <bin.wen@inlibro.com>
    Signed-off-by: Nadine Pierre <nadine.pierre@inLibro.com>
    Signed-off-by: Arthur Bousquet <arthur.bousquet@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a3da6d6825f686099d8e23a1abff061071d679ad
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 21 14:27:40 2019 +0000

    Bug 22948: Markup error in OPAC bibliographic detail template
    
    This patch addresses one markup problem in opac-detail.tt which triggers
    a validation error.
    
    To reproduce the problem, view the normal bibliographic detail page for
    a record in the OPAC. Run the page through the W3C validation service:
    https://validator.w3.org. Either by pasting in the URL for the search
    results (if web accessible) or by viewing source, copying, and pasting
    into "Validate by Direct Input."
    
    This patch addresses one specific error:
    
     - "The aria-labelledby attribute must point to an element in the same
       document."
    
    To test, apply the patch and try again to reproduce the validation
    errors. Those errors should no longer be present. There should be no
    visible change to the page.
    
    Test the "Save record -> Dublin Core" menu item. It should trigger a
    modal window.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Bin Wen <bin.wen@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4ae854242839ebe9871b65fe0add2241eb4ae0b7
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jun 4 10:06:46 2019 +0100

    Bug 22960: DBRev 19.06.00.001
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit f6f86a79d623ac478e2636e2d0cc2272006fe5f0
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Tue Jun 4 09:48:59 2019 +0100

    Bug 22960: (RM follow-up) Correct a further typo
    
    "This a list" changed to "This is a list"
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 76a64f8046af820b8be57fbc8d65483259a63f6c
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Sun Jun 2 09:18:00 2019 +0000

    Bug 22960: (QA follow-up) Fix another tiny typo
    
    This only seems to appear in the .pref file:
    
    ...pairs. the => ... pairs. The
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2b0347084ce8daa0a11ff4bdfd2e9f8442e65ffb
Author: Katrin Fischer <katrin.fischer.83@web.de>
Date:   Mon May 27 20:34:33 2019 +0000

    Bug 22960: Fix the same typo on db level for existing and new installations
    
    Seriously trying to kill the typo everywhere:
    - Check your DB with a report:
      select * from systempreferences where variable = 'UpdateItemLocationOnCheckin';
    - Verify the typo in the explanation column: locaiton
    - Apply patch and run database update
    - Verify the typo is fixed
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d5520510602c123d1ea8d7dc9a9d874995d200c3
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Wed May 22 12:23:47 2019 +0000

    Bug 22960: Typo found in circulation.pref in UpdateItemLocationOnCheckin preference
    
    This patch corrects a typo in circulation.pref in the description of the
    UpdateItemLocationOnCheckin preference.
    
    To see the problem, go to Administration -> System preferences ->
    Circulation and look at the description for the
    UpdateItemLocationOnCheckin preference:
    
    "The special term _BLANK_ may be used on either side of a value pair to
    update or remove the location from items with no locaiton assigned."
    
    Note the misspelling "locaiton."
    
    To test, apply the patch and refresh the circulation preferences page.
    The typo should be fixed.
    
    Signed-off-by: Bin Wen <bin.wen@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Josef Moravec <josef.moravec@gmail.com>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 851d41ab6b9ec28901086d6a6ce15b3fd589182a
Author: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
Date:   Wed May 29 13:46:15 2019 +0000

    Bug 23006: Cannot use inventory with barcodes containing special chars
    
    If a barcode contains special characters like $, the regex in inventory
    does no longer work.
    This fix (as suggested by Jonathan) replaces the regex by a eq compare.
    
    Test plan:
    Pick one barcode and add a $ somewhere in the middle, say 123$456.
    Include this barcode in a barcode file for inventory.
    Run inventory on that file and verify that barcode was read and datelastseen
    was updated. The barcode should not be reported as missing (not scanned).
    
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de>
    Signed-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit b40e58343ef65aabe0a575a0b3f842b5e22a3600
Author: Jonathan Druart <jonathan.druart@bugs.koha-community.org>
Date:   Wed Sep 12 09:38:39 2018 -0700

    Bug 19457: Handle 'PREVISSUE' return by CanBookBeIssued from SIP (CheckPrevCheckout)
    
    If CheckPrevCheckout is set to Do, then checkouts are blocked at the SIPServer
    
    To test:
    - Do not apply this patch
    - Set CheckPrevCheckout to "Do", or "Unless overridden, do"
    Verify the SIP server is blocking checkouts with this setting set
    - Apply this patch
    - Note that the checkout is now allowed, with a screen message telling
    the borrower they've issued the item before.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit ac423d5dcf2c7503a8ca78cbafdb94dfc43dfdb6
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Fri Dec 14 02:05:36 2018 +0000

    Bug 11492: (follow-up) Don't pass publisheddatetext param to NewIssue
    
    I have removed publisheddatetext as a param from my patch, but only in
    the places where my patch added it. Any other instance already existed
    before my patch.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 2c25016a8e17b52e23c3d9806264e141b6426254
Author: Aleisha Amohia <aleisha@catalystacademy.net.nz>
Date:   Fri Dec 7 01:03:42 2018 +0000

    Bug 11492: Keep routing notes when receiving next serial
    
    This patch ensures the routing notes are carried over when generating
    the next serial.
    
    To test:
    1) Create a routing list for a subscription
    2) Add a borrower and a note to the routing list
    3) Generate the next serial (serials-collection.pl)
    4) Edit the routing list to see the notes
    5) Note that the notes have disappeared
    6) Apply patch
    7) Edit the routing list, add a note
    8) Generate the next serial
    9) Edit the routing list and confirm the note is still there
    10) Confirm you are still able to edit serials (serials-edit.pl) and
    routing notes stay
    
    Sponsored-by: Plant and Food Research Limited
    Signed-off-by: Nazlı Çetin <nazli@devinim.com.tr>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 66877b780a775daf135ef1137364d76f67166e61
Author: Hayley Pelham <hayleymapley@catalyst.net.nz>
Date:   Thu Mar 21 14:39:59 2019 +1300

    Bug 22099: Fixed ILL toolbar to say Refresh when displaying requests
    
    On the ILL requests page that lists all requests, the List Request
    button is displayed as part of the ILL toolbar. This patch fixes this by
    instead changing the wording of the button to Refresh when on the main
    page.
    
    Test plan:
    1) More -> ILL Requests, note that the List Requests button displays
    while all the requests are already displayed
    2) Apply the patch and restart things
    3) More -> ILL Requests, note that the button now says Refresh, and
    clicking it refreshes the page
    4) Check that on all the other functions of the ILLs the button says
    List Requests
    5) Sign off!
    
    Sponsored-by: Catalyst IT
    Signed-off-by: Magnus Enger <magnus@libriotech.no>
    Small conflict resolved. Works as advertised.
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d26991cf4cc298fc3900b8133ff9b40cd061fb96
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 21 17:14:36 2019 +0000

    Bug 22955: Markup error in OPAC lists template
    
    This patch makes a minor correction to the template for OPAC lists.
    This correction fixes an error returned by the HTML validator by adding
    an empty "alt" attribute to an image tag.
    
    To reproduce the problem you should have at least one list available in
    the OPAC with one or more items on it. View the contents of that list in
    the OPAC. Run the page through the W3C validation service:
    https://validator.w3.org. Either by pasting in the URL for the search
    results (if web accessible) or by viewing source, copying, and pasting
    into "Validate by Direct Input."
    
    This patch addresses one specific error:
    
     - "An img element must have an alt attribute, except
        under certain conditions."
    
    To test, apply the patch and try again to reproduce the validation
    error. The error should no longer be present. There should be no
    visible change to the page.
    
    Click "Download list." A modal window should appear with a "Loading"
    message, followed by a form for selecting a download format.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 87cbb27826a9d03a424e8c944293669157924a01
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 21 13:19:17 2019 +0000

    Bug 22947: Markup error in OPAC preferences file
    
    This patch corrects a markup error in the OPAC .pref file which can
    cause display problems. The patch also corrects a validator warning by
    changing at <tt> to a <code>.
    
    To reproduce the problem, go to Administration -> Global system
    preferences -> OPAC.
    
    Run the page through the W3C validation service:
    https://validator.w3.org. Either by pasting in the URL for the search
    results (if web accessible) or by viewing source, copying, and pasting
    into "Validate by Direct Input."
    
    This patch addresses two specific errors:
    
     - "Unclosed element code."
     - "The tt element is obsolete. Use CSS instead."
    
    To test, apply the patch and try again to reproduce the validation
    errors. Those errors should no longer be present. There should be no
    visible change to the display.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 1653ae887103d783b91e00775f60e80041fd9860
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 3 18:46:40 2019 +0100

    Bug 22950: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 457000102e7e2228c6bd834283a9e58f32bb2104
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 21 15:04:33 2019 +0000

    Bug 22950: Markup error in OPAC recent comment template
    
    This patch makes minor corrections to the template for the OPAC's
    recent comments view. These corrections fix errors returned by the HTML
    validator.
    
    The patch moves some inline CSS into a class in the global OPAC CSS.
    Some minor reindentation has also been done, so use diff with the '-w'
    flag.
    
    To reproduce the problem you should have the 'reviewson' system
    preference turned on, and your system should have one or more
    approved comments. View the "Recent comments" page in the OPAC. Run the
    page through the W3C validation service: https://validator.w3.org.
    Either by pasting in the URL for the search results (if web accessible)
    or by viewing source, copying, and pasting into "Validate by Direct
    Input."
    
    This patch addresses one specific error:
    
     - "CSS: font-color: Property font-color doesn't exist."
    
    To test, apply the patch and rebuild the OPAC CSS
    (https://wiki.koha-community.org/wiki/Working_with_SCSS_in_the_OPAC_and_staff_client).
    
    Try again to reproduce the validation errors. Those errors should no
    longer be present. There should be no visible change to the page.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit fa411c2f80d3464c9205f49fc31de492bc265c57
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu May 9 16:34:09 2019 +0100

    Bug 22877: (QA follow-up) Clarify intent of tests and remove one.
    
    This patch embelishes the existing comments slightly and removes a test
    which had a FIXME, but was in fact just a duplicate of the test directly
    above it.  I beleive it became a duplicate after the subroutine signature
    changed at some point recently.  I also move the bug 22877 specific test
    into a subtest.
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 55289562468f77e6f6a2c1671d8a3ec472a50f99
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu May 9 16:00:59 2019 +0100

    Bug 22877: (follow-up) Fix test plan count
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit d1b6e320860060ffe35e7df7f3df1b8c10517a73
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Thu May 9 15:53:56 2019 +0100

    Bug 22877: Prevent double overdue processing for lost and returned
    
    Test plan:
    1 - Issue an item to a patron with a backdated due date
    2 - Run fines.pl - note you generate a fine for the patron
    3 - Run longoverdue.pl - make sure MarkLostItemsAsReturned is turned off
    and to charge
    4 - Confirm the patron has a lost fee and an overdue
    5 - Return the item
    6 - With patch applied, patron should now have 1 overdue fine and 1 lost fine
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 01c4ee5703af156e2bb2057da83e156f9090be40
Author: Nick Clemens <nick@bywatersolutions.com>
Date:   Thu May 9 12:32:38 2019 +0000

    Bug 22877: Unit test to highlight problem
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 83af64f59fdc02c470f6e9754cbc922862aa1d18
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 3 17:40:38 2019 +0100

    Bug 22906: Compiled CSS
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit e9294c3cc20584adebb6d38451ebccce86a8f1aa
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 14 13:10:32 2019 +0000

    Bug 22906: Minor corrections to plugins home page
    
    This patch makes a few minor markup improvements to the plugins home
    page and corrects some CSS introduced by Bug 22053 which was having
    unintended consequences elsewhere.
    
    To test, apply the patch and rebuild the staff client CSS.
    
     - You should have one or more plugins installed.
     - Go to Administration -> Manage plugins.
     - The "badges" for disabled and enabled should look correct.
     - Go to Tools -> Staged MARC management and click on an batch.
       - In the information about the batch, the labels should be bold.
    
    Signed-off-by: Liz Rea <wizzyrea@gmail.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit a4844b85eed809c20053adb7862c21601d6cf148
Author: Owen Leonard <oleonard@myacpl.org>
Date:   Tue May 21 16:29:06 2019 +0000

    Bug 22953: Markup warning in OPAC user summary template
    
    This patch makes a minor markup change to the OPAC user summary template
    (opac-user.tt) in order to quiet warnings from the HTML validator. The
    obsolete name attribute on two links is removed in favor of class names.
    The JavaScript has been modified accordingly.
    
    To reproduce the problem you should have the AllowCheckoutNotes system
    preference enabled. Log in to the OPAC as a user who has checkouts and
    view the "your summary" page. Run the page through the W3C validation
    service: https://validator.w3.org. Either by pasting in the URL for the
    search results (if web accessible) or by viewing source, copying, and
    pasting into "Validate by Direct Input."
    
    This patch specifically addresses this warning:
    
     - "The name attribute is obsolete. Consider putting an id attribute on
       the nearest container instead."
    
    To test, apply the patch and try again to reproduce the validation
    errors. Those errors should no longer be present. There should be no
    visible change to the page.
    
    Test the process of adding or editing an note on a checkout. It should
    work correctly.
    
    Signed-off-by: Maryse Simard <maryse.simard@inlibro.com>
    
    Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>

commit 4f81a252ddceaf2cd964aa0cfb95d0966b781dd8
Author: Martin Renvoize <martin.renvoize@ptfs-europe.com>
Date:   Mon Jun 3 10:50:50 2019 +0100

    Koha 19.06 - Wingardium Leviosa!
    
      “Hermione rolled up the sleeves of her gown,
       flicked her wand and said, 'Wingardium Leviosa!'
    
       The feather rose off the desk and hovered about
       four feet above their heads.
    
       ‘Oh, well done!’ cried Professor Flitwick, clapping.
       ‘Everyone see here, Miss Granger’s done it!’”
    
    Together, let's make Koha fly to new heights, 🧹
    
    Signed-off-by: Martin Renvoize <martin.renvoize@ptfs-europe.com>
